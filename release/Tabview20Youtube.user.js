// ==UserScript==
// @name                  Tabview Youtube
// @name:en               Tabview Youtube




// @version               4.73.41
// @resource              contentCSS        https://raw.githubusercontent.com/cyfung1031/Tabview-Youtube/d066d967b779d8bf9a53917929af0277ff31a56b/css/style_content.css
// @resource              chatCSS           https://raw.githubusercontent.com/cyfung1031/Tabview-Youtube/d066d967b779d8bf9a53917929af0277ff31a56b/css/style_chat.css
// @resource              controlCSS        https://raw.githubusercontent.com/cyfung1031/Tabview-Youtube/d066d967b779d8bf9a53917929af0277ff31a56b/css/style_control.css
// @resource              injectionJS1      https://raw.githubusercontent.com/cyfung1031/Tabview-Youtube/d066d967b779d8bf9a53917929af0277ff31a56b/js/injection_script_1.js
// @require               https://greasyfork.org/scripts/465421-vanilla-js-dialog/code/Vanilla%20JS%20Dialog.js?version=1188332

// @namespace             http://tampermonkey.net/
// @author                CY Fung
// @license               MIT
// @supportURL            https://github.com/cyfung1031/Tabview-Youtube
// @run-at                document-start
// @match                 https://www.youtube.com/*
// @exclude               /^https?://\w+\.youtube\.com\/live_chat.*$/
// @exclude               /^https?://\S+\.(txt|png|jpg|jpeg|gif|xml|svg|manifest|log|ini)[^\/]*$/
// @icon                  https://raw.githubusercontent.com/cyfung1031/Tabview-Youtube/main/images/icon128p.png

// @compatible            edge Edge [Blink] >= 79;                      Tampermonkey (Beta) / Violentmonkey
// @compatible            chrome Chrome >= 54;                          Tampermonkey (Beta) / Violentmonkey
// @compatible            firefox FireFox / Waterfox (Classic) >= 55;   Tampermonkey / Violentmonkey
// @compatible            opera Opera >= 41;                            Tampermonkey (Beta) / Violentmonkey
// @compatible            safari Safari >= 12.1

// @grant                 GM_getResourceText
// @grant                 GM.getResourceText
// @grant                 GM_registerMenuCommand
// @noframes
// @downloadURL https://raw.githubusercontent.com/king1x32/compiledUserscripts/release/release/Tabview20Youtube.user.js
// @updateURL https://raw.githubusercontent.com/king1x32/compiledUserscripts/release/release/Tabview20Youtube.meta.js
// ==/UserScript==
function t(){"use strict";function t(t){return e.createHTML(t)}if("undefined"!=typeof trustedTypes&&null===trustedTypes.defaultPolicy){let o=t=>t;trustedTypes.createPolicy("default",{createHTML:o,createScriptURL:o,createScript:o})}const e="undefined"!=typeof trustedTypes&&trustedTypes.defaultPolicy||{createHTML:t=>t};let n=null;try{document.createElement("div").innerHTML=t("1")}catch(l){n=l}if(n&&(console.log("trustHTMLErr",n),n()),"object"==typeof window){function r(){(()=>{let t="undefined"!=typeof unsafeWindow?unsafeWindow:this instanceof Window?this:window;if(!t._ytConfigHacks){let e=4;class n extends Set{add(t){if(e<=0)return console.warn("yt.config_ is already applied on the page.");"function"==typeof t&&super.add(t)}}let o=(async()=>{})().constructor,l=t._ytConfigHacks=new n,r=()=>{let e=t.ytcsi.originalYtcsi;e&&(t.ytcsi=e,r=null)},i=null,a=()=>{if(e>=1){let n=(t.yt||0).config_||(t.ytcfg||0).data_||0;if("string"==typeof n.INNERTUBE_API_KEY&&"object"==typeof n.EXPERIMENT_FLAGS)for(let t of(--e<=0&&r&&r(),i=!0,l))t(n)}},c=1,s=e=>{if(e=e||t.ytcsi)return t.ytcsi=new Proxy(e,{get:(t,e)=>"originalYtcsi"===e?t:(a(),i&&--c<=0&&r&&r(),t[e])}),!0};s()||Object.defineProperty(t,"ytcsi",{get(){},set:e=>(e&&(delete t.ytcsi,s(e)),!0),enumerable:!1,configurable:!0});let{addEventListener:d,removeEventListener:u}=Document.prototype;function y(e){a(),e&&t.removeEventListener("DOMContentLoaded",y,!1)}new o(t=>{if("undefined"!=typeof AbortSignal)d.call(document,"yt-page-data-fetched",t,{once:!0}),d.call(document,"yt-navigate-finish",t,{once:!0}),d.call(document,"spfdone",t,{once:!0});else{let e=()=>{t(),u.call(document,"yt-page-data-fetched",e,!1),u.call(document,"yt-navigate-finish",e,!1),u.call(document,"spfdone",e,!1)};d.call(document,"yt-page-data-fetched",e,!1),d.call(document,"yt-navigate-finish",e,!1),d.call(document,"spfdone",e,!1)}}).then(a),new o(t=>{if("undefined"!=typeof AbortSignal)d.call(document,"yt-action",t,{once:!0,capture:!0});else{let e=()=>{t(),u.call(document,"yt-action",e,!0)};d.call(document,"yt-action",e,!0)}}).then(a),o.resolve().then(()=>{"loading"!==document.readyState?y():t.addEventListener("DOMContentLoaded",y,!1)})}})();let t=!1;window._ytConfigHacks.add(e=>{if(t)return;t=!0;const n=e.EXPERIMENT_FLAGS||0,o=e.EXPERIMENTS_FORCED_FLAGS||0;for(const t of[n,o])t&&(t.kevlar_watch_metadata_refresh_no_old_secondary_data=!1,t.live_chat_overflow_hide_chat=!1,t.web_watch_chat_hide_button_killswitch=!1,t.web_watch_theater_chat=!1,t.suppress_error_204_logging=!0,t.kevlar_watch_grid=!1,t.enable_shadydom_free_scoped_node_methods=!1,t.enable_shadydom_free_scoped_query_methods=!1,t.enable_shadydom_free_scoped_readonly_properties_batch_one=!1,t.enable_shadydom_free_parent_node=!1,t.enable_shadydom_free_children=!1,t.enable_shadydom_free_last_child=!1)}),new Promise(t=>{document.addEventListener("yt-action",t,{once:!0,capture:!0})}).then(()=>{"function"!=typeof EventTarget.prototype.addEventListener52178&&"function"==typeof EventTarget.prototype.addEventListener&&(EventTarget.prototype.addEventListener52178=EventTarget.prototype.addEventListener,EventTarget.prototype.addEventListener=function(t,e,n){if("wheel"===t&&!n&&"function"==typeof e&&void 0===this.overscrollConfigDisable)try{this.overscrollConfigDisable=!0,delete this.overscrollConfig,Object.defineProperty(this,"overscrollConfig",{get(){},set:()=>!0,configurable:!0,enumerable:!1});const t=(o=this)?o.polymerController||o.inst||o||0:o||0;t!==this&&(delete t.overscrollConfig,Object.defineProperty(t,"overscrollConfig",{get(){},set:()=>!0,configurable:!0,enumerable:!1}))}catch(t){}var o;return this.addEventListener52178(t,e,n)})})}let i=document.createElement("button");i.setAttribute("onclick",`(${r})()`),i.click()}!function(e){function n(t){const{hrs:e,mins:n,seconds:o}=t;let l=[];return l.push("Length:"),e>0&&l.push(`${e} ${1===e?"hour":"hours"}`),n>0&&l.push(`${n} ${1===n?"minute":"minutes"}`),null!==o&&l.push(`${o} ${1===o?"second":"seconds"}`),l.join(" ")}function o(t){const{hrs:e,mins:n,seconds:o}=t;let l=[];return l.push("長さ："),e>0&&l.push(`${e}時間`),n>0&&l.push(`${n}分`),null!==o&&l.push(`${o}秒`),l.join("")}function l(t,e){const{bd1:o,bd2:l,durationInfo:r,formatDates:i}=e;switch(t){case 512:return[`The livestream was in ${o.lokStringDateEN()} from ${o.lokStringTime()} to ${l.lokStringTime()}. [GMT${Ie()}]`,n(r)].join("\n");case 528:return[`The livestream was from ${o.lokStringDateEN()} ${o.lokStringTime()} to ${l.lokStringDateEN()} ${l.lokStringTime()}. [GMT${Ie()}]`,n(r)].join("\n");case 768:return`The livestream started at ${o.lokStringTime()} [GMT${Ie()}] in ${o.lokStringDateEN()}.`;case 1536:return`The video was uploaded in ${i.uploadDate} and published in ${i.publishDate}.`;case 1552:return`The video was uploaded in ${i.uploadDate}.`;case 1792:return`The video was published in ${i.publishDate}.`}return""}function r(t,e){const{bd1:n,bd2:l,durationInfo:r,formatDates:i}=e;switch(t){case 512:return[`ライブ配信は${n.lokStringDateJP()}の${n.lokStringTime()}から開始し、${l.lokStringTime()}まで続きました。[GMT${Ie()}]`,o(r)].join("\n");case 528:return[`ライブ配信は${n.lokStringDateJP()}の${n.lokStringTime()}から${l.lokStringDateJP()}の${l.lokStringTime()}まで行われました。[GMT${Ie()}]`,o(r)].join("\n");case 768:return`ライブ配信は${n.lokStringDateJP()}の${n.lokStringTime()}から開始しました。[GMT${Ie()}]`;case 1536:return`この動画は${i.uploadDate}にアップロードされ、${i.publishDate}に公開されました。`;case 1552:return`この動画は${i.uploadDate}にアップロードされました。`;case 1792:return`この動画は${i.publishDate}に公開されました。`}return""}function i(){document.querySelector("ytd-watch-flexy[is-two-columns_][theater] ytd-live-chat-frame#chat:not([collapsed])")&&I()}function a(){if(xn.ytlstmTheaterMode&&(document.fullscreenElement||document.querySelector("ytd-watch-flexy[fullscreen]")))return xn.allowChatControl=!0,void(xn.ytlstmTheaterMode=!1);xn.allowChatControl?document.body.hasAttribute("data-ytlstm-theater-mode")&&(xn.allowChatControl=!1,xn.ytlstmTheaterMode=!0):document.body.hasAttribute("data-ytlstm-theater-mode")||(xn.allowChatControl=!0,xn.ytlstmTheaterMode=!1)}async function c(t,e,...n){if(!Hn){const t=(Rn.get(e)||0)+1;if(Rn.set(e,t),await Fn.d(),t!==Rn.get(e))return}t.dispatchEvent(new CustomEvent("tabview-page-script",{detail:{id:e,args:n.length?n:null}}))}function s(t){const e=new Array(t);for(let n=0;n<t;n++){let t=null;do{t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()))}while(0===n&&10-t>0);e[n]=t}return e.join("")}function d(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)}async function u(){if("watch"!==he)return;const t=Xe.ytdFlexy;t&&"#tab-comments"===t.getAttribute("tyt-tab")&&c(document,"tabview-resize-comments-rows")}function y(t,e){return new zt(n=>{t&&"function"==typeof t.requestPictureInPicture&&"function"==typeof document.exitPictureInPicture?function(t){return t.currentTime>0&&!t.paused&&!t.ended&&t.readyState>t.HAVE_CURRENT_DATA}(t)&&null===document.pictureInPictureElement?t.requestPictureInPicture().then(()=>{n(!0)}).catch(t=>{void 0===e?console.warn(t):"function"==typeof e&&e(t),n(!1)}):n(!1):n(null)})}function f(){null!==document.pictureInPictureElement&&"function"==typeof document.exitPictureInPicture&&document.exitPictureInPicture().then(()=>{}).catch(console.warn)}function h(){if(me&&"string"==typeof me.txt_expand&&"string"==typeof me.txt_collapse){let t=document.querySelector("ytd-live-chat-frame#chat");if(!t)return;let e=tn.call(t,'span.yt-core-attributed-string[role="text"]'),n=(e||0).textContent;"string"==typeof n&&n.length>2&&(t.hasAttribute("collapsed")?n!==me.txt_expand&&(e.textContent=me.txt_expand):n!==me.txt_collapse&&(e.textContent=me.txt_collapse))}else if(me&&"string"==typeof me.txt_expand){let t=document.querySelector("ytd-live-chat-frame#chat");if(!t)return;let e=tn.call(t,'span.yt-core-attributed-string[role="text"]'),n=(e||0).textContent;"string"==typeof n&&n.length>2&&t.hasAttribute("collapsed")&&n!==me.txt_expand&&(e.textContent=me.txt_expand)}}function m(){Fn.debounce(()=>{!async function(){let t=document.querySelector("#secondary.ytd-watch-flexy");if(t){if(t.classList.contains("tabview-hover-slider-enable"))t.dispatchEvent(new CustomEvent("tabview-hover-slider-restore"));else{let e=tn.call(t,"#secondary-inner.ytd-watch-flexy");if(e){t.classList.contains("tabview-hover-slider")||e.style.setProperty("--tabview-slider-right",`${b()}px`);let n=await async function(){let t=document.documentElement.clientHeight,e=(document.querySelector("#right-tabs")||0).clientHeight;return await zt.resolve(0),t>300&&e>300?e/t:0}();n>0&&n<=1&&(e.style.setProperty("--ytd-watch-flexy-sidebar-width-d",Math.round(100*n*10)/10+"vw"),t.classList.add("tabview-hover-slider"),t.classList.add("tabview-hover-slider-enable"),y(document.querySelector("#player video")))}}u()}}()})}function p(e){if(!e)return null;let n=e.id;if(!n||"string"!=typeof n)return null;if(tn.call(e,`#${n} > tabview-view-tab-expander`))return!1;let o=document.createElement("tabview-view-tab-expander");return co(o,e),o.innerHTML=t(`<div>${oo(16,16,12,12,'<svg stroke="currentColor" fill="none"><path d="M8 2h2v2M7 5l3-3m-6 8H2V8m0 2l3-3"/></svg>',"svg-expand")}${oo(16,16,12,12,'<svg stroke="currentColor" fill="none"><path d="M7 3v2h2M7 5l3-3M5 9V7H3m-1 3l3-3"/></svg>',"svg-collapse")}</div>`),o.addEventListener("click",m,!1),!0}function b(){let t=document.querySelector("#secondary.style-scope.ytd-watch-flexy + tabview-view-columns-endpos"),e=document.querySelector("#secondary.style-scope.ytd-watch-flexy > tabview-view-secondary-xpander");return t&&e?t.getBoundingClientRect().x-e.getBoundingClientRect().right:null}function v(){let t=document.querySelector("ytd-watch-flexy[class][is-two-columns_] #secondary-inner.ytd-watch-flexy");if(!t)return;let e=Ft(t);if(!e)return;if(e.classList.contains("tabview-hover-slider-enable"))return;let n=document.documentElement.clientWidth;Mn.lockWith(e=>{let o=document.documentElement.clientWidth;n===o&&t.matches("body ytd-watch-flexy[class][is-two-columns_] #secondary-inner.ytd-watch-flexy")?async function(t){await yn();let e=Ft(t);if(!e)return;if(e.classList.contains("tabview-hover-slider-enable"))return;if(!e.matches("#columns.ytd-watch-flexy #primary.ytd-watch-flexy ~ #secondary.ytd-watch-flexy"))return;const n=!0===we,o=!0===e.classList.contains("tabview-hover-slider-hover");(n||o)&&(await zt.resolve(0),e.classList.add("tabview-hover-final"),o&&!n?(t.style.removeProperty("--tabview-slider-right"),t.style.removeProperty("--tabview-slider-offset")):(o||t.style.setProperty("--tabview-slider-right",`${b()}px`),Zn(t)),n^o&&(e.classList.toggle("tabview-hover-slider",n),e.classList.toggle("tabview-hover-slider-hover",n)),await zt.resolve(0),setTimeout(()=>{e.classList.remove("tabview-hover-final")},350))}(t).then(e):e()})}function g(t){if(A()&&k())return;const e=document.querySelector(`a[tyt-tab-content="${pe}"]:not(.tab-btn-hidden)`)||document.querySelector(`a[tyt-tab-content="${t||ke.defaultTab}"]:not(.tab-btn-hidden)`)||document.querySelector(`a[tyt-tab-content="${Te}"]:not(.tab-btn-hidden)`)||document.querySelector("a[tyt-tab-content]:not(.tab-btn-hidden)")||null;return At(e),!!e}function w(t){return!(t&ee)&&t&te?t|le:-257&t}function x(t,e,n){t&&(!0===n?t.setAttribute(e,""):!1===n?t.removeAttribute(e):null===n||"string"==typeof n&&t.setAttribute(e,n))}function E(t,e){let n=!1;"#tab-comments"===t.getAttribute("tyt-tab-content")?($e=!e,2&~qe&&(n=!0)):n=!0,n&&(e?t.classList.remove("tab-btn-hidden"):t.classList.add("tab-btn-hidden"))}function S(t){let e=t.classList.contains("active");E(t,!1),e&&g()}function A(){const t=Xe.ytdFlexy;return t&&t.hasAttribute("theater")}function L(){const t=Xe.ytdFlexy;return t&&t.hasAttribute("fullscreen")}function T(){const t=Xe.ytdFlexy;return t&&"+"===(t.getAttribute("tyt-chat")||"").charAt(0)}function k(){const t=Xe.ytdFlexy;return t&&t.hasAttribute("is-two-columns_")}function _(){const t=Xe.ytdFlexy;return t&&+t.getAttribute("tyt-ep-visible")>0}function C(){const t=Xe.ytdFlexy;return t&&t.hasAttribute("tyt-donation-shelf")}function q(){let t=[],e=0;for(const n of document.querySelectorAll("ytd-watch-flexy[class][tyt-tab] #panels.ytd-watch-flexy ytd-engagement-panel-section-list-renderer[target-id][visibility]:not([hidden])")){let o=n.getAttribute("target-id");if("string"!=typeof o)continue;let l=lo.get(o);l||(lo.set(o,l=ro),ro===1<<62?(ro=1,console.warn("engagementId reached 1 << 62")):ro<<=1);let r=l;"ENGAGEMENT_PANEL_VISIBILITY_EXPANDED"===n.getAttribute("visibility")?(e|=r,t.push({ePanel:n,k:r,visible:!0})):t.push({ePanel:n,k:r,visible:!1})}return{list:t,value:e}}function D(t){let e=t.getAttribute("target-id");Fn.debounce(()=>{document.dispatchEvent(new CustomEvent("tyt-engagement-panel-visibility-change",{detail:{panelId:e,toHide:!0}}))})}function M(){if(_())for(const t of document.querySelectorAll("ytd-watch-flexy[class][tyt-tab] #panels.ytd-watch-flexy ytd-engagement-panel-section-list-renderer[target-id][visibility]:not([hidden])"))"ENGAGEMENT_PANEL_VISIBILITY_EXPANDED"==t.getAttribute("visibility")&&D(t)}function $(){if(C()){let t=document.querySelector("#tyt-donation-shelf-toggle-btn");if(t)return t.click(),!0}return!1}function P(){if(!A()){const t=document.querySelector("ytd-watch-flexy #ytd-player button.ytp-size-button");t&&t.click()}}function N(){if(A()){const t=document.querySelector("ytd-watch-flexy #ytd-player button.ytp-size-button");t&&t.click()}}function F(){let t=document.querySelector("ytd-live-chat-frame#chat[collapsed] > .ytd-live-chat-frame#show-hide-button");t&&(t=tn.call(t,"div.yt-spec-touch-feedback-shape")||tn.call(t,"ytd-toggle-button-renderer"),t&&t.click())}function I(){let t=document.querySelector("ytd-live-chat-frame#chat:not([collapsed]) > .ytd-live-chat-frame#show-hide-button");t&&(t=tn.call(t,"div.yt-spec-touch-feedback-shape")||tn.call(t,"ytd-toggle-button-renderer"),t&&t.click())}function H(){Fn.debounce(()=>{if(!ae)return;let t=document.querySelector("*:not(#tab-videos) > #related.ytd-watch-flexy > ytd-watch-next-secondary-results-renderer");if(t){let e=nn.call(t,"#related.ytd-watch-flexy"),n=document.querySelector("#right-tabs"),o=on(n,"#tab-videos");if(null!==o){let t=document.querySelector("ytd-watch-flexy:not([is-two-columns_]) #primary-inner.ytd-watch-flexy, ytd-watch-flexy[is-two-columns_] #secondary-inner.ytd-watch-flexy");t&&rn.call(t,n),rn.call(o,e),e.setAttribute("placeholder-for-youtube-play-next-queue",""),e.setAttribute("placeholder-videos",""),async function(){let t=document.querySelector("ytd-watch-flexy #tab-videos [placeholder-videos]");if(!t)return null;await zt.resolve(0);let e=document.querySelector("tabview-view-videos-endpos");e&&e.remove(),e=document.createElement("tabview-view-videos-endpos"),ao(e,t),await zt.resolve(0),Se?(Se.disconnect(),Se.observe(e)):(Se=new IntersectionObserver(t=>{if(!(2&~no.layoutStatus))return;if(1!==t.length)return;if(!0!==t[0].isIntersecting)return;let e=(t[0]||0).target||0;e&&(e=null,t=null,new zt(t=>{document.querySelector("#related.style-scope.ytd-watch-flexy ytd-watch-next-secondary-results-renderer.style-scope.ytd-watch-flexy ytd-compact-video-renderer.yt-search-generated.style-scope.ytd-item-section-renderer ~ ytd-continuation-item-renderer.style-scope.ytd-item-section-renderer[hidden]")||document.querySelector('ytd-watch-next-secondary-results-renderer.style-scope.ytd-watch-flexy yt-chip-cloud-renderer.style-scope.yt-related-chip-cloud-renderer yt-chip-cloud-chip-renderer.style-scope.yt-chip-cloud-renderer[aria-selected="false"] ~ [aria-selected="true"]')||yn().then(t)}).then(()=>{let t=function(){let t={};return t.m2=document.querySelector("[placeholder-videos] tp-yt-paper-spinner#spinner.style-scope.ytd-continuation-item-renderer"),t.m2&&x(t.m2,"hidden",!1),t.m3=document.querySelector("[placeholder-videos] div#button.style-scope.ytd-continuation-item-renderer"),t.m3&&x(t.m3,"hidden",""),t}();if(t.m2&&t.m3){const e=nn.call(t.m2,"ytd-continuation-item-renderer");if(e){const t=tn.call(e,"ytd-button-renderer.style-scope.ytd-continuation-item-renderer, yt-button-renderer.style-scope.ytd-continuation-item-renderer"),n=on(t,"button.yt-spec-button-shape-next--call-to-action");n?n.click():t?t.click():e.dispatchEvent(new Event("yt-service-request-sent-button-renderer"))}}t=null}))},{rootMargin:"0px",threshold:[0]}),Se.observe(e))}()}}if(a(),!xn.allowChatControl)return;let e=null;if(e=document.querySelector("ytd-live-chat-frame#chat")){const t="chat-container"===e.parentNode.id?e.parentNode:e;let n=document.querySelector('tabview-view-pholder[data-positioner="before|#chat"]');if(!n||n.nextElementSibling!==t){if(n&&n.remove(),document.querySelector(".YouTubeLiveFilledUpView"));else{let e=document.querySelector("#right-tabs");if(e&&e.previousSibling!==t){const n=e.parentNode;let o=!0;if(n===t.parentNode&&n instanceof HTMLElement&&"function"==typeof Bt&&"function"==typeof jt){const l=[],r=[];let i=0;for(let o=n.firstChild;o instanceof Node;o=o.nextSibling)if(o===e)i|=1;else if(o===t)i|=2;else{if(o instanceof HTMLIFrameElement||o instanceof Element&&o.querySelector("iframe")){i|=4;break}1&i?r.push(o):l.push(o)}if(3===i&&l.length+r.length<8e3){if(l.length>0){const t=Bt.call(document);jt.call(t,...l),n.insertBefore(t,n.firstChild)}const t=Bt.call(document);jt.call(t,e,...r),n.appendChild(t),o=!1}}o&&io(t,e)}}n||(n=document.createElement("tabview-view-pholder"),n.setAttribute("data-positioner","before|#chat")),io(n,t)}}})}function R(){if(document.querySelector("autocomplete-holder"))return;let t,e;t=this,this.removeEventListener("tyt-autocomplete-sc-exist",R,!1);let n=this.getAttribute("data-autocomplete-results-id");if(e=document.querySelector(`[data-autocomplete-input-id="${n}"]`),!n||!t)return;let o=Rt(t);o&&"tabview-view-autocomplete-pos"===o.nodeName.toLowerCase()||(o=function(){let t=document.createElement("tabview-view-autocomplete-pos"),e=document.querySelector("tabview-view-autocomplete-pos");return e&&e.remove(),t}(),io(o,t)),co(e,o),async function(t,e){let n=t.offsetHeight+"px";e.style.setProperty("--tyt-swwv-searchbox-h",n),O()}(t,o)}function O(){const t=Xe.ytdFlexy;if(!ae||!t)return;const e=tn.call(t,"[placeholder-for-youtube-play-next-queue] #suggestions-search-container tabview-view-autocomplete-pos > .autocomplete-suggestions[data-autocomplete-input-id]:not([position-fixed-by-tabview-youtube])");if(e){const n=document.querySelector("[placeholder-for-youtube-play-next-queue] input#suggestions-search");if(n){const o=hn(e);function l(t,e){t.style.display=e?"block":"none"}function r(t,e){return(t.value||"").length>0&&(e.textContent||"").length>0}if(Ft(e).setAttribute("position-fixed-by-tabview-youtube",""),e.setAttribute("position-fixed-by-tabview-youtube",""),e.setAttribute("userscript-scrollbar-render",""),!n.hasAttribute("is-set-click-to-toggle")){n.setAttribute("is-set-click-to-toggle",""),n.addEventListener("click",function(){zt.resolve(0).then(()=>{const t=mn(o);t&&r(this,t)&&l(t,!d(t))})},Ze);let i=null,a=0;n.addEventListener("keydown",function(t){switch(t.code){case"ArrowUp":case"ArrowDown":let t=Date.now();0===a&&(Gt().then(()=>{if(a=0,Date.now()-t>300)return;const e=mn(o);if(!e)return;let n=tn.call(e,".autocomplete-suggestion.selected"),l=n&&n!==i;if(i=n,l)try{n.scrollIntoView({block:"nearest",inline:"nearest"})}catch(t){}}),a=1)}},Ze),n.addEventListener("tyt-autocomplete-suggestions-change",function(t){t.target===document.activeElement&&yn().then(()=>{const t=document.querySelector(`.autocomplete-suggestions[data-autocomplete-input-id="${this.getAttribute("data-autocomplete-results-id")}"]`);t&&r(this,t)&&l(t,!0)})},Ze)}}}}function B(t){if(null===t&&!(t=document.querySelector("ytd-watch-flexy[playlist] *:not(#tabview-playlist-wrapper) > ytd-playlist-panel-renderer.style-scope.ytd-watch-flexy#playlist:not(.ytd-miniplayer)")))return;const e=Xe.ytdFlexy;if(ae&&e&&null!==tn.call(t,"*:not(#tabview-playlist-wrapper) > ytd-playlist-panel-renderer#playlist:not(.ytd-miniplayer) #items.ytd-playlist-panel-renderer:not(:empty)")&&"YTD-PLAYLIST-PANEL-RENDERER"===t.nodeName.toUpperCase()){let e=document.querySelector("#tab-list");if(!e)return;let n=function(t){let e=document.getElementById(t);return e||(e=document.createElement("div"),e.id=t),e}("tabview-playlist-wrapper"),o=new DocumentFragment;o.appendChild(n),rn.call(n,t),rn.call(e,o),o=null,n=null}}function j(t){return`${fe||0}...${t.textContent}`}function z(t){const e=Xe.ytdFlexy;if(!ae||!e)return;if("watch"!==he)return;const n=document.querySelector("ytd-comments#comments");if(!n)return;const o=en.call(n,"#count.ytd-comments-header-renderer, ytd-item-section-renderer.ytd-comments#sections #header ~ #contents > ytd-message-renderer.ytd-item-section-renderer"),l=+(Date.now()-de+"00");let r=new Array(o.length);r.newFound=!1;let i=0,a=-1,c=se;se=l;for(const t of o){let e=0;if("count"===t.id?e=1:(t.textContent||"").trim()&&(e=2),e>0){let n=c-(Ue.get(t)||0),o=n>4||n<-4;o?(Ue.set(t,l+1),r.newFound=!0,a=i):Ue.set(t,l),r[i]={elm:hn(t),isNew:o,isLatest:!1,f:so[e-1]},i++}}if(r.length>i&&(r.length=i),a>=0){r[a].isLatest=!0;let t=mn(r[a].elm);t&&(uo=t.textContent)}else if(1===r.length){let t=mn(r[0].elm);if(t){let e=t.textContent;e!==uo&&(Ue.set(t,l+1),r.newFound=!0,r[0].isNew=!0,a=0,r[a].isLatest=!0),uo=e}}return t&&yo(r),r}function V(){if(2===ue)return;const e=Xe.ytdFlexy;if(!e)return;if((e.getAttribute("tyt-comments")||"").indexOf("K")>=0)return;if(!tn.call(e,"ytd-comments#comments:not([hidden])"))return;e.setAttribute("tyt-comments","Kz");const n=document.querySelector('[tyt-tab-content="#tab-comments"]');let o=tn.call(n,"span#tyt-cm-count");n.removeAttribute("loaded-comment"),o.innerHTML=t(""),n&&E(n,!0)}function W(){$n.resolved&&0===Le.comments_section_loaded&&Pe.new&&!Pe.fetched&&(Pe.new.f(),Pe.fetched=!0,pt())}function Y(t){let e=!1;t&&2!==ue&&document.querySelector("ytd-comments#comments:not([hidden])")&&(bt(0),W(),e=!0),G(e)}function G(t){2!==ue&&(document.querySelector("ytd-comments#comments").hasAttribute("hidden")?gt():0===Le.comments_section_loaded&&(!t&&3&~ce||lt()))}function U(){be={lastTab:null,lastPanel:null,last:null},ae=!1,Ae=null,no.layoutStatus=0,Yn.clear(!0),Un.clear(!0),Kn.clear(!0),zn.clear(!0),Vn.clear(!0),ge=null}function X(t){if(!(t instanceof HTMLElement))return null;let e=t.textContent;if(0===e.trim().length)return null;let n=t.nodeName,o=t.id;return o&&(n+="#"+o),n+"\n"+e}async function K(){let t=document.querySelector("#primary.ytd-watch-flexy #above-the-fold.ytd-watch-metadata"),e=document.querySelector("#tab-info ytd-expander > #content");if(t&&e){const n=new Set;for(let t=Ot(e);t instanceof HTMLElement;t=Ot(t)){let e=X(t);null!==e&&n.add(e)}for(let e=Ot(t);e instanceof HTMLElement;e=Ot(e)){let t=X(e);null!==t&&n.has(t)?e.classList.add("tyt-hidden-duplicated-meta"):e.classList.remove("tyt-hidden-duplicated-meta")}n.clear()}}async function J(){if(!document.querySelector("#tab-info"))return;const t=document.querySelectorAll("[tyt-info-expander-placeholder]");if(1===t.length){const e=t[0],n=po.get(e);if(!n)return;for(const t of document.querySelectorAll("[tyt-info-expander-content]"))n!==t&&t.remove();!1===n.isConnected&&document.querySelector("#tab-info").appendChild(n),bo()&&vo.resolve()}}function Z(t){return Fe[Ne][t]||Fe.en[t]||""}function Q(){let t="en";switch(((document||0).documentElement||0).lang||""){case"en":case"en-GB":default:t="en";break;case"de":case"de-DE":t="du";break;case"fr":case"fr-CA":case"fr-FR":t="fr";break;case"zh-Hant":case"zh-Hant-HK":case"zh-Hant-TW":t="tw";break;case"zh-Hans":case"zh-Hans-CN":t="cn";break;case"ja":case"ja-JP":t="jp";break;case"ko":case"ko-KR":t="kr";break;case"ru":case"ru-RU":t="ru"}return t}function tt(){const t=Xe.ytdFlexy;if(!ae||!t)return;const e=document.documentElement;e.setAttribute("sxmq8","1"===e.getAttribute("sxmq8")?"0":"1"),console.log("sxmq8 r1",document.documentElement.getAttribute("sxmq8"));let n=tn.call(t,"#primary.ytd-watch-flexy ytd-watch-metadata ~ ytd-comments#comments");if(n){let t=document.querySelector("#tab-comments");t&&rn.call(t,n)}B(null),H(),O()}function et(t,e){if(!e)return;const n=(Re[t]||0)+1;Re[t]=n;const o=He[n-1]||(He[n-1]=Symbol());document.addEventListener(t,function(t){t[o]||(t[o]=!0,zt.resolve().then(()=>{e(t)}))},Qe)}function nt(){let t=document.querySelector("#below h1.ytd-watch-metadata yt-formatted-string");if(t){let e="";try{if(Xo&&Object.keys(Xo).length>0){function n(t,e){let n=e-t,o=Math.floor(n/36e5);n-=36e5*o;let l=Math.round(n/6e4),r=null;return l<10&&0===o&&(l=Math.floor(n/6e4),n-=6e4*l,r=Math.round(n/1e3),0===r&&(r=null)),{hrs:o,mins:l,seconds:r}}const o="jp"===Q()?r:l;if(Xo.broadcastBeginAt&&!1===Xo.isLiveNow){let i=new kn(Xo.broadcastBeginAt),a=Xo.broadcastEndAt?new kn(Xo.broadcastEndAt):null,c=0;a&&i.toLocaleDateString()===a.toLocaleDateString()?c=1:a&&+a>+i&&a-i<864e5&&i.getHours()>=6&&a.getHours()<6&&(c=2);let s=n(i,a);c>0?(a.dayBack=2===c,e=o(512,{bd1:i,bd2:a,isSameDay:c,durationInfo:s,formatDates:Xo})):a&&0===c&&(e=o(528,{bd1:i,bd2:a,isSameDay:c,durationInfo:s,formatDates:Xo}))}else Xo.broadcastBeginAt&&!0===Xo.isLiveNow?e=o(768,{bd1:new kn(Xo.broadcastBeginAt),formatDates:Xo}):Xo.uploadDate?e=Xo.publishDate&&Xo.publishDate!==Xo.uploadDate?o(1536,{formatDates:Xo}):o(1552,{formatDates:Xo}):!Xo.uploadDate&&Xo.publishDate&&(e=o(1792,{formatDates:Xo}))}}catch(d){e=""}e?t.setAttribute("data-title-details",e):t.removeAttribute("data-title-details")}}function ot(){let t=document.querySelector(`#tab-list ytd-playlist-panel-renderer#playlist:not([o3r-${Gn}])`);const e=Xe.ytdFlexy;if(ae&&e&&t){Yn.bindElement(t)&&Yn.observer.check(9);let e=hn(t);Fn.debounce(()=>{let t=mn(e);e=null,t&&!0===t.isConnected&&c(t,"tabview-yt-data-reassign"),t=null},go),t=null}mo.mtf_attrPlaylist(),zt.resolve(0).then(()=>{const t=Xe.ytdFlexy;ae&&t&&(pe||0!==(t.getAttribute("tyt-tab")+"").indexOf("#tab-")||"/watch"!==location.pathname||(/[\?\&]list=[\w\-\_]+/.test(location.search)?g("#tab-list")&&(pe="#tab-list"):/[\?\&]lc=[\w\-\_]+/.test(location.search)&&g("#tab-comments")&&(pe="#tab-comments")))}),zt.resolve(0).then(()=>{!function(){let t=document.querySelector("#tab-list ytd-playlist-panel-renderer#playlist");if(t&&t.matches("[collapsed], [collapsible]")){const e=t;t=null;const n=nn.call(e,"ytd-watch-flexy #tab-list");if(!n||1!==n.nodeType)return;e.hasAttribute("collapsed")&&x(e,"collapsed",!1),e.hasAttribute("collapsible")&&x(e,"collapsible",!1)}}()})}function lt(){function t(){if(!$n.resolved)return;if(0!==Le.comments_section_loaded)return;if(Pe.fetched)return;let t=z(!0);if(!Pe.new||Pe.fetched){if(e++,Pe.base&&!Pe.new&&!Pe.fetched&&1===Pe.count){let t=mn(Pe.base.elm),n=t?j(t):null;(e>7||n===Ee)&&Pe.base.f()&&(Pe.fetched=!0,pt())}if(!Pe.fetched){if(e>7){let e=1===t.length?mn(t[0].elm):null,n=e?j(e):null;return void(e&&n!==Ee&&(Pe.base=null,Pe.new=t[0],Pe.new.f(),Pe.fetched=!0,pt()))}return!0}}else Pe.new.f()&&(Pe.fetched=!0,pt())}ce=0;let e=0,n=Nn.valueOf();$n.debounce(()=>{n===Nn.valueOf()&&(32&Go||(Go|=32,async function(e){for(let n=9;--n>0&&Nn.valueOf()===e&&!0===t();)await new zt(t=>setTimeout(t,420))}(n)))})}async function rt(t){Ao=0,await Fn.d(),K(),vo=new gn,bo()?vo.resolve():await vo.then(),await J(),Eo(t),Ao=1}function it(t){const e=t||document.querySelector("ytd-live-chat-frame#chat");e&&(function(t){if(!(t instanceof Element))return;const e=Xe.ytdFlexy;ae&&e&&Kn.bindElement(t)&&Kn.observer.check(9)}(e),me&&(h(),null!==t?Gt().then(h):Dn.lockWith(t=>{document.fullscreenElement||i(),yn().then(t)})))}function at(t){let e=(t||0).target||0,n=document.activeElement||0;1===e.nodeType&&1===n.nodeType&&zt.resolve().then(()=>{e.contains(n)&&n.blur()})}function ct(t,e){if(0===To.size)document.addEventListener("animationstart",t=>{const e=t.animationName;if(!e)return;let n=To.get(e);if(n)n(t);else{let t=e.indexOf("Controller-");if(t>0){let n=t+10;!function(t,e){if((e=+e)>-1&&e>=0)if("tabviewTabsHideController"===t){let t;qe=e,t=document.querySelector('[tyt-tab-content="#tab-info"]'),t&&t.classList.toggle("tab-btn-hidden",!(1&~qe)),t=document.querySelector('[tyt-tab-content="#tab-comments"]'),t&&(2&~qe?t.classList.toggle("tab-btn-hidden",$e):t.classList.toggle("tab-btn-hidden",!0)),t=document.querySelector('[tyt-tab-content="#tab-videos"]'),t&&t.classList.toggle("tab-btn-hidden",!(4&~qe)),document.querySelector('[tyt-tab-content^="#"].active.tab-btn-hidden')&&g()}else"tabviewDefaultTabController"===t&&(De=e,Me&&Me())}(e.substring(0,n),e.substring(n+1))}}},Qe);else if(To.has(t))return;To.set(t,e)}async function st(){je&&!Be&&Qo&&(Qo=!1,f())}function dt(){je&&!Be?st():!je&&Be&&"function"==typeof IntersectionObserver&&Ct()}function ut(t){let e=null;return t&&"string"==typeof t&&/^\#[a-zA-Z\_\-\+]+$/.test(t)&&document.querySelector(`.tab-btn[tyt-tab-content="${t}"]`)&&(e=t),e}function yt(t){let e;return e=1===De?"#tab-info":2===De?"#tab-comments":3===De?"#tab-videos":(t=t||Lt())[Ce],e}function ft(){function t(t){if(!t)return;const e=Xe.ytdFlexy;e&&(t["font-size-#tab-info"]&&e.style.setProperty("--ut2257-info",t["font-size-#tab-info"]),t["font-size-#tab-comments"]&&e.style.setProperty("--ut2257-comments",t["font-size-#tab-comments"]),t["font-size-#tab-videos"]&&e.style.setProperty("--ut2257-videos",t["font-size-#tab-videos"]),t["font-size-#tab-list"]&&e.style.setProperty("--ut2257-list",t["font-size-#tab-list"]),c(document,"tabview-zoom-updated"))}const e=document.querySelector("#material-tabs");if(!e)return;if(ye)return;ye=!0;let n=null;e.addEventListener("click",async function(t){const e=t.target;if(1!==(e||0).nodeType)return;if(await Gt().then(),await Fn.d(),!0!==e.isConnected)return;(je||Be&&"function"==typeof IntersectionObserver)&&yn().then(dt);const o=e.getAttribute("tyt-di");"q9Kjc"===o?kt.call(e,t):"8rdLQ"===o&&n&&n.call(e,t)},!0),n=function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();let n=e.target;if(!n)return;let o=n.classList.contains("font-size-plus")?1:n.classList.contains("font-size-minus")?-1:0,l=nn.call(n,"[tyt-tab-content]").getAttribute("tyt-tab-content"),r=Lt(),i=`font-size-${l}`;r[i]||(r[i]=1),o<0?r[i]-=.05:o>0&&(r[i]+=.05),r[i]<.1?r[i]=.1:r[i]>10&&(r[i]=10),Tt(r),r=Lt(),t(r)};let o=Lt();t(o),function(t){let e=yt(t);e=e?ut(e):null,e&&(ke.defaultTab=e)}(o),Me=function(){let t=yt();t=t?ut(t):null,ke.defaultTab=t||Te}}function ht(t){t=ut(t);let e=Lt();t?(e[Ce]=t,ke.defaultTab=t):(delete e[Ce],ke.defaultTab=Te),Tt(e)}function mt(t){let e=(t||0).target;e instanceof HTMLIFrameElement&&"chatframe"===e.id&&ho()}function pt(){const t=Xe.ytdFlexy;ae&&t&&2!==ue&&(t.setAttribute("tyt-comments","L"),Ke.log(2909,1))}function bt(t){Le.comments_section_loaded=t,0===t&&Pe&&(Pe.fetched=!1)}function vt(){let t=document.querySelector('.tab-btn[tyt-tab-content="#tab-comments"]');if(t){let e=tn.call(t,"span#tyt-cm-count");t.removeAttribute("loaded-comment"),e&&(e.textContent="")}bt(0),Ke.log(7233,"comments_section_loaded = 0")}function gt(){if(Ke.log(2909,1),!ae)return;let t=Xe.ytdFlexy;if(!t)return;Ke.log(2909,2);let e=document.querySelector("ytd-comments#comments");if(2===ue);else if(e&&!e.hasAttribute("hidden"))return;if(Ke.log(2909,4),2===Le.comments_section_loaded)return;bt(2),Ke.log(2909,5);let n=document.querySelector('.tab-btn[tyt-tab-content="#tab-comments"]');if(n){let t=tn.call(n,"span#tyt-cm-count");n.removeAttribute("loaded-comment"),n.classList.contains("tab-btn-hidden")||S(n),t&&(t.textContent="")}t.setAttribute("tyt-comments","D"),Ke.log(2909,10)}function wt(t,e,n){return e?t|n:t&~n}function xt(t,e){let n,o,l;switch(e){case"theater":o=A(),t=wt(t,o,4);break;case"tyt-chat":n=Xe.ytdFlexy,l=n.getAttribute("tyt-chat"),null!==l&&"-"===l.charAt(0)?t=wt(t,!0,48):(t=wt(t,null!==l,te),t=wt(t,!1,ee));break;case"is-two-columns_":o=k(),t=wt(t,o,2);break;case"tyt-tab":n=Xe.ytdFlexy,o="string"==typeof(r=n.getAttribute("tyt-tab"))&&r.length>0,t=wt(t,o,ne);break;case"fullscreen":n=Xe.ytdFlexy,o=n.hasAttribute("fullscreen"),t=wt(t,o,8);break;case"tyt-ep-visible":n=Xe.ytdFlexy,l=n.getAttribute("tyt-ep-visible"),o=+l>0,t=wt(t,o,oe);break;case"tyt-donation-shelf":n=Xe.ytdFlexy,o=n.hasAttribute("tyt-donation-shelf"),t=wt(t,o,re)}var r;return t}function Et(t){if(!Ve)return;if(!t||1!==t.length)return;let e=t[0];if(!0===e.isIntersecting){if(!1===fn(no.layoutStatus,10,0))return;let n=e.target;if(!n)return;let o=!1,l=null;async function r(t,e){if(e){let e=nn.call(t,"#description.item.style-scope.ytd-watch-metadata");e&&e.click()}await yn();let n,o=null;try{let e=nn.call(t,"#description.item.style-scope.ytd-watch-metadata"),l=e.offsetHeight;n=nn.call(e,"#primary-inner");let r=n.offsetHeight;e.setAttribute("userscript-scrollbar-render",""),r>l&&l>0&&r>0&&(o=r-l)}catch(t){}n&&n.style.setProperty("--tyt-desc-top-h",`${o||0}px`)}!1===fn(no.layoutStatus,0,960)&&(l=nn.call(n,"#description.item.style-scope.ytd-watch-metadata"),l&&(Ve=!1,o=!0)),r(n,o)}}function St(){ae&&fn(no.layoutStatus,2,972)&&g()}function At(t){if(!ae)return;const e=Xe.ytdFlexy;if(!e)return;if(t&&t.classList.contains("tab-btn-hidden"))return;const n=document.querySelectorAll("#material-tabs a[tyt-tab-content]");for(const e of n){let n=document.querySelector(e.getAttribute("tyt-tab-content"));e&&n&&(e!==t?(e.classList.remove("active"),n.classList.add("tab-content-hidden"),n.hasAttribute("tyt-hidden")||n.setAttribute("tyt-hidden","")):(e.classList.add("active"),n.hasAttribute("tyt-hidden")&&n.removeAttribute("tyt-hidden"),n.classList.remove("tab-content-hidden")))}!function(){t&&(be.lastTab=t.getAttribute("tyt-tab-content"),be.lastPanel=null,document.querySelector(`${be.lastTab}.tab-content-cld tabview-view-tab-expander`)||Fn.debounce(()=>{let t=document.querySelector("#secondary.ytd-watch-flexy");t&&t.dispatchEvent(new CustomEvent("tabview-hover-slider-restore"))}));const n=t?be.lastTab:"";if(e.setAttribute("tyt-tab",n),"#tab-videos"===n){let t=document.querySelector("#tab-videos yt-chip-cloud-renderer");t&&Fn.debounce(()=>{t.isConnected&&c(t,"tyt-resize-chip-cloud"),t=null})}}()}function Lt(){function t(){let t={version:1};return localStorage[_e]=JSON.stringify(t),t}let e=localStorage[_e];if(!e)return t();let n=null;try{n=JSON.parse(e)}catch(t){}return n&&1===n.version?n:t()}function Tt(t){return!(!t||"object"!=typeof t||1!==t.version||(localStorage[_e]=JSON.stringify(t),0))}function kt(t){const e=Xe.ytdFlexy;if(!ae||!e)return null;if(!this.hasAttribute("tyt-tab-content"))return;let n=t.target;n&&(n.classList.contains("font-size-btn")||(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),async function(t){await zt.resolve(0);let e=await new zt(t=>{Dn.lockWith(e=>{t(e)})});pe=t.getAttribute("tyt-tab-content");let n=t.classList.contains("tab-btn")&&t.classList.contains("active")&&!t.classList.contains("tab-btn-hidden");Ke.log(8221,15,n),L()?(Ke.log(8221,16,1),n?(yn().then(e),At(null)):(T()&&k()?I():_()&&k()?M():C()&&k()&&$(),(async()=>{Qn&&(await yn(),to()),await yn(),e()})(),At(t))):k()&&!A()&&n?(At(null),P(),yn().then(e)):n?(At(null),yn().then(e)):(T()&&k()?I():_()&&k()?M():C()&&k()?$():k()&&A()&&!L()&&N(),At(t),(async()=>{await yn();let n=document.querySelector("#right-tabs");if(!k()&&n&&n.offsetTop>0&&t.classList.contains("active")&&n.hasAttribute("tyt-stickybar")){let t=document.querySelector("#material-tabs"),e=t?t.offsetHeight:0;window.scrollTo(0,n.offsetTop-e)}await yn(),e()})())}(this)))}function _t(){je=!1}async function Ct(){if(!je&&Be&&Qo&&"function"==typeof IntersectionObserver){let t=document.querySelector("#player video");if(!t)return;const e=t.getBoundingClientRect();if(!(e.top<0&&e.height>100&&e.bottom<.25*e.height))return;await zt.resolve(0);const n=document.documentElement.clientWidth;n+320<screen.width&&n>320&&!document.querySelector("#rCbM3")&&(await zt.resolve(0),y(t,null).then(t=>{!0===t&&(Qo=!1,je=!0)}),t.removeEventListener("leavepictureinpicture",_t,!1),t.addEventListener("leavepictureinpicture",_t,!1),!t.hasAttribute("NOL4j"))&&(t.setAttribute("NOL4j",""),await zt.resolve(0),jo||(jo=new IntersectionObserver(t=>{let e=t[t.length-1];e&&!0===e.isIntersecting?(zo=!0,je&&!Be&&Qo&&zo&&st()):zo=!1},{root:null,rootMargin:"0px",threshold:.25})),jo.takeRecords(),jo.disconnect(),jo.observe(t))}}function qt(t,e,n,o){if(!0===e){const{width:e,height:l}=n();t.style.setProperty("--tyt-stickybar-w",e+"px"),t.style.setProperty("--tyt-stickybar-h",l+"px");const r=o();r&&(t.style.setProperty("--tyt-stickybar-l",r.left+"px"),t.style.setProperty("--tyt-stickybar-r",r.right+"px")),x(t,"tyt-stickybar",!0),Be=!0,!je&&Be&&Qo&&"function"==typeof IntersectionObserver&&yn().then(Ct)}else!1===e&&(x(t,"tyt-stickybar",!1),Be=!1)}function Dt(e){if("YTD-APP"!==(((e||0).target||0).nodeName||"").toUpperCase())return;const n=e.detail;let o=((n||0).pageData||0).page;if(!o)return;if(he=o,"watch"!==he)return;let l=8&xe;l&&(xe-=8,Co.resolve(),document.addEventListener("load",qo,Qe),function(){function e(t){const{newPageType:e,oldPageType:n}=t;if(e&&n){let t=!1;"ytd-watch-flexy"==e?(t=!0,he="watch"):"ytd-browse"==e&&(he="browse"),document.documentElement.classList.toggle("tabview-normal-player",t)}}ct("videosDOMAppended",function(){No.resolve()}),ct("liveChatFrameDOMAppended",t=>{let e=t.target;e&&it(e)});const n=bn();ct("pageLoaderAnimation",()=>{Pn=2,$n.resolve(),console.debug("[tyt] pageRendered"),Fn.debounce(()=>{yn().then(()=>{document.dispatchEvent(new CustomEvent("yt-watch-comments-ready"))})},n)});const o=()=>{console.log("d943",Lo),nt();let t=Nn.valueOf();Fn.debounce(()=>{console.log("d944",Lo),t===Nn.valueOf()&&(console.log("d945",Lo),2&Go||(Go|=2,console.log("d946",Lo),document.documentElement.removeAttribute("pnzgu"),(()=>{console.log("d950");const t=`${Nn.valueOf()}`,e=document.querySelectorAll(`[bsptu="${t}"]`);if(console.log("d951",e.length),e.length)for(const t of e){const e=t.nodeName.toLowerCase();let n="yt-dummy-532"===e?t:null,o=n?po.get(n):null;if(o&&nn.call(o,"#tab-info"))continue;console.log("d952",t);const l=o||("ytd-expander"===e?t:null);if(l){let t=0;const e=document.querySelector("#tab-info");if(e){if(t=1,!l.hasAttribute("tyt-info-expander-content")){t=2,l.setAttribute("tyt-info-expander-content","");const e=document.createElement("yt-dummy-532");e.setAttribute("tyt-info-expander-placeholder",""),l.replaceWith(e),po.set(l,e),po.set(e,l);const n=nn.call(e,"[hidden]");n&&(t=3,ko.observe(n.parentNode,{subtree:!0,childList:!0}))}rn.call(e,l)}J(),console.log("d953",t)}}})(),K(),async function(){if(!ae)return 0;await Fn.d(),await zt.all([zt.resolve().then(()=>{let t=document.querySelector("ytd-watch-flexy #tab-info ytd-expander tp-yt-paper-button#less.ytd-expander:not([hidden]), #tab-info ytd-expander tp-yt-paper-button#more.ytd-expander:not([hidden])");if(t){const e=t;t=null;const n=nn.call(e,"ytd-watch-flexy #tab-info ytd-expander");if(!n||1!==n.nodeType)return;n.style.getPropertyValue("--ytd-expander-collapsed-height")&&n.style.setProperty("--ytd-expander-collapsed-height",""),c(n,"tabview-expander-config")}}),zt.resolve().then(()=>{let t=document.querySelector("ytd-watch-flexy #tab-info ytd-structured-description-content-renderer.style-scope.ytd-video-secondary-info-renderer");if(t){const e=nn.call(t,"[hidden]");if(e){t.hasAttribute("hidden")&&t.removeAttribute("hidden");const e=nn.call(t,"ytd-expander.style-scope.ytd-video-secondary-info-renderer #description.style-scope.ytd-video-secondary-info-renderer");e&&e.hasAttribute("hidden")&&e.removeAttribute("hidden")}e&&setTimeout(()=>{let e=nn.call(t,"ytd-watch-flexy #tab-info ytd-expander");if(!e)return;let n=en.call(e,'#tab-info .more-button.style-scope.ytd-video-secondary-info-renderer[role="button"]');if(1===n.length){let t=Ft(n[0]);"TP-YT-PAPER-BUTTON"===t.nodeName.toUpperCase()&&t.click()}},300)}}),zt.resolve().then(()=>{let t=document.querySelector("#primary.ytd-watch-flexy #below ytd-watch-metadata #owner #owner-sub-count");if(t){if(!t.hasAttribute("title")){let e=nn.call(t,"body #primary.ytd-watch-flexy #below ytd-watch-metadata:not([tabview-uploader-hover])");if(e){e.setAttribute("tabview-uploader-hover","");let t=0;e.addEventListener("transitionend",function(e){let n="background-position-y"===e.propertyName?1:"background-position-x"===e.propertyName?2:0;if(n&&e.target){let t=this;if(t.classList.contains("tabview-uploader-hover")){if("owner"!==e.target.id)return;t.classList.toggle("tabview-uploader-hover",!1)}}if(1===n){let n=e.elapsedTime<.03;n?n&&(t=0):(t>0&&this.classList.toggle("tabview-uploader-hover",!1),t=0)}else if(2===n){e.elapsedTime<.03?t++:t--;let n=this;t<=0?(n.classList.toggle("tabview-uploader-hover",!1),t=0):1===t&&n.classList.toggle("tabview-uploader-hover",!0)}},Qe)}}t.setAttribute("title",t.textContent)}})])}().then(()=>{Fn.d().then(()=>{const t=document.querySelector("#primary.ytd-watch-flexy #below ytd-watch-metadata #info-container.ytd-watch-metadata:first-child")||document.querySelector("#primary.ytd-watch-flexy #below ytd-watch-metadata #ytd-watch-info-text.ytd-watch-metadata:first-child")||null;t&&!t.hasAttribute("tyt-info-toggler")&&(t.setAttribute("tyt-info-toggler",""),c(t,"tyt-info-toggler"))}),$n.debounce(()=>{8&Go||(Go|=8,setTimeout(()=>{!async function(){window.dispatchEvent(new Event("resize"))}(),$t()},420))},Nn);let t=document.querySelector("#columns.ytd-watch-flexy #secondary.ytd-watch-flexy");(function(t,e){if(!t||!e)return;let n=`o4r-${function(t){let e=On.get(t);if(!e){const n=Bn.uidStore;do{e=s(5)}while(n[e]);On.set(t,e)}return e}("tabview-hover-slider-restore")}`;if(t.hasAttribute(n))return;t.setAttribute(n,"");let o=document.querySelector("tabview-view-secondary-xpander");o||(o=document.createElement("tabview-view-secondary-xpander"),co(o,t));let l=document.querySelector("tabview-view-columns-endpos");l&&l.remove(),l=document.createElement("tabview-view-columns-endpos");let r=new IntersectionObserver(t=>{let e=null,n=we;for(const n of t){if(null===n.rootBounds)continue;let t=n.boundingClientRect,o=n.rootBounds;e=!n.isIntersecting&&t.left>o.right&&o.left<=0}let o=document.querySelector("#columns.style-scope.ytd-watch-flexy");o&&o.classList.toggle("tyt-column-overflow",e),n!==e&&null!==e&&(we=e)});rn.call(e,l),2&~no.layoutStatus||r.observe(l),Jn=r,t.addEventListener("tabview-hover-slider-restore",function(t){let e=t.target;if(!e.classList.contains("tabview-hover-slider-enable"))return;let n=tn.call(e,"#secondary-inner.ytd-watch-flexy");if(n){if(e.classList.contains("tabview-hover-slider-hover"))zt.resolve(0).then(()=>{n.style.removeProperty("--ytd-watch-flexy-sidebar-width-d")}).then(()=>{e.classList.remove("tabview-hover-slider-enable"),f()});else{let e=t.target;e.classList.remove("tabview-hover-slider"),e.classList.remove("tabview-hover-slider-enable"),n.style.removeProperty("--ytd-watch-flexy-sidebar-width-d"),n.style.removeProperty("--tabview-slider-right"),f()}yn().then(()=>{v()})}},!1)})(t,ln(t,"#columns.ytd-watch-flexy")),p(document.querySelector("#tab-info")),p(document.querySelector("#tab-comments")),document.documentElement.setAttribute("pnzgu","")}).catch(console.warn)))})},l=bn(),r=()=>{$n.debounce(()=>{Lo|=1,setTimeout(()=>{3===Lo&&(Lo|=4,zt.resolve().then(o))},8)},l)};ct("watchMetaFrameReady1",r),ct("watchMetaFrameReady2",r);const i=bn(),a=t=>{const e=t.target;$n.debounce(()=>{Lo|=2,e.isConnected&&e.setAttribute("bsptu",Nn.valueOf()),setTimeout(()=>{3===Lo&&(Lo|=4,zt.resolve().then(o))},8)},i)};ct("watchMetaContentReady1",a),ct("watchMetaContentReady2",a),ct("fixInvisibleInfoBug",t=>t.target.removeAttribute("hidden")),ct("commentsHeaderAppended1",Y),ct("commentsHeaderAppended2",Y),ct("fixPlaylistLocation1",t=>{const e=t.target;nn.call(e,"#tab-list")||(B(e),ot())});const d=t=>{const e=t.target;if(!e||1!==e.nodeType)return;const n=Xe.ytdFlexy;ae&&n&&co(e,Ft(e))};ct("chatFrameToggleBtnAppended1",d),ct("chatFrameToggleBtnAppended2",d),ct("epDOMAppended",async t=>{try{let e=t.target,n=document.querySelectorAll('ytd-watch-flexy[class][tyt-tab] #panels.ytd-watch-flexy ytd-engagement-panel-section-list-renderer[target-id][visibility="ENGAGEMENT_PANEL_VISIBILITY_EXPANDED"]:not([hidden])');if(n&&n.length>0){if(n.length>1){let t=0;for(const o of n)o!==e&&(D(o),t++);t>0&&await zt.resolve(0)}mo.mtf_attrEngagementPanel(9,e),zt.resolve().then(()=>{Wn.bindElement(e,{attributes:!0,attributeFilter:["visibility"],attributeOldValue:!0}),e.removeEventListener("mouseleave",at,!1),e.addEventListener("mouseleave",at,!1)})}}catch(t){}}),ct("playlistRowDOMSelected",t=>{if(!t)return;let e=t.target;if(!e)return;let n=Ft(e);if(!n||"items"!==n.id)return;let o=/\/watch\?v=[^\&]+\&/.exec(location.href||"");if(!o)return;let l=o[0]+"";if(!l||l.length<=10)return;let r=tn.call(n,`ytd-playlist-panel-video-renderer a[href*="${l}"]`);if(!r||e.contains(r))return;let i=nn.call(r,"ytd-playlist-panel-video-renderer");i&&(e.removeAttribute("selected"),i.setAttribute("selected",""))});let y=!1;ct("tabviewSiderAnimation",()=>{y||(y=!0,u())}),ct("tabviewSiderAnimationNone",()=>{y&&(y=!1,u())}),ct("SearchWhileWatchAutocomplete",t=>{let e=t.target;if(e.hasAttribute("tyt-found"))return;e.setAttribute("tyt-found","");let n=document.createElement("div");n.id="suggestions-search-container",e.replaceWith(n),n.appendChild(e),e.addEventListener("tyt-autocomplete-sc-exist",R,!1),Fn.debounce(()=>{e.isConnected&&c(e,"tabview-fix-autocomplete"),e=null})}),ct("rydTooltipAppear",()=>{document.documentElement.classList.add("return-youtube-dislike")}),ct("oldYtIconPinAppeared",e=>{let n=e.target,o=document.createElement("template");o.innerHTML=t('<svg viewBox="0 0 12 12" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 100%; height: 100%;"><g class="style-scope yt-icon"><path d="M8,2V1H3v1h1v3.8L3,7h2v2.5L5.5,10L6,9.5V7h2L7,5.8V2H8z M6,6H5V2h1V6z" class="style-scope yt-icon"></path></g></svg>'),n.replaceWith(o.content.firstChild)}),et("yt-rendererstamper-finished",t=>{if(!ae&&Cn.resolved)return;if(!t||!t.target||1!==t.target.nodeType)return;let e=t.target;const n=e.nodeName.toUpperCase();"YTD-PLAYLIST-PANEL-RENDERER"!==n&&"YTD-COMMENTS-HEADER-RENDERER"!==n||qn(()=>{const t=e;e=null,"YTD-PLAYLIST-PANEL-RENDERER"===n?(B(t),ot()):"YTD-COMMENTS-HEADER-RENDERER"===n&&(3&~ce||lt())})}),ct("deferredDuplicatedMetaChecker",()=>{rt()}),et("yt-page-data-updated",t=>{Ao&&"/watch"===location.pathname&&rt(1),t&&t.target&&1===t.target.nodeType&&qn(()=>{ae&&(W(),tt(),it(null),ot())})}),et("yt-watch-comments-ready",t=>{if(!ae&&Cn.resolved)return;if(!t||!t.target||1!==t.target.nodeType)return;const e=t.target.nodeName.toUpperCase();ce|=2,async function(t){await wn.then(),await Fn.d(),W(),t&&(fo(),G())}("YTD-WATCH-FLEXY"===e)}),window.addEventListener("message",t=>{if((ae||!Cn.resolved)&&t.origin===location.origin){const n=t.data.tabviewData||0;"yt-page-type-changed"===n.eventType&&zt.resolve(n.eventDetail||{}).then(e)}},Ze);let h=!1;et("data-changed",t=>{!ae&&Cn.resolved||"YTD-THUMBNAIL-OVERLAY-TOGGLE-BUTTON-RENDERER"===(((t||0).target||0).nodeName||"").toUpperCase()&&(h||(h=!0,c(document,"tabview-fix-popup-refit")))})}()),U(),l&&Uo>=2&&Fn.debounce(()=>{let t=document.documentElement;if(t.hasAttribute("tabview-loaded"))throw"Tabview Youtube Duplicated";t.setAttribute("tabview-loaded","o"),zt.resolve(t).then(t=>{Uo>=2&&(c(t,"tabview-ce-hack"),t=null)})}),function(t){Xo={};try{Xo.publishDate=t.pageData.playerResponse.microformat.playerMicroformatRenderer.publishDate}catch(t){}try{Xo.uploadDate=t.pageData.playerResponse.microformat.playerMicroformatRenderer.uploadDate}catch(t){}try{Xo.publishDate2=t.pageData.response.contents.twoColumnWatchNextResults.results.results.contents[0].videoPrimaryInfoRenderer.dateText.simpleText}catch(t){}"string"==typeof Xo.publishDate2&&Xo.publishDate2!==Xo.publishDate&&(Xo.publishDate=Xo.publishDate2,Xo.uploadDate=null);try{Xo.broadcastBeginAt=t.pageData.playerResponse.microformat.playerMicroformatRenderer.liveBroadcastDetails.startTimestamp}catch(t){}try{Xo.broadcastEndAt=t.pageData.playerResponse.microformat.playerMicroformatRenderer.liveBroadcastDetails.endTimestamp}catch(t){}try{Xo.isLiveNow=t.pageData.playerResponse.microformat.playerMicroformatRenderer.liveBroadcastDetails.isLiveNow}catch(t){}}(n);const r=zt.resolve(n).then(t=>{if(Uo>=2){let e=null;try{e=t.pageData.response.contents.twoColumnWatchNextResults.conversationBar.liveChatRenderer}catch(t){}me=e?function(t){const e=t,n=((e||0).showHideButton||0).toggleButtonRenderer,o=n?null:((e||0).showButton||0).buttonRenderer;let l=null,r=null,i=null;return!n&&o&&o.text&&"string"==typeof o.text.simpleText?(("LIVE_CHAT_DISPLAY_STATE_EXPANDED"==e.initialDisplayState||"LIVE_CHAT_DISPLAY_STATE_COLLAPSED"==e.initialDisplayState)&&(l=e.initialDisplayState),i=o.text.simpleText):n&&n.defaultText&&n.toggledText&&n.defaultText.runs&&n.toggledText.runs&&1===n.defaultText.runs.length&&1===n.toggledText.runs.length&&("LIVE_CHAT_DISPLAY_STATE_EXPANDED"==e.initialDisplayState?(l=e.initialDisplayState,r=(n.defaultText.runs[0]||0).text,i=(n.toggledText.runs[0]||0).text):"LIVE_CHAT_DISPLAY_STATE_COLLAPSED"==e.initialDisplayState&&(l=e.initialDisplayState,i=(n.defaultText.runs[0]||0).text,r=(n.toggledText.runs[0]||0).text),"string"==typeof i&&"string"==typeof r&&i.length>0&&r.length>0||(i=null,r=null)),e&&!l&&console.log("[tyt] Unable to obtain showHideButton data"),{default_display_state:l,txt_collapse:r,txt_expand:i}}(e):null}}).then();let i=Xe.ytdFlexy;if(i&&!0===i.isConnected&&"ytd-watch-flexy"===i.nodeName.toLowerCase()||(Ae=hn(document.querySelector("ytd-watch-flexy:not([hidden])")||document.querySelector("ytd-watch-flexy"))),i=null,!Xe.ytdFlexy)return;zt.resolve(0).then(()=>{const t=Xe.ytdFlexy;if(Uo>=2&&0===Pn&&t&&!0===t.isConnected){let e=document.createElement("tabview-view-ploader");Pn=1,rn.call(t,e)}else Uo>=2&&1===Pn&&t&&!0===t.isConnected||console.warn(511,[Uo,Pn,!!t])});let a=n;r.then(()=>{const t=Xe.ytdFlexy;Uo>=2&&t&&t.classList.toggle("tyt-chat-toggleable",!!me),Uo>=2&&qn(()=>{const t=a;a=null,Uo>=2&&null!==t&&(fo(),function(t){if(console.debug("[tyt] newVideoPage"),Go=0,!Xe.ytdFlexy)return;Dn=new Sn;let e=null,n=null;if("watch"!==he)return;!function(){const t=Xe.ytdFlexy;if(!t)return;ae=!0,Ke.log(27056);let e=no.layoutStatus;const n=2&e,o=4&e,l=8&e,r=e&oe,i=e&re,a=!(e&ne||!(e&ee)&&e&te||r||i);""===t.getAttribute("tyt-tab")&&n&&!o&&a&&!l?g():r&&0===en.call(t,'ytd-watch-flexy[class][tyt-tab] #panels.ytd-watch-flexy ytd-engagement-panel-section-list-renderer[target-id][visibility="ENGAGEMENT_PANEL_VISIBILITY_EXPANDED"]:not([hidden])').length?no.layoutStatus=-129&e:i&&0===en.call(t,"ytd-donation-shelf-renderer.ytd-watch-flexy:not([hidden])").length&&(no.layoutStatus=-513&e)}();try{e=t.pageData.response.contents.twoColumnWatchNextResults.conversationBar.liveChatRenderer}catch(t){}e&&!0===e.isReplay&&(n=!0),fe=((((t||0).pageData||0).playerResponse||0).videoDetails||0).videoId||0;const o=fe,l=Yo.inc(),r=()=>new zt(t=>{let e=new MutationObserver(()=>{t&&e&&(e.disconnect(),e.takeRecords(),e=null,t(),t=null)});e&&e.observe(document.documentElement,{attributes:!0,attributeFilter:["sxmq8"]})}),i=r(),a=document.documentElement;a.setAttribute("sxmq8","1"===a.getAttribute("sxmq8")?"0":"1"),console.log("sxmq8 r3",document.documentElement.getAttribute("sxmq8")),i.then(()=>{const t=r(),e=document.documentElement;e.setAttribute("sxmq8","1"===e.getAttribute("sxmq8")?"0":"1"),console.log("sxmq8 r4",document.documentElement.getAttribute("sxmq8")),t.then(()=>{if(o!==fe)return;if(l!==Yo.valueOf())return;Yo.inc();const t=document.querySelector("ytd-live-chat-frame#chat");if(t&&!t.hasAttribute("collapsed")){const e=tn.call(t,"body iframe.style-scope.ytd-live-chat-frame#chatframe");e&&zt.resolve(e).then(Po)}})});const c=e?n?3:1:0,s=e?e.initialDisplayState:null;e=null,(()=>{Ke.log(932,1,1);const t=Xe.ytdFlexy;if(!ae||!t)return;if(Ke.log(932,1,2),"watch"!==he)return;Ke.log(932,1,3);let e=function(t,e){const n=Xe.ytdFlexy;if(!ae||!n)return;let o=ge!==t,l=1===t?"chat$live":3===t&&"chat$playback",r=!1;if(l){let t=document.querySelector("ytd-live-chat-frame#chat");r=t?t.hasAttribute("collapsed"):"LIVE_CHAT_DISPLAY_STATE_COLLAPSED"===e}if(o){ge=t;let e=l;"string"==typeof l&&(!0===r&&(e="-"+l),!1===r&&(e="+"+l)),x(n,"tyt-chat",e)}return{attr_chatblock:l,attr_chatcollapsed:r,chatTypeChanged:o}}(c,s),{attr_chatblock:n,attr_chatcollapsed:o,chatTypeChanged:l}=e;if("watch"===he){let t=Xe.storeLastPanel;t?d(t)||(ve=null,M()):ve=null}if(l)if("chat$live"!=n||Xo&&Xo&&Xo.broadcastBeginAt&&!Xo.broadcastEndAt&&!1===Xo.isLiveNow){const t=document.querySelector('[tyt-tab-content="#tab-comments"].tab-btn-hidden');t?(vt(),Ke.log(9360,74),E(t,!0)):bt(0),ue=0,Ke.log(7234,"comments_section_loaded = 0"),V()}else Ke.log(932,4),ue=2,gt();else 2===ue||!1!==n&&"chat$playback"!==n||(vt(),Ke.log(9360,77),ue=0,Ke.log(7235,"comments_section_loaded = 0"),V());W()})()}(t))})}),Io&&(Io=!1,Xe.ytdFlexy&&Dn.lockWith(t=>{const e=Xe.ytdFlexy;e&&(e.hasAttribute("hidden")||(Bo(),Oo(1),t()))}))}function Mt(){Fo=0,1!==Uo&&(Uo=1,Ko.lockWith(t=>{xo(),t()}))}function $t(){ae&&"watch"===he&&8&~no.layoutStatus&&(2&no.layoutStatus?v():yn().then(()=>{Vo(!0)}))}let Pt;try{Pt=(async()=>{})().constructor}catch(tl){throw"Please update your browser to use Tabview Youtube."}const Nt=(t,e)=>{let n=null;try{n=Object.getOwnPropertyDescriptor(t,e).get}catch(t){}return"function"==typeof n?t=>n.call(t):t=>t[e]},Ft=Nt(Node.prototype,"parentNode"),It=Nt(Node.prototype,"firstChild"),Ht=Nt(Node.prototype,"nextSibling"),Rt=Nt(Node.prototype,"previousSibling"),Ot=Nt(Element.prototype,"nextElementSibling"),Bt=Document.prototype.createDocumentFragment,jt=DocumentFragment.prototype.append,zt=Pt,{requestAnimationFrame:Vt,cancelAnimationFrame:Wt}=e;let Yt=null;const Gt=()=>Yt||(Yt=new zt(t=>{Vt(e=>{Yt=null,t(e)})}));if(function(){try{return window.self!==window.top}catch(t){return!0}}())return;if(document.documentElement&&document.documentElement.hasAttribute("plugin-tabview-youtube"))return void console.warn("Multiple instances of Tabview Youtube is attached. [0x7F01]");const Ut=(()=>{let t=zt.resolve();return e=>new zt((n,o)=>{t=t.then(async()=>{let t;try{t=await e()}catch(t){console.log("error_F1",t),o(t)}n(t)}).catch(console.warn)})})(),Xt=()=>"undefined"==typeof GM&&"function"==typeof(((window||0).chrome||0).runtime||0).getURL,Kt='<path d="M80 27H12A12 12 90 0 0 0 39v42a12 12 90 0 0 12 12h12v20a2 2 90 0 0 3.4 2L47 93h33a12 \n  12 90 0 0 12-12V39a12 12 90 0 0-12-12zM20 47h26a2 2 90 1 1 0 4H20a2 2 90 1 1 0-4zm52 28H20a2 2 90 1 1 0-4h52a2 2 90 \n  1 1 0 4zm0-12H20a2 2 90 1 1 0-4h52a2 2 90 1 1 0 4zm36-58H40a12 12 90 0 0-12 12v6h52c9 0 16 7 16 16v42h0v4l7 7a2 2 90 \n  0 0 3-1V71h2a12 12 90 0 0 12-12V17a12 12 90 0 0-12-12z"/>'.trim(),Jt='<path d="M89 10c0-4-3-7-7-7H7c-4 0-7 3-7 7v70c0 4 3 7 7 7h75c4 0 7-3 7-7V10zm-62 2h13v10H27V12zm-9 \n  66H9V68h9v10zm0-56H9V12h9v10zm22 56H27V68h13v10zm-3-25V36c0-2 2-3 4-2l12 8c2 1 2 4 0 5l-12 8c-2 1-4 0-4-2zm25 \n  25H49V68h13v10zm0-56H49V12h13v10zm18 56h-9V68h9v10zm0-56h-9V12h9v10z"/>'.trim(),Zt='<path d="M30 0C13.3 0 0 13.3 0 30s13.3 30 30 30 30-13.3 30-30S46.7 0 30 0zm6.2 46.6c-1.5.5-2.6 \n  1-3.6 1.3a10.9 10.9 0 0 1-3.3.5c-1.7 0-3.3-.5-4.3-1.4a4.68 4.68 0 0 1-1.6-3.6c0-.4.2-1 .2-1.5a20.9 20.9 90 0 1 \n  .3-2l2-6.8c.1-.7.3-1.3.4-1.9a8.2 8.2 90 0 0 .3-1.6c0-.8-.3-1.4-.7-1.8s-1-.5-2-.5a4.53 4.53 0 0 0-1.6.3c-.5.2-1 \n  .2-1.3.4l.6-2.1c1.2-.5 2.4-1 3.5-1.3s2.3-.6 3.3-.6c1.9 0 3.3.6 4.3 1.3s1.5 2.1 1.5 3.5c0 .3 0 .9-.1 1.6a10.4 10.4 \n  90 0 1-.4 2.2l-1.9 6.7c-.2.5-.2 1.1-.4 1.8s-.2 1.3-.2 1.6c0 .9.2 1.6.6 1.9s1.1.5 2.1.5a6.1 6.1 90 0 0 1.5-.3 9 9 90 \n  0 0 1.4-.4l-.6 2.2zm-3.8-35.2a1 1 0 010 8.6 1 1 0 010-8.6z"/>'.trim(),Qt='<path d="M0 3h12v2H0zm0 4h12v2H0zm0 4h8v2H0zm16 0V7h-2v4h-4v2h4v4h2v-4h4v-2z"/>'.trim(),te=(Math.floor(982451653*Math.random()+982451653).toString(36),Date.now().toString(36),16),ee=32,ne=64,oe=128,le=256,re=512,ie=function(){};let ae=!1,ce=0,se=0;const de=Date.now()-152e6;let ue=0,ye=!1,fe=null,he=null,me=null,pe=null,be=null,ve=null,ge=null,we=!1,xe=10,Ee="",Se=null,Ae=null;const Le={},Te="#tab-videos",ke={defaultTab:Te},_e="userscript-tabview-settings",Ce="my-default-tab";let qe=0,De=0,Me=null,$e=!1,Pe={base:null,new:null,fetched:!1,count:null},Ne="en";const Fe={en:{info:"Info",videos:"Videos",playlist:"Playlist"},jp:{info:"情報",videos:"動画",playlist:"再生リスト"},tw:{info:"資訊",videos:"影片",playlist:"播放清單"},cn:{info:"资讯",videos:"视频",playlist:"播放列表"},du:{info:"Info",videos:"Videos",playlist:"Playlist"},fr:{info:"Info",videos:"Vidéos",playlist:"Playlist"},kr:{info:"정보",videos:"동영상",playlist:"재생목록"},ru:{info:"Описание",videos:"Видео",playlist:"Плейлист"}},Ie=()=>{let t=new Date("2023-01-01T00:00:00Z");return 1===t.getDate()?`+${t.getHours()}`:"-"+(24-t.getHours())};let He=[],Re={},Oe=0,Be=!1,je=!1,ze=0,Ve=!1,We=!1,Ye=203,Ge=0,Ue=new WeakMap;const Xe={get ytdFlexy(){return mn(Ae)},get storeLastPanel(){return mn(ve)}},Ke=new Proxy(console,{get(t,e,n){return"log"===e?ie:Reflect.get(...arguments)}}),Je="function"==typeof IntersectionObserver,Ze=!!Je&&{capture:!1,passive:!0},Qe=!Je||{capture:!0,passive:!0},tn=HTMLElement.prototype.__shady_native_querySelector||HTMLElement.prototype.querySelector,en=HTMLElement.prototype.__shady_native_querySelectorAll||HTMLElement.prototype.querySelectorAll,nn=HTMLElement.prototype.closest,on=function(t,e){return t instanceof HTMLElement&&tn.call(t,e)||null},ln=function(t,e){return t instanceof HTMLElement&&nn.call(t,e)||null},{elementAppend:rn,_setAttribute:an,_insertBefore:cn}=(()=>{let t=HTMLElement.prototype.appendChild;try{t=ShadyDOM.nativeMethods.appendChild||t}catch(t){}let e=Element.prototype.setAttribute;try{e=ShadyDOM.nativeMethods.setAttribute||e}catch(t){}let n=Node.prototype.insertBefore;try{n=ShadyDOM.nativeMethods.insertBefore||n}catch(t){}return{elementAppend:t,_setAttribute:e,_insertBefore:n}})(),sn=()=>{let t=document.getElementById("d-m");t||(t=document.createElementNS("http://www.w3.org/2000/svg","defs"),t.id="d-m",cn.call(document.documentElement,t,document.documentElement.firstChild));const e=t;e._setAttribute=an;let n,o=0;for(;e.hasAttribute(n=`dm-${Math.floor(314159265359*Math.random()+314159265359).toString(36)}`););const l=n;let r=null;return new MutationObserver(()=>{null!==r&&(o>8&&(o=0),r(),r=null)}).observe(document,{childList:!0,subtree:!0,attributes:!0}),t=>(r||e._setAttribute(l,++o),r=t)},dn=sn();let un=null;const yn=()=>un||(un=new zt(dn).then(()=>{un=null})),fn=function(t,e,n){return(t&(e|n))===e},hn="function"==typeof WeakRef?t=>t?new WeakRef(t):null:t=>t||null,mn=t=>t&&t.deref?t.deref():t;class pn{constructor(){this.q=0}set(t){this.q=t}valueOf(){return this.q}inc(){return++this.q>1e9&&(this.q=9),this.q}}const bn=()=>new pn,vn=bn();vn.auto=!1;const gn=((t,e)=>{const n=(n,o)=>{t=n,e=o};return class extends zt{constructor(o=n){super(o),o===n&&(this.resolve=t,this.reject=e)}}})(),wn=new gn;let xn={allowChatControl:!0};class En{constructor(){this.reset()}debounce(t,e){let n=t;if(e){const o=!1===e.auto?e.valueOf():e.inc();n=()=>o===e.valueOf()?t():0}return this.promise.then().then(n).catch(console.warn)}d(){return this.promise.then().catch(console.warn)}reset(){this.resolved=!1,this.promise=new gn}resolve(){return!1===this.resolved&&(this.resolved=!0,this.promise.resolve(...arguments),!0)}}class Sn{constructor(){this.p=zt.resolve()}lockWith(t){this.p=this.p.then(()=>new zt(t).catch(console.warn))}}const An=Symbol(),Ln=(t,e)=>{if(t.constructor!==e){const n=e[An]||(e[An]=Object.keys(Object.getOwnPropertyDescriptors(e.prototype)));for(const o of n)t[o]=e.prototype[o]}};class Tn extends MutationObserver{constructor(t){super(t=>{for(const e of t)"attributes"===e.type&&this.checker(e.target,e.attributeName)}),this.flist=t,this.res={},Ln(this,Tn)}takeRecords(){super.takeRecords()}disconnect(){this._target=null,super.disconnect()}observe(t){if(this._target)return;this._target=hn(t);const e={attributes:!0,attributeFilter:Object.keys(this.flist),attributeOldValue:!0};super.observe(t,e)}checker(t,e){let n=t.getAttribute(e);if(this.res[e]!==n){this.res[e]=n;let t=this.flist[e];t&&t(e,n)}}check(t=0){setTimeout(()=>{let t=mn(this._target);if(null!==t)for(const e of Object.keys(this.flist))this.checker(t,e);else console.log("target is null");t=null},t)}}class kn extends Date{constructor(...t){super(...t),this.dayBack=!1}browserSupported(){}lokStringDateEN(){const t=this;let e=t.getFullYear(),n=t.getMonth()+1,o=t.getDate();return`${e<1e3?`0000${e}`.slice(-4):""+e}.${n<10?"0"+n:""+n}.${o<10?"0"+o:""+o}`}lokStringDateJP(){const t=this;let e=t.getFullYear(),n=t.getMonth()+1,o=t.getDate();return`${e<1e3?`0000${e}`.slice(-4):""+e}/${n<10?"0"+n:""+n}/${o<10?"0"+o:""+o}`}lokStringTime(){let t=this.getHours(),e=this.getMinutes();return this.dayBack&&(t+=24),`${t<10?"0"+t:""+t}:${e<10?"0"+e:""+e}`}}if(console.assert("browserSupported"in new kn,{error:"0x87FF",errorMsg:"Your userscript manager is not supported. FireMonkey is not recommended."}),!("browserSupported"in new kn))return;let _n=null;try{const el=[{id:"tabview-css-content",path:"css/style_content.css"},{id:"tabview-css-chat",path:"css/style_chat.css"},{id:"tabview-css-control",path:"css/style_control.css"}];for(const nl of el)nl.url=chrome.runtime.getURL(nl.path)||"";_n=el}catch(ol){}if(_n){const ll=document.head||document.documentElement;for(const{path:rl,url:il,id:al}of _n)if(il&&"string"==typeof il&&il.length>4){const cl=document.createElement("link");cl.id=al,cl.rel="stylesheet",cl.type="text/css",cl.href=il,ll.appendChild(cl)}_n=null}!function(){function t(t,e,n,o){return new zt(l=>{t||(t=document.createElement("link")),t.rel=e,o&&t.setAttribute("as",o),t.onload=function(){l({link:this,success:!0}),this.remove()},t.onerror=function(){l({link:this,success:!1}),this.remove()},t.href=n,(document.head||document.documentElement).appendChild(t),t=null})}new zt(t=>{if(document.documentElement)t();else{let e=new MutationObserver(()=>{null!==e&&document.documentElement&&(e.takeRecords(),e.disconnect(),e=null,t())});e.observe(document,{childList:!0,subtree:!1})}}).then(()=>{const e=["https://i.ytimg.com","https://www.youtube.com","https://rr2---sn-5n5ip-ioqd.googlevideo.com","https://googlevideo.com","https://accounts.youtube.com","https://jnn-pa.googleapis.com","https://googleapis.com","https://fonts.gstatic.com","https://www.gstatic.com","https://yt3.ggpht.com","https://yt4.ggpht.com"];for(const n of e)t(null,"preconnect",n)})}();const Cn=new En;Cn.resolve();const qn=function(t){!ae&&Cn.resolved||Cn.debounce(t,vn)};let Dn=new Sn,Mn=new Sn;const $n=new En;let Pn=0,Nn=bn();Nn.auto=!1;const Fn=new En,In=function(t){let e={script_id:t,inject:function(){let t=this,e=this.script_id;document.querySelector(`script#${e}`)||(t.runtime_url?(function(t){const e=document.createElement("script");e.type="text/javascript",e.src=t;try{document.documentElement.appendChild(e)}catch(t){console.log("addScriptByURL Error",t)}return e}(t.runtime_url)).id=e:(function(t){const e=document.createElement("script");e.type="text/javascript",e.textContent=t;try{document.documentElement.appendChild(e)}catch(t){console.log("addScript Error",t)}return e}(`${t.injection_script}`)).id=e)}};return e.script_id=t,Xt()?e.runtime_url=window.chrome.runtime.getURL("js/injection_script_1.js"):e.injection_script=GM_getResourceText("injectionJS1"),e}("userscript-tabview-injection-1");let Hn=!1;Fn.debounce(()=>{Hn=!0});const Rn=new Map,On=new Map;class Bn{constructor(t){let e=null;const n=Bn.uidStore;do{e=s(5)}while(n[e]);n[e]=!0,this.uid=e,this.observerCreator=t,this.observer=null,this.bindCount=0,Ln(this,Bn)}bindElement(t,...e){return!t.hasAttribute(`o3r-${this.uid}`)&&(t.setAttribute(`o3r-${this.uid}`,""),this.bindCount++,null===this.observer&&(this.observer=this.observerCreator()),this.observer.observe(t,...e),!0)}clear(t){if(null!==this.observer){!0===t&&(this.observer.takeRecords(),this.observer.disconnect()),this.observer=null,this.bindCount=0;for(const t of document.querySelectorAll(`[o3r-${this.uid}]`))t.removeAttribute(`o3r-${this.uid}`)}}}Bn.uidStore={};const jn=new Bn(()=>new IntersectionObserver(Et,{root:null,rootMargin:"0px"})),zn=new Bn(()=>new MutationObserver(Ho)),Vn=new Bn(()=>new MutationObserver(Ro)),Wn=new Bn(()=>new MutationObserver(mo.mtf_attrEngagementPanel)),Yn=new Bn(()=>new Tn({hidden:mo.mtf_attrPlaylist})),Gn=Yn.uid,Un=new Bn(()=>new Tn({hidden:mo.mtf_attrComments})),Xn=Un.uid,Kn=new Bn(()=>new Tn({collapsed:mo.mtf_attrChatroom}));let Jn=null;const Zn=t=>{let e=document.querySelector("#secondary.style-scope.ytd-watch-flexy + tabview-view-columns-endpos"),n=document.querySelector("#secondary.style-scope.ytd-watch-flexy > tabview-view-secondary-xpander");if(e&&n){let e=function(){let t=document.documentElement.getBoundingClientRect().width,e=document.querySelector("#secondary.style-scope.ytd-watch-flexy + tabview-view-columns-endpos");return e?e.getBoundingClientRect().x-t:null}(),o=1;o=e>=125||e>=75?1:e>=25?.25:0,t.style.setProperty("--tabview-slider-offset-k2",`${o}`),t.style.setProperty("--tabview-slider-offset",`${e}px`);let l=n.getBoundingClientRect().width;t.style.setProperty("--tabview-slider-ow",`${l}px`);let r="var(--ytd-watch-flexy-sidebar-width-d)",i="var(--tabview-slider-ow)",a=`${e}px`;t.style.setProperty("--tabview-slider-offset-actual",`calc(${r} - ${i} + ${a})`)}},Qn=(()=>{const t=document.createElementNS("http://www.w3.org/2000/svg","defs");let e=0;try{t.scrollIntoView({get behavior(){e++},get block(){e++}})}catch(t){}return 2===e})(),to=Qn?()=>{const t=document.querySelector("ytd-app[scrolling]");if(!(t&&L()&&k()&&(T()||function(){const t=Xe.ytdFlexy;return t&&"#"===(t.getAttribute("tyt-tab")||"").charAt(0)}()||_()||C())))return;const e=document.querySelector("#right-tabs"),n=e.getBoundingClientRect().top-t.getBoundingClientRect().top;if(e&&n>0){const t=e.closest("#secondary-inner");t&&t.getBoundingClientRect().height<document.documentElement.clientHeight&&document.documentElement.clientHeight>80&&(async(t,e)=>{const n=t=>`${t.height}|${t.width}|${t.left}|${t.top}`;let o=0;for(;o++<4;){const o=n(t.getBoundingClientRect()),l=new zt(t=>{document.addEventListener("scroll",t,{capture:!0,passive:!0,once:!0})});if(t.scrollIntoView(e),await l,await new zt(e=>{let n=new IntersectionObserver(()=>{e(),n.disconnect(),n=null});n.observe(t)}),o===n(t.getBoundingClientRect()))break}})(t,{behavior:"instant",block:"end",inline:"nearest"})}}:null;let eo=!1;const no=new Proxy({layoutStatus:void 0},{get:function(t,e){return t[e]},set:function(t,e,n){if("layoutStatus"==e){if(0===n)return t[e]=n,!0;if(t[e]===n)return!0;if(!t.layoutStatus_pending){t.layoutStatus_pending=!0;const o=t[e];return t[e]=n,Dn.lockWith(n=>{t.layoutStatus_pending=!1;let l=t[e];o!==l?(function(t,e){function n(){Dn.lockWith(t=>{"#chatroom"==be.lastPanel?(r&&At(null),l||F()):be.lastPanel&&0==be.lastPanel.indexOf("#engagement-panel-")?(r&&At(null),a||function(t){if("string"==typeof t&&(t=t.replace("#engagement-panel-",""),t=parseInt(t)),!(t>=0))return!1;let e=q(),n=[];for(const{ePanel:o,k:l,visible:r}of e.list)(t&l)===l?r||n.push({panelId:o.getAttribute("target-id"),toShow:!0}):r&&n.push({panelId:o.getAttribute("target-id"),toHide:!0});if(n.length>0){const t=n;Fn.debounce(()=>{document.dispatchEvent(new CustomEvent("tyt-engagement-panel-visibility-change",{detail:t}))})}n=null}(be.lastPanel)):"#donation-shelf"==be.lastPanel?(r&&At(null),s||function(){if(!C()){let t=document.querySelector("#tyt-donation-shelf-toggle-btn");t&&t.click()}}()):(l&&I(),r||g()),yn().then(t)})}2&e||async function(){if(We)return;We=!0,await zt.resolve(0);const[t,e,n]=await zt.all([zt.resolve().then(()=>document.querySelector("#right-tabs header")),zt.resolve().then(()=>document.querySelector("#right-tabs tabview-view-pos-thead")),zt.resolve().then(()=>document.querySelector("#masthead-container, #masthead"))]);let o=0;new IntersectionObserver(t=>{let e=null,n=null,l=null;for(const o of t)o.boundingClientRect&&o.rootBounds&&(!o.isIntersecting&&o.boundingClientRect.y<=o.rootBounds.top&&o.boundingClientRect.y<o.rootBounds.bottom?(e=2,n=o.boundingClientRect,l=o.rootBounds):o.isIntersecting&&o.boundingClientRect.y>=o.rootBounds.top&&o.boundingClientRect.y<o.rootBounds.bottom&&(e=1,n=o.boundingClientRect,l=o.rootBounds));let r=no.layoutStatus;null!==e&&(2===e&&!0===Be||1===e&&!1===Be||Wo(e,n.width,{left:n.left,right:l.width-n.right}));let i=Date.now();o=i,setTimeout(()=>{o===i&&r!==no.layoutStatus&&Vo()},300)},{rootMargin:"0px 0px 0px 0px",threshold:[0]}).observe(e)}();const o=Xe.ytdFlexy;if(!o)return;let l=!!(e&le),r=!!(e&ne),i=!!(8&e),a=!!(e&oe),s=!!(e&re);const d=!!(960&e),u=!d;let y=1&t?t^e:0,f=!!(y&ee),h=!!(4&y),m=!!(2&y),p=!!(8&y),b=!!(y&oe),w=!!(y&re),x=960&y,E=x,S=!!(e&x),L=!!(~e&x);const _=r+l+a+s>1;let D=null,H=()=>null===D?D=o.classList.contains("tyt-chat-popup"):D;y&le&&l&&async function(){const t=document.getElementById("chatframe");if(!(t instanceof HTMLIFrameElement))return;if((Mo.get(t)||0)%2==1)return;if(await Ut(()=>{}),(Mo.get(t)||0)%2==1)return;let e;try{e=t.contentDocument.location}catch(t){}e&&e.href.includes("youtube.com")&&await Ut(async()=>{(Mo.get(t)||0)%2!=1&&(await Co.then(),!0===t.isConnected&&t.matches("body iframe.style-scope.ytd-live-chat-frame#chatframe")&&await $o(t))})}();const R=()=>{!_||2&~e||Dn.lockWith(t=>{if(r&&null===be.lastPanel)l&&I(),a&&M(),s&&$();else if(be.lastPanel){let t=be.lastPanel||"";"string"!=typeof t&&(t=""),l&&"#chatroom"!==t&&I(),a&&t.indexOf("#engagement-panel-")<0&&M(),s&&"#donation-shelf"!==t&&$(),At(null)}yn().then(t)})};let O=zt.resolve();if(i?(E==le&&82==(114&e)&&d&&!m&&At(null),E&le&&l&&Qn&&O.then(async()=>{await yn(),document.querySelector("ytd-app[scrolling]")&&document.querySelector("ytd-live-chat-frame#chat")&&T()&&to()}),E&oe&&a&&O.then(async()=>{if(await yn(),!document.querySelector("ytd-app[scrolling]"))return;let t=document.querySelector('ytd-watch-flexy[class][tyt-tab] #panels.ytd-watch-flexy ytd-engagement-panel-section-list-renderer[target-id][visibility][visibility="ENGAGEMENT_PANEL_VISIBILITY_EXPANDED"]:not([hidden])');if(t){let e=50,n=setInterval(()=>{--e?t.scrollIntoView(!0):clearInterval(n)},17)}})):p?(!i&&u&&k()&&!A()?n():!i&&d&&k()&&A()&&(H()||N()),!i&&d&&k()&&zt.resolve().then(R)):146!=(246&e)||m||E!=le&&E!=oe?530!=(630&e)||m||E!=le&&E!=re?!E&&m&&2==(6&e)&&_?n():E==le&&82==(118&e)&&d&&!m?At(null):!S||6&~e||!d||6&y?6&~e||!d?L&&2==(6&e)&&u&&!m?E==oe||E==re||E==le?(be.lastPanel=null,i||n()):i||P():!E&&6&y&&2==(6&e)&&u?n():2==(974&e)&&Dn.lockWith(t=>{g(),yn().then(t)}):H()||Dn.lockWith(t=>{r&&At(null),l&&I(),a&&M(),s&&$(),yn().then(t)}):N():w?Dn.lockWith(t=>{I(),yn().then(t)}):f&&Dn.lockWith(t=>{$(),sn().then(t)}):b?Dn.lockWith(t=>{I(),yn().then(t)}):f&&Dn.lockWith(t=>{M(),yn().then(t)}),h){let t=Date.now();ze=t,setTimeout(()=>{ze===t&&v()},130)}let B=null;(B=document.querySelector(".tabview-hover-slider-enable"))&&Fn.debounce(()=>{B.isConnected&&B.dispatchEvent(new CustomEvent("tabview-hover-slider-restore"))}),p&&(Ve=!0,yn().then(So)),m&&zt.resolve(0).then(()=>{if(R(),tt(),null!==Jn)if(2&~e)Jn.disconnect();else{let t=document.querySelector("tabview-view-columns-endpos");null!==t&&Jn.observe(t)}yn().then(()=>{Vo(!0)})}),!0===eo&&(fn(e,6,0)&&l&&H()||(eo=!1,c(document,"tyt-close-popup")))}(o,l),yn().then(n)):n()}),!0}}return t[e]=n,!0},has:function(t,e){return e in t}}),oo=(t,e,n,o,l,r)=>`<svg${r?` class=${r}`:""} width="${t}" height="${e}" viewBox="0 0 ${n} ${o}" preserveAspectRatio="xMidYMid meet">${l}</svg>`,lo=new Map;let ro=1;const io=HTMLElement.prototype.before?(t,e)=>e&&t?(HTMLElement.prototype.before.call(e,t),!0):null:(t,e)=>{if(!e||!t)return null;try{return HTMLElement.prototype.insertBefore.call(Ft(e),t,e),!0}catch(t){console.log("element insert failed in old browser CE")}return!1},ao=HTMLElement.prototype.after?(t,e)=>e&&t?(HTMLElement.prototype.after.call(e,t),!0):null:(t,e)=>{if(!e||!t)return null;try{return HTMLElement.prototype.insertBefore.call(Ft(e),t,Ht(e)),!0}catch(t){console.log("element insert failed in old browser CE")}return!1},co=HTMLElement.prototype.prepend?(t,e)=>e&&t?(HTMLElement.prototype.prepend.call(e,t),!0):null:(t,e)=>{if(!e||!t)return null;try{return HTMLElement.prototype.insertBefore.call(e,t,It(e)),!0}catch(t){console.log("element insert failed in old browser CE")}return!1},so=(HTMLElement.prototype.append,[function(){let t=mn(this.elm);if(!t)return;let e=document.querySelector("span#tyt-cm-count");if(e){let t=nn.call(e,'.tab-btn[tyt-tab-content="#tab-comments"]');t&&t.setAttribute("loaded-comment","normal"),c(document,"tyt-update-cm-count")}return bt(1),Ee=j(t),!0},function(){let t=mn(this.elm);if(!t)return;let e=document.querySelector("span#tyt-cm-count");if(e){let t=nn.call(e,'.tab-btn[tyt-tab-content="#tab-comments"]');t&&t.setAttribute("loaded-comment","message"),e.textContent="​"}return bt(1),Ee=j(t),!0}]);let uo=null;const yo=t=>{if(t&&(Pe.count=t.length,!Pe.new))if(t.newFound){if(1===t.length)return Pe.new=t[0],!0;if(t.length>1)for(const e of t)if(!0===e.isLatest&&e.isNew)return Pe.new=e,!0}else if(1===t.length)return Pe.base=t[0],!1},fo=()=>{let t=document.querySelector(`ytd-comments#comments:not([o3r-${Xn}])`);if(!t)return;const e=Xe.ytdFlexy;ae&&e&&Un.bindElement(t)&&Un.observer.check(9)},ho=()=>{c(document,"tabview-fix-live-chat-toggle-btn")},mo={mtf_attrPlaylist:()=>{if(!ae)return;if("watch"!==he)return;if(!Xe.ytdFlexy)return;let t=document.querySelector("#tab-list ytd-playlist-panel-renderer#playlist"),e=t&&!t.hasAttribute("hidden");const n=document.querySelector('[tyt-tab-content="#tab-list"]');if(n){let t=n.classList.contains("tab-btn-hidden");t&&e?n.classList.remove("tab-btn-hidden"):t||e||S(n)}},mtf_attrComments:()=>{if($n.resolved&&z(!0),"watch"!==he)return;let t=document.querySelector("ytd-comments#comments");const e=document.querySelector('[tyt-tab-content="#tab-comments"]');if(!t||!e)return;let n=t.hasAttribute("hidden");const o=Xe.ytdFlexy;ae&&o&&(2===ue||(n?n&&(o.setAttribute("tyt-comments","Kh"),"watch"===he&&1===Le.comments_section_loaded&&vt()):(o.setAttribute("tyt-comments","Kv"),Pe.fetched||vt(),E(e,!0))))},mtf_attrChatroom:()=>{const t=Xe.ytdFlexy;ae&&t&&"watch"===he&&(h(),Dn.lockWith(t=>{const e=document.querySelector("ytd-live-chat-frame#chat"),n=Xe.ytdFlexy;if(!e||!n)return void t();if("watch"!==he)return void t();let o="",l=!!e.hasAttribute("collapsed"),r=n.getAttribute("tyt-chat");if(null!==r&&r.charCodeAt(0)<46&&(o=r.substring(1)),l&&(o=`-${o}`),l||(o=`+${o}`),x(n,"tyt-chat",o),"string"!=typeof o||l||(be.lastPanel="#chatroom"),l||null===document.querySelector("#right-tabs .tab-btn.active")||!k()||A()?t():(At(null),yn().then(t)),l){e.classList.remove("tyt-chat-frame-ready");let t=document.querySelector("tyt-iframe-popup-btn");t&&t.remove()}else{const t=tn.call(e,"body iframe.style-scope.ytd-live-chat-frame#chatframe");t&&zt.resolve(t).then(Po)}ho()}))},mtf_attrEngagementPanel:(t,e)=>{const n=Xe.ytdFlexy;if(!ae||!n)return;let o=null;if(9!==t)return void(document.querySelector('ytd-watch-flexy[class][tyt-tab] #panels.ytd-watch-flexy ytd-engagement-panel-section-list-renderer[target-id][visibility="ENGAGEMENT_PANEL_VISIBILITY_EXPANDED"]:not([hidden])')||(Wn.clear(!0),ve=null,x(n,"tyt-ep-visible",!1)));o=e;let l=q().value,r=+n.getAttribute("tyt-ep-visible")||0;0!==l&&r!==l&&(n.setAttribute("tyt-ep-visible",l),be.lastPanel=`#engagement-panel-${l}`,ve=hn(o),qn(()=>{Xe.storeLastPanel===o&&Dn.lockWith(t=>{Xe.storeLastPanel===o&&function(){const t=no.layoutStatus;if(2==(6&t)){if(t&ne)return At(null),!0;if(t&le)return I(),!0}return!1}()?yn().then(t):t()})}))}},po=new WeakMap,bo=()=>1===document.querySelectorAll("[tyt-info-expander-placeholder]").length&&1===document.querySelectorAll("[tyt-info-expander-content]").length;let vo=new gn;const go=bn(),wo=function(){vn.inc(),Pe={base:null,new:null,fetched:!1,count:null},fe=null,me=null},xo=function(){const t=document.documentElement;if(t.setAttribute("sxmq8","1"===t.getAttribute("sxmq8")?"0":"1"),t.removeAttribute("pnzgu"),console.log("sxmq8 r2",document.documentElement.getAttribute("sxmq8")),Lo=0,Nn.inc(),$n.reset(),Fn.resolved||2&~xe){if(2===Pn){Pn=0;let t=document.querySelector("tabview-view-ploader");t&&t.remove()}}else xe-=2,In.inject();Cn.resolved&&(ce=1,Cn.reset(),8&xe||(z(!1),wo()))},{removeDuplicateInfoFn:Eo,setHiddenStateForDesc:So}=(()=>{function t(){let t=Xe.ytdFlexy;if(!t)return;let e,n=!document.fullscreenElement&&t.classList.contains("tabview-info-duplicated");e=document.querySelector(".tabview-info-duplicated-checked ytd-text-inline-expander#description-inline-expander.ytd-watch-metadata #plain-snippet-text"),e&&x(e,"hidden",n),e=document.querySelector(".tabview-info-duplicated-checked ytd-text-inline-expander#description-inline-expander.ytd-watch-metadata #formatted-snippet-text"),e&&x(e,"hidden",n)}function e(){const e=Xe.ytdFlexy;if(!e)return;let n=!1,o=!1;e.matches(".tabview-info-duplicated")&&(n=!!tn.call(e,"#description.style-scope.ytd-watch-metadata > #description-inner:only-child"),o=!!tn.call(e,"#tab-info ytd-expander #description.ytd-video-secondary-info-renderer")),t(),e.setAttribute("tyt-has",`${n?"A":"a"}${o?"B":"b"}`)}async function n(){const t=Xe.ytdFlexy;if(!t)return;const e=[...document.querySelectorAll("ytd-text-inline-expander#description-inline-expander:not([hidden])")].filter(t=>!nn.call(t,"[hidden]"));if(1!==e.length)return;const n=e[0];let l=Date.now();o=l,t.classList.toggle("tabview-info-duplicated",!0);let r=!1;try{if(await yn(),o!==l)return;let t=!1,e=null;await zt.all([...en.call(n,'#expand[role="button"]:not([hidden])')].map(o=>zt.resolve().then(()=>{e=e||new zt(t=>{let e=new MutationObserver(()=>{e.disconnect(),e=null,t()});e.observe(n,{subtree:!0,childList:!0})}),o.click(),t=!0}))),e&&await e.then(),"undefined"!=typeof IntersectionObserver&&await new zt(t=>{let e=new IntersectionObserver(()=>{e.disconnect(),e=null,t()});e.observe(n)}),await zt.resolve(0),r=await async function(t){const e=t||document.querySelector("ytd-text-inline-expander#description-inline-expander"),n=document.querySelector("#tab-info ytd-expander #description");return!(!e||!n)&&await async function(t,e){const n=t,o=e;if(n.hasAttribute("tyt-du744")||o.hasAttribute("tyt-du744"))return!0;if(!n||!o)return!1;if(n.hasAttribute("hidden")||o.hasAttribute("hidden"))return!1;const l="object"==typeof crypto&&"function"==typeof crypto.randomUUID?`${crypto.randomUUID()}`:"",r="function"==typeof String.prototype.replaceAll,i=l&&r;let a=i&&sessionStorage.getItem("js-yt-usernames")||"";{const t=document.querySelectorAll("#owner a.yt-simple-endpoint[href]");let e=null,n=null;for(const o of t){let t;null===n&&null===o.firstElementChild&&(o.textContent||"").length>0&&(n=o.textContent),null===e&&(t=/\/(\@[-_a-zA-Z0-9.]{3,30})(\/|$)/.exec(o.getAttribute("href")))&&(e=t[1])}null!==e&&null!==n&&a.indexOf(`\n${e}\t`)<0&&`${a}\n`.indexOf(`\t${n}\n`)<0&&(a=`\n${e}\t${n}\n${a}`.trim())}const c=[];let s;if(a){do{s=crypto.randomUUID()}while(a.includes(s));let t=0;const e=new Map;for(const n of a.split("\n")){if(n.length<4)continue;const o=n.split("\t"),l=o[1].replaceAll(" ","");let r=e.get(l);r||(r=++t,e.set(l,r)),c.push([o[0],r]),c.push([l,r])}e.clear(),c.length>1&&c.sort((t,e)=>e[0].length-t[0].length)}const d=i&&s&&c.length>0?t=>{if("string"==typeof t){t=t.replaceAll(" ","");for(const e of c){const n=`[[${s}::${e[1]}]]`;t=t.replaceAll(e[0],n)}}return t}:t=>t,u=new Map,y=(t,e)=>{t instanceof HTMLElement&&(t=>{for(const e of en.call(t,"[hidden]")){const t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,null);let n;for(;n=t.nextNode();){const t=n.nodeValue;t&&!t.startsWith("")&&(u.set(n,t),n.nodeValue=`${t.replace(/[\uF204\uF205]/g,"")}`)}}})(t);let n=t.textContent.trim(),o=n.length>0;if(o&&n.includes("")&&(n=n.replace(/\uF204[^\uF204\uF205]+\uF205/g,""),n=n.replace(/[\uF204\uF205]/g,""),o=n.length>0),o){n=n.replace(/\n[\n\x20]+\n/g,"\n\n"),n=n.replace(/[\u0020\u00A0\u16A0\u180E\u2000-\u200A\u202F\u205F\u3000]/g," "),n=n.replace(/[\u200b\uFEFF]/g,"");let t=64;for(;t-- >0;){const e=n;n=n.replace(/([\u1000-\uDF77])\x20([\x21-\x7E])/g,"$1$2"),n=n.replace(/([\x21-\x7E])\x20([\u1000-\uDF77])/g,"$1$2"),e===n&&(t=0)}n=d(n),n=n.replace(/[,，.。、]/g," "),n=n.replace(/[#＃]/g,"#"),n=n.replace(/[*＊]/g,"*"),n=n.replace(/[「」『』”’＜＞"'<>\[\]\{\}]/g,'"'),n=n.replace(/[:：]/g,":"),n=n.replace(/\s+/g," "),n=n.trim(),n&&e.push(n)}},f=t=>{if(t.nodeType===Node.ELEMENT_NODE){if("STYLE"===t.nodeName)return!1;if("button"===t.getAttribute("role"))return!1;if(t.hasAttribute("hidden"))return!1;if("snippet"===t.id){let e=!0;for(let n=It(t);n;n=Ht(n))if(!1!==f(n)&&0!==n.textContent.trim().length){e=!1;break}if(e)return!1}}else if(t.nodeType!==Node.TEXT_NODE)return!1;return!0},h=async(t,e=[])=>{try{await zt.resolve();for(let n=It(t);n;n=Ht(n))!1!==f(n)&&(n instanceof HTMLElement&&n.firstElementChild&&!n.nodeName.includes("-")?await h(n,e):y(n,e),await zt.resolve())}catch(t){console.log(t)}return e};u.clear();const[m,p]=await zt.all([h(n),h(o)]);if(u.forEach((t,e)=>{(e.nodeValue||"")===`${t.replace(/[\uF204\uF205]/g,"")}`&&(e.nodeValue=t)}),u.clear(),"undefined"==typeof GM&&(console.log(7191,m),console.log(7192,p),m.length===p.length)){let t=m.length;const e=[];for(let n=0;n<t;n++){let t=m[n],o=p[n],l=t.split(/([\w\-]+)/),r=o.split(/([\w\-]+)/),i=Math.min(l.length,r.length),a=-1;for(let t=0;t<i&&l[t]===r[t];t++)a=t;a>=0&&(t=l.slice(a+1).join(""),o=r.slice(a+1).join("")),e.push([t,o])}console.log(7194,e)}const b=function(t,e){const n=new Set(e),o=t.every(t=>n.has(t));return n.clear(),o}(m,p);return b&&async function(t,e){t&&e&&(t.setAttribute("tyt-du744",""),e.setAttribute("tyt-du744",""))}(n,o),b}(e,n.closest("ytd-expander")||n)}(n),!1===r&&t&&await zt.all([...en.call(n,'#collapse[role="button"]:not([hidden])')].map(t=>zt.resolve().then(()=>{t.click()})))}catch(e){t.classList.toggle("tabview-info-duplicated",!1)}return console.debug("[tyt] Have any details with duplicated information been found?",r?"Yes":"No"),o===l?{ok:1,infoDuplicated:r}:void 0}let o=0;return{removeDuplicateInfoFn:t=>{let o=Nn.valueOf();$n.debounce(()=>{if(o===Nn.valueOf()&&!document.fullscreenElement){if(!t){if(1&Go)return;Go|=1}!async function(t){let o=null;const l='#collapse[role="button"]:not([hidden]), #expand[role="button"]:not([hidden])',r=ln(document.querySelector("ytd-watch-metadata ytd-text-inline-expander#description-inline-expander"),"ytd-watch-metadata"),i=on(r,"ytd-text-inline-expander#description-inline-expander.style-scope.ytd-watch-metadata"),a=on(i,l);a&&(r.hasAttribute("description-collapsed")&&"expand"===a.id?o=!1:r.hasAttribute("description-collapsed")||"collapse"!==a.id||(o=!0)),r&&r.classList.add("tyt-tmp-hide-metainfo");try{for(let o=2;o-- >0&&(await Gt().then(),Nn.valueOf()===t);){const t=await n();if(t&&t.ok){const n=t.infoDuplicated;if(n||0===o){const t=Xe.ytdFlexy;t&&(t.classList.toggle("tabview-info-duplicated",n),t.classList.toggle("tabview-info-duplicated-checked",!0),e(),c(document,"tabview-fix-info-box-tooltip"));break}}await new zt(t=>setTimeout(t,270))}await zt.resolve(0);const a="boolean"==typeof o?on(i,l):null;if(a){const t=r.hasAttribute("description-collapsed"),e=a.id;(o?t&&"expand"===e:!t&&"collapse"===e)&&a.click()}}catch(t){console.warn(t)}if(r){r.classList.remove("tyt-tmp-hide-metainfo"),await zt.resolve(0);const t=tn.call(r,"#info-container.style-scope.ytd-watch-metadata")||tn.call(r,"#ytd-watch-info-text.style-scope.ytd-watch-metadata")||null;t&&zt.resolve(t).then(t=>{t&&jn.bindElement(t)})}}(o)}})},setHiddenStateForDesc:t}})();let Ao=0;et("yt-player-updated",t=>{const e=(t||0).target||0;1===e.nodeType&&"YTD-PLAYER"===e.nodeName.toUpperCase()&&(async function(t){const e="gM7Cp";let n=tn.call(t,`#movie_player video[src]:not([${e}])`);n=n||tn.call(t,`#movie_player audio.video-stream.html5-main-video[src]:not([${e}])`),n&&(n.setAttribute(e,""),n.addEventListener("timeupdate",()=>{!async function(){await async function(){return null!==document.fullscreenElement}()||(Ge++,Ge>=88e6&&Ge%88e6==0&&(Ge=0),(Ge+Ye)%11==0&&(Ye>208&&(Ye=200,Ge=Ge%8+1),document.head.dataset.viTime=`${Ye+1}`,await zt.resolve(0),Ye=+document.head.dataset.viTime||0))}()},Ze),n.addEventListener("ended",t=>{if("watch"===he){let e=t.target;zt.resolve(e).then(t=>{if("watch"===he){let e=nn.call(t,"#player")||nn.call(t,"#ytd-player")||t;e.scrollIntoView(!1),e=null}t=null})}},Ze))}(e),qn(()=>{ae&&(W(),tt(),fo(),it(null))}))});let Lo=0,To=new Map;const ko=new MutationObserver(()=>{J()}),_o=bn();let Co=new gn;const qo=function(t){const e=(t||0).target,n=e instanceof HTMLIFrameElement?e:null;n&&"chatframe"===n.id&&Ut(async()=>{await Co.then(),n.matches("body iframe.style-scope.ytd-live-chat-frame#chatframe")&&await $o(n)})};document.addEventListener("load",qo,Qe);let Do=0;const Mo=new WeakMap,$o=async function(t){const e=t;Do>1e9&&(Do=9);const n=++Do;if(Mo.set(e,2*n),await Fn.d(),await wn.then(),n!==Do)return;if(await Gt().then(),n!==Do)return;if(await $n.d(),n!==Do)return;if(!0!==e.isConnected)return;const o=nn.call(e,"ytd-live-chat-frame#chat");if(!o)return;if(o.hasAttribute("collapsed"))return;const l=_o.inc(),r=await new zt(t=>{let n=250,r=0;const i=()=>{let i;i=l!==_o.valueOf()||--n<0||!(!0===o.isConnected&&!0===e.isConnected&&!o.hasAttribute("collapsed"));let a=null;if(!i){if(HTMLElement.prototype.closest.call(e,"[hidden]"))return;if(!HTMLElement.prototype.closest.call(e,"#columns.style-scope.ytd-watch-flexy"))return;try{a=e.contentDocument}catch(t){}if(!a)return;if(!a.body)return}t&&t(a),t=null,r&&clearInterval(r),r=0};i(),null!==t&&(r=setInterval(i,17))}).catch(console.warn);if(n!==Do)return;if(l!==_o.valueOf()||!r)return;if(o.hasAttribute("collapsed")||!0!==e.isConnected)return;if(!r||"loading"!==r.readyState&&(r.body||0).firstElementChild||await new zt(t=>setTimeout(t,50)),o.hasAttribute("collapsed")||!0!==e.isConnected)return;if(n!==Do)return;const i=(r.body||0).firstElementChild;if(i){if(!ae||!T())return;if(!(e instanceof HTMLIFrameElement)||!0!==e.isConnected)return;let t=!1;try{t=e.contentDocument===r}catch(t){}if(t){let t=nn.call(e,"ytd-live-chat-frame#chat");t&&(c(t,"tabview-chatroom-ready"),Mo.set(e,2*n+1))}}else i||setTimeout(()=>{if(n===Do)try{if(o.isConnected&&!o.hasAttribute("collapsed")&&o.contains(e)){const t=e.contentDocument;if(t){const e=t.body;e&&null===e.firstElementChild&&c(o,"tabview-chat-fix-url-onload-with-empty-body")}}}catch(t){console.warn(t)}},230)},Po=async function(t){const e=t;if(!0!==e.isConnected||!(e instanceof HTMLIFrameElement))return;if((Mo.get(e)||0)%2!=1)return;const n=nn.call(e,"ytd-live-chat-frame#chat");if(!n)return;if(n.hasAttribute("collapsed")||!0!==e.isConnected)return;let o=0;try{o=e.contentDocument}catch(t){}(o.body||0).firstElementChild&&ae&&T()&&c(n,"tabview-chatroom-ready")};let No=new En,Fo=0;document.addEventListener("tabview-setMyDefaultTab",function(t){ht(((t||0).detail||0).myDefaultTab)},!1);let Io=!1;const Ho=t=>{if(t&&t.length>=1){let e=0;for(const n of t)if("hidden"===n.attributeName){e=1;break}e&&(Io=!0)}if(!ae)return;const e=Xe.ytdFlexy;if(!e)return;if(!t)return;const n=no.layoutStatus;if(0===n)return;let o=n,l=!1,r=0,i=0;if(a(),xn.allowChatControl){for(const n of t)o=xt(o,n.attributeName),"tyt-chat"===n.attributeName?l||(l=!0,(e.getAttribute("tyt-chat")||"").indexOf("chat$live")>=0&&gt(),e.hasAttribute("tyt-chat")||(i|=1)):"tyt-ep-visible"===n.attributeName?(0===+(e.getAttribute("tyt-ep-visible")||0)&&+n.oldValue>0&&(i|=2),r=0===r?1:-1):"tyt-donation-shelf"===n.attributeName?(e.hasAttribute("tyt-donation-shelf")?(be.lastPanel="#donation-shelf",At(null)):i|=4,r=0===r?2:-1):"is-extra-wide-video_"===n.attributeName&&yn().then(v);o=w(o),o!==n&&(fn(o,2,324)&&(1===r?fn(o,640,0)&&$():2===r&&fn(o,640,0)&&M()),no.layoutStatus=o),(async()=>{await yn(),Dn.lockWith(t=>{St(),t()})})()}},Ro=()=>{yn().then(()=>{Dn.lockWith(t=>{a(),function(){let t=document.getElementById("tabview-css-content");if(!t)return;let e=document.getElementById("tabview-css-chat");if(e)if(!1===t.disabled){if(xn.ytlstmTheaterMode){t.disabled=!0,e.disabled=!0;let n=document.querySelector(".youtube-genius-lyrics-found-hide-btn");n&&n.click(),M()}}else!0!==t.disabled||xn.ytlstmTheaterMode||(t.disabled=!1,e.disabled=!1)}(),xn.allowChatControl&&(Oo(no.layoutStatus),H()),document.fullscreenElement?t():4&no.layoutStatus?(xn.allowChatControl?i():document.querySelector("ytd-watch-flexy[is-two-columns_][theater] ytd-live-chat-frame#chat[collapsed]")&&F(),yn().then(t)):t()})})},Oo=t=>{const e=t;t=xt(t,"theater"),t=xt(t,"tyt-chat"),t=xt(t,"is-two-columns_"),t=xt(t,"tyt-tab"),t=xt(t,"fullscreen"),t=xt(t,"tyt-ep-visible"),w(t=xt(t,"tyt-donation-shelf")),e!==t&&(no.layoutStatus=t)},Bo=()=>{const t=Xe.ytdFlexy;if(!t)return;const e=function(){const t=Xe.ytdFlexy;if(!ae||!t)return null;let e=null,n=null;const o=document.querySelector("ytd-live-chat-frame#chat");let l=null;if(o){l=function(){let t=function(){let t=document.querySelector("ytd-live-chat-frame iframe#chatframe");if(!t)return null;let e=null;try{e=t.contentDocument}catch(t){}return e?"complete"!=e.readyState?null:e:null}();if(!t)return null;let e=null;try{e=t.querySelector("yt-live-chat-renderer #continuations")}catch(t){console.log("iframe error",t)}return e}();let r=0;if(l){if(r|=tn.call(l,"yt-timed-continuation")?1:0,r|=tn.call(l,"yt-live-chat-replay-continuation, yt-player-seek-continuation")?2:0,1==r?e="chat$live":2==r&&(e="chat$playback"),1==r){let t=document.querySelector("span#tyt-cm-count");t&&(t.textContent="")}}else t.hasAttribute("tyt-chat")||(e="");n=!!o.hasAttribute("collapsed")}else e=!1,n=!1;return{attr_chatblock:e,attr_chatcollapsed:n}}();if(e){let{attr_chatblock:n,attr_chatcollapsed:o}=e;null===n&&(n=!1,o=!1);let l=n;"string"==typeof l&&(!0===o&&(l="-"+l),!1===o&&(l="+"+l)),x(t,"tyt-chat",l)}};document.addEventListener("tabview-fix-layout",()=>{St()},!1);let jo=null,zo=!1;const Vo=async function(){function t(){o=null,l=null,r=null}if(!ae||"watch"!==he)return;if(!(2&~no.layoutStatus))return void(Be&&qt(document.querySelector("#right-tabs"),!1,null,null));let e=scrollY,n=Date.now();Oe=n,Ke.log(7891,"scrolling");let[o,l,r]=await zt.all([zt.resolve().then(()=>document.querySelector("#right-tabs")),zt.resolve().then(()=>document.querySelector("#right-tabs header")),zt.resolve().then(()=>document.querySelector("#masthead-container, #masthead"))]);if(!o||!l)return t();if(Oe!==n)return t();let i=await zt.all([zt.resolve().then(()=>r?r.offsetHeight:0),zt.resolve().then(()=>o.offsetTop)]);if(null===i)return t();if(Oe!==n)return t();const a=function(t){const[n,o]=t;let l=[o+n,e,o-n],r=0;return l[1]<l[2]&&l[2]<l[0]&&(r=1),l[0]>l[1]&&l[1]>l[2]&&(r=2),l[2]<l[0]&&l[0]<l[1]&&(r=3),r}(i);qt(o,2==a||3==a||1!=a&&null,function(){return{width:o.offsetWidth,height:l.offsetHeight}},function(){let t=document.querySelector("tabview-view-pos-thead");if(t){let e=t.getBoundingClientRect();if(e)return{left:e.left,right:document.documentElement.clientWidth-e.right}}return null}),t()},Wo=async function(t,e,n){function o(){l=null,r=null}if(!ae||"watch"!==he)return;if(!(2&~no.layoutStatus))return;let[l,r]=await zt.all([zt.resolve().then(()=>document.querySelector("#right-tabs")),zt.resolve().then(()=>document.querySelector("#right-tabs header"))]);if(!l||!r)return o();qt(l,2==t||3==t||1!=t&&null,function(){return{width:e||l.offsetWidth,height:r.offsetHeight}},function(){return n}),o()},Yo=bn();let Go=0,Uo=0,Xo=null,Ko=new Sn;document.addEventListener("yt-navigate-start",Mt,Ze),document.addEventListener("yt-navigate-cache",Mt,Ze),document.addEventListener("yt-navigate-redirect",Mt,Ze),document.addEventListener("yt-page-data-fetched",function(t){Fo=0,1!==Uo&&(Uo=1,Ko.lockWith(t=>{xo(),t()})),1===Uo&&(Uo=2,he=null,Ko.lockWith(e=>{if(he=null,Dt(t),"watch"!==he&&(Ae=null,me=null),zt.resolve().then(()=>{const t="watch"===he,e=Uo>=2;t||(Ae=null,me=null),!t&&e&&(U(),vt(),Cn.reset(),wo(),Cn.resolve()),e&&document.documentElement.classList.toggle("tabview-normal-player",t)}),Ge>0){const t=document.querySelector("#movie_player video[src]");let e=!1;t&&t.readyState>t.HAVE_CURRENT_DATA&&t.currentTime>2.2&&(e=!0),e||(Ye=203,Ge=0,delete document.head.dataset.viTime)}e()}))},Ze),document.addEventListener("yt-navigate-finish",function(){Fo=0,2===Uo&&(Uo=3,Ko.lockWith(e=>{"watch"===he&&async function(){if(await Fn.d(),"watch"!==he)return;zt.resolve().then(nt);let e=Date.now();Fo=e;const n=Gt().then(),o=No.d(),l=()=>{if(Fo!==e)return-400;if(3!==Uo)return-200;const t=document.querySelector("ytd-watch-flexy:not([hidden])")||document.querySelector("ytd-watch-flexy");return t?(Ae=hn(t),0):(Ae=null,-100)};let r=l();if(r<0)return;let i=ae;if(ae=!0,await zt.all([o,n]),r=l(),r<0)return ae=i,void(Ae||(ae=!1));r=null;const a=mn(Ae);if(!a)return Ae=null,void(ae=!1);ho(),document.removeEventListener("load",mt,!0),document.addEventListener("load",mt,!0);const c=tn.call(a,"#related.ytd-watch-flexy");if(!c)return;if(!document.querySelector("#right-tabs")){!function(){let t=Q();Ne=Fe[t]?t:"en"}();let e=document.createElement("template");e.innerHTML=t(function(){const t=`${oo(16,16,90,90,Jt)}<span>${Z("videos")}</span>`,e=`${oo(16,16,60,60,Zt)}<span>${Z("info")}</span>`,n=`${oo(16,16,20,20,Qt)}<span>${Z("playlist")}</span>`;let o='\n        <paper-ripple class="style-scope yt-icon-button">\n            <div id="background" class="style-scope paper-ripple" style="opacity:0;"></div>\n            <div id="waves" class="style-scope paper-ripple"></div>\n        </paper-ripple>\n        ',l='\n    <div class="font-size-right">\n    <div class="font-size-btn font-size-plus" tyt-di="8rdLQ">\n    <svg width="12" height="12" viewbox="0 0 50 50" preserveAspectRatio="xMidYMid meet" \n    stroke="currentColor" stroke-width="6" stroke-linecap="round" vector-effect="non-scaling-size">\n      <path d="M12 25H38M25 12V38"/>\n    </svg>\n    </div><div class="font-size-btn font-size-minus" tyt-di="8rdLQ">\n    <svg width="12" height="12" viewbox="0 0 50 50" preserveAspectRatio="xMidYMid meet"\n    stroke="currentColor" stroke-width="6" stroke-linecap="round" vector-effect="non-scaling-size">\n      <path d="M12 25h26"/>\n    </svg>\n    </div>\n    </div>\n    '.replace(/[\r\n]+/g,"");return`\n        <div id="right-tabs">\n            <tabview-view-pos-thead></tabview-view-pos-thead>\n            <header>\n                <div id="material-tabs">\n                    ${[`<a id="tab-btn1" tyt-di="q9Kjc" tyt-tab-content="#tab-info" class="tab-btn${1&~qe?"":" tab-btn-hidden"}">${e}${o}${l}</a>`,`<a id="tab-btn3" tyt-di="q9Kjc" tyt-tab-content="#tab-comments" class="tab-btn${2&~qe?"":" tab-btn-hidden"}">${oo(16,16,120,120,Kt)}<span id="tyt-cm-count"></span>${o}${l}</a>`,`<a id="tab-btn4" tyt-di="q9Kjc" tyt-tab-content="#tab-videos" class="tab-btn${4&~qe?"":" tab-btn-hidden"}">${t}${o}${l}</a>`,`<a id="tab-btn5" tyt-di="q9Kjc" tyt-tab-content="#tab-list" class="tab-btn tab-btn-hidden">${n}${o}${l}</a>`].join("")}\n                </div>\n            </header>\n            <div class="tab-content">\n                <div id="tab-info" class="tab-content-cld tab-content-hidden" tyt-hidden userscript-scrollbar-render></div>\n                <div id="tab-comments" class="tab-content-cld tab-content-hidden" tyt-hidden userscript-scrollbar-render></div>\n                <div id="tab-videos" class="tab-content-cld tab-content-hidden" tyt-hidden userscript-scrollbar-render></div>\n                <div id="tab-list" class="tab-content-cld tab-content-hidden" tyt-hidden userscript-scrollbar-render></div>\n            </div>\n        </div>\n        `}());let n=e.content.firstElementChild;null!==n&&(io(n,c),tn.call(n,"#material-tabs").addEventListener("mousemove",t=>{t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()},!0),ft(),console.debug("[tyt] #right-tabs inserted")),e.textContent="",e=null}a.hasAttribute("tyt-tab")||a.setAttribute("tyt-tab",""),H();let s=!1;(document.querySelector('ytd-watch-flexy[tyt-chat^="+"]')||document.querySelector('ytd-watch-flexy[class][tyt-tab] #panels.ytd-watch-flexy ytd-engagement-panel-section-list-renderer[target-id][visibility="ENGAGEMENT_PANEL_VISIBILITY_EXPANDED"]:not([hidden])')||document.querySelector("ytd-watch-flexy ytd-donation-shelf-renderer.ytd-watch-flexy:not([hidden]):not(:empty)"))&&(s=!0),s?At(null):g(),zn.clear(!0),Vn.clear(!0),(()=>{const t=Xe.ytdFlexy;if(!ae||!t)return!0;void 0!==no.layoutStatus&&1&no.layoutStatus||(no.layoutStatus=0),t.hasAttribute("hidden")||Bo();let e=[...en.call(t,".tab-btn[tyt-tab-content]")].map(t=>({elm:t,hidden:t.classList.contains("tab-btn-hidden")}));0===e.length?x(t,"tyt-tab",!1):(e=e.filter(t=>!0!==t.hidden),0===e.length&&x(t,"tyt-tab","")),e=null;let n=q();n&&n.list.length>0?x(t,"tyt-ep-visible",`${n.value}`):x(t,"tyt-ep-visible",!1),Oo(1),zn.bindElement(t,{attributes:!0,attributeFilter:["tyt-chat","theater","is-two-columns_","tyt-tab","fullscreen","tyt-ep-visible","tyt-donation-shelf","hidden","is-extra-wide-video_"],attributeOldValue:!0}),Vn.bindElement(document.body,{attributes:!0,attributeFilter:["data-ytlstm-theater-mode"],attributeOldValue:!0});let o=document.querySelector("ytd-page-manager#page-manager #columns.ytd-watch-flexy");o&&x(o,"userscript-scrollbar-render",!0),St()})(),document.documentElement.setAttribute("tyt-deferred",""),Cn.resolve(),wn.resolve(),mo.mtf_attrEngagementPanel()}(),e()}))},Ze),et("yt-page-data-fetched",0),et("yt-page-data-updated",0),et("yt-player-updated",0),et("yt-watch-comments-ready",0),et("yt-page-type-changed",0),et("data-changed",0),et("yt-navigate-finish",0),et("yt-navigate-redirect",0),et("yt-navigate-error",0),et("yt-navigate-start",0),et("yt-page-manager-navigate-start",0),et("yt-navigate",0),et("yt-navigate-cache",0);const Jo=bn();window.addEventListener("resize",function(t){if(!0===t.isTrusted){let t=Jo.inc();zt.resolve(0).then(()=>{t===Jo.valueOf()&&setTimeout(()=>{t===Jo.valueOf()&&(Jo.set(0),$t(),u())},160)})}},Ze),document.addEventListener("tyt-chat-popup",t=>{let e=(t||0).detail;if(!e)return;const{popuped:n}=e;if("boolean"!=typeof n)return;let o=Xe.ytdFlexy;o&&(o.classList.toggle("tyt-chat-popup",n),!0===n?(eo=!0,P()):(eo=!1,N()))});let Zo=!1;document.addEventListener("keyup",t=>{t&&t.target&&t.key&&Zo&&(t.shiftKey&&0!=t.key.indexOf("Shift")||(Zo=!1))}),document.addEventListener("keydown",t=>{if(t&&t.target&&t.key&&t.shiftKey&&0==t.key.indexOf("Arrow"))try{!Zo&&window.getSelection().isCollapsed||(t.stopImmediatePropagation(),t.stopPropagation(),Zo=!0)}catch(t){}},!0);let Qo=!1;if(document.addEventListener("click",function(){Qo=!0,je&&!Be&&Qo&&zo&&yn().then(dt)}),document.addEventListener("ytd-comments-data-changed",function(t){!1===(t.detail||0).hasData&&vt(),z(!0),W()},!0),document.addEventListener("ytd-comments-header-changed",function(){const t=z(!0);t&&!0===t.newFound&&1===t.length&&t[0].isLatest&&t[0].isNew&&$n.resolved&&Pe.new&&(Pe.fetched=!1,Le.comments_section_loaded=0),W()},!0),document.addEventListener("tabview-plugin-loaded",()=>{Fn.resolve(),c(document,"tabview-miniview-browser-enable")},!1),"undefined"!=typeof GM&&!Xt()&&"function"==typeof GM_registerMenuCommand){let sl=null;function dl(){const t={dialogBackgroundColor:"#f6f6f6",dialogBackgroundColorDark:"#23252a",backdropColor:"#b5b5b568",textColor:"#111111",textColorDark:"#f0f3f4",zIndex:6e4,fontSize:"10pt",dialogMinWidth:"32px",dialogMinHeight:"24px"};class e extends VanillaJSDialog{get themeProps(){return t}isDarkTheme(){return document.documentElement.hasAttribute("dark")}onBeforeShow(){const t=this.es;"checkboxSelectionDisplay"in t&&(t.checkboxSelectionDisplay.textContent="");const e=t=>{for(const e of document.getElementsByName("tabview-tab-default"))e.checked=e.value===t};!function(t){if(t){let n=t[Ce];if(n&&"string"==typeof n&&/^\#[a-zA-Z\_\-\+]+$/.test(n)&&document.querySelector(`.tab-btn[tyt-tab-content="${n}"]`))return e(n)}e(null)}(Lt())}onFirstCreation(){const t=this.S;t.widgets.icon=e=>t.ce("i",{className:"vjsd-icon fa-solid fa-"+e}),t.importCSS("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/fontawesome.min.css#sha512=SgaqKKxJDQ/tAUAAXzvxZz33rmn7leYDYfBP+YoMRSENhf3zJyx3SBASt/OfeQwBHA1nxMis7mM3EV/oYT6Fdw==","https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/solid.min.css#sha512=yDUXOUWwbHH4ggxueDnC5vJv4tmfySpVdIcN1LksGZi8W8EVZv4uKGrQc0pVf66zS7LDhFJM7Zdeow1sw1/8Jw=="),this.themeSetup()}init(){const t=this.S,e=this.es;e.dialog=t.ce("div",{className:"vjsd-dialog"},{__vjsd__:""}),e.dialog.append(e.header=t.ce("div",{className:"vjsd-dialog-header vjsd-hflex"}),e.body=t.ce("div",{className:"vjsd-dialog-body vjsd-gap-2 vjsd-overscroll-none vjsd-vflex"}),e.footer=t.ce("div",{className:"vjsd-dialog-footer vjsd-hflex"})),e.header.append(t.widgets.icon("circle-info",()=>{}),t.widgets.title("Tabview Youtube - Change Default Tab",{className:"vjsd-flex-fill"}),t.widgets.buttonIcon("square-xmark",{"vjsd-clickable":"#dialogXmark"}));const n=()=>{let t=[...document.getElementsByName("tabview-tab-default")].filter(t=>t.checked).map(t=>t.value);console.assert(t.length<=1),e.checkboxSelectionDisplay.textContent=1===t.length?`The default tab will be set to ${t[0]}`:"The default tab will be reset."};e.body.append(t.widgets.labeledRadio("vjsd-checkbox1 vjsd-checkbox-tick","Info",(t,o)=>{o.name="tabview-tab-default",o.value="#tab-info",e.checkbox1=o,o.addEventListener("change",n),t.style.fontSize="200%"}),t.widgets.labeledRadio("vjsd-checkbox1 vjsd-checkbox-tick","Comment",(t,o)=>{o.name="tabview-tab-default",o.value="#tab-comments",e.checkbox2=o,o.addEventListener("change",n),t.style.fontSize="200%"}),t.widgets.labeledRadio("vjsd-checkbox1 vjsd-checkbox-tick","Video",(t,o)=>{o.name="tabview-tab-default",o.value="#tab-videos",e.checkbox3=o,o.addEventListener("change",n),t.style.fontSize="200%"}),e.checkboxSelectionDisplay=t.ce("div",{className:"vjsd-custom-widget"})),e.footer.append(e.clearButton=t.widgets.button("Clear",{"vjsd-clickable":"#clear"}),t.widgets.space(),t.widgets.button("Cancel",{"vjsd-clickable":"#cancel"}),t.widgets.button("Confirm",{"vjsd-clickable":"#confirm"})),this.clickable("#cancel",()=>{this.dismiss()}),this.clickable("#clear",()=>{e.checkbox1.checked=!1,e.checkbox2.checked=!1,e.checkbox3.checked=!1,n()}),this.clickable("#confirm",()=>{let t=null;for(const e of document.getElementsByName("tabview-tab-default"))e.checked&&(t=e.value);t=t||null,console.log(t),ht(t),this.dismiss()}),this.clickable("#dialogXmark",()=>{this.dismiss()}),this.backdrop="dismiss",document.body.appendChild(e.dialog)}}return e.setup1(),new e}GM_registerMenuCommand("Change Default Tab",function(){sl=sl||dl(),sl.show()})}ct("#tabview-controller",()=>{}),document.documentElement.appendChild(document.createElement("tabview-controller")).id="tabview-tabs-hide-controller",document.documentElement.appendChild(document.createElement("tabview-controller")).id="tabview-default-tab-controller",document.documentElement.setAttribute("plugin-tabview-youtube","2022/12/04"),document.documentElement.getAttribute("tabview-unwrapjs")&&document.dispatchEvent(new CustomEvent("tabview-plugin-loaded"))}({requestAnimationFrame:"function"==typeof webkitRequestAnimationFrame?webkitRequestAnimationFrame:requestAnimationFrame,cancelAnimationFrame:"function"==typeof webkitRequestAnimationFrame?webkitRequestAnimationFrame:requestAnimationFrame})}(async()=>{"use strict";const e=[{id:"tabview-css-content",resTag:"contentCSS"},{id:"tabview-css-chat",resTag:"chatCSS"},{id:"tabview-css-control",resTag:"controlCSS"}],n=(async()=>{})().constructor,o=e.map(t=>(t=t.resTag,GM_getResourceText(t)||GM.getResourceText(t)||"")),l=await n.all(o);null===document.documentElement&&await new n(t=>{let e=new MutationObserver(()=>{e&&null!==document.documentElement&&(e.disconnect(),e.takeRecords(),e=null,t())});e.observe(document,{childList:!0,subtree:!0})});const r=document.head||document.documentElement;let i=0;for(const t of e){const e=l[i++];if(e){const n=document.createElement("style");n.id=t.id,n.textContent=e,r.appendChild(n)}}t()})();