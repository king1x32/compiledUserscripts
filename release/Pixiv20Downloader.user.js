// ==UserScript==
// @name               Pixiv Downloader
// @namespace          https://greasyfork.org/zh-CN/scripts/432150
// @version            1.11.0
// @author             ruaruarua
// @license            MIT
// @icon               https://www.pixiv.net/favicon.ico
// @supportURL         https://github.com/drunkg00se/Pixiv-Downloader/issues
// @match              https://www.pixiv.net/*
// @match              https://rule34.xxx/*
// @match              https://danbooru.donmai.us/*
// @match              https://yande.re/*
// @match              https://booru.allthefallen.moe/*
// @match              https://konachan.com/*
// @match              https://konachan.net/*
// @match              https://www.sakugabooru.com/*
// @match              https://safebooru.org/*
// @match              https://gelbooru.com/*
// @match              https://e621.net/*
// @match              https://e926.net/*
// @match              https://e6ai.net/*
// @match              https://nijie.info/*
// @match              https://rule34vault.com/*
// @match              https://rule34.paheal.net/*
// @match              https://rule34.us/*
// @require            https://unpkg.com/dexie@3.2.7/dist/dexie.min.js
// @require            https://unpkg.com/jszip@3.9.1/dist/jszip.min.js
// @require            https://unpkg.com/gif.js@0.2.0/dist/gif.js
// @require            https://unpkg.com/dayjs@1.11.13/dayjs.min.js
// @require            https://cdn.jsdelivr.net/npm/mp4-muxer@5.1.5/build/mp4-muxer.min.js
// @require            https://cdn.jsdelivr.net/npm/webm-muxer@5.0.3/build/webm-muxer.min.js
// @resource           ../wasm/toWebpWorker?raw    https://update.greasyfork.org/scripts/500281/1409041/libwebp_wasm.js
// @resource           gif.js/dist/gif.worker?raw  https://unpkg.com/gif.js@0.2.0/dist/gif.worker.js
// @resource           pako/dist/pako.js?raw       https://unpkg.com/pako@2.1.0/dist/pako.min.js
// @resource           upng-js?raw                 https://unpkg.com/upng-js@2.1.0/UPNG.js
// @connect            i.pximg.net
// @connect            source.pixiv.net
// @connect            rule34.xxx
// @connect            donmai.us
// @connect            yande.re
// @connect            allthefallen.moe
// @connect            konachan.com
// @connect            konachan.net
// @connect            sakugabooru.com
// @connect            safebooru.org
// @connect            gelbooru.com
// @connect            e621.net
// @connect            e926.net
// @connect            e6ai.net
// @connect            nijie.net
// @connect            rule34vault.com
// @connect            r34xyz.b-cdn.net
// @connect            r34i.paheal-cdn.net
// @connect            rule34.us
// @grant              GM_download
// @grant              GM_getResourceText
// @grant              GM_info
// @grant              GM_registerMenuCommand
// @grant              GM_xmlhttpRequest
// @grant              unsafeWindow
// @noframes
// @downloadURL https://raw.githubusercontent.com/king1x32/compiledUserscripts/release/release/Pixiv20Downloader.user.js
// @updateURL https://raw.githubusercontent.com/king1x32/compiledUserscripts/release/release/Pixiv20Downloader.meta.js
// ==/UserScript==
(()=>{const t=new CSSStyleSheet;t.replaceSync(" .anim-indeterminate.svelte-12wvf64{transform-origin:0% 50%;animation:svelte-12wvf64-anim-indeterminate 2s infinite linear}@keyframes svelte-12wvf64-anim-indeterminate{0%{transform:translate(0) scaleX(0)}40%{transform:translate(0) scaleX(.4)}to{transform:translate(100%) scaleX(.5)}}*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: \"\"}:host [data-theme=skeleton],:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\",Segoe UI Symbol,\"Noto Color Emoji\";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}:host [data-theme=skeleton]{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h3,h4{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}dl,dd,h1,h3,h4,hr,figure,p{margin:0}fieldset{margin:0;padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}[type=text],input:where(:not([type])),[type=email],[type=url],[type=password],[type=number],[type=date],[type=datetime-local],[type=month],[type=search],[type=tel],[type=time],[type=week],[multiple],textarea,select{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#fff;border-color:#6b7280;border-width:1px;border-radius:0;padding:8px 12px;font-size:16px;line-height:24px;--tw-shadow: 0 0 #0000}[type=text]:focus,input:where(:not([type])):focus,[type=email]:focus,[type=url]:focus,[type=password]:focus,[type=number]:focus,[type=date]:focus,[type=datetime-local]:focus,[type=month]:focus,[type=search]:focus,[type=tel]:focus,[type=time]:focus,[type=week]:focus,[multiple]:focus,textarea:focus,select:focus{outline:2px solid transparent;outline-offset:2px;--tw-ring-inset: var(--tw-empty, );--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: #2563eb;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow);border-color:#2563eb}input::-moz-placeholder,textarea::-moz-placeholder{color:#6b7280;opacity:1}input::placeholder,textarea::placeholder{color:#6b7280;opacity:1}::-webkit-datetime-edit-fields-wrapper{padding:0}::-webkit-date-and-time-value{min-height:1.5em;text-align:inherit}::-webkit-datetime-edit{display:inline-flex}::-webkit-datetime-edit,::-webkit-datetime-edit-year-field,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute-field,::-webkit-datetime-edit-second-field,::-webkit-datetime-edit-millisecond-field,::-webkit-datetime-edit-meridiem-field{padding-top:0;padding-bottom:0}select{background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e\");background-position:right 8px center;background-repeat:no-repeat;background-size:1.5em 1.5em;padding-right:40px;-webkit-print-color-adjust:exact;print-color-adjust:exact}[multiple],[size]:where(select:not([size=\"1\"])){background-image:initial;background-position:initial;background-repeat:unset;background-size:initial;padding-right:12px;-webkit-print-color-adjust:unset;print-color-adjust:unset}[type=checkbox],[type=radio]{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:0;-webkit-print-color-adjust:exact;print-color-adjust:exact;display:inline-block;vertical-align:middle;background-origin:border-box;-webkit-user-select:none;-moz-user-select:none;user-select:none;flex-shrink:0;height:16px;width:16px;color:#2563eb;background-color:#fff;border-color:#6b7280;border-width:1px;--tw-shadow: 0 0 #0000}[type=checkbox]{border-radius:0}[type=radio]{border-radius:100%}[type=checkbox]:focus,[type=radio]:focus{outline:2px solid transparent;outline-offset:2px;--tw-ring-inset: var(--tw-empty, );--tw-ring-offset-width: 2px;--tw-ring-offset-color: #fff;--tw-ring-color: #2563eb;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}[type=checkbox]:checked,[type=radio]:checked{border-color:transparent;background-color:currentColor;background-size:100% 100%;background-position:center;background-repeat:no-repeat}[type=checkbox]:checked{background-image:url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e\")}@media (forced-colors: active){[type=checkbox]:checked{-webkit-appearance:auto;-moz-appearance:auto;appearance:auto}}[type=radio]:checked{background-image:url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3ccircle cx='8' cy='8' r='3'/%3e%3c/svg%3e\")}@media (forced-colors: active){[type=radio]:checked{-webkit-appearance:auto;-moz-appearance:auto;appearance:auto}}[type=checkbox]:checked:hover,[type=checkbox]:checked:focus,[type=radio]:checked:hover,[type=radio]:checked:focus{border-color:transparent;background-color:currentColor}[type=checkbox]:indeterminate{background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 16 16'%3e%3cpath stroke='white' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M4 8h8'/%3e%3c/svg%3e\");border-color:transparent;background-color:currentColor;background-size:100% 100%;background-position:center;background-repeat:no-repeat}@media (forced-colors: active){[type=checkbox]:indeterminate{-webkit-appearance:auto;-moz-appearance:auto;appearance:auto}}[type=checkbox]:indeterminate:hover,[type=checkbox]:indeterminate:focus{border-color:transparent;background-color:currentColor}[type=file]{background:unset;border-color:inherit;border-width:0;border-radius:0;padding:0;font-size:unset;line-height:inherit}[type=file]:focus{outline:1px solid ButtonText;outline:1px auto -webkit-focus-ring-color}:host [data-theme=skeleton]{background-color:rgb(var(--color-surface-50));font-size:16px;line-height:24px;font-family:var(--theme-font-family-base);color:rgba(var(--theme-font-color-base))}:host .dark [data-theme=skeleton]{background-color:rgb(var(--color-surface-900));color:rgba(var(--theme-font-color-dark))}::-moz-selection{background-color:rgb(var(--color-primary-500) / .3)}::selection{background-color:rgb(var(--color-primary-500) / .3)}:host [data-theme=skeleton]{-webkit-tap-highlight-color:rgba(128,128,128,.5);scrollbar-color:rgba(0,0,0,.2) rgba(255,255,255,.05)}:host [data-theme=skeleton]{scrollbar-color:rgba(128,128,128,.5) rgba(0,0,0,.1);scrollbar-width:thin}:host.dark{scrollbar-color:rgba(255,255,255,.1) rgba(0,0,0,.05)}hr:not(.divider){display:block;border-top-width:1px;border-style:solid;border-color:rgb(var(--color-surface-300))}.dark hr:not(.divider){border-color:rgb(var(--color-surface-600))}fieldset,label{display:block}::-moz-placeholder{color:rgb(var(--color-surface-500))}::placeholder{color:rgb(var(--color-surface-500))}.dark ::-moz-placeholder{color:rgb(var(--color-surface-400))}.dark ::placeholder{color:rgb(var(--color-surface-400))}:is(.dark input::-webkit-calendar-picker-indicator){--tw-invert: invert(100%);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}input[type=search]::-webkit-search-cancel-button{-webkit-appearance:none;background:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cpath d='M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z'/%3E%3C/svg%3E\") no-repeat 50% 50%;pointer-events:none;height:16px;width:16px;border-radius:9999px;background-size:contain;opacity:0}input[type=search]:focus::-webkit-search-cancel-button{pointer-events:auto;opacity:1}:is(.dark input[type=search]::-webkit-search-cancel-button){--tw-invert: invert(100%);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}progress{webkit-appearance:none;-moz-appearance:none;-webkit-appearance:none;appearance:none;height:8px;width:100%;overflow:hidden;border-radius:var(--theme-rounded-base);background-color:rgb(var(--color-surface-400))}.dark progress{background-color:rgb(var(--color-surface-500))}progress::-webkit-progress-bar{background-color:rgb(var(--color-surface-400))}.dark progress::-webkit-progress-bar{background-color:rgb(var(--color-surface-500))}progress::-webkit-progress-value{background-color:rgb(var(--color-surface-900))}.dark progress::-webkit-progress-value{background-color:rgb(var(--color-surface-50))}::-moz-progress-bar{background-color:rgb(var(--color-surface-900))}.dark ::-moz-progress-bar{background-color:rgb(var(--color-surface-50))}:indeterminate::-moz-progress-bar{width:0}input[type=file]:not(.file-dropzone-input)::file-selector-button:disabled{cursor:not-allowed;opacity:.5}input[type=file]:not(.file-dropzone-input)::file-selector-button:disabled:hover{--tw-brightness: brightness(1);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}input[type=file]:not(.file-dropzone-input)::file-selector-button:disabled:active{--tw-scale-x: 1;--tw-scale-y: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}input[type=file]:not(.file-dropzone-input)::file-selector-button{font-size:14px;line-height:20px;padding:6px 12px;white-space:nowrap;text-align:center;display:inline-flex;align-items:center;justify-content:center;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s;border-radius:var(--theme-rounded-base);background-color:rgb(var(--color-surface-900));color:rgb(var(--color-surface-50));margin-right:8px;border-width:0px}input[type=file]:not(.file-dropzone-input)::file-selector-button>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(8px * var(--tw-space-x-reverse));margin-left:calc(8px * calc(1 - var(--tw-space-x-reverse)))}input[type=file]:not(.file-dropzone-input)::file-selector-button:hover{--tw-brightness: brightness(1.15);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}input[type=file]:not(.file-dropzone-input)::file-selector-button:active{--tw-scale-x: 95%;--tw-scale-y: 95%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));--tw-brightness: brightness(.9);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.dark input[type=file]:not(.file-dropzone-input)::file-selector-button{background-color:rgb(var(--color-surface-50));color:rgb(var(--color-surface-900))}[type=range]{width:100%;accent-color:rgb(var(--color-surface-900) / 1)}:is(.dark [type=range]){accent-color:rgb(var(--color-surface-50) / 1)}[data-sort]{cursor:pointer}[data-sort]:hover:hover,.dark [data-sort]:hover:hover{background-color:rgb(var(--color-primary-500) / .1)}[data-sort]:after{margin-left:8px!important;opacity:0;--tw-content: \"↓\" !important;content:var(--tw-content)!important}[data-popup]{position:absolute;top:0;left:0;display:none;transition-property:opacity;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}:host [data-theme=skeleton]{--theme-font-family-base: system-ui;--theme-font-family-heading: system-ui;--theme-font-color-base: 0 0 0;--theme-font-color-dark: 255 255 255;--theme-rounded-base: 9999px;--theme-rounded-container: 8px;--theme-border-base: 1px;--on-primary: 0 0 0;--on-secondary: 255 255 255;--on-tertiary: 0 0 0;--on-success: 0 0 0;--on-warning: 0 0 0;--on-error: 255 255 255;--on-surface: 255 255 255;--color-primary-50: 219 245 236;--color-primary-100: 207 241 230;--color-primary-200: 195 238 224;--color-primary-300: 159 227 205;--color-primary-400: 87 207 167;--color-primary-500: 15 186 129;--color-primary-600: 14 167 116;--color-primary-700: 11 140 97;--color-primary-800: 9 112 77;--color-primary-900: 7 91 63;--color-secondary-50: 229 227 251;--color-secondary-100: 220 218 250;--color-secondary-200: 211 209 249;--color-secondary-300: 185 181 245;--color-secondary-400: 132 126 237;--color-secondary-500: 79 70 229;--color-secondary-600: 71 63 206;--color-secondary-700: 59 53 172;--color-secondary-800: 47 42 137;--color-secondary-900: 39 34 112;--color-tertiary-50: 219 242 252;--color-tertiary-100: 207 237 251;--color-tertiary-200: 195 233 250;--color-tertiary-300: 159 219 246;--color-tertiary-400: 86 192 240;--color-tertiary-500: 14 165 233;--color-tertiary-600: 13 149 210;--color-tertiary-700: 11 124 175;--color-tertiary-800: 8 99 140;--color-tertiary-900: 7 81 114;--color-success-50: 237 247 220;--color-success-100: 230 245 208;--color-success-200: 224 242 197;--color-success-300: 206 235 162;--color-success-400: 169 219 92;--color-success-500: 132 204 22;--color-success-600: 119 184 20;--color-success-700: 99 153 17;--color-success-800: 79 122 13;--color-success-900: 65 100 11;--color-warning-50: 252 244 218;--color-warning-100: 251 240 206;--color-warning-200: 250 236 193;--color-warning-300: 247 225 156;--color-warning-400: 240 202 82;--color-warning-500: 234 179 8;--color-warning-600: 211 161 7;--color-warning-700: 176 134 6;--color-warning-800: 140 107 5;--color-warning-900: 115 88 4;--color-error-50: 249 221 234;--color-error-100: 246 209 228;--color-error-200: 244 198 221;--color-error-300: 238 163 200;--color-error-400: 225 94 159;--color-error-500: 212 25 118;--color-error-600: 191 23 106;--color-error-700: 159 19 89;--color-error-800: 127 15 71;--color-error-900: 104 12 58;--color-surface-50: 228 230 238;--color-surface-100: 219 222 233;--color-surface-200: 210 214 227;--color-surface-300: 182 189 210;--color-surface-400: 128 140 177;--color-surface-500: 73 90 143;--color-surface-600: 66 81 129;--color-surface-700: 55 68 107;--color-surface-800: 44 54 86;--color-surface-900: 36 44 70}[data-theme=skeleton] h1,[data-theme=skeleton] h3,[data-theme=skeleton] h4{font-weight:700}[data-theme=skeleton]{background-image:radial-gradient(at 0% 0%,rgba(var(--color-secondary-500) / .33) 0px,transparent 50%),radial-gradient(at 98% 1%,rgba(var(--color-error-500) / .33) 0px,transparent 50%);background-attachment:fixed;background-position:center;background-repeat:no-repeat;background-size:cover}*{scrollbar-color:initial;scrollbar-width:initial}.\\!container{width:100%!important}.container{width:100%}@media (min-width: 640px){.\\!container{max-width:640px!important}.container{max-width:640px}}@media (min-width: 768px){.\\!container{max-width:768px!important}.container{max-width:768px}}@media (min-width: 1024px){.\\!container{max-width:1024px!important}.container{max-width:1024px}}@media (min-width: 1280px){.\\!container{max-width:1280px!important}.container{max-width:1280px}}@media (min-width: 1536px){.\\!container{max-width:1536px!important}.container{max-width:1536px}}.hide-scrollbar::-webkit-scrollbar{display:none}.hide-scrollbar{-ms-overflow-style:none;scrollbar-width:none}.h3{font-size:20px;line-height:28px;font-family:var(--theme-font-family-heading)}.h4{font-size:18px;line-height:28px;font-family:var(--theme-font-family-heading)}.anchor{--tw-text-opacity: 1;color:rgb(var(--color-primary-700) / var(--tw-text-opacity));text-decoration-line:underline}.anchor:hover{--tw-brightness: brightness(1.1);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}:is(.dark .anchor){--tw-text-opacity: 1;color:rgb(var(--color-primary-500) / var(--tw-text-opacity))}.time{font-size:14px;line-height:20px;--tw-text-opacity: 1;color:rgb(var(--color-surface-500) / var(--tw-text-opacity))}:is(.dark .time){--tw-text-opacity: 1;color:rgb(var(--color-surface-400) / var(--tw-text-opacity))}.code{white-space:nowrap;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:12px;line-height:16px;--tw-text-opacity: 1;color:rgb(var(--color-primary-700) / var(--tw-text-opacity));background-color:rgb(var(--color-primary-500) / .3);border-radius:4px;padding:2px 4px}:is(.dark .code){--tw-text-opacity: 1;color:rgb(var(--color-primary-400) / var(--tw-text-opacity));background-color:rgb(var(--color-primary-500) / .2)}.alert{display:flex;flex-direction:column;align-items:flex-start;padding:16px;color:rgb(var(--color-surface-900));border-radius:var(--theme-rounded-container)}.alert>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(16px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(16px * var(--tw-space-y-reverse))}.dark .alert{color:rgb(var(--color-surface-50))}.badge{display:inline-flex;align-items:center;justify-content:center;white-space:nowrap;font-size:12px;line-height:16px;font-weight:600;padding:4px 8px;border-radius:var(--theme-rounded-base)}.badge>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(8px * var(--tw-space-x-reverse));margin-left:calc(8px * calc(1 - var(--tw-space-x-reverse)))}.\\!btn:disabled{cursor:not-allowed!important;opacity:.5!important}.btn:disabled,.btn-icon:disabled,.btn-group>*:disabled{cursor:not-allowed!important;opacity:.5!important}.\\!btn:disabled:hover{--tw-brightness: brightness(1) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.btn:disabled:hover,.btn-icon:disabled:hover,.btn-group>*:disabled:hover{--tw-brightness: brightness(1);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.\\!btn:disabled:active{--tw-scale-x: 1 !important;--tw-scale-y: 1 !important;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))!important}.btn:disabled:active,.btn-icon:disabled:active,.btn-group>*:disabled:active{--tw-scale-x: 1;--tw-scale-y: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.\\!btn{font-size:16px!important;line-height:24px!important;padding:9px 20px!important;white-space:nowrap!important;text-align:center!important;display:inline-flex!important;align-items:center!important;justify-content:center!important;transition-property:all!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important;transition-duration:.15s!important;border-radius:var(--theme-rounded-base)!important}.btn{font-size:16px;line-height:24px;padding:9px 20px;white-space:nowrap;text-align:center;display:inline-flex;align-items:center;justify-content:center;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s;border-radius:var(--theme-rounded-base)}.\\!btn>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0 !important;margin-right:calc(8px * var(--tw-space-x-reverse))!important;margin-left:calc(8px * calc(1 - var(--tw-space-x-reverse)))!important}.btn>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(8px * var(--tw-space-x-reverse));margin-left:calc(8px * calc(1 - var(--tw-space-x-reverse)))}.\\!btn:hover{--tw-brightness: brightness(1.15) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.btn:hover{--tw-brightness: brightness(1.15);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.\\!btn:active{--tw-scale-x: 95% !important;--tw-scale-y: 95% !important;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))!important;--tw-brightness: brightness(.9) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.btn:active{--tw-scale-x: 95%;--tw-scale-y: 95%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));--tw-brightness: brightness(.9);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.btn-sm{padding:6px 12px;font-size:14px;line-height:20px}.btn-icon{font-size:16px;line-height:24px;white-space:nowrap;text-align:center;display:inline-flex;align-items:center;justify-content:center;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s;padding:0;aspect-ratio:1 / 1;width:43px;border-radius:9999px}.btn-icon>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(8px * var(--tw-space-x-reverse));margin-left:calc(8px * calc(1 - var(--tw-space-x-reverse)))}.btn-icon:hover{--tw-brightness: brightness(1.15);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.btn-icon:active{--tw-scale-x: 95%;--tw-scale-y: 95%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));--tw-brightness: brightness(.9);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.btn-icon-sm{aspect-ratio:1 / 1;width:33px;font-size:14px;line-height:20px}.btn-group{display:inline-flex;flex-direction:row;overflow:hidden;border-radius:var(--theme-rounded-base);isolation:isolate}.btn-group>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(0px * var(--tw-space-x-reverse));margin-left:calc(0px * calc(1 - var(--tw-space-x-reverse)))}.btn-group button,.btn-group a{font-size:16px;line-height:24px;padding:9px 20px;white-space:nowrap;text-align:center;display:inline-flex;align-items:center;justify-content:center;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s;color:inherit!important;text-decoration-line:none!important}.btn-group button>:not([hidden])~:not([hidden]),.btn-group a>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(8px * var(--tw-space-x-reverse));margin-left:calc(8px * calc(1 - var(--tw-space-x-reverse)))}.btn-group button:hover,.btn-group a:hover{--tw-brightness: brightness(1.15);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);background-color:rgb(var(--color-surface-50) / 3%)}.btn-group button:active,.btn-group a:active{background-color:rgb(var(--color-surface-900) / 3%)}.btn-group>*+*{border-top-width:0px;border-left-width:1px;border-color:rgb(var(--color-surface-500) / .2)}.card{background-color:rgb(var(--color-surface-100));--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-inset: inset;--tw-ring-color: rgb(23 23 23 / .05);border-radius:var(--theme-rounded-container)}.dark .card{background-color:rgb(var(--color-surface-800));--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-inset: inset;--tw-ring-color: rgb(250 250 250 / .05)}a.card{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}a.card:hover{--tw-brightness: brightness(1.05);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.\\!chip{cursor:pointer!important;white-space:nowrap!important;padding:6px 12px!important;text-align:center!important;font-size:12px!important;line-height:16px!important;border-radius:4px!important;display:inline-flex!important;align-items:center!important;justify-content:center!important;transition-property:all!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important;transition-duration:.15s!important}.chip{cursor:pointer;white-space:nowrap;padding:6px 12px;text-align:center;font-size:12px;line-height:16px;border-radius:4px;display:inline-flex;align-items:center;justify-content:center;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.\\!chip>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0 !important;margin-right:calc(8px * var(--tw-space-x-reverse))!important;margin-left:calc(8px * calc(1 - var(--tw-space-x-reverse)))!important}.chip>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(8px * var(--tw-space-x-reverse));margin-left:calc(8px * calc(1 - var(--tw-space-x-reverse)))}a.chip:hover,button.chip:hover{--tw-brightness: brightness(1.15);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}a.\\!chip:hover,button.\\!chip:hover{--tw-brightness: brightness(1.15) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.\\!chip:disabled{cursor:not-allowed!important;opacity:.5!important}.chip:disabled{cursor:not-allowed!important;opacity:.5!important}.\\!chip:disabled:active{--tw-scale-x: 1 !important;--tw-scale-y: 1 !important;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))!important}.chip:disabled:active{--tw-scale-x: 1;--tw-scale-y: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.label>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(4px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(4px * var(--tw-space-y-reverse))}.\\!input{width:100%!important;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter!important;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter!important;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important;transition-duration:.2s!important;background-color:rgb(var(--color-surface-200))!important;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important;border-width:var(--theme-border-base)!important;border-color:rgb(var(--color-surface-400))!important}.input,.textarea,.select,.input-group{width:100%;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.2s;background-color:rgb(var(--color-surface-200));--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important;border-width:var(--theme-border-base);border-color:rgb(var(--color-surface-400))}.dark .input,.dark .textarea,.dark .select,.dark .input-group{background-color:rgb(var(--color-surface-700));border-color:rgb(var(--color-surface-500))}.dark .\\!input{background-color:rgb(var(--color-surface-700))!important;border-color:rgb(var(--color-surface-500))!important}.\\!input:hover{--tw-brightness: brightness(1.05) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.input:hover,.textarea:hover,.select:hover,.input-group:hover{--tw-brightness: brightness(1.05);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.\\!input:focus{--tw-brightness: brightness(1.05) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.input:focus,.textarea:focus,.select:focus,.input-group:focus{--tw-brightness: brightness(1.05);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.\\!input:focus-within{--tw-border-opacity: 1 !important;border-color:rgb(var(--color-primary-500) / var(--tw-border-opacity))!important}.input:focus-within,.textarea:focus-within,.select:focus-within,.input-group:focus-within{--tw-border-opacity: 1;border-color:rgb(var(--color-primary-500) / var(--tw-border-opacity))}.\\!input{border-radius:var(--theme-rounded-base)!important}.input,.input-group{border-radius:var(--theme-rounded-base)}.textarea,.select{border-radius:var(--theme-rounded-container)}.select>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(4px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(4px * var(--tw-space-y-reverse))}.select{padding:8px 32px 8px 8px}.select[size]{background-image:none}.select optgroup>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(4px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(4px * var(--tw-space-y-reverse))}.select optgroup{font-weight:700}.select optgroup option{margin-left:0;padding-left:0}.select optgroup option:first-of-type{margin-top:12px}.select optgroup option:last-child{margin-bottom:12px!important}.select option{cursor:pointer;padding:8px 16px;background-color:rgb(var(--color-surface-200));border-radius:var(--theme-rounded-base)}.dark .select option{background-color:rgb(var(--color-surface-700))}.select option:checked{background:rgb(var(--color-primary-500)) linear-gradient(0deg,rgb(var(--color-primary-500)),rgb(var(--color-primary-500)));color:rgb(var(--on-primary))}.checkbox,.radio{height:20px;width:20px;cursor:pointer;border-radius:4px;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important;background-color:rgb(var(--color-surface-200));border-width:var(--theme-border-base);border-color:rgb(var(--color-surface-400))}.dark .checkbox,.dark .radio{background-color:rgb(var(--color-surface-700));border-color:rgb(var(--color-surface-500))}.checkbox:hover,.radio:hover{--tw-brightness: brightness(1.05);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.checkbox:focus,.radio:focus{--tw-brightness: brightness(1.05);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);--tw-border-opacity: 1;border-color:rgb(var(--color-primary-500) / var(--tw-border-opacity))}.checkbox:checked,.checkbox:indeterminate,.radio:checked{--tw-bg-opacity: 1;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity))}.checkbox:checked:hover,.checkbox:indeterminate:hover,.radio:checked:hover{--tw-bg-opacity: 1;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity))}.checkbox:checked:focus,.checkbox:indeterminate:focus,.radio:checked:focus{--tw-bg-opacity: 1;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity));--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.radio{border-radius:var(--theme-rounded-base)}.\\!input[type=file]{padding:4px!important}.input[type=file]{padding:4px}.\\!input[type=color]{height:40px!important;width:40px!important;cursor:pointer!important;overflow:hidden!important;border-style:none!important;border-radius:var(--theme-rounded-base)!important;-webkit-appearance:none!important}.input[type=color]{height:40px;width:40px;cursor:pointer;overflow:hidden;border-style:none;border-radius:var(--theme-rounded-base);-webkit-appearance:none}.\\!input[type=color]::-webkit-color-swatch-wrapper{padding:0!important}.input[type=color]::-webkit-color-swatch-wrapper{padding:0}.\\!input[type=color]::-webkit-color-swatch{border-style:none!important}.input[type=color]::-webkit-color-swatch{border-style:none}.\\!input[type=color]::-webkit-color-swatch:hover{--tw-brightness: brightness(1.1) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.input[type=color]::-webkit-color-swatch:hover{--tw-brightness: brightness(1.1);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.\\!input[type=color]::-moz-color-swatch{border-style:none!important}.input[type=color]::-moz-color-swatch{border-style:none}.\\!input:disabled{cursor:not-allowed!important;opacity:.5!important}.input:disabled,.textarea:disabled,.select:disabled,.input-group>input:disabled,.input-group>textarea:disabled,.input-group>select:disabled{cursor:not-allowed!important;opacity:.5!important}.\\!input:disabled:hover{--tw-brightness: brightness(1) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.input:disabled:hover,.textarea:disabled:hover,.select:disabled:hover,.input-group>input:disabled:hover,.input-group>textarea:disabled:hover,.input-group>select:disabled:hover{--tw-brightness: brightness(1) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.\\!input[readonly],.input[readonly],.textarea[readonly],.select[readonly]{cursor:not-allowed!important;border-color:transparent!important}.\\!input[readonly]:hover,.input[readonly]:hover,.textarea[readonly]:hover,.select[readonly]:hover{--tw-brightness: brightness(1) !important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important}.input-group{display:grid;overflow:hidden}.input-group input,.input-group select{border-width:0px;background-color:transparent;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important}.input-group select option{background-color:rgb(var(--color-surface-200))}.dark .input-group select option{background-color:rgb(var(--color-surface-700))}.input-group div,.input-group a,.input-group button{display:flex;align-items:center;justify-content:space-between;padding-left:16px;padding-right:16px}.input-group-divider input,.input-group-divider select,.input-group-divider div,.input-group-divider a{border-left-width:1px;border-color:rgb(var(--color-surface-400));--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important;min-width:-moz-fit-content!important;min-width:fit-content!important}.dark .input-group-divider input,.dark .input-group-divider select,.dark .input-group-divider div,.dark .input-group-divider a{border-color:rgb(var(--color-surface-500))}.input-group-divider input:focus,.input-group-divider select:focus,.input-group-divider div:focus,.input-group-divider a:focus{border-color:rgb(var(--color-surface-400))}.dark .input-group-divider input:focus,.dark .input-group-divider select:focus,.dark .input-group-divider div:focus,.dark .input-group-divider a:focus{border-color:rgb(var(--color-surface-500))}.input-group-divider *:first-child{border-left-width:0px!important}.input-group-shim{background-color:rgb(var(--color-surface-400) / .1);color:rgb(var(--color-surface-600))}.dark .input-group-shim{color:rgb(var(--color-surface-300))}.input-error{--tw-border-opacity: 1;border-color:rgb(var(--color-error-500) / var(--tw-border-opacity));--tw-bg-opacity: 1;background-color:rgb(var(--color-error-200) / var(--tw-bg-opacity));--tw-text-opacity: 1;color:rgb(var(--color-error-500) / var(--tw-text-opacity))}:is(.dark .input-error){--tw-border-opacity: 1;border-color:rgb(var(--color-error-500) / var(--tw-border-opacity));--tw-bg-opacity: 1;background-color:rgb(var(--color-error-200) / var(--tw-bg-opacity));--tw-text-opacity: 1;color:rgb(var(--color-error-500) / var(--tw-text-opacity))}.input-error::-moz-placeholder{--tw-text-opacity: 1;color:rgb(var(--color-error-500) / var(--tw-text-opacity))}.input-error::placeholder{--tw-text-opacity: 1;color:rgb(var(--color-error-500) / var(--tw-text-opacity))}.variant-form-material{border-radius:4px 4px 0 0/4px 4px 0px 0px!important;background-color:rgb(var(--color-surface-500) / .1);border-width:0px;border-bottom-width:2px}:is(.dark .variant-form-material){background-color:rgb(var(--color-surface-500) / .2)}.variant-form-material[type=file]{padding-top:6px!important;padding-bottom:6px!important}.list{list-style-type:none}.list>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(4px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(4px * var(--tw-space-y-reverse))}.list li{display:flex;align-items:center;border-radius:var(--theme-rounded-base)}.list li>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(16px * var(--tw-space-x-reverse));margin-left:calc(16px * calc(1 - var(--tw-space-x-reverse)))}.placeholder{height:20px;background-color:rgb(var(--color-surface-300));border-radius:var(--theme-rounded-base)}.dark .placeholder{background-color:rgb(var(--color-surface-600))}.w-modal{width:100%;max-width:640px}.modal *:focus:not([tabindex=\"-1\"]):not(.input):not(.textarea):not(.select):not(.input-group):not(.input-group input){outline-style:auto;outline-color:-webkit-focus-ring-color}.variant-filled{background-color:rgb(var(--color-surface-900));color:rgb(var(--color-surface-50))}.dark .variant-filled{background-color:rgb(var(--color-surface-50));color:rgb(var(--color-surface-900))}.\\!variant-filled-primary{--tw-bg-opacity: 1 !important;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity))!important;color:rgb(var(--on-primary))!important}.variant-filled-primary{--tw-bg-opacity: 1;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity));color:rgb(var(--on-primary))}:is(.dark .variant-filled-primary){--tw-bg-opacity: 1;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity));color:rgb(var(--on-primary))}:is(.dark .\\!variant-filled-primary){--tw-bg-opacity: 1 !important;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity))!important;color:rgb(var(--on-primary))!important}.variant-filled-secondary{--tw-bg-opacity: 1;background-color:rgb(var(--color-secondary-500) / var(--tw-bg-opacity));color:rgb(var(--on-secondary))}:is(.dark .variant-filled-secondary){--tw-bg-opacity: 1;background-color:rgb(var(--color-secondary-500) / var(--tw-bg-opacity));color:rgb(var(--on-secondary))}.variant-filled-warning{--tw-bg-opacity: 1;background-color:rgb(var(--color-warning-500) / var(--tw-bg-opacity));color:rgb(var(--on-warning))}:is(.dark .variant-filled-warning){--tw-bg-opacity: 1;background-color:rgb(var(--color-warning-500) / var(--tw-bg-opacity));color:rgb(var(--on-warning))}.variant-filled-error{--tw-bg-opacity: 1;background-color:rgb(var(--color-error-500) / var(--tw-bg-opacity));color:rgb(var(--on-error))}:is(.dark .variant-filled-error){--tw-bg-opacity: 1;background-color:rgb(var(--color-error-500) / var(--tw-bg-opacity));color:rgb(var(--on-error))}.variant-ghost-surface{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-inset: inset;--tw-ring-opacity: 1;--tw-ring-color: rgb(var(--color-surface-500) / var(--tw-ring-opacity));background-color:rgb(var(--color-surface-500) / .2)}:is(.dark .variant-ghost-surface){--tw-ring-opacity: 1;--tw-ring-color: rgb(var(--color-surface-500) / var(--tw-ring-opacity));background-color:rgb(var(--color-surface-500) / .2)}.variant-soft-primary{background-color:rgb(var(--color-primary-400) / .2);--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important;color:rgb(var(--color-primary-700))}.dark .variant-soft-primary{color:rgb(var(--color-primary-200))}:is(.dark .variant-soft-primary){background-color:rgb(var(--color-primary-500) / .2)}.variant-soft-error{background-color:rgb(var(--color-error-400) / .2);--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important;color:rgb(var(--color-error-700))}.dark .variant-soft-error{color:rgb(var(--color-error-200))}:is(.dark .variant-soft-error){background-color:rgb(var(--color-error-500) / .2)}.variant-soft,.variant-soft-surface{background-color:rgb(var(--color-surface-400) / .2);--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important;color:rgb(var(--color-surface-700))}.dark .variant-soft,.dark .variant-soft-surface{color:rgb(var(--color-surface-200))}:is(.dark .variant-soft),:is(.dark .variant-soft-surface){background-color:rgb(var(--color-surface-500) / .2)}@media (min-width: 768px){.h3{font-size:24px;line-height:32px}.h4{font-size:20px;line-height:28px}}@media (min-width: 1024px){.alert{flex-direction:row;align-items:center}.alert>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(0px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0px * var(--tw-space-y-reverse));--tw-space-x-reverse: 0;margin-right:calc(16px * var(--tw-space-x-reverse));margin-left:calc(16px * calc(1 - var(--tw-space-x-reverse)))}}.modal *:focus:not([tabindex=\"-1\"]):not(.input):not(.textarea):not(.select):not(.input-group):not(.input-group input){outline-width:0px!important}.pointer-events-none{pointer-events:none}.pointer-events-auto{pointer-events:auto}.visible{visibility:visible}.static{position:static}.fixed{position:fixed}.\\!absolute{position:absolute!important}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.bottom-0{bottom:0}.bottom-24{bottom:96px}.left-0{left:0}.left-1\\/2{left:50%}.right-0{right:0}.right-2{right:8px}.right-20{right:80px}.right-4{right:16px}.top-0{top:0}.top-1\\/2{top:50%}.top-2{top:8px}.top-36{top:144px}.-z-10{z-index:-10}.z-\\[888\\]{z-index:888}.z-\\[999\\]{z-index:999}.row-span-2{grid-row:span 2 / span 2}.row-start-1{grid-row-start:1}.\\!m-0{margin:0!important}.m-auto{margin:auto}.mx-2{margin-left:8px;margin-right:8px}.my-4{margin-top:16px;margin-bottom:16px}.my-\\[1px\\]{margin-top:1px;margin-bottom:1px}.ml-1{margin-left:4px}.ml-3{margin-left:12px}.ml-4{margin-left:16px}.mr-2{margin-right:8px}.mr-6{margin-right:24px}.mt-2{margin-top:8px}.mt-4{margin-top:16px}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.inline-flex{display:inline-flex}.grid{display:grid}.contents{display:contents}.hidden{display:none}.size-14{width:56px;height:56px}.size-full{width:100%;height:100%}.h-0{height:0px}.h-10{height:40px}.h-2{height:8px}.h-4{height:16px}.h-48{height:192px}.h-6{height:24px}.h-8{height:32px}.h-\\[38px\\]{height:38px}.h-auto{height:auto}.h-fit{height:-moz-fit-content;height:fit-content}.h-full{height:100%}.h-screen{height:100vh}.max-h-80{max-height:320px}.max-h-\\[200px\\]{max-height:200px}.min-h-0{min-height:0px}.min-h-full{min-height:100%}.w-0{width:0px}.w-12{width:48px}.w-16{width:64px}.w-20{width:80px}.w-3{width:12px}.w-32{width:128px}.w-36{width:144px}.w-48{width:192px}.w-5{width:20px}.w-6{width:24px}.w-8{width:32px}.w-\\[140px\\]{width:140px}.w-\\[38px\\]{width:38px}.w-\\[50\\%\\]{width:50%}.w-\\[600px\\]{width:600px}.w-full{width:100%}.w-screen{width:100vw}.max-w-\\[640px\\]{max-width:640px}.max-w-full{max-width:100%}.flex-1{flex:1 1 0%}.flex-\\[0_0_20\\%\\]{flex:0 0 20%}.flex-\\[1\\]{flex:1}.flex-\\[3\\]{flex:3}.flex-auto{flex:1 1 auto}.flex-none{flex:none}.shrink-0{flex-shrink:0}.flex-grow{flex-grow:1}.basis-0{flex-basis:0px}.origin-\\[50\\%_50\\%\\]{transform-origin:50% 50%}.-translate-x-1\\/2{--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-x-full{--tw-translate-x: -100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-1\\/2{--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-0{--tw-translate-x: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-\\[calc\\(100\\%-44px\\)\\]{--tw-translate-x: calc(100% - 44px) ;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-full{--tw-translate-x: 100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-rotate-90{--tw-rotate: -90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-180{--tw-rotate: 180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-\\[0\\.8\\]{--tw-scale-x: .8;--tw-scale-y: .8;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-\\[105\\%\\]{--tw-scale-x: 105%;--tw-scale-y: 105%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.\\!transform-none{transform:none!important}@keyframes spin{to{transform:rotate(360deg)}}.animate-spin{animation:spin 1s linear infinite}.\\!cursor-default{cursor:default!important}.cursor-not-allowed{cursor:not-allowed}.cursor-pointer{cursor:pointer}.select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.list-inside{list-style-position:inside}.list-disc{list-style-type:disc}.grid-cols-\\[0px_1fr\\]{grid-template-columns:0px 1fr}.grid-cols-\\[140px_1fr\\]{grid-template-columns:140px 1fr}.grid-cols-\\[auto_1fr_auto\\]{grid-template-columns:auto 1fr auto}.grid-cols-\\[auto_1fr_auto_auto\\]{grid-template-columns:auto 1fr auto auto}.grid-rows-\\[0fr\\]{grid-template-rows:0fr}.grid-rows-\\[1fr\\]{grid-template-rows:1fr}.grid-rows-\\[auto_1fr\\]{grid-template-rows:auto 1fr}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.\\!items-stretch{align-items:stretch!important}.justify-start{justify-content:flex-start}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.justify-evenly{justify-content:space-evenly}.gap-1{gap:4px}.gap-14{gap:56px}.gap-2{gap:8px}.gap-3{gap:12px}.gap-4{gap:16px}.gap-6{gap:24px}.gap-x-2{-moz-column-gap:8px;column-gap:8px}.gap-y-1{row-gap:4px}.gap-y-2{row-gap:8px}.space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(8px * var(--tw-space-x-reverse));margin-left:calc(8px * calc(1 - var(--tw-space-x-reverse)))}.space-x-4>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(16px * var(--tw-space-x-reverse));margin-left:calc(16px * calc(1 - var(--tw-space-x-reverse)))}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(4px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(4px * var(--tw-space-y-reverse))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(8px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(8px * var(--tw-space-y-reverse))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(16px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(16px * var(--tw-space-y-reverse))}.divide-y-\\[1px\\]>:not([hidden])~:not([hidden]){--tw-divide-y-reverse: 0;border-top-width:calc(1px * calc(1 - var(--tw-divide-y-reverse)));border-bottom-width:calc(1px * var(--tw-divide-y-reverse))}.self-start{align-self:flex-start}.self-center{align-self:center}.self-stretch{align-self:stretch}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.overflow-y-hidden{overflow-y:hidden}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.break-words{overflow-wrap:break-word}.rounded{border-radius:4px}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:8px}.rounded-md{border-radius:6px}.rounded-none{border-radius:0}.rounded-e-\\[4px\\]{border-start-end-radius:4px;border-end-end-radius:4px}.rounded-l-none{border-top-left-radius:0;border-bottom-left-radius:0}.rounded-r-none{border-top-right-radius:0;border-bottom-right-radius:0}.rounded-s-full{border-start-start-radius:9999px;border-end-start-radius:9999px}.border{border-width:1px}.border-0{border-width:0px}.\\!border-t-0{border-top-width:0px!important}.border-b{border-bottom-width:1px}.border-b-2{border-bottom-width:2px}.border-l{border-left-width:1px}.\\!border-surface-700{--tw-border-opacity: 1 !important;border-color:rgb(var(--color-surface-700) / var(--tw-border-opacity, 1))!important}.border-surface-400\\/20{border-color:rgb(var(--color-surface-400) / .2)}.bg-primary-500{--tw-bg-opacity: 1;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity, 1))}.bg-primary-500\\/30{background-color:rgb(var(--color-primary-500) / .3)}.bg-surface-400{--tw-bg-opacity: 1;background-color:rgb(var(--color-surface-400) / var(--tw-bg-opacity, 1))}.bg-surface-400\\/20{background-color:rgb(var(--color-surface-400) / .2)}.bg-surface-900{--tw-bg-opacity: 1;background-color:rgb(var(--color-surface-900) / var(--tw-bg-opacity, 1))}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-white\\/30{background-color:#ffffff4d}.bg-white\\/75{background-color:#ffffffbf}.bg-scroll{background-attachment:scroll}.fill-current{fill:currentColor}.fill-primary-500{fill:rgb(var(--color-primary-500) / 1)}.fill-slate-700{fill:#334155}.fill-transparent{fill:transparent}.stroke-primary-500{stroke:rgb(var(--color-primary-500) / 1)}.stroke-primary-500\\/30{stroke:rgb(var(--color-primary-500) / .3)}.stroke-surface-500\\/30{stroke:rgb(var(--color-surface-500) / .3)}.stroke-surface-900{stroke:rgb(var(--color-surface-900) / 1)}.object-cover{-o-object-fit:cover;object-fit:cover}.object-center{-o-object-position:center;object-position:center}.\\!p-0{padding:0!important}.p-0{padding:0}.p-1{padding:4px}.p-2{padding:8px}.p-4{padding:16px}.\\!px-1{padding-left:4px!important;padding-right:4px!important}.\\!py-2{padding-top:8px!important;padding-bottom:8px!important}.\\!py-\\[7px\\]{padding-top:7px!important;padding-bottom:7px!important}.px-3{padding-left:12px;padding-right:12px}.px-4{padding-left:16px;padding-right:16px}.px-8{padding-left:32px;padding-right:32px}.py-1{padding-top:4px;padding-bottom:4px}.py-2{padding-top:8px;padding-bottom:8px}.py-6{padding-top:24px;padding-bottom:24px}.pb-4{padding-bottom:16px}.pb-6{padding-bottom:24px}.pl-6{padding-left:24px}.pr-0{padding-right:0}.pr-2{padding-right:8px}.pr-4{padding-right:16px}.pr-6{padding-right:24px}.pt-4{padding-top:16px}.text-center{text-align:center}.text-start{text-align:start}.text-2xl{font-size:24px;line-height:32px}.text-\\[12px\\]{font-size:12px}.text-base{font-size:16px;line-height:24px}.text-sm{font-size:14px;line-height:20px}.text-xl{font-size:20px;line-height:28px}.text-xs{font-size:12px;line-height:16px}.font-bold{font-weight:700}.italic{font-style:italic}.leading-\\[14px\\]{line-height:14px}.leading-loose{line-height:2}.\\!text-error-500{--tw-text-opacity: 1 !important;color:rgb(var(--color-error-500) / var(--tw-text-opacity, 1))!important}.text-error-400{--tw-text-opacity: 1;color:rgb(var(--color-error-400) / var(--tw-text-opacity, 1))}.text-error-500{--tw-text-opacity: 1;color:rgb(var(--color-error-500) / var(--tw-text-opacity, 1))}.text-surface-400{--tw-text-opacity: 1;color:rgb(var(--color-surface-400) / var(--tw-text-opacity, 1))}.underline-offset-2{text-underline-offset:2px}.accent-surface-900{accent-color:rgb(var(--color-surface-900) / 1)}.opacity-40{opacity:.4}.opacity-50{opacity:.5}.opacity-70{opacity:.7}.mix-blend-hard-light{mix-blend-mode:hard-light}.shadow{--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-lg{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow: 0 20px 25px -5px rgb(0 0 0 / .1), 0 8px 10px -6px rgb(0 0 0 / .1);--tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.-outline-offset-\\[3px\\]{outline-offset:-3px}.\\!ring-0{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important}.blur{--tw-blur: blur(8px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.blur-\\[1px\\]{--tw-blur: blur(1px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-xl{--tw-drop-shadow: drop-shadow(0 20px 13px rgb(0 0 0 / .03)) drop-shadow(0 8px 5px rgb(0 0 0 / .08));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur-sm{--tw-backdrop-blur: blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[grid-template-columns\\]{transition-property:grid-template-columns;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[grid-template-rows\\]{transition-property:grid-template-rows;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[stroke-dashoffset\\]{transition-property:stroke-dashoffset;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[transform\\]{transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[width\\]{transition-property:width;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-opacity{transition-property:opacity;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.delay-100{transition-delay:.1s}.duration-100{transition-duration:.1s}.duration-\\[200ms\\]{transition-duration:.2s}.duration-\\[250ms\\]{transition-duration:.25s}.duration-\\[400ms\\]{transition-duration:.4s}.bg-surface-backdrop-token{background-color:rgb(var(--color-surface-400) / .7)}.dark .bg-surface-backdrop-token{background-color:rgb(var(--color-surface-900) / .7)}.bg-surface-100-800-token{background-color:rgb(var(--color-surface-100))}.dark .bg-surface-100-800-token{background-color:rgb(var(--color-surface-800))}.bg-surface-200-700-token{background-color:rgb(var(--color-surface-200))}.dark .bg-surface-200-700-token{background-color:rgb(var(--color-surface-700))}.bg-surface-900-50-token{background-color:rgb(var(--color-surface-900))}.dark .bg-surface-900-50-token{background-color:rgb(var(--color-surface-50))}.border-token{border-width:var(--theme-border-base)}.border-surface-400-500-token{border-color:rgb(var(--color-surface-400))}.dark .border-surface-400-500-token{border-color:rgb(var(--color-surface-500))}.border-surface-900-50-token{border-color:rgb(var(--color-surface-900))}.dark .border-surface-900-50-token{border-color:rgb(var(--color-surface-50))}.border-surface-800-100-token{border-color:rgb(var(--color-surface-800))}.dark .border-surface-800-100-token{border-color:rgb(var(--color-surface-100))}.rounded-token{border-radius:var(--theme-rounded-base)}.rounded-container-token{border-radius:var(--theme-rounded-container)}.rounded-tl-container-token{border-top-left-radius:var(--theme-rounded-container)}.rounded-tr-container-token{border-top-right-radius:var(--theme-rounded-container)}.fill-token{fill:rgba(var(--theme-font-color-base))}.dark .fill-token{fill:rgba(var(--theme-font-color-dark))}.text-surface-700-200-token{color:rgb(var(--color-surface-700))}.dark .text-surface-700-200-token{color:rgb(var(--color-surface-200))}.scrollbar-thin::-webkit-scrollbar-track{background-color:var(--scrollbar-track);border-radius:var(--scrollbar-track-radius)}.scrollbar-thin::-webkit-scrollbar-track:hover{background-color:var(--scrollbar-track-hover, var(--scrollbar-track))}.scrollbar-thin::-webkit-scrollbar-track:active{background-color:var(--scrollbar-track-active, var(--scrollbar-track-hover, var(--scrollbar-track)))}.scrollbar-thin::-webkit-scrollbar-thumb{background-color:var(--scrollbar-thumb);border-radius:var(--scrollbar-thumb-radius)}.scrollbar-thin::-webkit-scrollbar-thumb:hover{background-color:var(--scrollbar-thumb-hover, var(--scrollbar-thumb))}.scrollbar-thin::-webkit-scrollbar-thumb:active{background-color:var(--scrollbar-thumb-active, var(--scrollbar-thumb-hover, var(--scrollbar-thumb)))}.scrollbar-thin::-webkit-scrollbar-corner{background-color:var(--scrollbar-corner);border-radius:var(--scrollbar-corner-radius)}.scrollbar-thin::-webkit-scrollbar-corner:hover{background-color:var(--scrollbar-corner-hover, var(--scrollbar-corner))}.scrollbar-thin::-webkit-scrollbar-corner:active{background-color:var(--scrollbar-corner-active, var(--scrollbar-corner-hover, var(--scrollbar-corner)))}.scrollbar-thin{scrollbar-width:thin;scrollbar-color:var(--scrollbar-thumb, initial) var(--scrollbar-track, initial)}.scrollbar-thin::-webkit-scrollbar{display:block;width:8px;height:8px}.scrollbar-track-transparent{--scrollbar-track: transparent !important}.scrollbar-thumb-slate-400\\/50{--scrollbar-thumb: rgb(148 163 184 / .5) !important}.scrollbar-corner-transparent{--scrollbar-corner: transparent !important}.dark .hover\\:bg-primary-hover-token:hover:hover{background-color:rgb(var(--color-primary-500) / .1)}.has-\\[\\:checked\\]\\:\\!variant-filled-primary:has(:checked){--tw-bg-opacity: 1 !important;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity))!important;color:rgb(var(--on-primary))!important}:is(.dark .has-\\[\\:checked\\]\\:\\!variant-filled-primary:has(:checked)){--tw-bg-opacity: 1 !important;background-color:rgb(var(--color-primary-500) / var(--tw-bg-opacity))!important;color:rgb(var(--on-primary))!important}.hover\\:variant-filled:hover{background-color:rgb(var(--color-surface-900));color:rgb(var(--color-surface-50))}.dark .hover\\:variant-filled:hover{background-color:rgb(var(--color-surface-50));color:rgb(var(--color-surface-900))}.hover\\:variant-soft:hover,.hover\\:variant-soft-surface:hover{background-color:rgb(var(--color-surface-400) / .2);--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important;color:rgb(var(--color-surface-700))}.dark .hover\\:variant-soft:hover,.dark .hover\\:variant-soft-surface:hover{color:rgb(var(--color-surface-200))}:is(.dark .hover\\:variant-soft:hover){background-color:rgb(var(--color-surface-500) / .2)}:is(.dark .hover\\:variant-soft-surface:hover){background-color:rgb(var(--color-surface-500) / .2)}.\\[\\&\\:not\\(\\[disabled\\]\\)\\]\\:variant-soft-primary:not([disabled]){background-color:rgb(var(--color-primary-400) / .2);--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important;--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color) !important;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)!important;color:rgb(var(--color-primary-700))}.dark .\\[\\&\\:not\\(\\[disabled\\]\\)\\]\\:variant-soft-primary:not([disabled]){color:rgb(var(--color-primary-200))}:is(.dark .\\[\\&\\:not\\(\\[disabled\\]\\)\\]\\:variant-soft-primary:not([disabled])){background-color:rgb(var(--color-primary-500) / .2)}.\\*\\:\\!m-0>*{margin:0!important}.\\*\\:items-center>*{align-items:center}.\\*\\:\\!rounded-none>*{border-radius:0!important}.\\*\\:py-2>*{padding-top:8px;padding-bottom:8px}.\\*\\:py-4>*{padding-top:16px;padding-bottom:16px}.\\*\\:text-sm>*{font-size:14px;line-height:20px}.\\*\\:border-surface-300-600-token>*{border-color:rgb(var(--color-surface-300))}.dark .\\*\\:border-surface-300-600-token>*{border-color:rgb(var(--color-surface-600))}.hover\\:translate-x-0:hover{--tw-translate-x: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\\:text-xl:hover{font-size:20px;line-height:28px}.hover\\:opacity-100:hover{opacity:1}.hover\\:brightness-110:hover{--tw-brightness: brightness(1.1);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.hover\\:brightness-\\[105\\%\\]:hover{--tw-brightness: brightness(105%);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.hover\\:bg-primary-hover-token:hover:hover,.dark .hover\\:bg-primary-hover-token:hover:hover{background-color:rgb(var(--color-primary-500) / .1)}.focus\\:decoration-wavy:focus{text-decoration-style:wavy}.focus\\:\\!outline-none:focus{outline:2px solid transparent!important;outline-offset:2px!important}.disabled\\:cursor-wait:disabled{cursor:wait}.disabled\\:opacity-70:disabled{opacity:.7}.dark\\:\\!border-surface-200:is(.dark *){--tw-border-opacity: 1 !important;border-color:rgb(var(--color-surface-200) / var(--tw-border-opacity, 1))!important}.dark\\:border-surface-500\\/20:is(.dark *){border-color:rgb(var(--color-surface-500) / .2)}.dark\\:bg-black\\/15:is(.dark *){background-color:#00000026}.dark\\:bg-surface-300:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(var(--color-surface-300) / var(--tw-bg-opacity, 1))}.dark\\:bg-surface-500\\/20:is(.dark *){background-color:rgb(var(--color-surface-500) / .2)}.dark\\:bg-surface-700:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(var(--color-surface-700) / var(--tw-bg-opacity, 1))}.dark\\:fill-slate-200:is(.dark *){fill:#e2e8f0}.dark\\:stroke-surface-50:is(.dark *){stroke:rgb(var(--color-surface-50) / 1)}.dark\\:accent-surface-50:is(.dark *){accent-color:rgb(var(--color-surface-50) / 1)}.dark\\:hover\\:brightness-110:hover:is(.dark *){--tw-brightness: brightness(1.1);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}@media (min-width: 768px){.md\\:h-\\[600px\\]{height:600px}.md\\:max-w-screen-md{max-width:768px}.md\\:max-w-screen-sm{max-width:640px}.md\\:flex-row{flex-direction:row}.md\\:\\!items-center{align-items:center!important}.md\\:\\!items-baseline{align-items:baseline!important}}@media (min-width: 1024px){.lg\\:max-w-screen-md{max-width:768px}}@media (min-width: 1280px){.xl\\:max-w-screen-lg{max-width:1024px}}.\\[\\&\\:last-child\\]\\:\\*\\:pt-4>*:last-child{padding-top:16px}.\\[\\&\\:not\\(\\:last-child\\)\\]\\:\\*\\:py-4>*:not(:last-child){padding-top:16px;padding-bottom:16px}.\\[\\&\\:not\\(\\[disabled\\]\\)\\]\\:hover\\:bg-slate-400\\/30:hover:not([disabled]){background-color:#94a3b84d}.\\[\\&\\>input\\]\\:\\!min-w-0>input{min-width:0px!important}.\\[\\&\\>input\\]\\:\\!border-transparent>input{border-color:transparent!important} "),window._pdlShadowStyle=t})(),function(t,e,r,a,o,n){"use strict";function i(t){return"function"==typeof t}function s(t){return t()}function l(t){for(var e=0;e<t.length;e++)t[e]()}function c(){Rc=!1;const t=zc.slice();zc=[],l(t)}function d(){Fc=!1;const t=qc.slice();qc=[],l(t)}function u(t){Rc||(Rc=!0,queueMicrotask(c)),zc.push(t)}function p(){console.warn("https://svelte.dev/e/hydration_mismatch")}function h(t){return t===this.v}function g(t,e){return t!=t?e==e:t!==e||null!==t&&"object"==typeof t||"function"==typeof t}function f(t,e){return t!==e}function m(t){return!g(t,this.v)}function w(t){return v(t,new Map,"",Yc)}function v(t,e,r,a,o=null){var n,i,s,l,c;if("object"==typeof t&&null!==t){if(void 0!==(n=e.get(t)))return n;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if(ci(t)){for(i=Array(t.length),e.set(t,i),null!==o&&e.set(o,i),s=0;s<t.length;s+=1)l=t[s],s in t&&(i[s]=v(l,e,r,a));return i}if(vi(t)===mi){for(c in i={},e.set(t,i),null!==o&&e.set(o,i),t)i[c]=v(t[c],e,r,a);return i}if(t instanceof Date)return structuredClone(t);if("function"==typeof t.toJSON)return v(t.toJSON(),e,r,a,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch(e){return t}}function b(t){return{f:0,v:t,reactions:null,equals:h,rv:0,wv:0}}function y(t){return _(b(t))}function x(t,e=!1){var r;const a=b(t);return e||(a.equals=m),Gc&&null!==hd&&null!==hd.l&&((r=hd.l).s??(r.s=[])).push(a),a}function k(t,e=!1){return _(x(t,e))}function _(t){return null!==ad&&2&ad.f&&(null===nd?nd=[t]:nd.push(t)),t}function A(t,e){return null!==ad&&R()&&18&ad.f&&(null===nd||!nd.includes(t))&&function(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}(),E(t,e)}function E(t,e){return t.equals(e)||(t.v,t.v=e,t.wv=j(),S(t,Pc),!R()||null===od||0===(od.f&Cc)||96&od.f||(null===ld?function(t){ld=t}([t]):ld.push(t))),e}function S(t,e){var r,a,o,n,i,s=t.reactions;if(null!==s)for(r=R(),a=s.length,o=0;o<a;o++)0===((i=(n=s[o]).f)&Pc)&&(r||n!==od)&&(at(n,e),1280&i&&(2&i?S(n,Ic):X(n)))}function C(t){var e,r=2050;null===od?r|=Ec:od.f|=Nc,e=null!==ad&&2&ad.f?ad:null;const a={children:null,ctx:hd,deps:null,equals:h,f:r,fn:t,reactions:null,rv:0,v:null,wv:0,parent:e??od};return null!==e&&(e.children??(e.children=[])).push(a),a}function P(t){const e=C(t);return e.equals=m,e}function I(t){var e,r,a=t.children;if(null!==a)for(t.children=null,e=0;e<a.length;e+=1)2&(r=a[e]).f?B(r):Ut(r)}function T(t){var e,r=od;L(function(t){for(var e=t.parent;null!==e;){if(!(2&e.f))return e;e=e.parent}return null}(t));try{I(t),e=H(t)}finally{L(r)}return e}function $(t){var e=T(t);at(t,!ud&&0===(t.f&Ec)||null===t.deps?Cc:Ic),t.equals(e)||(t.v=e,t.wv=j())}function B(t){I(t),U(t,0),at(t,$c),t.v=t.children=t.deps=t.ctx=t.reactions=null}function D(){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function N(t){Zc=t}function M(t){td=t}function O(t){ad=t}function L(t){od=t}function j(){return++cd}function R(){return!Gc||null!==hd&&null===hd.l}function F(t){var e,r,a,o,n,i,s,l,c=t.f;if(0!==(c&Pc))return!0;if(0!==(c&Ic)){if(r=t.deps,a=0!==(c&Ec),null!==r){if(i=0!==(c&Sc),s=a&&null!==od&&!ud,l=r.length,i||s){for(o=0;o<l;o++)n=r[o],!i&&(null==(e=null==n?void 0:n.reactions)?void 0:e.includes(t))||(n.reactions??(n.reactions=[])).push(t);i&&(t.f^=Sc)}for(o=0;o<l;o++)if(F(n=r[o])&&$(n),n.wv>t.wv)return!0}a&&(null===od||ud)||at(t,Cc)}return!1}function z(t,e,r){if(Jc){if(null===r&&(Jc=!1),function(t){return 0===(t.f&$c)&&(null===t.parent||0===(t.parent.f&Ac))}(e))throw t}else null!==r&&(Jc=!0),function(t,e){for(var r=e;null!==r;){if(0!==(r.f&Ac))try{return void r.fn(t)}catch{r.f^=Ac}r=r.parent}throw Jc=!1,t}(t,e)}function q(t,e,r=0){var a,o,n=t.reactions;if(null!==n)for(a=0;a<n.length;a++)2&(o=n[a]).f?q(o,e,r+1):e===o&&(0===r?at(o,Pc):0!==(o.f&Cc)&&at(o,Ic),X(o))}function H(t){var e,r,a,o,n=id,i=sd,s=ld,l=ad,c=ud,d=nd,u=hd,p=t.f;id=null,sd=0,ld=null,ad=96&p?null:t,ud=!Zc&&0!==(p&Ec),nd=null,hd=t.ctx,dd++;try{if(r=(0,t.fn)(),a=t.deps,null!==id){if(U(t,sd),null!==a&&sd>0)for(a.length=sd+id.length,o=0;o<id.length;o++)a[sd+o]=id[o];else t.deps=a=id;if(!ud)for(o=sd;o<a.length;o++)((e=a[o]).reactions??(e.reactions=[])).push(t)}else null!==a&&sd<a.length&&(U(t,sd),a.length=sd);if(R()&&null!==ld&&!(6146&t.f))for(o=0;o<ld.length;o++)q(ld[o],t);return null!==l&&dd++,r}finally{id=n,sd=i,ld=s,ad=l,ud=c,nd=d,hd=u}}function W(t,e){var r,a;let o=e.reactions;null!==o&&-1!==(r=di.call(o,t))&&(0==(a=o.length-1)?o=e.reactions=null:(o[r]=o[a],o.pop())),null===o&&2&e.f&&(null===id||!id.includes(e))&&(at(e,Ic),768&e.f||(e.f^=Sc),U(e,0))}function U(t,e){var r,a=t.deps;if(null!==a)for(r=e;r<a.length;r++)W(t,a[r])}function G(t){var e,r,a,o=t.f;if(0===(o&$c)){at(t,Cc),e=od,r=hd,od=t;try{16&o?function(t){for(var e,r=t.first;null!==r;)e=r.next,0===(r.f&_c)&&Ut(r),r=e}(t):Wt(t),Ht(t),qt(t),a=H(t),t.teardown="function"==typeof a?a:null,t.wv=cd,t.deps}catch(a){z(a,t,e,r||t.ctx)}finally{od=e}}}function Y(){if(rd>1e3){rd=0;try{!function(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}()}catch(t){if(null===Kc)throw t;z(t,Kc,null)}}rd++}function V(t){var e,r,a,o,n=t.length;if(0!==n){Y(),e=Zc,Zc=!0;try{for(r=0;r<n;r++)0===((a=t[r]).f&Cc)&&(a.f^=Cc),K(a,o=[]),J(o)}finally{Zc=e}}}function J(t){var e,r,a=t.length;if(0!==a)for(e=0;e<a;e++)if(!(24576&(r=t[e]).f))try{F(r)&&(G(r),null===r.deps&&null===r.first&&null===r.nodes_start&&(null===r.teardown?Gt(r):r.fn=null))}catch(t){z(t,r,null,r.ctx)}}function Q(){if(Xc=!1,rd>1001)return;const t=ed;ed=[],V(t),Xc||(rd=0,Kc=null)}function X(t){var e,r;for(Qc===Vc&&(Xc||(Xc=!0,queueMicrotask(Q))),Kc=t,e=t;null!==e.parent;)if(96&(r=(e=e.parent).f)){if(0===(r&Cc))return;e.f^=Cc}ed.push(e)}function K(t,e){var r,a,o,n,i,s,l,c=t.first,d=[];t:for(;null!==c;){if(o=(a=0!==((r=c.f)&_c))&&0!==(r&Cc),n=c.next,!o&&0===(r&Tc))if(8&r){if(a)c.f^=Cc;else try{F(c)&&G(c)}catch(t){z(t,c,null,c.ctx)}if(null!==(i=c.first)){c=i;continue}}else 4&r&&d.push(c);if(null===n){let e=c.parent;for(;null!==e;){if(t===e)break t;if(null!==(s=e.next)){c=s;continue t}e=e.parent}}c=n}for(l=0;l<d.length;l++)i=d[l],e.push(i),K(i,e)}function Z(t){var e,r=Qc,a=ed;try{Y();const r=[];return Qc=1,ed=r,Xc=!1,V(a),e=null==t?void 0:t(),Rc&&c(),Fc&&d(),(ed.length>0||r.length>0)&&Z(),rd=0,Kc=null,e}finally{Qc=r,ed=a}}async function tt(){await Promise.resolve(),Z()}function et(t){var e,r,a,o,n,i,s,l,c=t.f,d=!!(2&c);if(d&&0!==(c&$c))return r=T(t),B(t),r;if(null!==pd&&pd.add(t),null!==ad)null!==nd&&nd.includes(t)&&function(){throw new Error("https://svelte.dev/e/state_unsafe_local_read")}(),a=ad.deps,t.rv<dd&&(t.rv=dd,null===id&&null!==a&&a[sd]===t?sd++:null===id?id=[t]:id.push(t));else if(d&&null===t.deps)for(n=(o=t).parent,i=o;null!==n;){if(!(2&n.f)){(null==(e=(l=n).deriveds)?void 0:e.includes(i))||(l.deriveds??(l.deriveds=[])).push(i);break}i=s=n,n=s.parent}return d&&F(o=t)&&$(o),t.v}function rt(t){const e=ad;try{return ad=null,t()}finally{ad=e}}function at(t,e){t.f=t.f&gd|e}function ot(t){return it().get(t)}function nt(t,e){return it().set(t,e),e}function it(){return null===hd&&D(),hd.c??(hd.c=new Map(function(t){let e=t.p;for(;null!==e;){const t=e.c;if(null!==t)return t;e=e.p}return null}(hd)||void 0))}function st(t,e=1){var r=et(t),a=1===e?r++:r--;return A(t,r),a}function lt(t,e=!1){hd={p:hd,c:null,e:null,m:!1,s:t,x:null,l:null},Gc&&!e&&(hd.l={s:null,u:null,r1:[],r2:b(!1)})}function ct(t){var e,r,a,o;const n=hd;if(null!==n){void 0!==t&&(n.x=t);const i=n.e;if(null!==i){e=od,r=ad,n.e=null;try{for(a=0;a<i.length;a++)L((o=i[a]).effect),O(o.reaction),Mt(o.fn)}finally{L(e),O(r)}}hd=n.p,n.m=!0}return t||{}}function dt(t){if("object"==typeof t&&t&&!(t instanceof EventTarget))if(Mc in t)ut(t);else if(!Array.isArray(t))for(let e in t){const r=t[e];"object"==typeof r&&r&&Mc in r&&ut(r)}}function ut(t,e=new Set){if(!("object"!=typeof t||null===t||t instanceof EventTarget||e.has(t))){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{ut(t[r],e)}catch(t){}const r=vi(t);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const e=fi(r);for(let r in e){const a=e[r].get;if(a)try{a.call(t)}catch(t){}}}}}function pt(t){md=t}function ht(t){if(null===t)throw p(),Wc;return fd=t}function gt(){return ht(Et(fd))}function ft(t){if(md){if(null!==Et(fd))throw p(),Wc;fd=t}}function mt(t=1){var e,r;if(md){for(e=t,r=fd;e--;)r=Et(r);fd=r}}function wt(){for(var t,e,r=0,a=fd;;){if(8===a.nodeType)if("]"===(t=a.data)){if(0===r)return a;r-=1}else"["!==t&&t!==Hc||(r+=1);e=Et(a),a.remove(),a=e}}function vt(t){var e,r,a;if("object"!=typeof t||null===t||Mc in t)return t;const o=vi(t);return o!==mi&&o!==wi?t:(e=new Map,r=ci(t),a=b(0),r&&e.set("length",b(t.length)),new Proxy(t,{defineProperty(t,r,a){"value"in a&&!1!==a.configurable&&!1!==a.enumerable&&!1!==a.writable||function(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}();var o=e.get(r);return void 0===o?(o=b(a.value),e.set(r,o)):A(o,vt(a.value)),!0},deleteProperty(t,o){var n,i,s=e.get(o);return void 0===s?o in t&&e.set(o,b(Uc)):(r&&"string"==typeof o&&(n=e.get("length"),i=Number(o),Number.isInteger(i)&&i<n.v&&A(n,i)),A(s,Uc),bt(a)),!0},get(r,a,o){var n,i,s,l;return a===Mc?t:(s=a in r,void 0!==(i=e.get(a))||s&&!(null==(n=gi(r,a))?void 0:n.writable)||(i=b(vt(s?r[a]:Uc)),e.set(a,i)),void 0!==i?(l=et(i))===Uc?void 0:l:Reflect.get(r,a,o))},getOwnPropertyDescriptor(t,r){var a,o,n,i=Reflect.getOwnPropertyDescriptor(t,r);if(i&&"value"in i)(a=e.get(r))&&(i.value=et(a));else if(void 0===i&&(n=null==(o=e.get(r))?void 0:o.v,void 0!==o&&n!==Uc))return{enumerable:!0,configurable:!0,value:n,writable:!0};return i},has(t,r){var a,o,n;return r===Mc||(n=void 0!==(o=e.get(r))&&o.v!==Uc||Reflect.has(t,r),!((void 0!==o||null!==od&&(!n||(null==(a=gi(t,r))?void 0:a.writable)))&&(void 0===o&&(o=b(n?vt(t[r]):Uc),e.set(r,o)),et(o)===Uc))&&n)},set(t,o,n,i){var s,l,c,d,u,p,h=e.get(o),g=o in t;if(r&&"length"===o)for(l=n;l<h.v;l+=1)void 0!==(c=e.get(l+""))?A(c,Uc):l in t&&(c=b(Uc),e.set(l+"",c));return void 0===h?g&&!(null==(s=gi(t,o))?void 0:s.writable)||(A(h=b(void 0),vt(n)),e.set(o,h)):(g=h.v!==Uc,A(h,vt(n))),(null==(d=Reflect.getOwnPropertyDescriptor(t,o))?void 0:d.set)&&d.set.call(i,n),g||(r&&"string"==typeof o&&(u=e.get("length"),p=Number(o),Number.isInteger(p)&&p>=u.v&&A(u,p+1)),bt(a)),!0},ownKeys(t){var r;for(var[o,n]of(et(a),r=Reflect.ownKeys(t).filter(t=>{var r=e.get(t);return void 0===r||r.v!==Uc}),e))n.v===Uc||o in t||r.push(o);return r},setPrototypeOf(){!function(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}()}}))}function bt(t,e=1){A(t,t.v+e)}function yt(t){return null!==t&&"object"==typeof t&&Mc in t?t[Mc]:t}function xt(t,e){return Object.is(yt(t),yt(e))}function kt(){var t,e;void 0===bi&&(bi=window,t=Element.prototype,e=Node.prototype,yi=gi(e,"firstChild").get,xi=gi(e,"nextSibling").get,t.__click=void 0,t.__className="",t.__attributes=null,t.__styles=null,t.__e=void 0,Text.prototype.__t=void 0)}function _t(t=""){return document.createTextNode(t)}function At(t){return yi.call(t)}function Et(t){return xi.call(t)}function St(t,e){var r,a;if(!md)return At(t);if(null===(r=At(fd)))r=fd.appendChild(_t());else if(e&&3!==r.nodeType)return a=_t(),null==r||r.before(a),ht(a),a;return ht(r),r}function Ct(t){if(!md){var e=At(t);return e instanceof Comment&&""===e.data?Et(e):e}return fd}function Pt(t,e=1,r=!1){var a,o,n;let i=md?fd:t;for(;e--;)a=i,i=Et(i);return md?(o=null==i?void 0:i.nodeType,r&&3!==o?(n=_t(),null===i?null==a||a.after(n):i.before(n),ht(n),n):(ht(i),i)):i}function It(t){t.textContent=""}function Tt(){null===od&&null===ad&&function(){throw new Error("https://svelte.dev/e/effect_orphan")}(),null!==ad&&0!==(ad.f&Ec)&&function(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}(),td&&function(){throw new Error("https://svelte.dev/e/effect_in_teardown")}()}function $t(t,e,r,a=!0){var o,n,i=!!(64&t),s=od,l={ctx:hd,deps:null,deriveds:null,nodes_start:null,nodes_end:null,f:t|Pc,first:null,fn:e,last:null,next:null,parent:i?null:s,prev:null,teardown:null,transitions:null,wv:0};if(r){o=Zc;try{N(!0),G(l),l.f|=32768}catch(t){throw Ut(l),t}finally{N(o)}}else null!==e&&X(l);return r&&null===l.deps&&null===l.first&&null===l.nodes_start&&null===l.teardown&&!(1048704&l.f)||i||!a||(null!==s&&function(t,e){var r=e.last;null===r?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}(l,s),null!==ad&&2&ad.f&&((n=ad).children??(n.children=[])).push(l)),l}function Bt(t){const e=$t(8,null,!1);return at(e,Cc),e.teardown=t,e}function Dt(t){var e;if(Tt(),null===od||0===(od.f&_c)||null===hd||hd.m)return Mt(t);((e=hd).e??(e.e=[])).push({fn:t,effect:od,reaction:ad})}function Nt(t){const e=$t(64,t,!0);return()=>{Ut(e)}}function Mt(t){return $t(4,t,!1)}function Ot(t,e){var r=hd,a={effect:null,ran:!1};r.l.r1.push(a),a.effect=jt(()=>{t(),a.ran||(a.ran=!0,A(r.l.r2,!0),rt(e))})}function Lt(){var t=hd;jt(()=>{var e,r;if(et(t.l.r2)){for(e of t.l.r1)0!==((r=e.effect).f&Cc)&&at(r,Ic),F(r)&&G(r),e.ran=!1;t.l.r2.v=!1}})}function jt(t){return $t(8,t,!0)}function Rt(t){return Ft(t)}function Ft(t,e=0){return $t(24|e,t,!0)}function zt(t,e=!0){return $t(40,t,!0,e)}function qt(t){var e=t.teardown;if(null!==e){const t=td,r=ad;M(!0),O(null);try{e.call(null)}finally{M(t),O(r)}}}function Ht(t){var e,r=t.deriveds;if(null!==r)for(t.deriveds=null,e=0;e<r.length;e+=1)B(r[e])}function Wt(t,e=!1){var r,a=t.first;for(t.first=t.last=null;null!==a;)r=a.next,Ut(a,e),a=r}function Ut(t,e=!0){var r,a,o,n,i,s=!1;if((e||524288&t.f)&&null!==t.nodes_start){for(r=t.nodes_start,a=t.nodes_end;null!==r;)o=r===a?null:Et(r),r.remove(),r=o;s=!0}if(Wt(t,e&&!s),Ht(t),U(t,0),at(t,$c),null!==(n=t.transitions))for(const t of n)t.stop();qt(t),null!==(i=t.parent)&&null!==i.first&&Gt(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=null}function Gt(t){var e=t.parent,r=t.prev,a=t.next;null!==r&&(r.next=a),null!==a&&(a.prev=r),null!==e&&(e.first===t&&(e.first=a),e.last===t&&(e.last=r))}function Yt(t,e){var r=[];Jt(t,r,!0),Vt(r,()=>{Ut(t),e&&e()})}function Vt(t,e){var r,a,o=t.length;if(o>0)for(a of(r=()=>--o||e(),t))a.out(r);else e()}function Jt(t,e,r){var a,o;if(0===(t.f&Tc)){if(t.f^=Tc,null!==t.transitions)for(const a of t.transitions)(a.is_global||r)&&e.push(a);for(a=t.first;null!==a;)o=a.next,Jt(a,e,!(0===(a.f&Bc)&&0===(a.f&_c))&&r),a=o}}function Qt(t){Xt(t,!0)}function Xt(t,e){var r,a;if(0!==(t.f&Tc)){for(t.f^=Tc,0===(t.f&Cc)&&(t.f^=Cc),F(t)&&(at(t,Pc),X(t)),r=t.first;null!==r;)a=r.next,Xt(r,!(0===(r.f&Bc)&&0===(r.f&_c))&&e),r=a;if(null!==t.transitions)for(const r of t.transitions)(r.is_global||e)&&r.in()}}function Kt(t){return t.endsWith("capture")&&"gotpointercapture"!==t&&"lostpointercapture"!==t}function Zt(t){return wd.includes(t)}function te(t){return t=t.toLowerCase(),vd[t]??t}function ee(t){return bd.includes(t)}function re(t,e){if(e){const e=document.body;t.autofocus=!0,u(()=>{document.activeElement===e&&t.focus()})}}function ae(){yd||(yd=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)null==(e=r.__on_r)||e.call(r)})},{capture:!0}))}function oe(t){var e=ad,r=od;O(null),L(null);try{return t()}finally{O(e),L(r)}}function ne(t,e,r,a=r){t.addEventListener(e,()=>oe(r));const o=t.__on_r;t.__on_r=o?()=>{o(),a(!0)}:()=>a(!0),ae()}function ie(t,e,r,a){function o(t){if(a.capture||de.call(e,t),!t.cancelBubble)return oe(()=>r.call(this,t))}return t.startsWith("pointer")||t.startsWith("touch")||"wheel"===t?u(()=>{e.addEventListener(t,o,a)}):e.addEventListener(t,o,a),o}function se(t,e,r,a={}){var o=ie(e,t,r,a);return()=>{t.removeEventListener(e,o,a)}}function le(t,e,r,a,o){var n={capture:a,passive:o},i=ie(t,e,r,n);e!==document.body&&e!==window&&e!==document||Bt(()=>{e.removeEventListener(t,i,n)})}function ce(t){var e,r;for(e=0;e<t.length;e++)xd.add(t[e]);for(r of kd)r(t)}function de(t){var e,r,a,o,n,i,s,l,c,d=this,u=d.ownerDocument,p=t.type,h=(null==(e=t.composedPath)?void 0:e.call(t))||[],g=h[0]||t.target,f=0,m=t.__root;if(m){if(-1!==(r=h.indexOf(m))&&(d===document||d===window))return void(t.__root=d);if(-1===(a=h.indexOf(d)))return;r<=a&&(f=r)}if((g=h[f]||t.target)!==d){hi(t,"currentTarget",{configurable:!0,get:()=>g||u}),o=ad,n=od,O(null),L(null);try{for(s=[];null!==g;){l=g.assignedSlot||g.parentNode||g.host||null;try{if(void 0!==(c=g["__"+p])&&!g.disabled)if(ci(c)){var[w,...v]=c;w.apply(g,[t,...v])}else c.call(g,t)}catch(t){i?s.push(t):i=t}if(t.cancelBubble||l===d||null===l)break;g=l}if(i){for(let t of s)queueMicrotask(()=>{throw t});throw i}}finally{t.__root=d,delete t.currentTarget,O(o),L(n)}}}function ue(t){var e=document.createElement("template");return e.innerHTML=t,e.content}function pe(t,e){var r=od;null===r.nodes_start&&(r.nodes_start=t,r.nodes_end=e)}function he(t,e){var r,a=!!(1&e),o=!!(2&e),n=!t.startsWith("<!>");return()=>{var e;return md?(pe(fd,null),fd):(void 0===r&&(r=ue(n?t:"<!>"+t),a||(r=At(r))),e=o?document.importNode(r,!0):r.cloneNode(!0),a?pe(At(e),e.lastChild):pe(e,e),e)}}function ge(t,e,r="svg"){var a,o=`<${r}>${t.startsWith("<!>")?"<!>"+t:t}</${r}>`;return()=>{var t,e;return md?(pe(fd,null),fd):(a||(t=ue(o),a=At(At(t))),pe(e=a.cloneNode(!0),e),e)}}function fe(t=""){var e,r;return md?(3!==(r=fd).nodeType&&(r.before(r=_t()),ht(r)),pe(r,r),r):(pe(e=_t(t+""),e),e)}function me(){var t,e,r;return md?(pe(fd,null),fd):(t=document.createDocumentFragment(),e=document.createComment(""),r=_t(),t.append(e,r),pe(e,r),t)}function we(t,e){if(md)return od.nodes_end=fd,void gt();null!==t&&t.before(e)}function ve(t,e){var r=null==e?"":"object"==typeof e?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=null==r?"":r+"")}function be(t,e){return xe(t,e)}function ye(t,e){kt(),e.intro=e.intro??!1;const r=e.target,a=md,o=fd;try{for(var n=At(r);n&&(8!==n.nodeType||"["!==n.data);)n=Et(n);if(!n)throw Wc;pt(!0),ht(n),gt();const a=xe(t,{...e,anchor:n});if(null===fd||8!==fd.nodeType||"]"!==fd.data)throw p(),Wc;return pt(!1),a}catch(a){if(a===Wc)return!1===e.recover&&function(){throw new Error("https://svelte.dev/e/hydration_failed")}(),kt(),It(r),pt(!1),be(t,e);throw a}finally{pt(a),ht(o)}}function xe(t,{target:e,anchor:r,props:a={},events:o,context:n,intro:i=!0}){var s,l,c,d;return kt(),s=new Set,(l=t=>{var r,a,o,n;for(r=0;r<t.length;r++)a=t[r],s.has(a)||(s.add(a),o=ee(a),e.addEventListener(a,de,{passive:o}),void 0===(n=Ad.get(a))?(document.addEventListener(a,de,{passive:o}),Ad.set(a,1)):Ad.set(a,n+1))})(ui(xd)),kd.add(l),c=void 0,d=function(){const d=$t(64,()=>{var d=r??e.appendChild(_t());return zt(()=>{n&&(lt({}),hd.c=n),o&&(a.$$events=o),md&&pe(d,null),_d=i,c=t(d,a)||{},_d=!0,md&&(od.nodes_end=fd),n&&ct()}),()=>{var t,a,o;for(a of s)e.removeEventListener(a,de),o=Ad.get(a),0===--o?(document.removeEventListener(a,de),Ad.delete(a)):Ad.set(a,o);kd.delete(l),d!==r&&(null==(t=d.parentNode)||t.removeChild(d))}},!0);return(t={})=>new Promise(e=>{t.outro?Yt(d,()=>{Ut(d),e(void 0)}):(Ut(d),e(void 0))})}(),Ed.set(c,d),c}function ke(t,e,r=!1){var a,o,n,i,s;md&&gt(),a=t,o=null,n=null,i=Uc,s=!1;const l=(t,e=!0)=>{s=!0,c(e,t)},c=(t,e)=>{if(i===(i=t))return;let r=!1;if(md){const t=a.data===Hc;!!i===t&&(ht(a=wt()),pt(!1),r=!0)}i?(o?Qt(o):e&&(o=zt(()=>e(a))),n&&Yt(n,()=>{n=null})):(n?Qt(n):e&&(n=zt(()=>e(a))),o&&Yt(o,()=>{o=null})),r&&pt(!0)};Ft(()=>{s=!1,e(l),s||c(null,null)},r?Bc:0),md&&(a=fd)}function _e(t,e){return e}function Ae(t,e,r,a,o,n=null){var i,s,l,c,d=t,p={flags:e,items:new Map,first:null};!!(4&e)&&(i=t,d=md?ht(At(i)):i.appendChild(_t())),md&&gt(),s=null,l=!1,c=P(()=>{var t=r();return ci(t)?t:null==t?[]:ui(t)}),Ft(()=>{var t,r,i,h,g,f=et(c),m=f.length;if(l&&0===m)return;l=0===m;let w=!1;if(md&&d.data===Hc!=(0===m)&&(ht(d=wt()),pt(!1),w=!0),md){for(t=null,i=0;i<m;i++){if(8===fd.nodeType&&"]"===fd.data){d=fd,w=!0,pt(!1);break}h=f[i],g=a(h,i),r=Se(fd,p,t,null,h,g,i,o,e),p.items.set(g,r),t=r}m>0&&ht(wt())}md||function(t,e,r,a,o,n,i){var s,l,c,d,p,h,g,f,m,w,v,b,y,x,k,_,A,E=!!(8&o),S=!!(3&o),C=t.length,P=e.items,I=e.first,T=null,$=[],B=[];if(E)for(w=0;w<C;w+=1)f=i(g=t[w],w),void 0!==(m=P.get(f))&&(null==(s=m.a)||s.measure(),(h??(h=new Set)).add(m));for(w=0;w<C;w+=1)if(f=i(g=t[w],w),void 0!==(m=P.get(f))){if(S&&Ee(m,g,w,o),0!==(m.e.f&Tc)&&(Qt(m.e),E&&(null==(l=m.a)||l.unfix(),(h??(h=new Set)).delete(m))),m!==I){if(void 0!==p&&p.has(m)){if($.length<B.length){for(T=(v=B[0]).prev,y=$[0],x=$[$.length-1],b=0;b<$.length;b+=1)Ce($[b],v,r);for(b=0;b<B.length;b+=1)p.delete(B[b]);Pe(e,y.prev,x.next),Pe(e,T,y),Pe(e,x,v),I=v,T=x,w-=1,$=[],B=[]}else p.delete(m),Ce(m,I,r),Pe(e,m.prev,m.next),Pe(e,m,null===T?e.first:T.next),Pe(e,T,m),T=m;continue}for($=[],B=[];null!==I&&I.k!==f;)(n||0===(I.e.f&Tc))&&(p??(p=new Set)).add(I),B.push(I),I=I.next;if(null===I)continue;m=I}$.push(m),T=m,I=m.next}else T=Se(I?I.e.nodes_start:r,e,T,null===T?e.first:T.next,g,f,w,a,o),P.set(f,T),$=[],B=[],I=T.next;if(null!==I||void 0!==p){for(k=void 0===p?[]:ui(p);null!==I;)(n||0===(I.e.f&Tc))&&k.push(I),I=I.next;if((_=k.length)>0){if(A=4&o&&0===C?r:null,E){for(w=0;w<_;w+=1)null==(c=k[w].a)||c.measure();for(w=0;w<_;w+=1)null==(d=k[w].a)||d.fix()}!function(t,e,r,a){var o,n,i,s=[],l=e.length;for(o=0;o<l;o++)Jt(e[o].e,s,!0);(n=l>0&&0===s.length&&null!==r)&&(It(i=r.parentNode),i.append(r),a.clear(),Pe(t,e[0].prev,e[l-1].next)),Vt(s,()=>{var r,o;for(r=0;r<l;r++)o=e[r],n||(a.delete(o.k),Pe(t,o.prev,o.next)),Ut(o.e,!n)})}(e,k,A,P)}}E&&u(()=>{var t;if(void 0!==h)for(m of h)null==(t=m.a)||t.apply()}),od.first=e.first&&e.first.e,od.last=T&&T.e}(f,p,d,o,e,0!==(ad.f&Tc),a),null!==n&&(0===m?s?Qt(s):s=zt(()=>n(d)):null!==s&&Yt(s,()=>{s=null})),w&&pt(!0),et(c)}),md&&(d=fd)}function Ee(t,e,r,a){1&a&&E(t.v,e),2&a?E(t.i,r):t.i=r}function Se(t,e,r,a,o,n,i,s,l){var c=Sd,d=1&l?16&l?b(o):x(o):o,u=2&l?b(i):i,p={i:u,v:d,k:n,a:null,e:null,prev:r,next:a};Sd=p;try{return p.e=zt(()=>s(t,d,u),md),p.e.prev=r&&r.e,p.e.next=a&&a.e,null===r?e.first=p:(r.next=p,r.e.next=p.e),null!==a&&(a.prev=p,a.e.prev=p.e),p}finally{Sd=c}}function Ce(t,e,r){for(var a,o=t.next?t.next.e.nodes_start:r,n=e?e.e.nodes_start:r,i=t.e.nodes_start;i!==o;)a=Et(i),n.before(i),i=a}function Pe(t,e,r){null===e?t.first=r:(e.next=r,e.e.next=r&&r.e),null!==r&&(r.prev=e,r.e.prev=e&&e.e)}function Ie(t,e){var r,a=t,o="";Ft(()=>{o!==(o=e()??"")?(void 0!==r&&(Ut(r),r=void 0),""!==o&&(r=zt(()=>{var t,e,r;if(md){for(fd.data,e=t=gt();null!==t&&(8!==t.nodeType||""!==t.data);)e=t,t=Et(t);if(null===t)throw p(),Wc;return pe(fd,e),void(a=ht(t))}pe(At(r=ue(o+"")),r.lastChild),a.before(r)}))):md&&gt()})}function Te(t,e,r,a,o){var n,i,s;md&&gt(),s=!1,!0===(i=null==(n=e.$$slots)?void 0:n[r])&&(i=e["default"===r?"children":r],s=!0),void 0===i?null!==o&&o(t):i(t,s?()=>a:a)}function $e(t){const e={};t.children&&(e.default=!0);for(const r in t.$$slots)e[r]=!0;return e}function Be(t,e,r){var a,o,n;md&&gt(),a=t,Ft(()=>{o!==(o=e())&&(n&&(Yt(n),n=null),o&&(n=zt(()=>r(a,o))))},Bc),md&&(a=fd)}function De(t,e,r){Mt(()=>{var a,o,n=rt(()=>e(t,null==r?void 0:r())||{});if(r&&(null==n?void 0:n.update)&&(a=!1,o={},jt(()=>{var t=r();dt(t),a&&g(o,t)&&(o=t,n.update(t))}),a=!0),null==n?void 0:n.destroy)return()=>n.destroy()})}function Ne(t){var e,r,a,o="";if("string"==typeof t||"number"==typeof t)o+=t;else if("object"==typeof t)if(Array.isArray(t))for(a=t.length,e=0;e<a;e++)t[e]&&(r=Ne(t[e]))&&(o&&(o+=" "),o+=r);else for(r in t)t[r]&&(o&&(o+=" "),o+=r);return o}function Me(t){return"object"==typeof t?function(){for(var t,e,r=0,a="",o=arguments.length;r<o;r++)(t=arguments[r])&&(e=Ne(t))&&(a&&(a+=" "),a+=e);return a}(t):t??""}function Oe(t){var e,r,a;md&&(e=!1,r=()=>{var r,a;e||(e=!0,t.hasAttribute("value")&&(r=t.value,je(t,"value",null),t.value=r),t.hasAttribute("checked")&&(a=t.checked,je(t,"checked",null),t.checked=a))},t.__on_r=r,a=r,Fc||(Fc=!0,jc(d)),qc.push(a),ae())}function Le(t,e){e?t.hasAttribute("selected")||t.setAttribute("selected",""):t.removeAttribute("selected")}function je(t,e,r){var a=t.__attributes??(t.__attributes={});md&&(a[e]=t.getAttribute(e),"src"===e||"srcset"===e||"href"===e&&"LINK"===t.nodeName)||a[e]!==(a[e]=r)&&("style"===e&&"__styles"in t&&(t.__styles={}),"loading"===e&&(t[Lc]=r),null==r?t.removeAttribute(e):"string"!=typeof r&&Fe(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function Re(t,e,r,a,o=!1,n=!1){var i,s,l,c,d,u,p,h,g=e||{},f="OPTION"===t.tagName;for(i in e)i in r||(r[i]=null);r.class&&(r.class=Me(r.class)),s=Fe(t),l=t.__attributes??(t.__attributes={});for(const e in r){let a=r[e];if(f&&"value"===e&&null==a)t.value=t.__value="",g[e]=a;else if(a!==(c=g[e])&&(g[e]=a,"$$"!==(d=e[0]+e[1]))){if("on"===d){const r={},o="$$"+e;let n=e.slice(2);if(u=Zt(n),Kt(n)&&(n=n.slice(0,-7),r.capture=!0),!u&&c){if(null!=a)continue;t.removeEventListener(n,g[o],r),g[o]=null}if(null!=a)if(u)t[`__${n}`]=a,ce([n]);else{let a=function(t){g[e].call(this,t)};g[o]=ie(n,t,a,r)}else u&&(t[`__${n}`]=void 0)}else if("style"===e&&null!=a)t.style.cssText=a+"";else if("autofocus"===e)re(t,Boolean(a));else if("__value"===e||"value"===e&&null!=a)t.value=t[e]=t.__value=a;else if("selected"===e&&f)Le(t,a);else if(p=e,o||(p=te(p)),h="defaultValue"===p||"defaultChecked"===p,null!=a||n||h)h||s.includes(p)&&(n||"string"!=typeof a)?t[p]=a:"function"!=typeof a&&(!md||"src"!==p&&"href"!==p&&"srcset"!==p)&&je(t,p,a);else if(l[e]=null,"value"===p||"checked"===p){let e=t;if("value"===p){let t=e.defaultValue;e.removeAttribute(p),e.defaultValue=t}else{let t=e.defaultChecked;e.removeAttribute(p),e.defaultChecked=t}}else t.removeAttribute(e);"style"===e&&"__styles"in t&&(t.__styles={})}}return g}function Fe(t){var e,r,a,o,n=ki.get(t.nodeName);if(n)return n;for(ki.set(t.nodeName,n=[]),r=t,a=Element.prototype;a!==r;){for(o in e=fi(r))e[o].set&&n.push(o);r=vi(r)}return n}function ze(t,e){var r=t.__className,a=He(e);md&&t.getAttribute("class")===a?t.__className=a:(r!==a||md&&t.getAttribute("class")!==a)&&(""===a?t.removeAttribute("class"):t.setAttribute("class",a),t.__className=a)}function qe(t,e){var r=t.__className,a=He(e);md&&t.className===a?t.__className=a:(r!==a||md&&t.className!==a)&&(null==e?t.removeAttribute("class"):t.className=a,t.__className=a)}function He(t){return(null==t?"":t)+""}function We(t,e,r){if(r){if(t.classList.contains(e))return;t.classList.add(e)}else{if(!t.classList.contains(e))return;t.classList.remove(e)}}function Ue(t,e,r){var a=t.__styles??(t.__styles={});a[e]!==r&&(a[e]=r,null==r?t.style.removeProperty(e):t.style.setProperty(e,r,""))}function Ge(){const t=Cd.now();Cd.tasks.forEach(e=>{e.c(t)||(Cd.tasks.delete(e),e.f())}),0!==Cd.tasks.size&&Cd.tick(Ge)}function Ye(t,e){t.dispatchEvent(new CustomEvent(e))}function Ve(t){if("float"===t)return"cssFloat";if("offset"===t)return"cssOffset";if(t.startsWith("--"))return t;const e=t.split("-");return 1===e.length?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function Je(t){const e={},r=t.split(";");for(const t of r){const[r,a]=t.split(":");if(!r||void 0===a)break;e[Ve(r.trim())]=a.trim()}return e}function Qe(t,e,r){var a,o,n,i=Sd,s=null;i.a??(i.a={element:t,measure(){a=this.element.getBoundingClientRect()},apply(){if(null==n||n.abort(),o=this.element.getBoundingClientRect(),a.left!==o.left||a.right!==o.right||a.top!==o.top||a.bottom!==o.bottom){const t=e()(this.element,{from:a,to:o},null==r?void 0:r());n=Ke(this.element,t,void 0,1,()=>{null==n||n.abort(),n=void 0})}},fix(){var e,r,o;if(!t.getAnimations().length){var{position:n,width:i,height:l}=getComputedStyle(t);"absolute"!==n&&"fixed"!==n&&(e=t.style,s={position:e.position,width:e.width,height:e.height,transform:e.transform},e.position="absolute",e.width=i,e.height=l,r=t.getBoundingClientRect(),a.left===r.left&&a.top===r.top||(o=`translate(${a.left-r.left}px, ${a.top-r.top}px)`,e.transform=e.transform?`${e.transform} ${o}`:o))}},unfix(){if(s){var e=t.style;e.position=s.position,e.width=s.width,e.height=s.height,e.transform=s.transform}}}),i.a.element=t}function Xe(t,e,r,a){function o(){var t=ad,o=od;O(null),L(null);try{return n??(n=r()(e,(null==a?void 0:a())??{},{direction:h}))}finally{O(t),L(o)}}var n,i,s,l,c,d=!!(1&t),u=!!(2&t),p=!!(4&t),h=d&&u?"both":d?"in":"out",g=e.inert,f=e.style.overflow,m={is_global:p,in(){var t;if(e.inert=g,!d)return null==s||s.abort(),void(null==(t=null==s?void 0:s.reset)||t.call(s));u||null==i||i.abort(),Ye(e,"introstart"),i=Ke(e,o(),s,1,()=>{Ye(e,"introend"),null==i||i.abort(),i=n=void 0,e.style.overflow=f})},out(t){if(!u)return null==t||t(),void(n=void 0);e.inert=!0,Ye(e,"outrostart"),s=Ke(e,o(),i,0,()=>{Ye(e,"outroend"),null==t||t()})},stop:()=>{null==i||i.abort(),null==s||s.abort()}},w=od;if((w.transitions??(w.transitions=[])).push(m),d&&_d){if(!(l=p)){for(c=w.parent;c&&0!==(c.f&Bc);)for(;(c=c.parent)&&!(16&c.f););l=!c||!!(32768&c.f)}l&&Mt(()=>{rt(()=>m.in())})}}function Ke(t,e,r,a,o){var n,s,l,c,d,p,h=1===a;if(i(e))return s=!1,u(()=>{if(!s){var i=e({direction:h?"in":"out"});n=Ke(t,i,r,a,o)}}),{abort:()=>{s=!0,null==n||n.abort()},deactivate:()=>n.deactivate(),reset:()=>n.reset(),t:()=>n.t()};if(null==r||r.deactivate(),!(null==e?void 0:e.duration))return o(),{abort:kc,deactivate:kc,reset:kc,t:()=>a};const{delay:g=0,css:f,tick:m,easing:w=Pd}=e;return l=[],h&&void 0===r&&(m&&m(0,1),f&&(c=Je(f(0,1)),l.push(c,c))),d=()=>1-a,(p=t.animate(l,{duration:g})).onfinish=()=>{var n,i,s,l,c,u,h,g,v=(null==r?void 0:r.t())??1-a;if(null==r||r.abort(),n=a-v,s=[],(i=e.duration*Math.abs(n))>0){if(l=!1,f)for(c=Math.ceil(i/(1e3/60)),u=0;u<=c;u+=1)h=v+n*w(u/c),g=Je(f(h,1-h)),s.push(g),l||(l="hidden"===g.overflow);l&&(t.style.overflow="hidden"),d=()=>{var t=p.currentTime;return v+n*w(t/i)},m&&function(t){let e;0===Cd.tasks.size&&Cd.tick(Ge),new Promise(r=>{Cd.tasks.add(e={c:t,f:r})})}(()=>{if("running"!==p.playState)return!1;var t=d();return m(t,1-t),!0})}(p=t.animate(s,{duration:i,fill:"forwards"})).onfinish=()=>{d=()=>a,null==m||m(a,1-a),o()}},{abort:()=>{p&&(p.cancel(),p.effect=null,p.onfinish=kc)},deactivate:()=>{o=kc},reset:()=>{0===a&&(null==m||m(1,0))},t:()=>d()}}function Ze(t,e,r=e){var a=R();ne(t,"input",o=>{var n,i,s=o?t.defaultValue:t.value;s=ar(t)?or(s):s,r(s),a&&s!==(s=e())&&(n=t.selectionStart,i=t.selectionEnd,t.value=s??"",null!==i&&(t.selectionStart=n,t.selectionEnd=Math.min(i,t.value.length)))}),(md&&t.defaultValue!==t.value||null==rt(e)&&t.value)&&r(ar(t)?or(t.value):t.value),jt(()=>{var r=e();ar(t)&&r===or(t.value)||("date"!==t.type||r||t.value)&&r!==t.value&&(t.value=r??"")})}function tr(t,e,r,a,o=a){var n,i="checkbox"===r.getAttribute("type"),s=t;let l=!1;if(null!==e)for(n of e)s=s[n]??(s[n]=[]);s.push(r),ne(r,"change",()=>{var t=r.__value;i&&(t=rr(s,t,r.checked)),o(t)},()=>o(i?[]:null)),jt(()=>{var t=a();md&&r.defaultChecked!==r.checked?l=!0:i?(t=t||[],r.checked=t.includes(r.__value)):r.checked=xt(r.__value,t)}),Bt(()=>{var t=s.indexOf(r);-1!==t&&s.splice(t,1)}),Id.has(s)||(Id.add(s),u(()=>{s.sort((t,e)=>4===t.compareDocumentPosition(e)?-1:1),Id.delete(s)})),u(()=>{var t,e;l&&(t=i?rr(s,t,r.checked):null==(e=s.find(t=>t.checked))?void 0:e.__value,o(t))})}function er(t,e,r=e){ne(t,"change",e=>{var a=e?t.defaultChecked:t.checked;r(a)}),(md&&t.defaultChecked!==t.checked||null==rt(e))&&r(t.checked),jt(()=>{var r=e();t.checked=Boolean(r)})}function rr(t,e,r){var a,o=new Set;for(a=0;a<t.length;a+=1)t[a].checked&&o.add(t[a].__value);return r||o.delete(e),Array.from(o)}function ar(t){var e=t.type;return"number"===e||"range"===e}function or(t){return""===t?null:+t}function nr(t,e,r){var a=gi(t,e);a&&a.set&&(t[e]=r,Bt(()=>{t[e]=null}))}function ir(t,e,r){var a;if(t.multiple)return function(t,e){for(var r of t.options)r.selected=~e.indexOf(lr(r))}(t,e);for(a of t.options)if(xt(lr(a),e))return void(a.selected=!0);r&&void 0===e||(t.selectedIndex=-1)}function sr(t,e,r=e){var a=!0;ne(t,"change",e=>{var a,o,n=e?"[selected]":":checked";a=t.multiple?[].map.call(t.querySelectorAll(n),lr):(o=t.querySelector(n)??t.querySelector("option:not([disabled])"))&&lr(o),r(a)}),Mt(()=>{var o,n=e();ir(t,n,a),a&&void 0===n&&null!==(o=t.querySelector(":checked"))&&(n=lr(o),r(n)),t.__value=n,a=!1}),function(t){Mt(()=>{var e=new MutationObserver(()=>{var e=t.__value;ir(t,e)});return e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{e.disconnect()}})}(t)}function lr(t){return"__value"in t?t.__value:t.value}function cr(t,e){return t===e||(null==t?void 0:t[Mc])===e}function dr(t={},e,r){return Mt(()=>{var a,o;return jt(()=>{a=o,o=[],rt(()=>{t!==r(...o)&&(e(t,...o),a&&cr(r(...a),t)&&e(null,...a))})}),()=>{u(()=>{o&&cr(r(...o),t)&&e(null,...o)})}}),t}function ur(t=!1){const e=hd,r=e.l.u;if(!r)return;let a=()=>dt(e.s);if(t){let t=0,r={};const o=C(()=>{let a=!1;const o=e.s;for(const t in o)o[t]!==r[t]&&(r[t]=o[t],a=!0);return a&&t++,t});a=()=>et(o)}var o;r.b.length&&(o=()=>{pr(e,a),l(r.b)},Tt(),jt(o)),Dt(()=>{const t=rt(()=>r.m.map(s));return()=>{for(const e of t)"function"==typeof e&&e()}}),r.a.length&&Dt(()=>{pr(e,a),l(r.a)})}function pr(t,e){if(t.l.s)for(const e of t.l.s)et(e);e()}function hr(t,e){var r,a,o=null==(r=t.$$events)?void 0:r[e.type],n=ci(o)?o.slice():null==o?[]:[o];for(a of n)a.call(this,e)}function gr(t,e,r){const a=r[e]??(r[e]={store:null,source:x(void 0),unsubscribe:kc});if(a.store!==t&&!($d in r))if(a.unsubscribe(),a.store=t??null,null==t)a.source.v=void 0,a.unsubscribe=kc;else{var o=!0;a.unsubscribe=Er(t,t=>{o?a.source.v=t:A(a.source,t)}),o=!1}return t&&$d in r?Cr(t):et(a.source)}function fr(){const t={};return[t,function(){Bt(()=>{for(var e in t)t[e].unsubscribe();hi(t,$d,{enumerable:!1,value:!0})})}]}function mr(t,e){return new Proxy({props:t,exclude:e,special:{},version:b(0)},Bd)}function wr(...t){return new Proxy({props:t},Dd)}function vr(t){for(var e=od,r=od;null!==e&&!(96&e.f);)e=e.parent;try{return L(e),t()}finally{L(r)}}function br(t,e,r,a){var o,n,i,s,l,c,d,u,p,h,g,f,w,v,b,y=!!(1&r),k=!Gc||!!(2&r),_=!!(8&r),E=!!(16&r),S=!1;return _?[n,S]=function(){var r=Td;try{return Td=!1,[t[e],Td]}finally{Td=r}}():n=t[e],i=Mc in t||Oc in t,s=_&&((null==(o=gi(t,e))?void 0:o.set)??(i&&e in t&&(r=>t[e]=r)))||void 0,l=a,c=!0,d=!1,u=()=>(d=!0,c&&(c=!1,l=E?rt(a):a),l),void 0===n&&void 0!==a&&(s&&k&&function(){throw new Error("https://svelte.dev/e/props_invalid_value")}(),n=u(),s&&s(n)),k?p=()=>{var r=t[e];return void 0===r?u():(c=!0,d=!1,r)}:((h=vr(()=>(y?C:P)(()=>t[e]))).f|=Dc,p=()=>{var t=et(h);return void 0!==t&&(l=void 0),void 0===t?l:t}),4&r?s?(g=t.$$legacy,function(t,e){return arguments.length>0?(k&&e&&!g&&!S||s(e?p():t),t):p()}):(f=!1,w=!1,v=x(n),b=vr(()=>C(()=>{var t=p(),e=et(v);return f?(f=!1,w=!0,e):(w=!1,v.v=t)})),y||(b.equals=m),function(t,e){if(null!==pd&&(f=w,p(),et(v)),arguments.length>0){const r=e?et(b):k&&_?vt(t):t;return b.equals(r)||(f=!0,A(v,r),d&&void 0!==l&&(l=r),rt(()=>et(b))),t}return et(b)}):p}function yr(t,e,r,a){var o;const n=null==(o=r[t])?void 0:o.type;if(e="Boolean"===n&&"boolean"!=typeof e?null!=e:e,!a||!r[t])return e;if("toAttribute"===a)switch(n){case"Object":case"Array":return null==e?null:JSON.stringify(e);case"Boolean":return e?"":null;case"Number":return null==e?null:e;default:return e}else switch(n){case"Object":case"Array":return e&&JSON.parse(e);case"Boolean":default:return e;case"Number":return null!=e?+e:e}}function xr(t){null===hd&&D(),Gc&&null!==hd.l?Ar(hd).m.push(t):Dt(()=>{const e=rt(t);if("function"==typeof e)return e})}function kr(){const t=hd;return null===t&&D(),(e,r,a)=>{var o;const n=null==(o=t.s.$$events)?void 0:o[e];if(n){const o=ci(n)?n.slice():[n],i=function(t,e,{bubbles:r=!1,cancelable:a=!1}={}){return new CustomEvent(t,{detail:e,bubbles:r,cancelable:a})}(e,r,a);for(const e of o)e.call(t.x,i);return!i.defaultPrevented}return!0}}function _r(t){null===hd&&D(),null===hd.l&&function(){throw new Error("https://svelte.dev/e/lifecycle_legacy_only")}(),Ar(hd).a.push(t)}function Ar(t){var e=t.l;return e.u??(e.u={a:[],b:[],m:[]})}function Er(t,e,r){if(null==t)return e(void 0),kc;const a=rt(()=>t.subscribe(e,r));return a.unsubscribe?()=>a.unsubscribe():a}function Sr(t,e=kc){function r(e){if(g(t,e)&&(t=e,o)){const e=!Od.length;for(const e of n)e[1](),Od.push(e,t);if(e){for(let t=0;t<Od.length;t+=2)Od[t][0](Od[t+1]);Od.length=0}}}function a(e){r(e(t))}let o=null;const n=new Set;return{set:r,update:a,subscribe:function(i,s=kc){const l=[i,s];return n.add(l),1===n.size&&(o=e(r,a)||kc),i(t),()=>{n.delete(l),0===n.size&&o&&(o(),o=null)}}}}function Cr(t){let e;return Er(t,t=>e=t)(),e}function Pr(t){let e,r=0,a=b(0);return()=>{null===ad||ud||(et(a),jt(()=>(0===r&&(e=rt(()=>t(()=>{var t;A(t=a,t.v+1)}))),r+=1,()=>{tt().then(()=>{r-=1,0===r&&(null==e||e(),e=void 0)})})))}}function Ir(t,e){let r=t();const a=Sr(r,e=>{let a=r!==t();const o=Nt(()=>{jt(()=>{const r=t();a&&e(r)})});return a=!0,o});return e?{set:e,update:r=>e(r(t())),subscribe:a.subscribe}:{subscribe:a.subscribe}}function Tr(t){return new Promise(e=>{setTimeout(e,t)})}function $r(t){if("string"!=typeof t)throw new TypeError("expect string but got "+typeof t);return t?t.replace(new RegExp("\\p{C}","gu"),"").replace(/\\/g,"＼").replace(/\//g,"／").replace(/:/g,"：").replace(/\*/g,"＊").replace(/\?/g,"？").replace(/\|/g,"｜").replace(/"/g,"＂").replace(/</g,"﹤").replace(/>/g,"﹥").replace(/~/g,"～").trim().replace(/^\.|\.$/g,"．"):""}async function Br(t){t.adoptedStyleSheets=[window._pdlShadowStyle]}function Dr(t){if(t.normalize(),0===t.childNodes.length)return"";const e=["ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","DD","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HR","LI","MAIN","NAV","OL","P","PRE","SECTION","TABLE","UL"];let r="";for(let a=0;a<t.childNodes.length;a++){const o=t.childNodes[a];if(o.nodeType===Node.TEXT_NODE){const t=o.nodeValue;(null==t?void 0:t.trim())&&(r+=t)}else if(o.nodeType===Node.ELEMENT_NODE){if("BR"===o.nodeName){r+="\n";continue}if(e.includes(o.nodeName)){const t=Dr(o);t&&(r+=r?"\n"+t:t)}else{const t=Dr(o);t&&(r+=t)}}}return r}function Nr(t,e){const r=document.createElement("a");r.href=URL.createObjectURL(t),r.download=e,r.click(),URL.revokeObjectURL(r.href)}function Mr(t){if("object"!=typeof t)return!1;if("[object Object]"!==Object.prototype.toString.call(t))return!1;const e=Object.getPrototypeOf(t);if(null===e)return!0;const r=Object.prototype.hasOwnProperty.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Function.prototype.toString.call(r)===Function.prototype.toString.call(Object)}function Or(t,e,r){let a,o;null==r||r.throwIfAborted();const n=new Promise((t,e)=>{a=t,o=e});let i;Jd.length?(i=Jd.shift(),Ld.info("Reuse apng workers.")):i=new Worker(Vd),null==r||r.addEventListener("abort",()=>{i.terminate(),o(null==r?void 0:r.reason)}),i.onmessage=function(t){if(i.terminate(),!t.data)return o(new Error("Mix Effect convert Failed."));a(t.data)};const s={illust:t,effect:e};return i.postMessage(s,[e]),n}function Lr(t,e){for(const r of Object.keys(t)){if(!(r in e))continue;const a=t[r],o=e[r];Mr(a)&&Mr(o)?Lr(a,o):void 0!==a&&(e[r]=a)}return e}function jr(t,e,r){let a=0,o=0;const n=localStorage.getItem(t);let i=y(vt(n?Lr(JSON.parse(n),Object.assign({},e)):e));const s=Ir(()=>et(i),t=>A(i,vt(t)));Nt(()=>{Dt(()=>{0===a?a=Date.now():a<o?a=o:(a=Date.now(),jd.emit(`sync:${t}`,{version:a,data:w(et(i))})),localStorage.setItem(t,JSON.stringify(et(i)))})}),jd.on(`sync:${t}`,({version:t,data:e})=>{t<=a||(o=t,A(i,vt(e)))});const l=Object.create(r||null);Object.defineProperties(l,{$state:{get:()=>et(i)},$subscribe:{value:s.subscribe},$update:{value:s.update}});for(const t of Object.keys(et(i)))Object.defineProperty(l,t,{enumerable:!0,get:()=>et(i)[t],set(e){et(i)[t]=e}});return l}function Rr(){const t=ot(ou);if(!t)throw new Error("modalStore is not initialized. Please ensure that `initializeStores()` is invoked in the root layout file of this app!");return t}function Fr(){const t=ot(iu);if(!t)throw new Error("toastStore is not initialized. Please ensure that `initializeStores()` is invoked in the root layout file of this app!");return t}function zr(t){return"local"===t?localStorage:sessionStorage}function qr(t,e){function r(t,e){zr(o).setItem(t,a.stringify(e))}const a=JSON,o="local";if(!su[t]){const n=Sr(e,e=>{const r=zr(o).getItem(t);r&&e(a.parse(r));{const r=r=>{r.key===t&&e(r.newValue?a.parse(r.newValue):null)};return window.addEventListener("storage",r),()=>window.removeEventListener("storage",r)}}),{subscribe:i,set:s}=n;su[t]={set(e){r(t,e),s(e)},update(e){const a=e(Cr(n));r(t,a),s(a)},subscribe:i}}return su[t]}function Hr(t,e){function r(t){t.shiftKey&&"Tab"===t.code&&(t.preventDefault(),i.focus())}function a(t){t.shiftKey||"Tab"!==t.code||(t.preventDefault(),n.focus())}function o(){n&&n.removeEventListener("keydown",r),i&&i.removeEventListener("keydown",a)}let n,i;const s=o=>{if(!1===e)return;const s=(t=>t.filter(t=>t.tabIndex>=0).sort((t,e)=>0===t.tabIndex&&e.tabIndex>0?1:t.tabIndex>0&&0===e.tabIndex?-1:t.tabIndex-e.tabIndex))(Array.from(t.querySelectorAll('a[href]:not([tabindex="-1"]), button:not([tabindex="-1"]), input:not([tabindex="-1"]), textarea:not([tabindex="-1"]), select:not([tabindex="-1"]), details:not([tabindex="-1"]), [tabindex]:not([tabindex="-1"])')));s.length&&(n=s[0],i=s[s.length-1],o||(e=>{const r=[...t.querySelectorAll("[data-focusindex]")];return r&&0!==r.length&&r.sort((t,e)=>+t.dataset.focusindex-+e.dataset.focusindex)[0]||e})(n).focus(),n.addEventListener("keydown",r),i.addEventListener("keydown",a))};s(!1);const l=new MutationObserver((t,e)=>(t.length&&(o(),s(!0)),e));return l.observe(t,{childList:!0,subtree:!0}),{update(t){e=t,t?s(!1):o()},destroy(){o(),l.disconnect()}}}function Wr(t){const e=t-1;return e*e*e+1}function Ur(t){const e="string"==typeof t&&t.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[t,"px"]}function Gr(t,{delay:e=0,duration:r=400,easing:a=du}={}){const o=+getComputedStyle(t).opacity;return{delay:e,duration:r,easing:a,css:t=>"opacity: "+t*o}}function Yr(t,{delay:e=0,duration:r=400,easing:a=Wr,x:o=0,y:n=0,opacity:i=0}={}){const s=getComputedStyle(t),l=+s.opacity,c="none"===s.transform?"":s.transform,d=l*(1-i),[u,p]=Ur(o),[h,g]=Ur(n);return{delay:e,duration:r,easing:a,css:(t,e)=>`\n\t\t\ttransform: ${c} translate(${(1-t)*u}${p}, ${(1-t)*h}${g});\n\t\t\topacity: ${l-d*e}`}}function Vr(t,{delay:e=0,duration:r=400,easing:a=Wr,axis:o="y"}={}){const n=getComputedStyle(t),i=+n.opacity,s="y"===o?"height":"width",l=parseFloat(n[s]),c="y"===o?["top","bottom"]:["left","right"],d=c.map(t=>`${t[0].toUpperCase()}${t.slice(1)}`),u=parseFloat(n[`padding${d[0]}`]),p=parseFloat(n[`padding${d[1]}`]),h=parseFloat(n[`margin${d[0]}`]),g=parseFloat(n[`margin${d[1]}`]),f=parseFloat(n[`border${d[0]}Width`]),m=parseFloat(n[`border${d[1]}Width`]);return{delay:e,duration:r,easing:a,css:t=>`overflow: hidden;opacity: ${Math.min(20*t,1)*i};${s}: ${t*l}px;padding-${c[0]}: ${t*u}px;padding-${c[1]}: ${t*p}px;margin-${c[0]}: ${t*h}px;margin-${c[1]}: ${t*g}px;border-${c[0]}-width: ${t*f}px;border-${c[1]}-width: ${t*m}px;min-${s}: 0`}}function Jr(t,{delay:e=0,duration:r=400,easing:a=Wr,start:o=0,opacity:n=0}={}){const i=getComputedStyle(t),s=+i.opacity,l="none"===i.transform?"":i.transform,c=1-o,d=s*(1-n);return{delay:e,duration:r,easing:a,css:(t,e)=>`\n\t\t\ttransform: ${l} scale(${1-c*e});\n\t\t\topacity: ${s-d*e}\n\t\t`}}function Qr(t,e){const{transition:r,params:a,enabled:o}=e;return o?r(t,a):"duration"in a?r(t,{duration:0}):{duration:0}}function Xr(t){const e=t-1;return e*e*e+1}function Kr(t,{from:e,to:r},a={}){var o,n,i,s,l,c,d,u,p,h,g,f,m,{delay:w=0,duration:v=t=>120*Math.sqrt(t),easing:b=Xr}=a;o=getComputedStyle(t),n="none"===o.transform?"":o.transform;var[y,x]=o.transformOrigin.split(" ").map(parseFloat);return y/=t.clientWidth,x/=t.clientHeight,i=function(t){if("currentCSSZoom"in t)return t.currentCSSZoom;for(var e=t,r=1;null!==e;)r*=+getComputedStyle(e).zoom,e=e.parentElement;return r}(t),s=t.clientWidth/r.width/i,l=t.clientHeight/r.height/i,c=e.left+e.width*y,d=e.top+e.height*x,u=r.left+r.width*y,p=r.top+r.height*x,h=(c-u)*s,g=(d-p)*l,f=e.width/r.width,m=e.height/r.height,{delay:w,duration:"function"==typeof v?v(Math.sqrt(h*h+g*g)):v,easing:b,css:(t,e)=>`transform: ${n} translate(${e*h}px, ${e*g}px) scale(${t+e*f}, ${t+e*m});`}}function Zr(t,e){function r(){N([])}function a(t=""){return!(!t&&!B())&&function(t){return void 0===z()||z()(t)}(t=""!==t?t.trim():B().trim())&&(-1===O()||N().length<O())&&function(t){return(-1===L()||t.length>=L())&&(-1===j()||t.length<=j())}(t)&&function(t){return 0===M().length||M().includes(t)}(t)&&function(t){return F()||!N().includes(t)}(t)}function o(t){t=R()?t:t.toLowerCase(),N().push(t),N(N()),et(ht).push({val:t,id:Math.random()}),A(ht,et(ht))}function n(t){let e=N().indexOf(t);N().splice(e,1),N(N()),et(ht).splice(e,1),A(ht,et(ht))}function i(t){A(pt,a(t)),!1!==et(pt)?(o(t),$("addManually",{chipIndex:N().length-1,chipValue:t})):$("invalidManually",{input:t})}function s(t){b.disabled||(n(t),$("removeManually",{chipValue:t}))}function l(){return delete b.class,b}var c,d,u,p,h,g,f,m,w;const v=mr(e,["children","$$slots","$$events","$$legacy"]),b=mr(v,["addChip","removeChip","input","name","value","whitelist","max","minlength","maxlength","allowUpperCase","allowDuplicates","validation","duration","required","chips","invalid","padding","rounded","regionChipWrapper","regionChipList","regionInput","label","transitions","listTransitionIn","listTransitionInParams","listTransitionOut","listTransitionOutParams","chipTransitionIn","chipTransitionInParams","chipTransitionOut","chipTransitionOutParams"]);lt(e,!1);const[y,x]=fr(),_=k(),S=k(),C=k(),I=k(),T=k(),$=kr();let B=br(e,"input",12,""),D=br(e,"name",8),N=br(e,"value",28,()=>[]),M=br(e,"whitelist",24,()=>[]),O=br(e,"max",24,()=>-1),L=br(e,"minlength",24,()=>-1),j=br(e,"maxlength",24,()=>-1),R=br(e,"allowUpperCase",8,!1),F=br(e,"allowDuplicates",8,!1),z=br(e,"validation",8,()=>!0),q=br(e,"duration",8,150),H=br(e,"required",8,!1),W=br(e,"chips",8,"variant-filled"),U=br(e,"invalid",8,"input-error"),G=br(e,"padding",8,"p-2"),Y=br(e,"rounded",8,"rounded-container-token"),V=br(e,"regionChipWrapper",8,""),J=br(e,"regionChipList",8,""),Q=br(e,"regionInput",8,""),X=br(e,"label",8,"Chips select"),K=br(e,"transitions",24,()=>!gr(cu,"$prefersReducedMotionStore",y)),Z=br(e,"listTransitionIn",8,Yr),tt=br(e,"listTransitionInParams",24,()=>({duration:150,opacity:0,y:-20})),at=br(e,"listTransitionOut",8,Yr),ot=br(e,"listTransitionOutParams",24,()=>({duration:150,opacity:0,y:-20})),nt=br(e,"chipTransitionIn",8,Jr),it=br(e,"chipTransitionInParams",24,()=>({duration:150,opacity:0})),st=br(e,"chipTransitionOut",8,Jr),ut=br(e,"chipTransitionOutParams",24,()=>({duration:150,opacity:0})),pt=k(!0),ht=k((null==(c=N())?void 0:c.map(t=>({val:t,id:Math.random()})))||[]),gt=k();xr(()=>{if(!et(gt).form)return;const t=et(gt).form;return t.addEventListener("reset",r),()=>{t.removeEventListener("reset",r)}}),Ot(()=>(et(pt),dt(U())),()=>{A(_,!1===et(pt)?U():"")}),Ot(()=>(dt(G()),dt(Y()),dt(v),et(_)),()=>{A(S,`textarea cursor-pointer ${G()} ${Y()} ${v.class??""} ${et(_)}`)}),Ot(()=>dt(V()),()=>{A(C,`space-y-4 ${V()}`)}),Ot(()=>dt(J()),()=>{A(I,`flex flex-wrap gap-2 ${J()}`)}),Ot(()=>dt(Q()),()=>{A(T,`unstyled bg-transparent border-0 !ring-0 p-0 w-full ${Q()}`)}),Ot(()=>(et(ht),dt(N())),()=>{var t;A(ht,(null==(t=N())?void 0:t.map((t,e)=>{var r;return(null==(r=et(ht)[e])?void 0:r.val)===t?et(ht)[e]:{id:Math.random(),val:t}}))||[])}),Lt(),ur(),u=St(d=Ji()),p=St(u),Rt(()=>{N(),function(t){var e,r=function(t){var e,r,a=pd;pd=new Set,e=pd;try{if(rt(t),null!==a)for(r of pd)a.add(r)}finally{pd=a}return e}(()=>rt(t));for(e of r)if(0!==(e.f&Dc))for(const t of e.deps||[])2&t.f||E(t,t.v);else E(e,e.v)}(()=>{et(gt),D(),H(),X()})}),Ae(p,5,N,_e,(t,e)=>{var r=Gi(),a={},o=St(r,!0);ft(r),Rt(()=>{a!==(a=et(e))&&(r.value=null==(r.__value=et(e))?"":et(e)),ve(o,et(e))}),we(t,r)}),ft(p),dr(p,t=>A(gt,t),()=>et(gt)),ft(u),h=Pt(u,2),Oe(g=St(h));const wt=P(l);let vt;return f=Pt(g,2),m=t=>{var r=Vi();Ae(r,15,()=>et(ht),({id:t,val:e})=>t,(t,r,a)=>{var o,i,s,l;let c=()=>et(r).val;o=Yi(),i=St(o),s=St(i),l=St(s,!0),ft(s),mt(2),ft(i),ft(o),Rt(()=>{qe(i,`chip ${W()??""}`),ve(l,c())}),le("click",i,t=>{return e=t,r=et(a),o=c(),void(b.disabled||(n(o),$("remove",{event:e,chipIndex:r,chipValue:o})));var e,r,o}),le("click",i,function(t){hr.call(this,e,t)}),le("keypress",i,function(t){hr.call(this,e,t)}),le("keydown",i,function(t){hr.call(this,e,t)}),le("keyup",i,function(t){hr.call(this,e,t)}),Xe(1,i,()=>Qr,()=>({transition:nt(),params:it(),enabled:K()})),Xe(2,i,()=>Qr,()=>({transition:st(),params:ut(),enabled:K()})),Qe(o,()=>Kr,()=>({duration:q()})),we(t,o)}),ft(r),Rt(()=>qe(r,`input-chip-list ${et(I)??""}`)),Xe(1,r,()=>Qr,()=>({transition:Z(),params:tt(),enabled:K()})),Xe(2,r,()=>Qr,()=>({transition:at(),params:ot(),enabled:K()})),we(t,r)},ke(f,t=>{et(ht).length&&t(m)}),ft(h),ft(d),Rt(()=>{qe(d,`input-chip ${et(S)??""}`),We(d,"opacity-50",b.disabled),je(p,"name",D()),p.required=H(),je(p,"aria-label",X()),qe(h,`input-chip-wrapper ${et(C)??""}`),vt=Re(g,vt,{type:"text",placeholder:b.placeholder??"Enter values...",class:`input-chip-field ${et(T)??""}`,disabled:b.disabled,...et(wt)})}),sr(p,N),Ze(g,B),le("keydown",g,function(t){"Enter"===t.key&&(t.preventDefault(),A(pt,a()),!1!==et(pt)?(o(B()),$("add",{event:t,chipIndex:N().length-1,chipValue:B()}),B("")):$("invalid",{event:t,input:B()}))}),le("input",g,function(t){hr.call(this,e,t)}),le("focus",g,function(t){hr.call(this,e,t)}),le("blur",g,function(t){hr.call(this,e,t)}),we(t,d),nr(e,"addChip",i),nr(e,"removeChip",s),w=ct({addChip:i,removeChip:s}),x(),w}function ta(t,e){function r(t){A(E,2*_*Math.PI),A(S,et(E)-t/100*et(E))}var a,o,n,i,s,l;const c=$e(e),d=mr(e,["children","$$slots","$$events","$$legacy"]);lt(e,!1);const u=k();let p=br(e,"value",24,()=>{}),h=br(e,"stroke",8,40),g=br(e,"font",8,56),f=br(e,"strokeLinecap",8,"butt"),m=br(e,"transition",8,"transition-[stroke-dashoffset]"),w=br(e,"width",8,"w-36"),v=br(e,"meter",8,"stroke-surface-900 dark:stroke-surface-50"),b=br(e,"track",8,"stroke-surface-500/30"),y=br(e,"fill",8,"fill-token"),x=br(e,"labelledby",8,"");const _=256-h()/2;let E=k(_),S=k();r(0),_r(()=>{r(void 0===p()?25:p())}),Ot(()=>(dt(w()),dt(d)),()=>{A(u,`progress-radial relative overflow-hidden ${w()} ${d.class??""}`)}),Lt(),ur(),je(a=os(),"aria-valuemin",0),je(a,"aria-valuemax",100),je(o=St(a),"viewBox","0 0 512 512"),je(n=St(o),"r",_),je(i=Pt(n),"r",_),s=Pt(i),l=t=>{var r=as();Te(St(r),e,"default",{},null),ft(r),Rt(()=>{je(r,"font-size",g()),ze(r,`progress-radial-text ${y()??""}`)}),we(t,r)},ke(s,t=>{null!=p()&&p()>=0&&c.default&&t(l)}),ft(o),ft(a),Rt(()=>{qe(a,`progress-radial ${et(u)??""}`),je(a,"aria-labelledby",x()),je(a,"aria-valuenow",p()||0),je(a,"aria-valuetext",p()?`${p()}%`:"Indeterminate Spinner"),We(o,"animate-spin",void 0===p()),ze(n,`progress-radial-track fill-transparent ${b()??""}`),je(n,"stroke-width",h()),ze(i,`progress-radial-meter fill-transparent -rotate-90 origin-[50%_50%] ${v()??""} ${m()??""}`),je(i,"stroke-width",h()),je(i,"stroke-linecap",f()),Ue(i,"stroke-dasharray",`${et(E)??""}\n\t\t\t${et(E)??""}`),Ue(i,"stroke-dashoffset",et(S))}),we(t,a),ct()}function ea(t,e){var r;const a=mr(e,["children","$$slots","$$events","$$legacy"]);lt(e,!1);const o=k();let n=br(e,"display",8,"inline-flex"),i=br(e,"flexDirection",8,"flex-row"),s=br(e,"gap",8,"gap-1"),l=br(e,"background",8,"bg-surface-200-700-token"),c=br(e,"border",8,"border-token border-surface-400-500-token"),d=br(e,"rounded",8,"rounded-token"),u=br(e,"padding",8,"px-4 py-1"),p=br(e,"active",8,"variant-filled"),h=br(e,"hover",8,"hover:variant-soft"),g=br(e,"color",8,""),f=br(e,"fill",8,""),m=br(e,"regionLabel",8,""),w=br(e,"labelledby",8,"");nt("rounded",d()),nt("padding",u()),nt("active",p()),nt("hover",h()),nt("color",g()),nt("fill",f()),nt("regionLabel",m()),Ot(()=>(dt(n()),dt(i()),dt(s()),dt(l()),dt(c()),dt(d()),dt(a)),()=>{A(o,`p-1 ${n()} ${i()} ${s()} ${l()} ${c()} ${d()} ${a.class??""}`)}),Lt(),ur(),Te(St(r=ns()),e,"default",{},null),ft(r),Rt(()=>{qe(r,`radio-group ${et(o)??""}`),je(r,"aria-labelledby",w())}),we(t,r),ct()}function ra(t,e){function r(){return delete l.class,l}var a,o,n,i;const s=mr(e,["children","$$slots","$$events","$$legacy"]),l=mr(s,["group","name","value","title","label","rounded","padding","active","hover","color","fill","regionLabel"]);lt(e,!1);const c=k(),d=k(),u=k(),p=k(),h=k();let g=br(e,"group",12),f=br(e,"name",8),m=br(e,"value",8),w=br(e,"title",8,""),v=br(e,"label",8,""),b=br(e,"rounded",24,()=>ot("rounded")),y=br(e,"padding",24,()=>ot("padding")),x=br(e,"active",24,()=>ot("active")),_=br(e,"hover",24,()=>ot("hover")),E=br(e,"color",24,()=>ot("color")),S=br(e,"fill",24,()=>ot("fill")),C=br(e,"regionLabel",24,()=>ot("regionLabel")),I=k();Ot(()=>(dt(m()),dt(g())),()=>{A(c,m()===g())}),Ot(()=>(et(c),dt(x()),dt(E()),dt(S()),dt(_())),()=>{A(d,et(c)?`${x()} ${E()} ${S()}`:_())}),Ot(()=>dt(s),()=>{A(u,s.disabled?"opacity-50 cursor-not-allowed":"")}),Ot(()=>{},()=>{A(p,"flex-auto")}),Ot(()=>(dt(y()),dt(b()),et(d),et(u),dt(s)),()=>{A(h,`text-base text-center cursor-pointer ${y()} ${b()} ${et(d)} ${et(u)} ${s.class??""}`)}),Lt(),ur(),a=is(),o=St(a),n=St(o),Oe(i=St(n));const T=P(r);let $;dr(i,t=>A(I,t),()=>et(I)),ft(n),Te(Pt(n,2),e,"default",{},null),ft(o),ft(a),Rt(()=>{qe(a,`radio-label ${et(p)??""} ${C()??""}`),qe(o,`radio-item ${et(h)??""}`),je(o,"aria-checked",et(c)),je(o,"aria-label",v()),je(o,"title",w()),$=Re(i,$,{type:"radio",name:f(),value:m(),...et(T),tabindex:"-1"})}),tr([],[],i,()=>(m(),g()),g),le("click",i,function(t){hr.call(this,e,t)}),le("change",i,function(t){hr.call(this,e,t)}),le("keydown",o,function(t){["Enter","Space"].includes(t.code)&&(t.preventDefault(),et(I).click())}),le("keydown",o,function(t){hr.call(this,e,t)}),le("keyup",o,function(t){hr.call(this,e,t)}),le("keypress",o,function(t){hr.call(this,e,t)}),we(t,a),ct()}function aa(t,e){function r(){0!=S()&&A(T,Array.from({length:_()-x()+1},(t,e)=>e+x()))}function a(){return delete f.class,f}var o,n,i,s,l,c,d,u,p;const h=$e(e),g=mr(e,["children","$$slots","$$events","$$legacy"]),f=mr(g,["name","id","value","min","max","step","ticked","accent","label"]);lt(e,!1);const m=k(),w=k();let v=br(e,"name",8),b=br(e,"id",24,()=>String(Math.random())),y=br(e,"value",12,0),x=br(e,"min",8,0),_=br(e,"max",8,100),E=br(e,"step",8,1),S=br(e,"ticked",8,!1),C=br(e,"accent",8,"accent-surface-900 dark:accent-surface-50"),I=br(e,"label",8,""),T=k();S()&&r(),_r(()=>{r()}),Ot(()=>dt(g),()=>{A(m,`space-y-2 ${g.class??""}`)}),Ot(()=>dt(C()),()=>{A(w,`w-full h-2 ${C()}`)}),Lt(),ur(),n=St(o=us()),i=t=>{var r=ss();qe(r,"range-slider-label "),Te(St(r),e,"default",{},null),ft(r),Rt(()=>je(r,"for",b())),we(t,r)},ke(n,t=>{h.default&&t(i)}),qe(s=Pt(n,2),"range-content flex justify-center py-2"),Oe(l=St(s));const $=P(a);let B;c=Pt(l,2),d=t=>{var e=cs();Ae(e,5,()=>et(T),_e,(t,e)=>{var r=ls(),a={};Rt(()=>{a!==(a=et(e))&&(r.value=null==(r.__value=et(e))?"":et(e)),je(r,"label",et(e))}),we(t,r)}),ft(e),Rt(()=>je(e,"id",`tickmarks-${b()??""}`)),we(t,e)},ke(c,t=>{S()&&et(T)&&et(T).length&&t(d)}),ft(s),u=Pt(s,2),p=t=>{var r=ds();Te(St(r),e,"trail",{},null),ft(r),we(t,r)},ke(u,t=>{h.trail&&t(p)}),ft(o),Rt(()=>{qe(o,`range-slider ${et(m)??""}`),B=Re(l,B,{type:"range",id:b(),name:v(),class:`range-slider-input ${et(w)??""}`,list:`tickmarks-${b()??""}`,"aria-label":I(),min:x(),max:_(),step:E(),...et($)})}),Ze(l,y),le("click",l,function(t){hr.call(this,e,t)}),le("change",l,function(t){hr.call(this,e,t)}),le("blur",l,function(t){hr.call(this,e,t)}),we(t,o),ct()}function oa(t,e){function r(){return delete p.class,p}var a,o,n,i,s,l,c;const d=$e(e),u=mr(e,["children","$$slots","$$events","$$legacy"]),p=mr(u,["name","checked","size","background","active","border","rounded","label"]);lt(e,!1);const h=k(),g=k(),f=k(),m=k(),w=k(),v=k(),b=k(),y=k(),x=kr();let _=br(e,"name",8),E=br(e,"checked",12,!1),S=br(e,"size",8,"md"),C=br(e,"background",8,"bg-surface-400 dark:bg-surface-700"),I=br(e,"active",8,"bg-surface-900 dark:bg-surface-300"),T=br(e,"border",8,""),$=br(e,"rounded",8,"rounded-full"),B=br(e,"label",8,""),D=k();switch(S()){case"sm":A(D,"w-12 h-6");break;case"lg":A(D,"w-20 h-10");break;default:A(D,"w-16 h-8")}Ot(()=>(dt(E()),dt(I()),dt(C())),()=>{A(h,E()?I():`${C()} cursor-pointer`)}),Ot(()=>dt(E()),()=>{A(g,E()?"bg-white/75":"bg-white")}),Ot(()=>dt(E()),()=>{A(f,E()?"translate-x-full":"")}),Ot(()=>dt(u),()=>{A(m,!0===u.disabled?"opacity-50":"hover:brightness-[105%] dark:hover:brightness-110 cursor-pointer")}),Ot(()=>(dt($()),et(m),dt(u)),()=>{A(w,`inline-block ${$()} ${et(m)} ${u.class??""}`)}),Ot(()=>{},()=>{A(v,"unstyled flex items-center")}),Ot(()=>(dt(T()),dt($()),et(D),et(h)),()=>{A(b,`flex transition-all duration-[200ms] cursor-pointer ${T()} ${$()} ${et(D)} ${et(h)}`)}),Ot(()=>(dt($()),et(g),et(f)),()=>{A(y,`w-[50%] h-full scale-[0.8] transition-all duration-[200ms] shadow ${$()} ${et(g)} ${et(f)}`)}),Lt(),ur(),a=hs(),o=St(a),Oe(n=St(o));const N=P(r);let M;i=Pt(n,2),s=St(i),ft(i),l=Pt(i,2),c=t=>{var r=ps();Te(St(r),e,"default",{},null),ft(r),we(t,r)},ke(l,t=>{d.default&&t(c)}),ft(o),ft(a),Rt(()=>{je(a,"id",B()),qe(a,`slide-toggle ${et(w)??""}`),je(a,"aria-label",B()),je(a,"aria-checked",E()),qe(o,`slide-toggle-label ${et(v)??""}`),M=Re(n,M,{type:"checkbox",class:"slide-toggle-input hidden",name:_(),...et(N),disabled:u.disabled}),qe(i,`slide-toggle-track ${et(b)??""}`),We(i,"cursor-not-allowed",u.disabled),qe(s,`slide-toggle-thumb ${et(y)??""}`),We(s,"cursor-not-allowed",u.disabled)}),er(n,E),le("click",n,function(t){hr.call(this,e,t)}),le("keydown",n,function(t){hr.call(this,e,t)}),le("keyup",n,function(t){hr.call(this,e,t)}),le("keypress",n,function(t){hr.call(this,e,t)}),le("mouseover",n,function(t){hr.call(this,e,t)}),le("change",n,function(t){hr.call(this,e,t)}),le("focus",n,function(t){hr.call(this,e,t)}),le("blur",n,function(t){hr.call(this,e,t)}),le("keydown",a,function(t){["Enter","Space"].includes(t.code)&&(t.preventDefault(),x("keyup",t),t.currentTarget.firstChild.click())}),we(t,a),ct()}function na(t,e){function r(){return delete h.class,h}var a,o,n,i,s,l,c,d;const u=$e(e),p=mr(e,["children","$$slots","$$events","$$legacy"]),h=mr(p,["group","name","value","title","controls","regionTab","active","hover","flex","padding","rounded","spacing"]);lt(e,!1);const g=k(),f=k(),m=k(),w=k(),v=k();let b=br(e,"group",12),y=br(e,"name",8),x=br(e,"value",8),_=br(e,"title",8,""),E=br(e,"controls",8,""),S=br(e,"regionTab",8,""),C=br(e,"active",24,()=>ot("active")),I=br(e,"hover",24,()=>ot("hover")),T=br(e,"flex",24,()=>ot("flex")),$=br(e,"padding",24,()=>ot("padding")),B=br(e,"rounded",24,()=>ot("rounded")),D=br(e,"spacing",24,()=>ot("spacing")),N=k();Ot(()=>(dt(x()),dt(b())),()=>{A(g,x()===b())}),Ot(()=>(et(g),dt(C()),dt(I())),()=>{A(f,et(g)?C():I())}),Ot(()=>(dt(T()),dt($()),dt(B()),et(f),dt(p)),()=>{A(m,`text-center cursor-pointer transition-colors duration-100 ${T()} ${$()} ${B()} ${et(f)} ${p.class??""}`)}),Ot(()=>dt(D()),()=>{A(w,` ${D()}`)}),Ot(()=>dt(S()),()=>{A(v,`${S()}`)}),Lt(),ur(),a=ws(),o=St(a),n=St(o),Oe(i=St(n));const M=P(r);let O;dr(i,t=>A(N,t),()=>et(N)),ft(n),l=St(s=Pt(n,2)),c=t=>{var r=ms();Te(St(r),e,"lead",{},null),ft(r),we(t,r)},ke(l,t=>{u.lead&&t(c)}),Te(St(d=Pt(l,2)),e,"default",{},null),ft(d),ft(s),ft(o),ft(a),Rt(()=>{qe(a,Me(et(m))),je(a,"title",_()),qe(o,`tab ${et(v)??""}`),je(o,"aria-controls",E()),je(o,"aria-selected",et(g)),je(o,"tabindex",et(g)?0:-1),O=Re(i,O,{type:"radio",name:y(),value:x(),...et(M),tabindex:"-1"}),qe(s,`tab-interface ${et(w)??""}`)}),tr([],[],i,()=>(x(),b()),b),le("click",i,function(t){hr.call(this,e,t)}),le("change",i,function(t){hr.call(this,e,t)}),le("keydown",o,function(t){if(["Enter","Space"].includes(t.code))t.preventDefault(),et(N).click();else if("ArrowRight"===t.code){const t=et(N).closest(".tab-list");if(!t)return;const e=Array.from(t.querySelectorAll(".tab")),r=et(N).closest(".tab");if(!r)return;const a=e.indexOf(r),o=e[a+1>=e.length?0:a+1],n=null==o?void 0:o.querySelector("input");o&&n&&(n.click(),o.focus())}else if("ArrowLeft"===t.code){const t=et(N).closest(".tab-list");if(!t)return;const e=Array.from(t.querySelectorAll(".tab")),r=et(N).closest(".tab");if(!r)return;const a=e.indexOf(r),o=e[a-1<0?e.length-1:a-1],n=null==o?void 0:o.querySelector("input");o&&n&&(n.click(),o.focus())}}),le("keydown",o,function(t){hr.call(this,e,t)}),le("keyup",o,function(t){hr.call(this,e,t)}),le("keypress",o,function(t){hr.call(this,e,t)}),we(t,a),ct()}function ia(t,e){var r,a,o;lt(e,!0);const[n,i]=fr();let s=br(e,"padding",3,"py-6 px-8"),l=br(e,"width",3,"w-full md:max-w-screen-sm lg:max-w-screen-md xl:max-w-screen-lg"),c=br(e,"height",3,""),d=br(e,"class",3,"");const u=C(()=>`${s()} ${l()} ${c()} ${d()}`),p=Rr();a=Ct(r=me()),o=t=>{var r,a,o=Bs(),n=St(o);!function(t,e,...r){var a,o=t,n=kc;Ft(()=>{n!==(n=e())&&(a&&(Ut(a),a=null),a=zt(()=>n(o,...r)))},Bc),md&&(o=fd)}(St(n),()=>e.children),ft(n),a=St(r=Pt(n,2)),Ie(St(a),()=>'<svg viewBox="0 0 98 96" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z"/></svg>'),ft(a),Pt(a,2).__click=function(...t){var r;null==(r=e.parent.onClose)||r.apply(this,t)},ft(r),ft(o),Rt(()=>qe(o,`relative rounded-container-token shadow-xl bg-scroll ${et(u)??""}`)),we(t,o)},ke(a,t=>{gr(p,"$modalStore",n)[0]&&t(o)}),we(t,r),ct(),i()}function sa(t,e){lt(e,!0);const r="leading-loose anchor underline-offset-2 focus:!outline-none focus:decoration-wavy";let a=y(!1);const o=C(()=>et(a)?"grid-rows-[1fr] mt-2":"grid-rows-[0fr]");ia(t,{get parent(){return e.parent},children:t=>{var e,n,i,s,l,c,d,u,p,h,g,f,m,w,v=Ns(),b=Ct(v);b.textContent="Pixiv Downloader 1.11.0",n=St(e=Pt(b,4)),qe(i=St(n),Me(r)),i.__click=[Ds,a],s=St(i,!0),Rt(()=>ve(s,gu("changelog.credit"))),ft(i),qe(l=Pt(i,2),Me(r)),c=St(l,!0),Rt(()=>ve(c,gu("changelog.feedback"))),ft(l),ft(n),u=St(d=Pt(n,2)),je(p=St(u),"src",uu),g=St(h=Pt(p,2)),f=St(g,!0),Rt(()=>ve(f,gu("changelog.give_me_a_star"))),ft(g),m=Pt(g,2),w=St(m,!0),Rt(()=>ve(w,gu("changelog.buy_me_a_drink"))),ft(m),ft(h),ft(u),ft(d),ft(e),Rt(()=>qe(d,`grid transition-[grid-template-rows] duration-[400ms] ${et(o)??""}`)),we(t,v)},$$slots:{default:!0}}),ct()}function la(t){if(zu.length){for(const[e]of zu)e(t);zu.length=0}}function ca(t){if(zu.length){for(const[,e]of zu)e(t);zu.length=0}}function da(t,e){if("dirHandle.picking"===t)return Ru="dirHandle.picking",void jd.emit("dirHandle.picking");if("dirHandle.unpick"===t)return Ru="dirHandle.unpick",void jd.emit("dirHandle.unpick");if(!e)throw new Error("directory handle should not be null.");Ru="dirHandle.picked",jd.emit("dirHandle.picked",e)}async function ua(t){const e={mode:"readwrite"};if("granted"===await t.queryPermission(e))return!0;if(navigator.userActivation.isActive){if("granted"===await t.requestPermission(e))return!0}else{"dirHandle.picking"!==Ru&&da("dirHandle.picking");const r=await new Promise(t=>{globalThis.dispatchEvent(new CustomEvent(Pu,{detail:{onAction(){t(!0)},onClosed(){t(!1)}}}))});if(!r)return da("dirHandle.picked",t),!1;const a=await t.requestPermission(e);if(da("dirHandle.picked",t),r&&"granted"===a)return!0}return!1}async function pa(t){try{"dirHandle.picking"!==Ru&&da("dirHandle.picking"),ju=await t(),da("dirHandle.picked",ju),la(ju),e=ju,zd.setDirectoryHandle(e)}catch(t){if(!ju)throw da("dirHandle.unpick"),ca(t),t;{Ld.warn(t);const e=await ua(ju);if(da("dirHandle.picked",ju),!e){const t=new Du;throw ca(t),t}la(ju)}}var e;return ju}async function ha(t,e,r,a){const o=await async function(t){if("dirHandle.unpick"===Ru){if(da("dirHandle.picking"),ju=await async function(){return await zd.getDirectoryHandle()??null}()){const t=await ua(ju);if(da("dirHandle.picked",ju),!t){const t=new Du;throw ca(t),t}return la(ju),ju}return await pa(()=>new Promise((e,r)=>{globalThis.dispatchEvent(new CustomEvent(Cu,{detail:{getFileHandle:async()=>{try{const t=await Ni.showDirectoryPicker({id:"pdl-dir-handle",mode:"readwrite"});e(t)}catch(t){r(t)}},abort:()=>r(new Tu)}})),null==t||t.addEventListener("abort",()=>{r(t.reason)},{once:!0}),zu.push([e,r])}))}if("dirHandle.picking"===Ru){const t=new Promise((t,e)=>{zu.push([t,e])});return await t}if(!ju)throw new Error("DirHandle should not be null.");if(!await ua(ju)){const t=new Du;throw ca(t),t}return ju}(a);null==a||a.throwIfAborted();let n=o,i=null,s=null;const l=r.lastIndexOf("/"),c=-1===l?r:r.slice(l+1);try{if(-1!==l){const t=r.slice(0,l).split("/");for(const e of t)n=await n.getDirectoryHandle(e,{create:!0})}i=await async function(t,e,r){if("overwrite"===r)return t.getFileHandle(e,{create:!0});if(!Fu.has(e)){Fu.add(e);try{await t.getFileHandle(e)}catch(r){return await t.getFileHandle(e,{create:!0})}finally{Fu.delete(e)}}if("prompt"===r)throw new DOMException("","NotFoundError");const a=e.lastIndexOf("."),o=e.slice(a+1),n=e.slice(0,a);for(let r=1;r<101;r++){const a=`${n} (${r}).${o}`;if(!Fu.has(a)){Fu.add(a);try{await t.getFileHandle(a)}catch(r){const o=await t.getFileHandle(a,{create:!0});return Ld.info(`Rename ${e}' to ${a}`),o}finally{Fu.delete(a)}}}const i=`${n} - ${(new Date).toISOString().replaceAll(":","")}.${o}`;return t.getFileHandle(i,{create:!0})}(n,c,t),s=await i.createWritable()}catch(t){if(!(t instanceof DOMException&&"NotFoundError"===t.name))throw t;null!==i&&n.removeEntry(i.name),i=await new Promise((t,e)=>{const o=c.lastIndexOf("."),i=c.slice(o+1),s=Lu.imageExt.test(i)?`image/${i}`:`video/${i}`;globalThis.dispatchEvent(new CustomEvent(Su,{detail:{signal:a,path:r,getFileHandle:async()=>{try{const e=await Ni.showSaveFilePicker({startIn:n,suggestedName:c,types:[{description:"Media",accept:{[s]:"."+i}}]});t(e)}catch(t){e(t)}},abort:()=>e(new Tu)}})),null==a||a.addEventListener("abort",()=>{e(a.reason)},{once:!0})})}try{s??(s=await i.createWritable()),await s.write(e),await s.close()}catch(t){throw n.removeEntry(i.name),t}}function ga(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}async function fa(){Ku.updateDirHandle()}function ma(e,r){var a,o,n,i,s,l,c,d,u,p,h,g,f,m,w,v,b,x,k,_,E,S,P,I,T,$,B,D,N,M,O,L,j,R,F,z;lt(r,!0);const[q,H]=fr();let W=br(r,"bg",3,"bg-white/30 dark:bg-black/15"),U=br(r,"border",3,"divide-y-[1px] *:border-surface-300-600-token"),G=br(r,"padding",3,"px-4 *:py-4"),Y=br(r,"margin",3,"mt-2 *:!m-0"),V=br(r,"rounded",3,"rounded-container-token *:!rounded-none"),J=br(r,"sectionSpace",19,()=>"space-y-4"),Q=br(r,"sectionTitle",3,"font-bold"),X=br(r,"class",3,""),K=br(r,"templates",19,()=>ot("supportedTemplate")),Z=br(r,"descriptionText",3,"text-sm text-surface-400");const rt=C(()=>`list *:items-center ${G()} ${Y()} ${U()} ${W()} ${V()} ${X()}`);let at,nt,it=y(vt(Zu.directoryTemplate)),st=y(vt(Zu.filenameTemplate));const dt=t.liveQuery(async()=>{var t;return(null==(t=await zd.getDirectoryHandle())?void 0:t.name)??""}),ut=C(()=>et(it)===Zu.directoryTemplate),pt=C(()=>et(st)===Zu.filenameTemplate),ht=C(()=>Zu.isSubpathSupported?gu("setting.save_to.placeholder.sub_directory_unused"):Mu.isViolentmonkey()?gu("setting.save_to.placeholder.vm_not_supported"):gu("setting.save_to.placeholder.need_browser_api"));o=St(a=xl()),n=St(o),i=St(n,!0),Rt(()=>ve(i,gu("setting.save_to.label.directory"))),ft(n),l=St(s=Pt(n,2)),c=St(l),(d=St(c)).__click=async function(){A(it,vt(Zu.directoryTemplate)),await tt();const t=et(it).length;at.focus(),at.setSelectionRange(t,t)},u=St(d),Ie(St(u),()=>'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z" /></svg>'),ft(u),ft(d),p=Pt(d,2),h=t=>{var e=hl();Oe(e),dr(e,t=>at=t,()=>at),Rt(()=>je(e,"placeholder",et(ht))),Ze(e,()=>et(it),t=>A(it,t)),we(t,e)},g=t=>{var e=gl();Rt(()=>je(e,"placeholder",et(ht))),we(t,e)},ke(p,t=>{Zu.isSubpathSupported?t(h):t(g,!1)}),(f=Pt(p,2)).__click=()=>A(it,vt(Zu.setDirectoryTemplate(et(it)))),m=St(f),Ie(St(m),()=>Ou),ft(m),ft(f),ft(c),Ae(w=Pt(c,2),21,()=>Object.entries(K()),_e,(t,e)=>{var r,a,o,n;r=fl(),a=C(()=>{return t=`{${et(e)[0]}}`,async()=>{const e=at.selectionStart,r=at.selectionEnd;A(it,et(it).slice(0,e)+t+et(it).slice(r)),await tt();const a=e+t.length;at.focus(),at.setSelectionRange(a,a)};var t}),r.__click=function(...t){var e;null==(e=et(a))||e.apply(this,t)},o=St(r),n=St(o,!0),ft(o),ft(r),Rt(()=>{r.disabled=!Zu.isSubpathSupported,ve(n,et(e)[1])}),we(t,r)}),ft(w),ft(l),b=St(v=Pt(l,2)),x=St(b,!0),Rt(()=>ve(x,gu("setting.save_to.options.use_fsa"))),ft(b),k=Pt(b,2),_=C(()=>!Mu.isFileSystemAccessAvaliable()),oa(k,{size:"sm",name:"fsa-enable",get disabled(){return et(_)},get checked(){return Zu.useFileSystemAccessApi},set checked(t){Zu.useFileSystemAccessApi=t}}),ft(v),E=Pt(v,2),S=t=>{var e,r,a,o,n,i,s,l=wl(),c=Ct(l),d=St(c),u=St(d,!0);Rt(()=>ve(u,gu("setting.save_to.options.fsa_directory"))),ft(d),e=Pt(d,2),r=St(e,!0),ft(e),(a=Pt(e,2)).__click=[fa],o=St(a,!0),Rt(()=>ve(o,gu("setting.save_to.button.choose_fsa_directory"))),ft(a),ft(c),i=St(n=Pt(c,2)),s=St(i,!0),Rt(()=>ve(s,gu("setting.save_to.options.fsa_filename_conflict"))),ft(i),ea(Pt(i,2),{class:"shrink-0",children:t=>{var e,r=ml(),a=Ct(r);ra(a,{name:"FilenameConflictAction",class:"text-sm",get value(){return dl.UNIQUIFY},get group(){return Zu.filenameConflictAction},set group(t){Zu.filenameConflictAction=t},children:t=>{mt();var e=fe();Rt(()=>ve(e,gu("setting.save_to.radio.filename_conflict_option_uniquify"))),we(t,e)},$$slots:{default:!0}}),ra(e=Pt(a,2),{name:"FilenameConflictAction",class:"text-sm",get value(){return dl.OVERWRITE},get group(){return Zu.filenameConflictAction},set group(t){Zu.filenameConflictAction=t},children:t=>{mt();var e=fe();Rt(()=>ve(e,gu("setting.save_to.radio.filename_conflict_option_overwrite"))),we(t,e)},$$slots:{default:!0}}),ra(Pt(e,2),{name:"FilenameConflictAction",class:"text-sm",get value(){return dl.PROMPT},get group(){return Zu.filenameConflictAction},set group(t){Zu.filenameConflictAction=t},children:t=>{mt();var e=fe();Rt(()=>ve(e,gu("setting.save_to.radio.filename_conflict_option_prompt"))),we(t,e)},$$slots:{default:!0}}),we(t,r)},$$slots:{default:!0}}),ft(n),Rt(()=>ve(r,gr(dt,"$directoryHandleStore",q))),we(t,l)},ke(E,t=>{Zu.useFileSystemAccessApi&&t(S)}),ft(s),ft(o),P=Pt(o,2),I=St(P),T=St(I,!0),Rt(()=>ve(T,gu("setting.save_to.label.filename"))),ft(I),B=St($=Pt(I,2)),D=St(B),(N=St(D)).__click=async function(){A(st,vt(Zu.filenameTemplate)),await tt();const t=et(st).length;nt.focus(),nt.setSelectionRange(t,t)},M=St(N),Ie(St(M),()=>'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z" /></svg>'),ft(M),ft(N),Oe(O=Pt(N,2)),Rt(()=>je(O,"placeholder",gu("setting.save_to.placeholder.filename_requried"))),dr(O,t=>nt=t,()=>nt),(L=Pt(O,2)).__click=()=>A(st,vt(Zu.setFilenameTemplate(et(st)))),j=St(L),Ie(St(j),()=>Ou),ft(j),ft(L),ft(D),Ae(R=Pt(D,2),21,()=>Object.entries(K()),_e,(t,e)=>{var r,a,o,n;r=vl(),a=C(()=>{return t=`{${et(e)[0]}}`,async()=>{const e=nt.selectionStart,r=nt.selectionEnd;A(st,et(st).slice(0,e)+t+et(st).slice(r)),await tt();const a=e+t.length;nt.focus(),nt.setSelectionRange(a,a)};var t}),r.__click=function(...t){var e;null==(e=et(a))||e.apply(this,t)},o=St(r),n=St(o,!0),ft(o),ft(r),Rt(()=>ve(n,et(e)[1])),we(t,r)}),ft(R),ft(B),F=Pt(B,2),z=t=>{var e,r,a=yl(),o=St(a),n=St(o),i=St(n,!0);Rt(()=>ve(i,gu("setting.save_to.options.tag_language"))),ft(n),e=Pt(n,2),r=St(e,!0),Rt(()=>ve(r,gu("setting.save_to.options.tag_language_tips"))),ft(e),ft(o),ea(Pt(o,2),{class:" shrink-0",children:t=>{var e,r,a=bl(),o=Ct(a);ra(o,{name:"tagLang",class:"text-sm",get value(){return pl.JAPANESE},get group(){return tp.tagLocale},set group(t){tp.tagLocale=t},children:t=>{mt(),we(t,fe("日本語"))},$$slots:{default:!0}}),ra(e=Pt(o,2),{name:"tagLang",class:"text-sm",get value(){return pl.CHINESE},get group(){return tp.tagLocale},set group(t){tp.tagLocale=t},children:t=>{mt(),we(t,fe("简中"))},$$slots:{default:!0}}),ra(r=Pt(e,2),{name:"tagLang",class:"text-sm",get value(){return pl.TRADITIONAL_CHINESE},get group(){return tp.tagLocale},set group(t){tp.tagLocale=t},children:t=>{mt(),we(t,fe("繁中"))},$$slots:{default:!0}}),ra(Pt(r,2),{name:"tagLang",class:"text-sm",get value(){return pl.ENGLISH},get group(){return tp.tagLocale},set group(t){tp.tagLocale=t},children:t=>{mt(),we(t,fe("En"))},$$slots:{default:!0}}),we(t,a)},$$slots:{default:!0}}),ft(a),Rt(()=>qe(e,Me(Z()))),we(t,a)},ke(F,t=>{Mu.isPixiv()&&t(z)}),ft($),ft(P),ft(a),Rt(()=>{qe(a,Me(J())),qe(n,Me(Q())),qe(s,Me(et(rt))),d.disabled=et(ut),f.disabled=et(ut),qe(I,Me(Q())),qe($,Me(et(rt))),N.disabled=et(pt),L.disabled=et(pt)}),Ze(O,()=>et(st),t=>A(st,t)),we(e,a),ct(),H()}function wa(t,e){var r,a,o,n,i,s,l,c,d,u,p,h,g,f,m,w,v,b,y,x,k,_,A,E,S,P,I,T,$,B,D,N,M,O,L,j,R,F,z,q,H,W,U,G,Y,V,J,Q,X;lt(e,!0);let K=br(e,"bg",3,"bg-white/30 dark:bg-black/15"),Z=br(e,"border",3,"divide-y-[1px] *:border-surface-300-600-token"),tt=br(e,"padding",3,"px-4 *:py-4"),rt=br(e,"margin",3,"mt-2 *:!m-0"),at=br(e,"rounded",3,"rounded-container-token *:!rounded-none"),ot=br(e,"sectionSpace",19,()=>"space-y-4"),nt=br(e,"sectionTitle",3,"font-bold"),it=br(e,"class",3,""),st=br(e,"descriptionText",3,"text-sm text-surface-400"),dt=br(e,"inputRounded",3,"rounded-full"),ut=br(e,"inputWidth",3,"w-32");const pt=C(()=>`list *:items-center ${tt()} ${rt()} ${Z()} ${K()} ${at()} ${it()}`),ht=C(()=>`${ut()} ${dt()} shrink-0`);a=St(r=El()),o=St(a),n=St(o,!0),Rt(()=>ve(n,gu("setting.ugoira.label.format"))),ft(o),s=St(i=Pt(o,2)),l=St(s),c=St(l,!0),Rt(()=>ve(c,gu("setting.ugoira.options.select_format"))),ft(l),ea(Pt(l,2),{class:"shrink-0",children:t=>{var e,r,a,o,n,i=kl(),s=Ct(i);ra(s,{name:"ugoiraFormat",class:"text-sm",value:"zip",get group(){return tp.ugoiraFormat},set group(t){tp.ugoiraFormat=t},children:t=>{mt(),we(t,fe("Zip"))},$$slots:{default:!0}}),ra(e=Pt(s,2),{name:"ugoiraFormat",class:"text-sm",get value(){return Ei.WEBM},get group(){return tp.ugoiraFormat},set group(t){tp.ugoiraFormat=t},children:t=>{mt(),we(t,fe("Webm"))},$$slots:{default:!0}}),r=Pt(e,2),a=C(()=>!Mu.videoFrameSupported()),ra(r,{get disabled(){return et(a)},class:"text-sm",name:"ugoiraFormat",get value(){return Ei.MP4},get group(){return tp.ugoiraFormat},set group(t){tp.ugoiraFormat=t},children:t=>{mt(),we(t,fe("Mp4"))},$$slots:{default:!0}}),ra(o=Pt(r,2),{name:"ugoiraFormat",class:"text-sm",get value(){return Ei.WEBP},get group(){return tp.ugoiraFormat},set group(t){tp.ugoiraFormat=t},children:t=>{mt(),we(t,fe("Webp"))},$$slots:{default:!0}}),ra(n=Pt(o,2),{name:"ugoiraFormat",class:"text-sm",get value(){return Ei.GIF},get group(){return tp.ugoiraFormat},set group(t){tp.ugoiraFormat=t},children:t=>{mt(),we(t,fe("Gif"))},$$slots:{default:!0}}),ra(Pt(n,2),{name:"ugoiraFormat",class:"text-sm",get value(){return Ei.PNG},get group(){return tp.ugoiraFormat},set group(t){tp.ugoiraFormat=t},children:t=>{mt(),we(t,fe("Png"))},$$slots:{default:!0}}),we(t,i)},$$slots:{default:!0}}),ft(s),ft(i),ft(a),d=Pt(a,2),u=St(d),p=St(u,!0),Rt(()=>ve(p,gu("setting.ugoira.label.quality"))),ft(u),g=St(h=Pt(u,2)),f=St(g),m=Pt(St(f),2),ft(f),De(w=Pt(f,2),(t,e)=>null==bu?void 0:bu(t,e),()=>({get:()=>ep.webmBitrate,set(t){ep.webmBitrate=t}})),ft(g),b=St(v=Pt(g,2)),y=Pt(St(b),2),ft(b),De(x=Pt(b,2),(t,e)=>null==bu?void 0:bu(t,e),()=>({get:()=>ep.mp4Bitrate,set(t){ep.mp4Bitrate=t}})),ft(v),k=Pt(v,2),_=Pt(St(k),2),A=St(_),E=St(A),S=St(E,!0),Rt(()=>ve(S,gu("setting.ugoira.options.webp_lossy"))),ft(E),oa(Pt(E,2),{name:"lossless-webp",size:"sm",get checked(){return ep.losslessWebp},set checked(t){ep.losslessWebp=t}}),ft(A),I=St(P=Pt(A,2)),T=St(I),$=St(T,!0),Rt(()=>ve($,gu("setting.ugoira.options.webp_quality"))),ft(T),B=Pt(T,2),D=St(B,!0),Rt(()=>ve(D,gu("setting.ugoira.options.webp_quality_tips"))),ft(B),ft(I),De(N=Pt(I,2),(t,e)=>null==bu?void 0:bu(t,e),()=>({get:()=>ep.webpQuality,set(t){ep.webpQuality=t}})),ft(P),O=St(M=Pt(P,2)),L=St(O),j=St(L,!0),Rt(()=>ve(j,gu("setting.ugoira.options.webp_method"))),ft(L),R=Pt(L,2),F=St(R,!0),Rt(()=>ve(F,gu("setting.ugoira.options.webp_method_tips"))),ft(R),ft(O),Ae(z=Pt(O,2),20,()=>Array.from({length:7},(t,e)=>e),_e,(t,e)=>{var r=_l(),a={},o=St(r,!0);ft(r),Rt(()=>{a!==(a=e)&&(r.value=null==(r.__value=e)?"":e),ve(o,e)}),we(t,r)}),ft(z),ft(M),ft(_),ft(k),H=St(q=Pt(k,2)),W=Pt(St(H),2),U=St(W,!0),Rt(()=>ve(U,gu("setting.ugoira.options.gif_tips"))),ft(W),ft(H),Ae(G=Pt(H,2),20,()=>Array.from({length:20},(t,e)=>e),_e,(t,e)=>{var r=Al(),a={},o=St(r,!0);ft(r),Rt(()=>{a!==(a=e+1)&&(r.value=null==(r.__value=e+1)?"":e+1),ve(o,e+1)}),we(t,r)}),ft(G),ft(q),V=St(Y=Pt(q,2)),J=Pt(St(V),2),Q=St(J,!0),Rt(()=>ve(Q,gu("setting.ugoira.options.png_tips"))),ft(J),ft(V),De(X=Pt(V,2),(t,e)=>null==bu?void 0:bu(t,e),()=>({get:()=>ep.pngColor,set(t){ep.pngColor=t}})),ft(Y),ft(h),ft(d),ft(r),Rt(()=>{qe(r,Me(ot())),qe(o,Me(nt())),qe(i,Me(et(pt))),qe(u,Me(nt())),qe(h,Me(et(pt))),qe(m,Me(st())),qe(w,`input ${et(ht)??""}`),qe(y,Me(st())),qe(x,`input ${et(ht)??""}`),qe(_,`list ${Z()??""} ${at()??""} [&:not(:last-child)]:*:py-4 [&:last-child]:*:pt-4`),qe(B,Me(st())),qe(N,`input ${et(ht)??""}`),qe(R,Me(st())),qe(z,`select ${et(ht)??""}`),qe(W,Me(st())),qe(G,`select ${et(ht)??""}`),qe(J,Me(st())),qe(X,`input ${et(ht)??""}`)}),sr(z,()=>ep.webpMehtod,t=>ep.webpMehtod=t),sr(G,()=>ep.gifQuality,t=>ep.gifQuality=t),we(t,r),ct()}function va(t){return function(t,e){return new Promise(t=>{if("application/json"!==e.type)throw new Error("Invalid file");const r=new FileReader;r.readAsText(e),r.onload=e=>{var r;const a=null==(r=e.target)?void 0:r.result;if("string"!=typeof a)throw new Error("Invalid file");const o=JSON.parse(a);if(!(o instanceof Array))throw new Error("Invalid file");t(o)}})}(0,t).then(t=>zd.import(t))}function ba(){return zd.getAll().then(t=>{const e=JSON.stringify(t);Nr(new Blob([e],{type:"application/json"}),`Pixiv Downloader_${location.hostname}_${(new Date).toLocaleString()}.json`)})}function ya(){return zd.generateCsv().then(t=>{Nr(t,`Pixiv Downloader_${location.hostname}_${(new Date).toLocaleString()}.csv`)})}function xa(){return{importJSON:va,exportAsJSON:ba,exportAsCSV:ya}}function ka(t,e){function r(t){const e=Sr(!1);return{store:e,async wrapFn(...r){e.set(!0);const a=await t(...r);return e.set(!1),a}}}var a,o,n,i,s,l,c,d,u,p,h,g,f,m,w,v,b,y,x,_,E,S,I,T,$,B,D,N,M,O,L,j,R,F,z,q,H,W,U,G,Y,V,J,Q,X,K,Z,tt,rt,at,ot,nt,it,st,ut,pt,ht,gt,mt,wt;lt(e,!0);const[bt,yt]=fr(),xt=()=>gr(Xt,"$exportJsonPending",bt),kt=()=>gr(Zt,"$exportCsvPending",bt),_t=()=>gr(Yt,"$importPending",bt),At=()=>gr(Jt,"$clearPending",bt);let Et=br(e,"bg",3,"bg-white/30 dark:bg-black/15"),It=br(e,"border",3,"divide-y-[1px] *:border-surface-300-600-token"),Tt=br(e,"padding",3,"px-4 *:py-4"),$t=br(e,"margin",3,"mt-2 *:!m-0"),Bt=br(e,"rounded",3,"rounded-container-token *:!rounded-none"),Dt=br(e,"sectionSpace",19,()=>"space-y-4"),Nt=br(e,"sectionTitle",3,"font-bold"),Mt=br(e,"inputRounded",3,"rounded-full"),Ft=br(e,"inputWidth",3,"w-32"),zt=br(e,"class",3,"");const qt=C(()=>`list *:items-center ${Tt()} ${$t()} ${It()} ${Et()} ${Bt()} ${zt()}`),Ht=C(()=>`${Ft()} ${Mt()} shrink-0`),{importJSON:Wt,exportAsJSON:Ut,exportAsCSV:Gt}=xa(),{store:Yt,wrapFn:Vt}=r(async function(t){var e;const r=null==(e=t.currentTarget.files)?void 0:e[0];if(r)try{await Wt(r)}catch(t){Ld.error(t),alert(t)}}),{store:Jt,wrapFn:Qt}=r(function(){if(confirm(gu("setting.history.text.confirm_clear_history")))return zd.clear()}),{store:Xt,wrapFn:Kt}=r(Ut),{store:Zt,wrapFn:te}=r(Gt);o=St(a=Pl()),n=St(o),i=St(n,!0),Rt(()=>ve(i,gu("setting.history.label.scheduled_backups"))),ft(n),l=St(s=Pt(n,2)),c=St(l),d=St(c,!0),Rt(()=>ve(d,gu("setting.history.options.scheduled_backups"))),ft(c),u=Pt(c,2),p=St(u),h={},g=St(p,!0),Rt(()=>ve(g,gu("setting.history.select.backup_interval_never"))),ft(p),f=Pt(p),m={},w=St(f,!0),Rt(()=>ve(w,gu("setting.history.select.backup_interval_every_day"))),ft(f),v=Pt(f),b={},y=St(v,!0),Rt(()=>ve(y,gu("setting.history.select.backup_interval_every_7_day"))),ft(v),x=Pt(v),_={},E=St(x,!0),Rt(()=>ve(E,gu("setting.history.select.backup_interval_every_30_day"))),ft(x),ft(u),ft(l),ft(s),ft(o),S=Pt(o,2),I=St(S),T=St(I,!0),Rt(()=>ve(T,gu("setting.history.label.export"))),ft(I),B=St($=Pt(I,2)),D=St(B),N=St(D,!0),Rt(()=>ve(N,gu("setting.history.options.export_as_json"))),ft(D),(M=Pt(D,2)).__click=async()=>{await Kt(),rp.lastTimestamp=(new Date).getTime()},O=St(M),L=t=>{ta(t,{stroke:80,width:"w-5",meter:"stroke-primary-500",track:"stroke-primary-500/30"})},ke(O,t=>{xt()&&t(L)}),j=Pt(O,2),R=St(j,!0),Rt(()=>ve(R,gu("setting.history.button.export"))),ft(j),ft(M),ft(B),z=St(F=Pt(B,2)),q=St(z,!0),Rt(()=>ve(q,gu("setting.history.options.export_as_csv"))),ft(z),(H=Pt(z,2)).__click=te,W=St(H),U=t=>{ta(t,{stroke:80,width:"w-5",meter:"stroke-primary-500",track:"stroke-primary-500/30"})},ke(W,t=>{kt()&&t(U)}),G=Pt(W,2),Y=St(G,!0),Rt(()=>ve(Y,gu("setting.history.button.export"))),ft(G),ft(H),ft(F),ft($),ft(S),V=Pt(S,2),J=St(V),Q=St(J,!0),Rt(()=>ve(Q,gu("setting.history.label.import"))),ft(J),K=St(X=Pt(J,2)),Z=St(K),tt=St(Z,!0),Rt(()=>ve(tt,gu("setting.history.options.import_json"))),ft(Z),function(t,e){function r(){return delete l.class,l}var a,o,n,i;const s=mr(e,["children","$$slots","$$events","$$legacy"]),l=mr(s,["files","fileInput","name","width","button"]);lt(e,!1);const c=k(),d=k();let u=br(e,"files",28,()=>{}),p=br(e,"fileInput",28,()=>{}),h=br(e,"name",8),g=br(e,"width",8,""),f=br(e,"button",8,"btn variant-filled");Ot(()=>dt(s),()=>{A(c,`${s.class??""}`)}),Ot(()=>(dt(f()),dt(g())),()=>{A(d,`${f()} ${g()}`)}),Lt(),ur(),o=St(a=Ui()),Oe(n=St(o));const m=P(r);let w;dr(n,t=>p(t),()=>p()),ft(o),Te(St(i=Pt(o,2)),e,"default",{},t=>{we(t,fe("Select a File"))}),ft(i),ft(a),Rt(()=>{qe(a,`file-button ${et(c)??""}`),w=Re(n,w,{type:"file",name:h(),...et(m)}),qe(i,`file-button-btn ${et(d)??""}`),i.disabled=l.disabled}),function(t,e,r=e){ne(t,"change",()=>{r(t.files)}),jt(()=>{t.files=e()})}(n,u),le("change",n,function(t){hr.call(this,e,t)}),le("click",i,function(){p()&&p().click()}),le("keydown",i,function(t){hr.call(this,e,t)}),le("keyup",i,function(t){hr.call(this,e,t)}),le("keypress",i,function(t){hr.call(this,e,t)}),we(t,a),ct()}(Pt(Z,2),{name:"import-file",accept:".json",get disabled(){return Td=!0,_t()},set disabled(t){var e,r;e=Yt,r=vt(t),e.set(r)},$$events:{change:Vt},children:t=>{var e,r,a=Cl(),o=Ct(a),n=t=>{ta(t,{stroke:80,width:"w-5",meter:"stroke-primary-500",track:"stroke-primary-500/30"})};ke(o,t=>{_t()&&t(n)}),e=Pt(o,2),r=St(e,!0),Rt(()=>ve(r,gu("setting.history.button.import"))),ft(e),we(t,a)},$$slots:{default:!0}}),ft(K),ft(X),ft(V),rt=Pt(V,2),at=St(rt),ot=St(at,!0),Rt(()=>ve(ot,gu("setting.history.label.clear"))),ft(at),it=St(nt=Pt(at,2)),st=St(it),ut=St(st,!0),Rt(()=>ve(ut,gu("setting.history.options.clear_history"))),ft(st),(pt=Pt(st,2)).__click=Qt,ht=St(pt),gt=t=>{ta(t,{stroke:80,width:"w-5",meter:"stroke-primary-500",track:"stroke-primary-500/30"})},ke(ht,t=>{At()&&t(gt)}),mt=Pt(ht,2),wt=St(mt,!0),Rt(()=>ve(wt,gu("setting.history.button.clear"))),ft(mt),ft(pt),ft(it),ft(nt),ft(rt),ft(a),Rt(()=>{qe(a,Me(Dt())),qe(n,Me(Nt())),qe(s,Me(et(qt))),qe(u,`select ${et(Ht)??""}`),h!==(h=Sl.NEVER)&&(p.value=null==(p.__value=Sl.NEVER)?"":Sl.NEVER),m!==(m=Sl.EVERY_DAY)&&(f.value=null==(f.__value=Sl.EVERY_DAY)?"":Sl.EVERY_DAY),b!==(b=Sl.EVERY_7_DAY)&&(v.value=null==(v.__value=Sl.EVERY_7_DAY)?"":Sl.EVERY_7_DAY),_!==(_=Sl.EVERY_30_DAY)&&(x.value=null==(x.__value=Sl.EVERY_30_DAY)?"":Sl.EVERY_30_DAY),qe(I,Me(Nt())),qe($,Me(et(qt))),M.disabled=xt(),H.disabled=kt(),qe(J,Me(Nt())),qe(X,Me(et(qt))),qe(at,Me(Nt())),qe(nt,Me(et(qt))),pt.disabled=At()}),sr(u,()=>rp.interval,t=>rp.interval=t),we(t,a),ct(),yt()}function _a(t,e){var r,a,o,n,i,s,l,c,d,u,p,h,g,f,m,w,v,b,y,x,k,_,A,E,S,P,I,T,$,B,D,N,M,O,L,j,R;lt(e,!0);let F=br(e,"bg",3,"bg-white/30 dark:bg-black/15"),z=br(e,"border",3,"divide-y-[1px] *:border-surface-300-600-token"),q=br(e,"padding",3,"px-4 *:py-4"),H=br(e,"margin",3,"mt-2 *:!m-0"),W=br(e,"rounded",3,"rounded-container-token *:!rounded-none"),U=br(e,"sectionSpace",19,()=>"space-y-4"),G=br(e,"sectionTitle",3,"font-bold"),Y=br(e,"class",3,"");const V=C(()=>`list *:items-center ${q()} ${H()} ${z()} ${F()} ${W()} ${Y()}`),J=100;let Q;xr(()=>{const t=new Hd({id:"0",shouldObserveDb:!1,onClick:()=>{}});if(t.setAttribute("disabled",""),Q.appendChild(t),!Mu.isPixiv())return;const e=new Hd({id:"0",type:Ai.PixivMyBookmark,shouldObserveDb:!1,onClick:()=>{}});e.setAttribute("disabled",""),e.setStatus(_i.Complete),Q.appendChild(e)}),a=St(r=ql()),dr(o=St(a),t=>Q=t,()=>Q),ft(a),n=Pt(a,2),i=St(n),s=St(i,!0),Rt(()=>ve(s,gu("setting.button_position.label.common"))),ft(i),c=St(l=Pt(i,2)),d=St(c),u=St(d),p=St(u),h=St(p,!0),Rt(()=>ve(h,gu("setting.button_position.options.horizontal_position"))),ft(p),ea(Pt(p,2),{children:t=>{var e=Il(),r=Ct(e);ra(r,{name:"thumbnail-btn-unit-x",get value(){return Ci.PERCENT},class:" text-xs",get group(){return ru.thumbnailBtnUnitX},set group(t){ru.thumbnailBtnUnitX=t},children:t=>{mt(),we(t,fe("%"))},$$slots:{default:!0}}),ra(Pt(r,2),{name:"thumbnail-btn-unit-x",get value(){return Ci.PX},class:" text-xs",get group(){return ru.thumbnailBtnUnitX},set group(t){ru.thumbnailBtnUnitX=t},children:t=>{mt(),we(t,fe("px"))},$$slots:{default:!0}}),we(t,e)},$$slots:{default:!0}}),ft(u),f=St(g=Pt(u,2)),m=t=>{var e,r,a=Tl(),o=Ct(a);o.__click=()=>ru["--pdl-btn-left-px"]+=1,De(e=Pt(o,2),(t,e)=>null==bu?void 0:bu(t,e),()=>({get:()=>ru["--pdl-btn-left-px"],set(t){ru["--pdl-btn-left-px"]=t}})),(r=Pt(e,2)).__click=()=>ru["--pdl-btn-left-px"]-=1,Rt(()=>r.disabled=ru["--pdl-btn-left-px"]<1),we(t,a)},w=t=>{aa(t,{name:"thumbnail-btn-left",step:4,max:J,ticked:!0,class:" flex-grow self-center",get value(){return ru[Si.LEFT_PERCENT]},set value(t){ru[Si.LEFT_PERCENT]=t}})},ke(f,t=>{ru.thumbnailBtnUnitX===Ci.PX?t(m):t(w,!1)}),ft(g),ft(d),b=St(v=Pt(d,2)),y=St(b),x=St(y,!0),Rt(()=>ve(x,gu("setting.button_position.options.vertical_position"))),ft(y),ea(Pt(y,2),{children:t=>{var e=$l(),r=Ct(e);ra(r,{name:"thumbnail-btn-unit-y",get value(){return Ci.PERCENT},class:" text-xs",get group(){return ru.thumbnailBtnUnitY},set group(t){ru.thumbnailBtnUnitY=t},children:t=>{mt(),we(t,fe("%"))},$$slots:{default:!0}}),ra(Pt(r,2),{name:"thumbnail-btn-unit-y",get value(){return Ci.PX},class:" text-xs",get group(){return ru.thumbnailBtnUnitY},set group(t){ru.thumbnailBtnUnitY=t},children:t=>{mt(),we(t,fe("px"))},$$slots:{default:!0}}),we(t,e)},$$slots:{default:!0}}),ft(b),_=St(k=Pt(b,2)),A=t=>{var e,r,a=Bl(),o=Ct(a);o.__click=()=>ru["--pdl-btn-top-px"]+=1,De(e=Pt(o,2),(t,e)=>null==bu?void 0:bu(t,e),()=>({get:()=>ru["--pdl-btn-top-px"],set(t){ru["--pdl-btn-top-px"]=t}})),(r=Pt(e,2)).__click=()=>ru["--pdl-btn-top-px"]-=1,Rt(()=>r.disabled=ru["--pdl-btn-top-px"]<1),we(t,a)},E=t=>{aa(t,{name:"thumbnail-btn-top",step:4,max:J,ticked:!0,class:" flex-grow self-center",get value(){return ru[Si.TOP_PERCENT]},set value(t){ru[Si.TOP_PERCENT]=t}})},ke(_,t=>{ru.thumbnailBtnUnitY===Ci.PX?t(A):t(E,!1)}),ft(k),ft(v),ft(c),ft(l),ft(n),S=Pt(n,2),P=t=>{var e,r,a,o=Ml(),n=St(o),i=St(n,!0);Rt(()=>ve(i,gu("setting.button_position.label.my_bookmark"))),ft(n),r=St(e=Pt(n,2)),aa(a=St(r),{name:"pdl-bookmark-btn-left",step:4,max:J,ticked:!0,class:"flex-grow",get value(){return ru[Si.PIXIV_BOOKMARK_LEFT_PERCENT]},set value(t){ru[Si.PIXIV_BOOKMARK_LEFT_PERCENT]=t},children:t=>{var e,r,a=Dl(),o=St(a),n=St(o,!0);Rt(()=>ve(n,gu("setting.button_position.options.horizontal_position"))),ft(o),e=Pt(o,2),r=St(e),ft(e),ft(a),Rt(()=>ve(r,`${ru[Si.PIXIV_BOOKMARK_LEFT_PERCENT]??""} / 100`)),we(t,a)},$$slots:{default:!0}}),aa(Pt(a,2),{name:"pdl-bookmark-btn-top",step:4,max:J,ticked:!0,class:"flex-grow",get value(){return ru[Si.PIXIV_BOOKMARK_TOP_PERCENT]},set value(t){ru[Si.PIXIV_BOOKMARK_TOP_PERCENT]=t},children:t=>{var e,r,a=Nl(),o=St(a),n=St(o,!0);Rt(()=>ve(n,gu("setting.button_position.options.vertical_position"))),ft(o),e=Pt(o,2),r=St(e),ft(e),ft(a),Rt(()=>ve(r,`${ru[Si.PIXIV_BOOKMARK_TOP_PERCENT]??""} / 100`)),we(t,a)},$$slots:{default:!0}}),ft(r),ft(e),ft(o),Rt(()=>{qe(n,Me(G())),qe(e,Me(et(V)))}),we(t,o)},ke(S,t=>{Mu.isPixiv()&&t(P)}),I=Pt(S,2),T=St(I),$=St(T,!0),Rt(()=>ve($,gu("setting.button_position.label.gallery"))),ft(T),D=St(B=Pt(T,2)),N=St(D),M=St(N),O=St(M,!0),Rt(()=>ve(O,gu("setting.button_position.options.horizontal_alignment"))),ft(M),ea(Pt(M,2),{children:t=>{var e=jl(),r=Ct(e);ra(r,{name:"artwork-align-x",get value(){return Pi.LEFT},class:" text-xs",get group(){return ru.artworkBtnAlignX},set group(t){ru.artworkBtnAlignX=t},children:t=>{var e=Ol();Ie(St(e),()=>'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-align-left-icon lucide-align-left"><path d="M15 12H3"/><path d="M17 18H3"/><path d="M21 6H3"/></svg>'),ft(e),we(t,e)},$$slots:{default:!0}}),ra(Pt(r,2),{name:"artwork-align-x",get value(){return Pi.RIGHT},class:" text-xs",get group(){return ru.artworkBtnAlignX},set group(t){ru.artworkBtnAlignX=t},children:t=>{var e=Ll();Ie(St(e),()=>'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-align-right-icon lucide-align-right"><path d="M21 12H9"/><path d="M21 18H7"/><path d="M21 6H3"/></svg>'),ft(e),we(t,e)},$$slots:{default:!0}}),we(t,e)},$$slots:{default:!0}}),ft(N),j=St(L=Pt(N,2)),R=St(j,!0),Rt(()=>ve(R,gu("setting.button_position.options.vertical_alignment"))),ft(j),ea(Pt(j,2),{children:t=>{var e=zl(),r=Ct(e);ra(r,{name:"artwork-align-y",get value(){return Ii.TOP},class:" text-xs",get group(){return ru.artworkBtnAlignY},set group(t){ru.artworkBtnAlignY=t},children:t=>{var e=Rl();Ie(St(e),()=>'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-align-start-horizontal-icon lucide-align-start-horizontal"><rect width="6" height="16" x="4" y="6" rx="2"/><rect width="6" height="9" x="14" y="6" rx="2"/><path d="M22 2H2"/></svg>'),ft(e),we(t,e)},$$slots:{default:!0}}),ra(Pt(r,2),{name:"artwork-align-y",get value(){return Ii.BOTTOM},class:" text-xs",get group(){return ru.artworkBtnAlignY},set group(t){ru.artworkBtnAlignY=t},children:t=>{var e=Fl();Ie(St(e),()=>'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-align-end-horizontal-icon lucide-align-end-horizontal"><rect width="6" height="16" x="4" y="2" rx="2"/><rect width="6" height="9" x="14" y="9" rx="2"/><path d="M22 22H2"/></svg>'),ft(e),we(t,e)},$$slots:{default:!0}}),we(t,e)},$$slots:{default:!0}}),ft(L),ft(D),ft(B),ft(I),ft(r),Rt(()=>{qe(r,Me(U())),qe(o,`w-48 h-48 backdrop-blur-sm rounded-lg relative overflow-hidden ${F()??""}`),qe(i,Me(G())),qe(l,Me(et(V))),qe(T,Me(G())),qe(B,Me(et(V)))}),we(t,r),ct()}function Aa(t,e){var r,a,o,n,i,s,l,c,d,u,p,h,g;lt(e,!0);let f=br(e,"bg",3,"bg-white/30 dark:bg-black/15"),m=br(e,"border",3,"divide-y-[1px] *:border-surface-300-600-token"),w=br(e,"padding",3,"px-4 *:py-4"),v=br(e,"margin",3,"mt-2 *:!m-0"),b=br(e,"rounded",3,"rounded-container-token *:!rounded-none"),y=br(e,"sectionSpace",19,()=>"space-y-4"),x=br(e,"sectionTitle",3,"font-bold"),k=br(e,"descriptionText",3,"text-sm text-surface-400"),_=br(e,"class",3,"");const A=C(()=>`list *:items-center ${w()} ${v()} ${m()} ${f()} ${b()} ${_()}`);r=Jl(),a=St(r),o=St(a),n=St(o),i=St(n,!0),Rt(()=>ve(i,gu("setting.others.options.show_setting_button"))),ft(n),oa(Pt(n,2),{name:"show-popup-button",size:"sm",get checked(){return np.showPopupButton},set checked(t){np.showPopupButton=t}}),ft(o),s=Pt(o,2),l=t=>{var e=Hl(),r=St(e),a=St(r,!0);Rt(()=>ve(a,gu("setting.others.options.bundle_multipage_illust"))),ft(r),oa(Pt(r,2),{name:"bundle-illusts",size:"sm",get checked(){return tp.compressMultiIllusts},set checked(t){tp.compressMultiIllusts=t}}),ft(e),we(t,e)},ke(s,t=>{(Mu.isPixiv()||Mu.isNijie())&&t(l)}),c=Pt(s,2),d=t=>{var e,r,a,o,n,i,s=Wl(),l=Ct(s),c=St(l),d=St(c,!0);Rt(()=>ve(d,gu("setting.others.options.bundle_manga"))),ft(c),oa(Pt(c,2),{name:"bundle-manga",size:"sm",get checked(){return tp.compressManga},set checked(t){tp.compressManga=t}}),ft(l),r=St(e=Pt(l,2)),a=St(r),o=St(a,!0),Rt(()=>ve(o,gu("setting.others.options.like_illust_when_downloading"))),ft(a),n=Pt(a,2),i=St(n,!0),Rt(()=>ve(i,gu("setting.others.options.option_does_not_apply_to_batch_download"))),ft(n),ft(r),oa(Pt(r,2),{name:"like-illust",size:"sm",get checked(){return tp.likeIllustWhenDownloading},set checked(t){tp.likeIllustWhenDownloading=t}}),ft(e),Rt(()=>qe(n,Me(k()))),we(t,s)},ke(c,t=>{Mu.isPixiv()&&t(d)}),u=Pt(c,2),p=t=>{var e,r,a,o,n=Yl(),i=St(n),s=St(i),l=St(s),c=St(l,!0);Rt(()=>ve(c,gu("setting.others.options.add_bookmark_when_downloading"))),ft(l),e=Pt(l,2),r=St(e,!0),Rt(()=>ve(r,gu("setting.others.options.option_does_not_apply_to_batch_download"))),ft(e),ft(s),oa(Pt(s,2),{name:"add-bookmark",size:"sm",get checked(){return tp.addBookmark},set checked(t){tp.addBookmark=t}}),ft(i),a=Pt(i,2),o=t=>{var e,r,a=Gl(),o=St(a),n=St(o),i=St(n),s=St(i,!0);Rt(()=>ve(s,gu("setting.others.options.add_bookmark_with_tags"))),ft(i),oa(Pt(i,2),{name:"bookmark-with-tags",size:"sm",get checked(){return tp.bookmarkWithTags},set checked(t){tp.bookmarkWithTags=t}}),ft(n),ft(o),e=Pt(o,2),r=t=>{var e=Ul(),r=St(e),a=St(r),o=St(a,!0);Rt(()=>ve(o,gu("setting.others.options.add_bookmark_private_r18"))),ft(a),oa(Pt(a,2),{name:"private-bookmark-if-r18",size:"sm",get checked(){return tp.privateBookmarkIfR18},set checked(t){tp.privateBookmarkIfR18=t}}),ft(r),ft(e),we(t,e)},ke(e,t=>{Mu.isPixiv()&&t(r)}),ft(a),Rt(()=>qe(a,`list ${m()??""} ${b()??""} [&:not(:last-child)]:*:py-4 [&:last-child]:*:pt-4`)),we(t,a)},ke(a,t=>{tp.addBookmark&&(Mu.isPixiv()||Mu.isNijie())&&t(o)}),ft(n),Rt(()=>qe(e,Me(k()))),we(t,n)},ke(u,t=>{null!==tp.addBookmark&&t(p)}),ft(a),h=Pt(a,2),g=t=>{var e=Vl(),r=St(e),a=Pt(r,2),o=St(a),n=St(o),i=Pt(St(n),2);ft(n),oa(Pt(n,2),{name:"mix-effect",size:"sm",get checked(){return tp.mixSeasonalEffect},set checked(t){tp.mixSeasonalEffect=t}}),ft(o),ft(a),ft(e),Rt(()=>{qe(r,Me(x())),qe(a,Me(et(A))),qe(i,`${k()??""} !text-error-500`)}),we(t,e)},ke(h,t=>{Mu.isPixiv()&&t(g)}),ft(r),Rt(()=>{qe(r,Me(y())),qe(a,Me(et(A)))}),we(t,r),ct()}function Ea(t,e){var r,a,o,n,i,s,l,c,d,u,p,h,g,f,m,w,v,b;lt(e,!0);let y=br(e,"bg",3,"bg-white/30 dark:bg-black/15"),x=br(e,"border",3,"divide-y-[1px] *:border-surface-300-600-token"),k=br(e,"padding",3,"px-4 *:py-4"),_=br(e,"margin",3,"mt-2 *:!m-0"),A=br(e,"rounded",3,"rounded-container-token *:!rounded-none"),E=br(e,"sectionSpace",19,()=>"space-y-4"),S=br(e,"sectionTitle",3,"font-bold"),P=br(e,"class",3,"");const I=C(()=>`list *:items-center ${k()} ${_()} ${x()} ${y()} ${A()} ${P()}`);a=St(r=Ql()),o=St(a),n=St(o,!0),Rt(()=>ve(n,gu("setting.feedback.label.feedback"))),ft(o),s=St(i=Pt(o,2)),l=St(s),Ie(St(l),()=>gu("setting.feedback.text.feedback_desc")),ft(l),ft(s),ft(i),ft(a),c=Pt(a,2),d=St(c),u=St(d,!0),Rt(()=>ve(u,gu("setting.feedback.label.donate"))),ft(d),h=St(p=Pt(d,2)),g=St(h),Ie(St(g),()=>gu("setting.feedback.text.give_me_a_star")),ft(g),ft(h),m=St(f=Pt(h,2)),je(w=St(m),"src",uu),v=Pt(w,2),b=St(v,!0),Rt(()=>ve(b,gu("setting.feedback.text.donate_desc"))),ft(v),ft(m),ft(f),ft(p),ft(c),ft(r),Rt(()=>{qe(r,Me(E())),qe(o,Me(S())),qe(i,Me(et(I))),qe(d,Me(S())),qe(p,Me(et(I)))}),we(t,r),ct()}function Sa(t,e){lt(e,!0);let r=br(e,"bg",3,"bg-white/30 dark:bg-black/15"),a=br(e,"border",3,"divide-y-[1px] *:border-surface-300-600-token"),o=br(e,"padding",3,"px-4 *:py-4"),n=br(e,"margin",3,"mt-2 *:!m-0"),i=br(e,"rounded",3,"rounded-container-token *:!rounded-none"),s=br(e,"sectionSpace",19,()=>"space-y-4"),l=br(e,"sectionTitle",3,"font-bold"),c=br(e,"class",3,"");const d=C(()=>`${o()} ${n()} ${a()} ${r()} ${i()} ${c()}`),u=Object.entries(ip).filter(([t,e])=>null!==e).map(([t,e])=>t);var p=Kl();Ae(p,20,()=>u,t=>t,(t,e)=>{var r,a,o,n=Xl(),i=St(n),s=St(i,!0);Rt(()=>ve(s,e.toUpperCase())),ft(i),a=St(r=Pt(i,2)),Oe(o=St(a)),ft(a),ft(r),ft(n),Rt(()=>{qe(i,Me(l())),qe(r,Me(et(d))),je(o,"name",e)}),Ze(o,()=>ip[e],t=>ip[e]=t),we(t,n)}),ft(p),Rt(()=>qe(p,Me(s()))),we(t,p),ct()}function Ca(t,e){lt(e,!0);let r=y(0),a=y(!0);const o=[{name:()=>gu("setting.save_to.title"),component:ma},{name:()=>gu("setting.ugoira.title"),component:wa,show:Mu.isPixiv()},{name:()=>gu("setting.history.title"),component:ka},{name:()=>gu("setting.button_position.title"),component:_a},{name:()=>gu("setting.others.title"),component:Aa},{name:()=>gu("setting.authorization.title"),component:Sa,show:Object.values(ip).some(t=>null!==t)},{name:()=>gu("setting.feedback.title"),component:Ea}],n=C(()=>o[et(r)].component),i=C(()=>et(a)?"grid-cols-[140px_1fr]":"grid-cols-[0px_1fr]"),s=C(()=>et(a)?"translate-x-0":"-translate-x-full");ia(t,{get parent(){return e.parent},height:"h-screen md:h-[600px]",width:"w-screen md:max-w-screen-md xl:max-w-screen-lg",padding:"",children:t=>{var e,l,c=rc(),d=St(c);!function(t,e){var r;const a=mr(e,["children","$$slots","$$events","$$legacy"]);lt(e,!1);const o=k();let n=br(e,"multiple",8,!1),i=br(e,"disabled",8,!1),s=br(e,"spacing",8,"space-y-1"),l=br(e,"rounded",8,"rounded-token"),c=br(e,"active",8,"variant-filled"),d=br(e,"hover",8,"hover:variant-soft"),u=br(e,"padding",8,"px-4 py-2"),p=br(e,"regionLead",8,""),h=br(e,"regionDefault",8,""),g=br(e,"regionTrail",8,""),f=br(e,"labelledby",8,"");nt("disabled",i()),nt("multiple",n()),nt("rounded",l()),nt("active",c()),nt("hover",d()),nt("padding",u()),nt("regionLead",p()),nt("regionDefault",h()),nt("regionTrail",g()),Ot(()=>(dt(s()),dt(l()),dt(a)),()=>{A(o,` ${s()} ${l()} ${a.class??""}`)}),Lt(),ur(),Te(St(r=Qi()),e,"default",{},null),ft(r),Rt(()=>{qe(r,`listbox ${et(o)??""}`),je(r,"aria-labelledby",f())}),we(t,r),ct()}(d,{get class(){return`pt-4 pr-6 row-start-1 row-span-2 w-[140px] transition-[transform] ${et(s)??""}`},children:t=>{var e=me();Ae(Ct(e),17,()=>o,_e,(t,e,a)=>{var o=me(),n=Ct(o),i=t=>{!function(t,e){function r(t,e){if(t===e)return!0;if(!(t instanceof Object&&e instanceof Object))return!1;const a=Object.keys(t),o=Object.keys(e);if(a.length!==o.length)return!1;for(const o of a)if(!r(t[o],e[o]))return!1;return!0}var a,o,n,i,s,l,c,d,u,p,h,g;const f=$e(e),m=mr(e,["children","$$slots","$$events","$$legacy"]);lt(e,!1);const w=k(),v=k(),b=k(),y=k(),x=k(),_=k(),E=k(),S=k(),C=[];let P=br(e,"group",12),I=br(e,"name",8),T=br(e,"value",8),$=br(e,"disabled",24,()=>ot("disabled")),B=br(e,"multiple",24,()=>ot("multiple")),D=br(e,"rounded",24,()=>ot("rounded")),N=br(e,"active",24,()=>ot("active")),M=br(e,"hover",24,()=>ot("hover")),O=br(e,"padding",24,()=>ot("padding")),L=br(e,"regionLead",24,()=>ot("regionLead")),j=br(e,"regionDefault",24,()=>ot("regionDefault")),R=br(e,"regionTrail",24,()=>ot("regionTrail")),F=k(),z=k();Ot(()=>(dt(B()),dt(P())),()=>{var t;B()&&(t=P(),A(F,t.indexOf(T())>=0))}),Ot(()=>(dt(B()),et(F)),()=>{B()&&function(t){const e=P().indexOf(T());t?e<0&&(P().push(T()),P(P())):e>=0&&(P().splice(e,1),P(P()))}(et(F))}),Ot(()=>(dt(B()),dt(P()),dt(T())),()=>{A(w,B()?P().some(t=>r(T(),t)):r(P(),T()))}),Ot(()=>(et(w),dt(N()),dt($()),dt(M())),()=>{A(v,et(w)?N():$()?"":M())}),Ot(()=>dt($()),()=>{A(b,$()?"opacity-50 !cursor-default":"")}),Ot(()=>(et(b),dt(D()),dt(O()),et(v),dt(m)),()=>{A(y,`cursor-pointer -outline-offset-[3px] ${et(b)} ${D()} ${O()} ${et(v)} ${m.class??""}`)}),Ot(()=>{},()=>{A(x,"flex items-center space-x-4")}),Ot(()=>dt(L()),()=>{A(_,` ${L()}`)}),Ot(()=>dt(j()),()=>{A(E,`flex-1 ${j()}`)}),Ot(()=>dt(R()),()=>{A(S,` ${R()}`)}),Lt(),ur(),a=es(),o=St(a),n=St(o),i=St(n),s=t=>{var r,a=Xi();Oe(a),dr(a,t=>A(z,t),()=>et(z)),Rt(()=>{a.disabled=$(),je(a,"name",I()),r!==(r=T())&&(a.value=null==(a.__value=T())?"":T())}),er(a,()=>et(F),t=>A(F,t)),le("click",a,function(t){hr.call(this,e,t)}),le("change",a,function(t){hr.call(this,e,t)}),we(t,a)},l=t=>{var r,a=Ki();Oe(a),dr(a,t=>A(z,t),()=>et(z)),Rt(()=>{a.disabled=$(),je(a,"name",I()),r!==(r=T())&&(a.value=null==(a.__value=T())?"":T())}),tr(C,[],a,()=>(T(),P()),P),le("click",a,function(t){hr.call(this,e,t)}),le("change",a,function(t){hr.call(this,e,t)}),we(t,a)},ke(i,t=>{B()?t(s):t(l,!1)}),ft(n),d=St(c=Pt(n,2)),u=t=>{var r=Zi();Te(St(r),e,"lead",{},null),ft(r),Rt(()=>qe(r,`listbox-label-lead ${et(_)??""}`)),we(t,r)},ke(d,t=>{f.lead&&t(u)}),Te(St(p=Pt(d,2)),e,"default",{},null),ft(p),h=Pt(p,2),g=t=>{var r=ts();Te(St(r),e,"trail",{},null),ft(r),Rt(()=>qe(r,`listbox-label-trail ${et(S)??""}`)),we(t,r)},ke(h,t=>{f.trail&&t(g)}),ft(c),ft(o),ft(a),Rt(()=>{qe(o,`listbox-item ${et(y)??""}`),je(o,"aria-selected",et(w)),qe(c,`listbox-label ${et(x)??""}`),qe(p,`listbox-label-content ${et(E)??""}`)}),le("keydown",o,function(t){["Enter","Space"].includes(t.code)&&(t.preventDefault(),et(z).click())}),le("keydown",o,function(t){hr.call(this,e,t)}),le("keyup",o,function(t){hr.call(this,e,t)}),le("keypress",o,function(t){hr.call(this,e,t)}),we(t,a),ct()}(t,{name:"option",value:a,class:"rounded-token",get group(){return et(r)},set group(t){A(r,vt(t))},children:t=>{mt();var r=fe();Rt(()=>ve(r,et(e).name())),we(t,r)},$$slots:{default:!0}})};ke(n,t=>{"show"in et(e)&&!et(e).show||t(i)}),we(t,o)}),we(t,e)},$$slots:{default:!0}}),function(t,e){var r,a,o,n,i,s,l,c,d;const u=$e(e),p=mr(e,["children","$$slots","$$events","$$legacy"]);lt(e,!1);const h=k(),g=k(),f=k(),m=k(),w=k(),v=k();let b=br(e,"background",8,"bg-surface-100-800-token"),y=br(e,"border",8,""),x=br(e,"padding",8,"p-4"),_=br(e,"shadow",8,""),E=br(e,"spacing",8,"space-y-4"),S=br(e,"gridColumns",8,"grid-cols-[auto_1fr_auto]"),C=br(e,"gap",8,"gap-4"),P=br(e,"regionRowMain",8,""),I=br(e,"regionRowHeadline",8,""),T=br(e,"slotLead",8,""),$=br(e,"slotDefault",8,""),B=br(e,"slotTrail",8,""),D=br(e,"label",8,""),N=br(e,"labelledby",8,"");Ot(()=>(dt(b()),dt(y()),dt(E()),dt(x()),dt(_()),dt(p)),()=>{A(h,`flex flex-col ${b()} ${y()} ${E()} ${x()} ${_()} ${p.class??""}`)}),Ot(()=>(dt(S()),dt(C()),dt(P())),()=>{A(g,`grid items-center ${S()} ${C()} ${P()}`)}),Ot(()=>dt(I()),()=>{A(f,` ${I()}`)}),Ot(()=>dt(T()),()=>{A(m,`flex-none flex justify-between items-center ${T()}`)}),Ot(()=>dt($()),()=>{A(w,`flex-auto ${$()}`)}),Ot(()=>dt(B()),()=>{A(v,`flex-none flex items-center space-x-4 ${B()}`)}),Lt(),ur(),r=Wi(),a=St(r),o=St(a),n=t=>{var r=zi();Te(St(r),e,"lead",{},null),ft(r),Rt(()=>qe(r,`app-bar-slot-lead ${et(m)??""}`)),we(t,r)},ke(o,t=>{u.lead&&t(n)}),Te(St(i=Pt(o,2)),e,"default",{},null),ft(i),s=Pt(i,2),l=t=>{var r=qi();Te(St(r),e,"trail",{},null),ft(r),Rt(()=>qe(r,`app-bar-slot-trail ${et(v)??""}`)),we(t,r)},ke(s,t=>{u.trail&&t(l)}),ft(a),c=Pt(a,2),d=t=>{var r=Hi();Te(St(r),e,"headline",{},null),ft(r),Rt(()=>qe(r,`app-bar-row-headline ${et(f)??""}`)),we(t,r)},ke(c,t=>{u.headline&&t(d)}),ft(r),Rt(()=>{qe(r,`app-bar ${et(h)??""}`),je(r,"aria-label",D()),je(r,"aria-labelledby",N()),qe(a,`app-bar-row-main ${et(g)??""}`),qe(i,`app-bar-slot-default ${et(w)??""}`)}),we(t,r),ct()}(e=Pt(d,2),{padding:"py-2",background:"bg-transparent",class:"mr-6 border-b border-surface-800-100-token",lead:t=>{var e,r,o,n,i=tc();i.__click=[Zl,a],e=St(i),r=St(e),o=t=>{var e=me();Ie(Ct(e),()=>'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6H13V8H3V6M3 16H13V18H3V16M3 11H15V13H3V11M16 7L14.58 8.39L18.14 12L14.58 15.61L16 17L21 12L16 7Z" /></svg>'),we(t,e)},n=t=>{var e=me();Ie(Ct(e),()=>'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21,15.61L19.59,17L14.58,12L19.59,7L21,8.39L17.44,12L21,15.61M3,6H16V8H3V6M3,13V11H13V13H3M3,18V16H16V18H3Z" /></svg>'),we(t,e)},ke(r,t=>{et(a)?t(o):t(n,!1)}),ft(e),ft(i),we(t,i)},children:t=>{var e=ec(),a=St(e,!0);Rt(()=>ve(a,o[et(r)].name())),ft(e),we(t,e)},$$slots:{lead:!0,default:!0}}),Be(St(l=Pt(e,2)),()=>et(n),(t,e)=>{e(t,{bg:"bg-white/30 dark:bg-surface-500/20 backdrop-blur-sm"})}),ft(l),ft(c),Rt(()=>qe(c,`h-full pt-4 pb-6 pl-6 grid grid-rows-[auto_1fr] transition-[grid-template-columns] ${et(i)??""}`)),we(t,c)},$$slots:{default:!0}}),ct()}function Pa(){var t,e;return(null==(e=null==(t=Ni.dataLayer)?void 0:t[0])?void 0:e.user_id)??""}function Ia(t,e){let r=!1;const a=Lu.bookmarkPage.exec(location.pathname);a&&a[1]===Pa()&&(r=!0),t.forEach(t=>{let a,o;if((0!==t.childElementCount||t.className.includes("_history-item")||t.className.includes("_history-related-item"))&&!t.querySelector(Hd.tagNameLowerCase)&&(a=function(t){const e=Lu.artworksPage.exec(t.getAttribute("href")||"");if(e){if(t.getAttribute("data-gtm-value")||["gtm-illust-recommend-node-node","gtm-discover-user-recommend-node","work","_history-item","_history-related-item"].some(e=>t.classList.contains(e)))return e[1]}else if(t instanceof HTMLSpanElement&&t.className.includes("_history-item")){const e=t.querySelector("img");if(!e)return"";const r=Lu.historyThumbnailsId.exec(e.src);if(r)return r[0]}else{const e=Lu.activityHref.exec(t.getAttribute("href")||"");if(e&&t.classList.contains("work"))return e[1]}return""}(t))){r?o=Ai.PixivMyBookmark:t.className.includes("_history-related-item")?(t.style.position="relative",o=Ai.PixivHistory):t.className.includes("_history-item")&&(o=Ai.PixivHistory);const n=new Hd({id:a,type:o,onClick:e});t.appendChild(n)}})}function Ta(t,e,r){const a=document.querySelectorAll("figure a.gtm-expand-full-size-illust");a.length<2||a.forEach((a,o)=>{var n;const i=null==(n=a.parentElement)?void 0:n.parentElement;i&&!i.querySelector(au.tagNameLowerCase)&&i.appendChild(new au({id:t,page:o,site:"pixiv",extraData:r?{unlistedId:r}:void 0,onClick:e}))})}function $a(t,e,r){const a=document.querySelector("body > [role='presentation'] div[class]");if(!a)return void(Cp&&(Cp.disconnect(),Cp=null,Pp=null));if(a.querySelector(Hd.tagNameLowerCase))return;const o=a.querySelector("div > img");if(!o)return;const n=Lu.originSrcPageNum.exec(o.src);if(!n)return;const[i]=n;Pp=new Hd({id:t,type:Ai.PixivPresentation,page:Number(i),extraData:r?{unlistedId:r}:void 0,onClick:e}),a.appendChild(Pp),Cp=new MutationObserver(o=>{const n=o[1].addedNodes[0],[i]=Lu.originSrcPageNum.exec(n.src)??[];if(!i)return Ld.throw("Invalid image element.");null==Pp||Pp.remove(),Pp=new Hd({id:t,type:Ai.PixivPresentation,page:Number(i),extraData:r?{unlistedId:r}:void 0,onClick:e}),a.appendChild(Pp)}),Cp.observe(o.parentElement,{childList:!0,subtree:!0})}function Ba(t,e,r){var a;const o=document.querySelector(".gtm-manga-viewer-preview-modal-open:not(.pdl-listened)"),n=document.querySelector(".gtm-manga-viewer-open-preview:not(.pdl-listened)"),i=null==(a=document.querySelectorAll(".gtm-manga-viewer-close-icon:not(.pdl-listened)"))?void 0:a[1];(o||n||i)&&[o,n,i].forEach(a=>{a&&(a.classList.add("pdl-listened"),a.addEventListener("click",()=>{!function(t,e,r){const a=setInterval(()=>{Ld.info("Start to find modal.");const o=document.querySelectorAll("ul"),n=o[o.length-1];"grid"===getComputedStyle(n).display&&(clearInterval(a),n.childNodes.forEach((a,o)=>{a.style.position="relative",a.appendChild(new Hd({id:t,page:o,extraData:r?{unlistedId:r}:void 0,onClick:e}))}))},300)}(t,e,r)}))})}function Da(t,e,r){const a=document.querySelector(".gtm-manga-viewer-close-icon");if(!a)return;const o=a.parentElement;o&&!o.querySelector(Hd.tagNameLowerCase)&&o.appendChild(new Hd({id:t,type:Ai.PixivMangaViewer,extraData:r?{unlistedId:r}:void 0,onClick:e}))}var Na,Ma,Oa,La,ja,Ra,Fa,za,qa,Ha,Wa,Ua,Ga,Ya,Va,Ja,Qa,Xa,Ka,Za,to,eo,ro,ao,oo,no,io,so,lo,co,uo,po,ho,go,fo,mo,wo,vo,bo,yo,xo,ko,_o,Ao,Eo,So,Co,Po,Io,To,$o,Bo,Do,No,Mo,Oo,Lo,jo,Ro,Fo,zo,qo,Ho,Wo,Uo,Go,Yo,Vo,Jo,Qo,Xo,Ko,Zo,tn,en,rn,an,on,nn,sn,ln,cn,dn,un,pn,hn,gn,fn,mn,wn,vn,bn,yn,xn,kn,_n,An,En,Sn,Cn,Pn,In,Tn,$n,Bn,Dn,Nn,Mn,On,Ln,jn,Rn,Fn,zn,qn,Hn,Wn,Un,Gn,Yn,Vn,Jn,Qn,Xn,Kn,Zn,ti,ei,ri,ai,oi,ni,ii,si,li,ci,di,ui,pi,hi,gi,fi,mi,wi,vi,bi,yi,xi,ki,_i,Ai,Ei,Si,Ci,Pi,Ii,Ti,$i,Bi,Di,Ni,Mi,Oi,Li,ji,Ri,Fi,zi,qi,Hi,Wi,Ui,Gi,Yi,Vi,Ji,Qi,Xi,Ki,Zi,ts,es,rs,as,os,ns,is,ss,ls,cs,ds,us,ps,hs,gs,fs,ms,ws,vs,bs,ys,xs,ks,_s,As,Es,Ss,Cs,Ps,Is,Ts,$s,Bs,Ds,Ns,Ms,Os,Ls,js,Rs,Fs,zs,qs,Hs,Ws,Us,Gs,Ys,Vs,Js,Qs,Xs,Ks,Zs,tl,el,rl,al,ol,nl,il,sl,ll,cl,dl,ul,pl,hl,gl,fl,ml,wl,vl,bl,yl,xl,kl,_l,Al,El,Sl,Cl,Pl,Il,Tl,$l,Bl,Dl,Nl,Ml,Ol,Ll,jl,Rl,Fl,zl,ql,Hl,Wl,Ul,Gl,Yl,Vl,Jl,Ql,Xl,Kl,Zl,tc,ec,rc,ac,oc,nc,ic,sc,lc,cc,dc,uc,pc,hc=Object.defineProperty,gc=t=>{throw TypeError(t)},fc=(t,e,r)=>((t,e,r)=>e in t?hc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r)(t,"symbol"!=typeof e?e+"":e,r),mc=(t,e,r)=>e.has(t)||gc("Cannot "+r),wc=(t,e,r)=>(mc(t,e,"read from private field"),r?r.call(t):e.get(t)),vc=(t,e,r)=>e.has(t)?gc("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),bc=(t,e,r)=>(mc(t,e,"write to private field"),e.set(t,r),r),yc=(t,e,r)=>(mc(t,e,"access private method"),r),xc=(t,e,r,a)=>({set _(r){bc(t,e,r)},get _(){return wc(t,e,a)}});(()=>{if(/\[native code\]/.test(Array.from.toString()))return;const t=document.createElement("iframe");document.body.append(t),Array.from=t.contentWindow.Array.from,t.remove()})(),ci=Array.isArray,di=Array.prototype.indexOf,ui=Array.from,pi=Object.keys,hi=Object.defineProperty,gi=Object.getOwnPropertyDescriptor,fi=Object.getOwnPropertyDescriptors,mi=Object.prototype,wi=Array.prototype,vi=Object.getPrototypeOf;const kc=()=>{},_c=32,Ac=128,Ec=256,Sc=512,Cc=1024,Pc=2048,Ic=4096,Tc=8192,$c=16384,Bc=65536,Dc=1<<17,Nc=1<<20,Mc=Symbol("$state"),Oc=Symbol("legacy props"),Lc=Symbol(""),jc="undefined"==typeof requestIdleCallback?t=>setTimeout(t,1):requestIdleCallback;let Rc=!1,Fc=!1,zc=[],qc=[];const Hc="[!",Wc={},Uc=Symbol();let Gc=!1;const Yc=[],Vc=0;let Jc=!1,Qc=Vc,Xc=!1,Kc=null,Zc=!1,td=!1,ed=[],rd=0,ad=null,od=null,nd=null,id=null,sd=0,ld=null,cd=1,dd=0,ud=!1,pd=null,hd=null;const gd=-7169;let fd,md=!1;const wd=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"],vd={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject"},bd=["touchstart","touchmove"];let yd=!1;const xd=new Set,kd=new Set;let _d=!0;const Ad=new Map;let Ed=new WeakMap,Sd=null;ki=new Map;const Cd={tick:t=>requestAnimationFrame(t),now:()=>performance.now(),tasks:new Set},Pd=t=>t,Id=new Set;let Td=!1,$d=Symbol();const Bd={get(t,e){if(!t.exclude.includes(e))return et(t.version),e in t.special?t.special[e]():t.props[e]},set:(t,e,r)=>(e in t.special||(t.special[e]=br({get[e](){return t.props[e]}},e,4)),t.special[e](r),st(t.version),!0),getOwnPropertyDescriptor(t,e){if(!t.exclude.includes(e))return e in t.props?{enumerable:!0,configurable:!0,value:t.props[e]}:void 0},deleteProperty:(t,e)=>(t.exclude.includes(e)||(t.exclude.push(e),st(t.version)),!0),has:(t,e)=>!t.exclude.includes(e)&&e in t.props,ownKeys:t=>Reflect.ownKeys(t.props).filter(e=>!t.exclude.includes(e))},Dd={get(t,e){let r=t.props.length;for(;r--;){let a=t.props[r];if(i(a)&&(a=a()),"object"==typeof a&&null!==a&&e in a)return a[e]}},set(t,e,r){let a=t.props.length;for(;a--;){let o=t.props[a];i(o)&&(o=o());const n=gi(o,e);if(n&&n.set)return n.set(r),!0}return!1},getOwnPropertyDescriptor(t,e){let r=t.props.length;for(;r--;){let a=t.props[r];if(i(a)&&(a=a()),"object"==typeof a&&null!==a&&e in a){const t=gi(a,e);return t&&!t.configurable&&(t.configurable=!0),t}}},has(t,e){if(e===Mc||e===Oc)return!1;for(let r of t.props)if(i(r)&&(r=r()),null!=r&&e in r)return!0;return!1},ownKeys(t){const e=[];for(let r of t.props){i(r)&&(r=r());for(const t in r)e.includes(t)||e.push(t)}return e}};class Nd{constructor(t){var e,r,a;vc(this,Na),vc(this,Ma),r=new Map,a=(t,e)=>{var a=x(e);return r.set(t,a),a};const o=new Proxy({...t.props||{},$$events:{}},{get:(t,e)=>et(r.get(e)??a(e,Reflect.get(t,e))),has:(t,e)=>e===Oc||(et(r.get(e)??a(e,Reflect.get(t,e))),Reflect.has(t,e)),set:(t,e,o)=>(A(r.get(e)??a(e,o),o),Reflect.set(t,e,o))});bc(this,Ma,(t.hydrate?ye:be)(t.component,{target:t.target,anchor:t.anchor,props:o,context:t.context,intro:t.intro??!1,recover:t.recover})),(null==(e=null==t?void 0:t.props)?void 0:e.$$host)&&!1!==t.sync||Z(),bc(this,Na,o.$$events);for(const t of Object.keys(wc(this,Ma)))"$set"!==t&&"$destroy"!==t&&"$on"!==t&&hi(this,t,{get(){return wc(this,Ma)[t]},set(e){wc(this,Ma)[t]=e},enumerable:!0});wc(this,Ma).$set=t=>{Object.assign(o,t)},wc(this,Ma).$destroy=()=>{!function(t){const e=Ed.get(t);e?(Ed.delete(t),e(void 0)):Promise.resolve()}(wc(this,Ma))}}$set(t){wc(this,Ma).$set(t)}$on(t,e){wc(this,Na)[t]=wc(this,Na)[t]||[];const r=(...t)=>e.call(this,...t);return wc(this,Na)[t].push(r),()=>{wc(this,Na)[t]=wc(this,Na)[t].filter(t=>t!==r)}}$destroy(){wc(this,Ma).$destroy()}}let Md;Na=new WeakMap,Ma=new WeakMap,"function"==typeof HTMLElement&&(Md=class extends HTMLElement{constructor(t,e,r){super(),fc(this,"$$ctor"),fc(this,"$$s"),fc(this,"$$c"),fc(this,"$$cn",!1),fc(this,"$$d",{}),fc(this,"$$r",!1),fc(this,"$$p_d",{}),fc(this,"$$l",{}),fc(this,"$$l_u",new Map),fc(this,"$$me"),this.$$ctor=t,this.$$s=e,r&&this.attachShadow({mode:"open"})}addEventListener(t,e,r){if(this.$$l[t]=this.$$l[t]||[],this.$$l[t].push(e),this.$$c){const r=this.$$c.$on(t,e);this.$$l_u.set(e,r)}super.addEventListener(t,e,r)}removeEventListener(t,e,r){if(super.removeEventListener(t,e,r),this.$$c){const t=this.$$l_u.get(e);t&&(t(),this.$$l_u.delete(e))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){let e=function(t){return e=>{const r=document.createElement("slot");"default"!==t&&(r.name=t),we(e,r)}};if(await Promise.resolve(),!this.$$cn||this.$$c)return;const r={},a=function(t){const e={};return t.childNodes.forEach(t=>{e[t.slot||"default"]=!0}),e}(this);for(const t of this.$$s)t in a&&("default"!==t||this.$$d.children?r[t]=e(t):(this.$$d.children=e(t),r.default=!0));for(const t of this.attributes){const e=this.$$g_p(t.name);e in this.$$d||(this.$$d[e]=yr(e,t.value,this.$$p_d,"toProp"))}for(const t in this.$$p_d)t in this.$$d||void 0===this[t]||(this.$$d[t]=this[t],delete this[t]);this.$$c=(t={component:this.$$ctor,target:this.shadowRoot||this,props:{...this.$$d,$$slots:r,$$host:this}},new Nd(t)),this.$$me=Nt(()=>{jt(()=>{var t;this.$$r=!0;for(const e of pi(this.$$c)){if(!(null==(t=this.$$p_d[e])?void 0:t.reflect))continue;this.$$d[e]=this.$$c[e];const r=yr(e,this.$$d[e],this.$$p_d,"toAttribute");null==r?this.removeAttribute(this.$$p_d[e].attribute||e):this.setAttribute(this.$$p_d[e].attribute||e,r)}this.$$r=!1})});for(const t in this.$$l)for(const e of this.$$l[t]){const r=this.$$c.$on(t,e);this.$$l_u.set(e,r)}this.$$l={}}var t}attributeChangedCallback(t,e,r){var a;this.$$r||(t=this.$$g_p(t),this.$$d[t]=yr(t,r,this.$$p_d,"toProp"),null==(a=this.$$c)||a.$set({[t]:this.$$d[t]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then(()=>{!this.$$cn&&this.$$c&&(this.$$c.$destroy(),this.$$me(),this.$$c=void 0)})}$$g_p(t){return pi(this.$$p_d).find(e=>this.$$p_d[e].attribute===t||!this.$$p_d[e].attribute&&e.toLowerCase()===t)||t}});const Od=[],Ld=function(){function t(t,a){2<=t&&console[e[t]]("%c[Pixiv Downloader]",r[t],...a)}const e=["info","warn","error"],r=["color: green;","color: orange;","color: red;"],a="[Pixiv Downlaoder] ";return{info(...e){t(0,e)},warn(...e){t(1,e)},error(...e){t(2,e)},time(t){console.time(a+t)},timeLog(t){console.timeLog(a+t)},timeEnd(t){console.timeEnd(a+t)},throw(t,e){throw e?new e(`${a}${t}`):new Error(`${a}${t}`)}}}();Oa=new WeakMap,La=new WeakMap;const jd=new class{constructor(t){vc(this,Oa),vc(this,La),bc(this,Oa,new BroadcastChannel(t)),bc(this,La,{}),wc(this,Oa).onmessage=t=>{const{eventName:e,args:r}=t.data;wc(this,La)[e]&&wc(this,La)[e].forEach(t=>t(...r))}}on(t,e){var r;(r=wc(this,La))[t]??(r[t]=new Set),wc(this,La)[t].add(e)}off(t,e){wc(this,La)[t]&&wc(this,La)[t].delete(e)}emit(t,...e){const r={eventName:t,args:e};wc(this,Oa).postMessage(r)}once(t,e){const r=(...a)=>{e(...a),this.off(t,r)};this.on(t,r)}}("pixiv-downloader");ja=new WeakMap;let Rd=class e extends t{constructor(){super("PdlHistory"),fc(this,"history"),fc(this,"imageEffect"),fc(this,"filehandle"),vc(this,ja,"directory-handle"),this.version(4).stores({history:"pid, userId, user, title, *tags",imageEffect:"id",filehandle:""})}throwIfInvalidNumber(t){if("string"==typeof t){if(""===t)return Ld.throw('Invalid argument: can not be "".',RangeError);t=+t}return(t<0||!Number.isSafeInteger(t))&&Ld.throw(`Invalid number: ${t}, must be a non-negative integer.`,RangeError),t}async add(t){const{pid:r,page:a}=t;return this.transaction("rw",this.history,async()=>{if(void 0!==a){this.throwIfInvalidNumber(a);const o=await this.get(r);if(o&&void 0===o.page)delete t.page,this.history.put(t);else{const r=e.updatePageData(a,null==o?void 0:o.page);this.history.put({...t,page:r})}}else this.history.put(t)})}import(t){const e=t.map(t=>t.page?{...t,page:new Uint8Array(Object.values(t.page))}:t);return this.history.bulkPut(e)}async has(t,r){if(void 0===r)return!!await this.get(t);{this.throwIfInvalidNumber(r);const a=await this.get(t);return!!a&&(!a.page||e.isPageInData(r,a.page))}}get(t){return t=this.throwIfInvalidNumber(t),this.history.get(t)}getAll(){return this.history.toArray()}generateCsv(){return this.getAll().then(t=>{const e=t.map(t=>{const{pid:e,userId:r="",user:a="",title:o="",tags:n="",comment:i=""}=t;return[String(e),String(r),a,o,i,n?n.join(","):n]});return e.unshift(["id","userId","user","title","comment","tags"]),function(t){const e=t.map(t=>t.map(t=>'"'+t.replace(/"/g,'""')+'"').join(",")).join("\r\n");return new Blob(["\ufeff"+e],{type:"text/csv"})}(e)})}clear(){return this.history.clear()}async getImageEffect(t){return await this.imageEffect.get(t)}addImageEffect(t){return this.imageEffect.put(t)}getDirectoryHandle(){return this.filehandle.get(wc(this,ja))}setDirectoryHandle(t){return this.filehandle.put(t,wc(this,ja))}static updatePageData(t,e){const r=Math.floor(t/8),a=t%8;if(e){if(r>e.length-1){const t=new Uint8Array(r+1);return t.set(e),t[r]|=1<<a,t}return e[r]|=1<<a,e}{const t=new Uint8Array(r+1);return t[r]|=1<<a,t}}static isPageInData(t,e){const r=Math.floor(t/8),a=t%8;return!(r>e.length-1||!(e[r]&1<<a))}};class Fd extends Rd{constructor(){super(),fc(this,"cache",new Map),fc(this,"initCachePromise"),this.initCachePromise=this.initCache(),this.initChannel()}async initCache(){Ld.time("loadDb");const t=await this.getAll();let e;for(let r=0;e=t[r++];){const{pid:t,page:r=null}=e;this.cache.set(t,r)}Ld.timeEnd("loadDb")}initChannel(){jd.on("db.sync",t=>{Array.isArray(t)?(t.forEach(t=>{this.cache.set(t.pid,t.page)}),Ld.info("Sync database cache:",t.length)):this.cache.set(t.pid,t.page)}),jd.on("db.clear",()=>{this.cache.clear(),Ld.info("clear database cache")})}updateCache(t){Array.isArray(t)?t.forEach(t=>{this.cache.set(t.pid,t.page)}):this.cache.set(t.pid,t.page),jd.emit("db.sync",t)}clearCache(){this.cache.clear(),jd.emit("db.clear")}async getCache(t){return t=this.throwIfInvalidNumber(t),await this.initCachePromise,this.cache.get(t)}async add(t){const{pid:e,page:r}=t;if(void 0===r)!await this.has(e)&&this.updateCache({pid:e,page:null});else{this.throwIfInvalidNumber(r);const t=await this.getCache(e);null!==t?this.updateCache({pid:e,page:Rd.updatePageData(r,t)}):this.updateCache({pid:e,page:null})}return super.add(t)}import(t){const e=t.map(t=>({pid:t.pid,page:t.page?new Uint8Array(Object.values(t.page)):null}));return this.updateCache(e),super.import(t)}async has(t,e){if(t=this.throwIfInvalidNumber(t),await this.initCachePromise,void 0===e)return this.cache.has(t);{this.throwIfInvalidNumber(e);const r=await this.getCache(t);return void 0!==r&&(null===r||Rd.isPageInData(e,r))}}clear(){return this.clearCache(),super.clear()}}const zd=new class extends Fd{constructor(){super(...arguments),fc(this,"subscribers",new Set)}runSubscription(){Ld.info("runSubscription",this.subscribers.size),this.subscribers.forEach(t=>{t(this.cache)})}async initCache(){await super.initCache(),this.runSubscription()}initChannel(){super.initChannel();const t=this.runSubscription.bind(this);jd.on("db.sync",t),jd.on("db.clear",t)}updateCache(t){super.updateCache(t),this.runSubscription()}clearCache(){super.clearCache(),this.runSubscription()}subscribe(t){return this.subscribers.add(t),t(this.cache),()=>{this.subscribers.delete(t)}}},qd={init:"#pdl-download",loading:"#pdl-loading",progress:"#pdl-progress",complete:"#pdl-complete",error:"#pdl-error"};_i=(t=>(t.Init="init",t.Loading="loading",t.Progress="progress",t.Complete="complete",t.Error="error",t))(_i||{}),Ai=(t=>(t.Gallery="gallery",t.PixivMyBookmark="pixiv-my-bookmark",t.PixivHistory="pixiv-history",t.PixivPresentation="pixiv-presentation",t.PixivToolbar="pixiv-toolbar",t.PixivMangaViewer="pixiv-manga-viewer",t.YandeBrowse="yande-browse",t.NijieIllust="nijie-illust",t.Rule34VaultPostAction="rule34vault-post-action",t))(Ai||{});class Hd extends HTMLElement{constructor(t){if(super(),vc(this,za),fc(this,"btn"),fc(this,"status","init"),fc(this,"mediaId"),fc(this,"page"),fc(this,"type"),fc(this,"onClick"),fc(this,"unsubscriber"),fc(this,"connectedFlag",!1),fc(this,"shouldObserveDb",!0),fc(this,"progress",0),fc(this,"dirty",!1),vc(this,Ra,null),vc(this,Fa,null),this.dispatchDownload=this.dispatchDownload.bind(this),this.onClick=t.onClick,this.mediaId=this.toValidatedNumber(t.id),this.dataset.id=String(this.mediaId),t.type&&(this.dataset.type=this.type=t.type),void 0!==t.page&&(this.page=this.toValidatedNumber(t.page),this.dataset.page=String(this.page)),void 0!==t.shouldObserveDb&&(this.shouldObserveDb=t.shouldObserveDb),t.extraData)for(const e in t.extraData)this.dataset[e]=t.extraData[e]}static get tagNameLowerCase(){return"pdl-button"}static get observedAttributes(){return["data-id","data-status","data-page","data-type","disabled"]}attributeChangedCallback(t,e,r){switch(t){case"data-id":this.updateId(r);break;case"data-status":this.updateIcon(r);break;case"data-page":this.updatePage(r);break;case"data-type":this.resetType(r);break;case"disabled":this.updateDisableStatus(r)}}toValidatedNumber(t){if("string"==typeof t){if(""===t)return Ld.throw('Invalid argument: can not be "".',RangeError);t=+t}return t<0||!Number.isSafeInteger(t)?Ld.throw(`Invalid number: ${t}, must be a non-negative integer.`,RangeError):t}resetType(t){null===t&&void 0===this.type||t!==this.type&&(void 0===this.type?delete this.dataset.type:this.dataset.type=this.type,Ld.error('Changes to "data-type" is not allowed.'))}updateId(t){try{if(null===t)throw new Error('Attribute "data-id" is required.');this.mediaId=this.toValidatedNumber(t),yc(this,za,qa).call(this),wc(this,Ra)&&bc(this,Ra,null),this.connectedFlag&&this.shouldObserveDb&&this.observeDb()()}catch(t){Ld.error(t),this.dataset.id=String(this.mediaId)}}updateDisableStatus(t){this.connectedFlag?"string"==typeof t?this.btn.setAttribute("disabled",""):this.btn.removeAttribute("disabled"):this.dirty=!0}updatePage(t){try{this.page=null===t?void 0:this.toValidatedNumber(t),wc(this,Fa)&&bc(this,Fa,null),yc(this,za,qa).call(this),this.connectedFlag&&this.shouldObserveDb&&this.observeDb()()}catch(t){Ld.error(t),void 0===this.page?delete this.dataset.page:this.dataset.page=String(this.page)}}updateIcon(t){if(null===t)t="init";else{if("init"===t)return void delete this.dataset.status;if(!(t in qd))return void(this.dataset.status=this.status)}if(this.status=t,!this.connectedFlag)return void(this.dirty=!0);const e=this.shadowRoot.querySelector("use");e.setAttribute("xlink:href",qd[t]),e.animate([{opacity:.5},{opactiy:1}],{duration:200})}render(){let t;if((t=this.shadowRoot)&&!this.dirty)return;const e="progress"===this.status;t??(t=this.attachShadow({mode:"open"})),t.innerHTML=`<style>.pdl-thumbnail{position:absolute;display:flex;justify-content:center;align-items:center;margin:0;padding:0;height:32px;width:32px;top:calc((100% - 32px) * var(--pdl-btn-top-percent) / 100 + var(--pdl-btn-top-px));left:calc((100% - 32px) * var(--pdl-btn-left-percent) / 100 + var(--pdl-btn-left-px));border:none;border-radius:4px;overflow:hidden;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;user-select:none;font-family:system-ui;font-size:13px;font-weight:700;color:#262626;background-color:#ffffff80;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);z-index:1;pointer-events:auto;cursor:pointer}.pdl-thumbnail:disabled{cursor:not-allowed}.pdl-thumbnail>svg{position:absolute;width:85%;height:85%;fill:currentColor;stroke:currentColor}.pdl-thumbnail>span{opacity:0;transition:opacity .2s}.pdl-thumbnail>span.show{opacity:1}:host([data-type=gallery]) .pdl-thumbnail{--pdl-sticky-safe-area-top: 0px;--pdl-sticky-safe-area-bottom: 0px;position:sticky;top:var(--pdl-sticky-safe-area-top);left:0;right:0}:host([data-type=gallery].bottom) .pdl-thumbnail{top:calc(100% - 32px - var(--pdl-sticky-safe-area-bottom))}:host([data-type=gallery].pixiv) .pdl-thumbnail{--pdl-sticky-safe-area-top: 40px;--pdl-sticky-safe-area-bottom: 48px}:host([data-type=gallery].nijie) .pdl-thumbnail{--pdl-sticky-safe-area-top: 36px;--pdl-sticky-safe-area-bottom: 70px}:host([data-type=pixiv-my-bookmark]) .pdl-thumbnail{top:calc((100% - 32px) * var(--pdl-btn-pixiv-bookmark-top-percent) / 100 + var(--pdl-btn-pixiv-bookmark-top-px));left:calc((100% - 32px) * var(--pdl-btn-pixiv-bookmark-left-percent) / 100 + var(--pdl-btn-pixiv-bookmark-left-px))}:host([data-type=pixiv-history]) .pdl-thumbnail{z-index:auto}:host([data-type=pixiv-presentation]) .pdl-thumbnail{position:fixed;top:50px;right:20px;left:auto}:host([data-type=pixiv-toolbar]) .pdl-thumbnail{position:relative;top:auto;left:auto;color:inherit;background-color:transparent;z-index:auto}:host([data-type=pixiv-manga-viewer]) .pdl-thumbnail{top:80%;right:4px;left:auto}:host([data-type=yande-browse]) .pdl-thumbnail{top:320px;right:4px;left:auto}:host([data-type=nijie-illust]) .pdl-thumbnail{display:inline-flex;position:static;height:44px;width:44px;top:auto;left:auto;border-radius:8px;margin:0 8px;vertical-align:top}:host([data-type=nijie-illust]) .pdl-thumbnail>svg{width:70%;height:70%}:host([data-type=rule34vault-post-action]) .pdl-thumbnail{position:relative;top:auto;left:auto;color:inherit;background-color:inherit;width:4em;height:36px}:host([data-type=rule34vault-post-action]) .pdl-thumbnail>svg{height:28px;width:28px}:host([data-type=rule34vault-post-action]) .pdl-thumbnail:hover{filter:brightness(1.2)}:host([data-status]) .pdl-thumbnail{color:#16a34a}:host([data-status=error]) .pdl-thumbnail{color:#ef4444}</style><svg xmlns="http://www.w3.org/2000/svg" style="display: none">\n  <symbol id="pdl-download" viewBox="0 0 512 512">\n    <path\n      d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm-32-316v116h-67c-10.7 0-16 12.9-8.5 20.5l99 99c4.7 4.7 12.3 4.7 17 0l99-99c7.6-7.6 2.2-20.5-8.5-20.5h-67V140c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12z"\n    ></path>\n  </symbol>\n\n  <symbol id="pdl-loading" viewBox="0 0 512 512">\n    <style>\n      @keyframes pdl-loading {\n        0% {\n          transform: rotate3d(0, 0, 1, -90deg) rotate3d(1, 0, 0, 0deg);\n          stroke-dashoffset: 1407.43;\n        }\n\n        49.99% {\n          transform: rotate3d(0, 0, 1, 90deg) rotate3d(1, 0, 0, 0deg);\n        }\n\n        50% {\n          transform: rotate3d(0, 0, 1, 90deg) rotate3d(1, 0, 0, 180deg);\n          stroke-dashoffset: 0;\n        }\n\n        100% {\n          transform: rotate3d(0, 0, 1, 270deg) rotate3d(1, 0, 0, 180deg);\n          stroke-dashoffset: 1407.43;\n        }\n      }\n\n      circle.rotate {\n        transform-origin: 50% 50%;\n        animation: 2.5s infinite ease-in-out pdl-loading;\n      }\n    </style>\n    <circle\n      class="rotate"\n      cx="256"\n      cy="256"\n      r="224"\n      stroke-width="48"\n      fill="none"\n      stroke-dasharray="1407.43"\n      stroke-dashoffset="1055.57"\n      stroke-linecap="round"\n    ></circle>\n  </symbol>\n\n  <symbol id="pdl-progress" viewBox="0 0 512 512">\n    <style>\n      circle.progress {\n        transition: stroke-dashoffset 0.2s ease;\n      }\n    </style>\n    <circle\n      class="progress"\n      cx="256"\n      cy="256"\n      r="224"\n      stroke-width="48"\n      fill="none"\n      stroke-dasharray="1407.43"\n      stroke-linecap="round"\n      transform="rotate(-90 256 256)"\n    ></circle>\n  </symbol>\n\n  <symbol id="pdl-error" viewBox="0 0 512 512">\n    <path\n      d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm101.8-262.2L295.6 256l62.2 62.2c4.7 4.7 4.7 12.3 0 17l-22.6 22.6c-4.7 4.7-12.3 4.7-17 0L256 295.6l-62.2 62.2c-4.7 4.7-12.3 4.7-17 0l-22.6-22.6c-4.7-4.7-4.7-12.3 0-17l62.2-62.2-62.2-62.2c-4.7-4.7-4.7-12.3 0-17l22.6-22.6c4.7-4.7 12.3-4.7 17 0l62.2 62.2 62.2-62.2c4.7-4.7 12.3-4.7 17 0l22.6 22.6c4.7 4.7 4.7 12.3 0 17z"\n    ></path>\n  </symbol>\n\n  <symbol id="pdl-complete" viewBox="0 0 512 512">\n    <path\n      d="M256 8C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm0 48c110.532 0 200 89.451 200 200 0 110.532-89.451 200-200 200-110.532 0-200-89.451-200-200 0-110.532 89.451-200 200-200m140.204 130.267l-22.536-22.718c-4.667-4.705-12.265-4.736-16.97-.068L215.346 303.697l-59.792-60.277c-4.667-4.705-12.265-4.736-16.97-.069l-22.719 22.536c-4.705 4.667-4.736 12.265-.068 16.971l90.781 91.516c4.667 4.705 12.265 4.736 16.97.068l172.589-171.204c4.704-4.668 4.734-12.266.067-16.971z"\n    ></path>\n  </symbol>\n</svg>\n<button class="pdl-thumbnail" ${this.hasAttribute("disabled")?"disabled":""}>\n      <svg xmlns="http://www.w3.org/2000/svg" class="pdl-icon" ${e?`style="stroke-dashoffset: ${this.clacProgressRadial(this.progress)};"`:""}>\n        <use xlink:href="${qd[this.status]}"></use>\n      </svg>\n      ${e?`<span class="show">${this.progress}</span>`:"<span></span>"}\n    </button>`}dispatchDownload(t){null==t||t.preventDefault(),null==t||t.stopPropagation(),this.setAttribute("disabled",""),this.setStatus("loading");const e=bc(this,Ra,this.mediaId),r=bc(this,Fa,this.page);Promise.resolve(this.onClick(this)).then(()=>{e===wc(this,Ra)&&r===wc(this,Fa)&&(this.setStatus("complete"),this.removeAttribute("disabled"))},t=>{t&&Ld.error(t),e===wc(this,Ra)&&r===wc(this,Fa)&&(this.setStatus("error"),this.removeAttribute("disabled"))}).finally(()=>{e===wc(this,Ra)&&bc(this,Ra,null),r===wc(this,Fa)&&bc(this,Fa,null)})}observeDb(){return zd.subscribe(async()=>{const t=this.mediaId,e=this.page,r=await zd.has(t,e);t===this.mediaId&&e===this.page&&("complete"===this.status?!r&&this.setStatus("init"):r&&this.setStatus("complete"))})}connectedCallback(){this.render(),this.dirty&&(this.dirty=!1),this.connectedFlag=!0,this.btn=this.shadowRoot.querySelector("button"),this.btn.addEventListener("click",this.dispatchDownload),this.shouldObserveDb&&(this.unsubscriber=this.observeDb())}disconnectedCallback(){var t,e;this.connectedFlag=!1,null==(t=this.btn)||t.removeEventListener("click",this.dispatchDownload),null==(e=this.unsubscriber)||e.call(this)}clacProgressRadial(t){const e=2*Math.PI*224;return e-t/100*e}setProgress(t,e=!0){if(t<0||t>100)throw new RangeError('Value "progress" must between 0-100');if(this.mediaId!==wc(this,Ra)||this.page!==wc(this,Fa))return;if(this.progress=Math.floor(t),"progress"!==this.status&&(this.dataset.status="progress"),!this.connectedFlag)return void(this.dirty=!0);const r=this.shadowRoot,a=r.querySelector("span");a.classList.add("show"),a.textContent=String(this.progress),e&&(r.querySelector("svg.pdl-icon").style.strokeDashoffset=String(this.clacProgressRadial(t)))}removeProgress(){if(this.progress=0,!this.connectedFlag)return void(this.dirty=!0);const t=this.shadowRoot,e=t.querySelector("span"),r=t.querySelector("svg.pdl-icon");e.classList.contains("show")&&(e.classList.remove("show"),e.addEventListener("transitionend",()=>{e.textContent=""},{once:!0}),r.style.removeProperty("stroke-dashoffset"))}setStatus(t){if(t!==this.status){if("init"===t)return void delete this.dataset.status;if("progress"===t)return void this.setProgress(0);this.removeProgress(),this.dataset.status=t}}}Ra=new WeakMap,Fa=new WeakMap,za=new WeakSet,qa=function(){this.hasAttribute("disabled")&&this.removeAttribute("disabled"),this.setStatus("init")},customElements.define(Hd.tagNameLowerCase,Hd);const Wd=GM_getResourceText("gif.js/dist/gif.worker?raw"),Ud=URL.createObjectURL(new Blob([Wd],{type:"text/javascript"})),Gd=GM_getResourceText("upng-js?raw"),Yd=GM_getResourceText("pako/dist/pako.js?raw"),Vd=URL.createObjectURL(new Blob(['function isBlobArray(frames) {\n    return frames[0] instanceof Blob;\n}\nasync function encodeAPNG(frames, delays, cnum) {\n    if (isBlobArray(frames)) {\n        frames = await Promise.all(frames.map((frame) => createImageBitmap(frame)));\n    }\n    const width = frames[0].width;\n    const height = frames[0].height;\n    const canvas = new OffscreenCanvas(width, height);\n    const ctx = canvas.getContext("2d", { willReadFrequently: true });\n    const u8arrs = [];\n    for (const frame of frames) {\n        ctx.drawImage(frame, 0, 0);\n        frame.close();\n        u8arrs.push(ctx.getImageData(0, 0, width, height).data);\n    }\n    const png = UPNG.encode(u8arrs, width, height, cnum, delays, { loop: 0 });\n    if (!png)\n        throw new Error("Failed to encode apng.");\n    return png;\n}\nfunction decodeApng(ab) {\n    const img = UPNG.decode(ab);\n    const rgba = UPNG.toRGBA8(img);\n    const { width, height } = img;\n    const delays = img.frames.map((frame) => frame.delay);\n    return { frames: rgba, delays, width, height };\n}\nasync function appendEffect(illustBlob, effect) {\n    const illustBitmap = await createImageBitmap(illustBlob);\n    const { frames: effectFrames, delays, width, height } = decodeApng(effect);\n    const effectBitmaps = await Promise.all(effectFrames.map((buf) => createImageBitmap(new ImageData(new Uint8ClampedArray(buf), width, height))));\n    const { width: illustWidth, height: illustHeight } = illustBitmap;\n    const illustAspectRatio = illustWidth / illustHeight;\n    const effectAspectRatio = width / height;\n    let dx;\n    let dy;\n    let dWidth;\n    let dHeight;\n    if (effectAspectRatio > illustAspectRatio) {\n        dWidth = illustHeight * effectAspectRatio;\n        dHeight = illustHeight;\n        dx = (illustWidth - dWidth) / 2;\n        dy = 0;\n    }\n    else {\n        dWidth = illustWidth;\n        dHeight = illustWidth / effectAspectRatio;\n        dx = 0;\n        dy = (illustHeight - dHeight) / 2;\n    }\n    const canvas = new OffscreenCanvas(illustWidth, illustHeight);\n    const ctx = canvas.getContext("2d", { willReadFrequently: true });\n    const finalDatas = [];\n    for (const effectBitmap of effectBitmaps) {\n        ctx.drawImage(illustBitmap, 0, 0);\n        ctx.drawImage(effectBitmap, dx, dy, dWidth, dHeight);\n        finalDatas.push(ctx.getImageData(0, 0, illustWidth, illustHeight));\n        effectBitmap.close();\n    }\n    illustBitmap.close();\n    const result = finalDatas.map((data) => createImageBitmap(data));\n    return {\n        frames: await Promise.all(result),\n        delays\n    };\n}\nself.onmessage = async (evt) => {\n    try {\n        const data = evt.data;\n        if ("effect" in data) {\n            const { illust, effect } = data;\n            const result = await appendEffect(illust, effect);\n            self.postMessage(result, [...result.frames]);\n        }\n        else {\n            const { frames, delays, cnum = 256 } = data;\n            const apng = await encodeAPNG(frames, delays, cnum);\n            self.postMessage(apng, [apng]);\n        }\n    }\n    catch (error) {\n        console.error(error);\n        self.postMessage(void 0);\n    }\n};\n'+Yd+Gd.replace("window.UPNG","self.UPNG").replace("window.pako","self.pako")],{type:"text/javascript"})),Jd=[],Qd=GM_getResourceText("../wasm/toWebpWorker?raw"),Xd=URL.createObjectURL(new Blob([Qd+'let resolveModule;\nconst moduleLoaded = new Promise((resolve) => {\n    resolveModule = resolve;\n});\nlet webpApi = {};\nModule.onRuntimeInitialized = () => {\n    webpApi = {\n        init: Module.cwrap("init", "", ["number", "number", "number"]),\n        createBuffer: Module.cwrap("createBuffer", "number", ["number"]),\n        addFrame: Module.cwrap("addFrame", "number", ["number", "number", "number"]),\n        generate: Module.cwrap("generate", "number", []),\n        freeResult: Module.cwrap("freeResult", "", []),\n        getResultPointer: Module.cwrap("getResultPointer", "number", []),\n        getResultSize: Module.cwrap("getResultSize", "number", [])\n    };\n    resolveModule();\n};\nfunction isBlobArray(frames) {\n    return frames[0] instanceof Blob;\n}\nonmessage = async (evt) => {\n    await moduleLoaded;\n    const { frames, delays, lossless = 0, quality = 95, method = 4 } = evt.data;\n    webpApi.init(lossless, quality, method);\n    const bitmaps = isBlobArray(frames) ? await Promise.all(frames.map((frame) => createImageBitmap(frame))) : frames;\n    const width = bitmaps[0].width;\n    const height = bitmaps[0].height;\n    const canvas = new OffscreenCanvas(width, height);\n    const ctx = canvas.getContext("2d");\n    for (let i = 0; i < bitmaps.length; i++) {\n        ctx?.drawImage(bitmaps[i], 0, 0);\n        bitmaps[i].close();\n        const webpBlob = await canvas.convertToBlob({\n            type: "image/webp",\n            quality: lossless ? 1 : quality / 100\n        });\n        const buffer = await webpBlob.arrayBuffer();\n        const u8a = new Uint8Array(buffer);\n        const pointer = webpApi.createBuffer(u8a.length);\n        Module.HEAPU8.set(u8a, pointer);\n        webpApi.addFrame(pointer, u8a.length, delays[i]);\n        postMessage((i + 1) / bitmaps.length * 100);\n    }\n    webpApi.generate();\n    const resultPointer = webpApi.getResultPointer();\n    const resultSize = webpApi.getResultSize();\n    const result = new Uint8Array(Module.HEAP8.buffer, resultPointer, resultSize);\n    postMessage(result);\n    webpApi.freeResult();\n};\n'],{type:"text/javascript"})),Kd=[];Ei=(t=>(t.GIF="gif",t.WEBP="webp",t.PNG="png",t.WEBM="webm",t.MP4="mp4",t))(Ei||{});const Zd={getAdapter(t){switch(t.format){case"gif":return(r,a,o,n)=>async function(t,r,a,o,n){null==o||o.throwIfAborted(),function(t){return t[0]instanceof Blob}(t)&&(t=await Promise.all(t.map(t=>createImageBitmap(t)))),null==o||o.throwIfAborted();const i=document.createElement("canvas"),s=i.width=t[0].width,l=i.height=t[0].height,c=i.getContext("2d",{willReadFrequently:!0});let d,u;const p=new Promise((t,e)=>{d=t,u=e}),h=new e({workers:2,quality:a,width:s,height:l,workerScript:Ud});return h.on("progress",t=>{null==n||n(100*t)}),h.on("abort",()=>{u(null==o?void 0:o.reason)}),h.on("finished",t=>{d(t)}),null==o||o.addEventListener("abort",()=>{h.abort()},{once:!0}),t.forEach((t,e)=>{c.drawImage(t,0,0),h.addFrame(c,{copy:!0,delay:r[e]}),t.close()}),h.render(),p}(r,a,t.quality,o,n);case"png":return(e,r,a)=>async function(t,e,r,a){let o,n;null==a||a.throwIfAborted();const i=new Promise((t,e)=>{o=t,n=e});let s;Jd.length?(s=Jd.shift(),Ld.info("Reuse apng workers.")):s=new Worker(Vd),null==a||a.addEventListener("abort",()=>{s.terminate(),n(null==a?void 0:a.reason)},{once:!0}),s.onmessage=function(t){if(Jd.push(s),null==a?void 0:a.aborted)return;if(!t.data)return n(new TypeError("Failed to get png data."));const e=new Blob([t.data],{type:"image/png"});o(e)};const l={frames:t,delays:e,cnum:r};return s.postMessage(l,l.frames[0]instanceof ImageBitmap?l.frames:[]),i}(e,r,t.cnum,a);case"mp4":return(e,r,o)=>async function(t,e,r,o){null==o||o.throwIfAborted(),function(t){return t[0]instanceof Blob}(t)&&(t=await Promise.all(t.map(t=>createImageBitmap(t)))),null==o||o.throwIfAborted();let n=t[0].width,i=t[0].height;n%2!=0&&(n+=1),i%2!=0&&(i+=1);const s=new a.Muxer({target:new a.ArrayBufferTarget,video:{codec:"avc",width:n,height:i},fastStart:"in-memory"}),l=new VideoEncoder({output:(t,e)=>s.addVideoChunk(t,e),error:t=>Ld.error(t)});l.configure({codec:"avc1.420034",width:n,height:i,bitrate:1e6*r});let c=0;e=e.map(t=>1e3*t);const d=[];null==o||o.addEventListener("abort",()=>{d.forEach(t=>t.close())},{once:!0});for(const[r,a]of t.entries()){const t=new VideoFrame(a,{duration:e[r],timestamp:c});l.encode(t),d.push(t),a.close(),c+=e[r]}await l.flush(),l.close(),d.forEach(t=>t.close()),null==o||o.throwIfAborted(),s.finalize();const{buffer:u}=s.target;return new Blob([u],{type:"video/mp4"})}(e,r,t.bitrate,o);case"webm":return(e,a,o)=>async function(t,e,a,o){null==o||o.throwIfAborted(),function(t){return t[0]instanceof Blob}(t)&&(t=await Promise.all(t.map(t=>createImageBitmap(t)))),null==o||o.throwIfAborted();const n=t[0].width,i=t[0].height,s=new r.Muxer({target:new r.ArrayBufferTarget,video:{codec:"V_VP9",width:n,height:i}}),l=new VideoEncoder({output:(t,e)=>s.addVideoChunk(t,e),error:t=>Ld.error(t)});l.configure({codec:"vp09.00.51.08.01.01.01.01.00",width:n,height:i,bitrate:1e6*a});let c=0;e=e.map(t=>1e3*t);const d=[];null==o||o.addEventListener("abort",()=>{d.forEach(t=>t.close())},{once:!0});for(const[r,a]of t.entries()){const t=new VideoFrame(a,{duration:e[r],timestamp:c});l.encode(t),d.push(t),a.close(),c+=e[r]}await l.flush(),l.close(),d.forEach(t=>t.close()),null==o||o.throwIfAborted(),s.finalize();const{buffer:u}=s.target;return new Blob([u],{type:"video/webm"})}(e,a,t.bitrate,o);case"webp":return(e,r,a,o)=>{const{lossless:n,quality:i,method:s}=t;return async function(t,e,r,a,o,n,i){let s,l,c;null==n||n.throwIfAborted(),Kd.length?(s=Kd.shift(),Ld.info("Reuse webp workers.")):s=new Worker(Xd);const d=new Promise((t,e)=>{l=t,c=e});return null==n||n.addEventListener("abort",()=>{s.terminate(),c(null==n?void 0:n.reason)},{once:!0}),s.onmessage=t=>{(null==n?void 0:n.aborted)||("object"!=typeof t.data?null==i||i(t.data):(Kd.push(s),l(new Blob([t.data],{type:"image/webp"}))))},s.postMessage({frames:t,delays:e,lossless:Number(r),quality:a,method:o},t[0]instanceof ImageBitmap?t:[]),d}(e,r,n,i,s,a,o)};default:throw new Error("Unspported format.")}},getMixEffectFn:()=>Or},tu=localStorage.getItem("pdlSetting");tu&&localStorage.removeItem("pdlSetting");const eu=tu?JSON.parse(tu):{};Si=(t=>(t.LEFT_PERCENT="--pdl-btn-left-percent",t.TOP_PERCENT="--pdl-btn-top-percent",t.PIXIV_BOOKMARK_LEFT_PERCENT="--pdl-btn-pixiv-bookmark-left-percent",t.PIXIV_BOOKMARK_TOP_PERCENT="--pdl-btn-pixiv-bookmark-top-percent",t.LEFT_PX="--pdl-btn-left-px",t.TOP_PX="--pdl-btn-top-px",t.PIXIV_BOOKMARK_LEFT_PX="--pdl-btn-pixiv-bookmark-left-px",t.PIXIV_BOOKMARK_TOP_PX="--pdl-btn-pixiv-bookmark-top-px",t))(Si||{}),Ci=(t=>(t[t.PERCENT=0]="PERCENT",t[t.PX=1]="PX",t))(Ci||{}),Pi=(t=>(t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT",t))(Pi||{}),Ii=(t=>(t[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM",t))(Ii||{});const ru=jr("pdl-button-position",{"--pdl-btn-left-percent":eu["pdl-btn-left"]??0,"--pdl-btn-left-px":0,"--pdl-btn-top-percent":eu["pdl-btn-top"]??100,"--pdl-btn-top-px":0,"--pdl-btn-pixiv-bookmark-left-percent":eu["pdl-btn-self-bookmark-left"]??100,"--pdl-btn-pixiv-bookmark-left-px":0,"--pdl-btn-pixiv-bookmark-top-percent":eu["pdl-btn-self-bookmark-top"]??76,"--pdl-btn-pixiv-bookmark-top-px":0,thumbnailBtnUnitX:0,thumbnailBtnUnitY:0,pixivBookmarkBtnUnitX:0,pixivBookmarkBtnUnitY:0,artworkBtnAlignX:1,artworkBtnAlignY:0},{setPosition(t,e){const r=document.documentElement,a=getComputedStyle(r).getPropertyValue(t);a&&a===e||r.style.setProperty(t,e)}});Nt(()=>{[[()=>ru.thumbnailBtnUnitX,"--pdl-btn-left-px","--pdl-btn-left-percent"],[()=>ru.thumbnailBtnUnitY,"--pdl-btn-top-px","--pdl-btn-top-percent"],[()=>ru.pixivBookmarkBtnUnitX,"--pdl-btn-pixiv-bookmark-left-px","--pdl-btn-pixiv-bookmark-left-percent"],[()=>ru.pixivBookmarkBtnUnitY,"--pdl-btn-pixiv-bookmark-top-px","--pdl-btn-pixiv-bookmark-top-percent"]].forEach(([t,e,r])=>{Dt(()=>{let a,o;1===t()?(a=ru[e]+"px",o="0"):(a="0px",o=String(ru[r])),ru.setPosition(e,a),ru.setPosition(r,o)})})});class au extends HTMLElement{constructor(t){super(),fc(this,"props"),vc(this,Ha),vc(this,Wa),vc(this,Ua,[]),this.props=t}static get tagNameLowerCase(){return"pdl-artwork-button"}render(){if(this.shadowRoot)return;const t=this.attachShadow({mode:"open"}),e={...this.props},r=e.site;t.innerHTML=`<style>.button-wrapper{--pdl-sticky-container-safe-area-top: 0px;--pdl-sticky-container-safe-area-bottom: 0px;--pdl-sticky-container-safe-area-right: 8px;--pdl-sticky-container-safe-area-left: 8px;inset:var(--pdl-sticky-container-safe-area-top) var(--pdl-sticky-container-safe-area-right) var(--pdl-sticky-container-safe-area-bottom) var(--pdl-sticky-container-safe-area-left);position:absolute;direction:ltr;pointer-events:none}.button-wrapper.rtl{direction:rtl}.button-wrapper.pixiv{--pdl-sticky-container-safe-area-top: 40px}.button-wrapper.gelbooru{--pdl-sticky-container-safe-area-bottom: calc(1em + 22px) }.button-wrapper.moebooru_image{--pdl-sticky-container-safe-area-right: calc(5em + 8px) }.button-wrapper.native_video{--pdl-sticky-container-safe-area-bottom: 70px}.button-wrapper.vjs_video{--pdl-sticky-container-safe-area-bottom: 32px}.button-wrapper.fluid_video{--pdl-sticky-container-safe-area-bottom: 56px}</style><div class="button-wrapper${r?" "+r:""}"></div>`,delete e.site;const a=new Hd({type:Ai.Gallery,...e});r&&a.classList.add(r);const o=t.querySelector(".button-wrapper");o.appendChild(a),bc(this,Wa,a),bc(this,Ha,o)}connectedCallback(){this.render();const t=Ir(()=>ru.artworkBtnAlignX).subscribe(t=>{var e,r;t===Pi.LEFT?null==(e=wc(this,Ha))||e.classList.remove("rtl"):null==(r=wc(this,Ha))||r.classList.add("rtl")}),e=Ir(()=>ru.artworkBtnAlignY).subscribe(t=>{var e,r;t===Ii.TOP?null==(e=wc(this,Wa))||e.classList.remove("bottom"):null==(r=wc(this,Wa))||r.classList.add("bottom")});wc(this,Ua).push(t,e)}disconnectedCallback(){for(const t of wc(this,Ua))t();wc(this,Ua).length=0}}Ha=new WeakMap,Wa=new WeakMap,Ua=new WeakMap,customElements.define(au.tagNameLowerCase,au),Ti=(()=>"undefined"!=typeof GM_download?GM_download:void 0)(),$i=(()=>"undefined"!=typeof GM_info?GM_info:void 0)(),Bi=(()=>"undefined"!=typeof GM_registerMenuCommand?GM_registerMenuCommand:void 0)(),Di=(()=>"undefined"!=typeof GM_xmlhttpRequest?GM_xmlhttpRequest:void 0)(),Ni=(()=>"undefined"!=typeof unsafeWindow?unsafeWindow:void 0)(),"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("5");const ou="modalStore",nu={message:"Missing Toast Message",autohide:!0,timeout:5e3},iu="toastStore",su={};qr("modeOsPrefers",!1),qr("modeUserPrefers",void 0),qr("modeCurrent",!1);const lu="(prefers-reduced-motion: reduce)",cu={subscribe:Sr(window.matchMedia(lu).matches,t=>{{const e=e=>{t(e.matches)},r=window.matchMedia(lu);return r.addEventListener("change",e),()=>{r.removeEventListener("change",e)}}}).subscribe};Gc=!0;const du=t=>t;Mi=he('<div data-testid="accordion"><!></div>'),Oi=he('<div class="accordion-lead"><!></div>'),Li=he("<div><!></div>"),ji=he("<div><!></div>"),Ri=he('<div role="region"><!></div>'),Fi=he('<div data-testid="accordion-item"><button type="button"><!> <div class="accordion-summary flex-1"><!></div> <!></button> <!></div>'),zi=he("<div><!></div>"),qi=he("<div><!></div>"),Hi=he("<div><!></div>"),Wi=he('<div data-testid="app-bar" role="toolbar"><div><!> <div><!></div> <!></div> <!></div>'),Ui=he('<div data-testid="file-button"><div class="w-0 h-0 overflow-hidden"><input></div> <button type="button"><!></button></div>'),Gi=he("<option> </option>"),Yi=he('<div><button type="button"><span> </span> <span>✕</span></button></div>'),Vi=he("<div></div>"),Ji=he('<div><div class="h-0 overflow-hidden"><select multiple tabindex="-1"></select></div> <div><input> <!></div></div>'),Qi=he('<div role="listbox" data-testid="listbox"><!></div>'),Xi=he('<input type="checkbox" tabindex="-1">'),Ki=he('<input type="radio" tabindex="-1">'),Zi=he("<div><!></div>"),ts=he("<div><!></div>"),es=he('<label><div data-testid="listbox-item" role="option" tabindex="0"><div class="h-0 w-0 overflow-hidden"><!></div> <div><!> <div><!></div> <!></div></div></label>'),rs=he('<div data-testid="progress-bar" role="progressbar"><div></div></div>'),as=ge('<text x="50%" y="50%" text-anchor="middle" dominant-baseline="middle" font-weight="bold"><!></text>'),os=he('<figure data-testid="progress-radial" role="meter"><svg class="rounded-full"><circle cx="50%" cy="50%"></circle><circle cx="50%" cy="50%"></circle><!></svg></figure>'),ns=he('<div data-testid="radio-group" role="radiogroup"><!></div>'),is=he('<label><div data-testid="radio-item" role="radio" tabindex="0"><div class="h-0 w-0 overflow-hidden"><input></div> <!></div></label>'),ss=he("<label><!></label>"),ls=he("<option></option>"),cs=he('<datalist class="range-slider-ticks"></datalist>'),ds=he('<div class="range-slider-trail"><!></div>'),us=he('<div data-testid="range-slider"><!> <div><input> <!></div> <!></div>'),ps=he('<div class="slide-toggle-text ml-3"><!></div>'),hs=he('<div data-testid="slide-toggle" role="switch" tabindex="0"><label><input> <div><div></div></div> <!></label></div>'),gs=he('<div role="tabpanel" tabindex="0"><!></div>'),fs=he('<div data-testid="tab-group"><div role="tablist"><!></div> <!></div>'),ms=he('<div class="tab-lead"><!></div>'),ws=he('<label><div data-testid="tab" role="tab"><div class="h-0 w-0 overflow-hidden"><input></div> <div><!> <div class="tab-label"><!></div></div></div></label>'),vs=he("<header><!></header>"),bs=he("<article><!></article>"),ys=he('<img alt="Modal">'),xs=he('<footer><button type="button"> </button></footer>'),ks=he('<footer><button type="button"> </button> <button type="button"> </button></footer>'),_s=he('<form class="space-y-4"><input> <footer><button type="button"> </button> <button type="submit"> </button></footer></form>'),As=he('<div data-testid="modal" role="dialog" aria-modal="true"><!> <!> <!> <!></div>'),Es=he('<div data-testid="modal-component" role="dialog" aria-modal="true"><!></div>'),Ss=he('<div data-testid="modal-backdrop"><div><!></div></div>'),Cs=he("<button><!></button>"),Ps=he('<button aria-label="Dismiss toast"> </button>'),Is=he("<div><!> <!></div>"),Ts=he('<div aria-live="polite"><div data-testid="toast"><div class="text-base"><!></div> <!></div></div>'),$s=he('<div data-testid="snackbar-wrapper"><div></div></div>');const uu="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxMAAAsTAQCanBgAADzWSURBVHhe7Z0HnBRF9sdrMyxZoiCegKCCOZ3xzKcCgp56CoqKohj+6pmznBGMGM+cQDALBgwneuZ4nieGU5KKIoqAIrCEDf1/3zddQ29vd09P2oD++BQzW93TXV316uWqLvhZUCowv8P8+OOP5uOPPzY9evQwvXr1MoWFhe6RYDiOY2bPnm2+/vprs+WWW5p27dq5R37bWCEwNTU1K6WDfvNYvny5M2LECKd58+bOjjvu6Hz77bfukXB88803zuabb+60aNHCueqqq5xVq1a5R+JB+t79tmZBnms5U7IqQWdrHhYvXmymTZvm/hWNlStXmpkzZxohMOVCcK9UKCkpMT/88INZtmyZqa6uNgUFBe6RaHzxxRdm6dKl7l9rJKqieX0Txi+//GKGDh1qhKOYs846y1RVRc+fsrIy0759eyWOyspK2Ll7JBxrr722ef31182ECRPMyJEjTXFxsXskHOeee67p27ev+b//+79Y92iqWGMJCy4yb9481YNeeOGFlBwINbNbt26qV8G94g567969lYDXWmsttyYatIM2iWqLGuLWrnlYYwmrdevWyoHATz/9ZL777jv9HgYIqmPHjqaoqEg5FmIUAsg1xo4dax588EFz/fXXm/Lycrd2zUOTIiy4CDqNKMluTThatmxpNt54YxVPiMXvv/8+JaF07dpVCYvrw1nywVHatm1rDjvsMLU64+hk6G60Jc4zNyY0GcJCPI0ePdoMGjTIiAWmXCUKDNr+++9vNthgA7PeeuupmEs1kB06dFDCgqDgcg0tqrj/zTffbAYPHmzGjRuXUk9sVJDGL5OZ3OghHMfZZpttYDmO6DXOl19+6R4JhwyEI7PdmTNnjn5PhX/9619Oq1at9B4nn3yyuiDiQvrR/ZY7VFRUOMJFtT177723s2TJEvdI44b0xZImw7FQjvv166cc5auvvjJTp05VMREFzu3UqZPp3r27fk8FxJQ9LxXH4t633Xab2XrrrVVfSsVBM0GzZs3MlVdeaf70pz+Z4cOHm+bNm7tHmgCaCscC77//vtOmTRudwZtuuqkjg+8eiQYz/7PPPnNk8N2aYMyePdvp3LmzXn+PPfZwfv31V/dIXcyfP9/Zbrvt9Ny+ffsqV4xC3DYEAU4lhOz+1fjRpDiWtNdstdVWZt9999W/P/30UzNlyhT9ngrXXHON2XHHHdWHFAUh2mRYZtGiRZEcCwcnliOAy6XyYV133XXahlGjRrk18dGiRYuU4aVGh8bAscTaiz0jZ8yYoSEUabrqWmLxuUfCIaJEzxcCcObNm+fW1gXtsHrcH/7wh0iO+MUXXzg9evTQc//4xz86QojukbrgulZXEmPCrQ0HoaFrr73WkYngiBUcW3+jD9PRC/OFRsGx3nvvPXPUUUeZ++67L5aesv7665tjjjlGvwuRmXvuuUe/R0EGXj/Ri15++WX9HgS87zvttJN+h3NFcSFcHzhhgYjPSP1HjAJ1kwARsfoZhaefflq565gxY8xTTz0Vyy1BKOqGG25QVwb6Z4OjoTnWgQce6EjHafD3zTffdGuj8c477ziiaMfiFkBEpiNEo+eLEhzKHeEMIt6cCy+8UC3EKC767rvvOq1bt9ZrCqG7tcE47rjj9DzKs88+69YGg/tvttlmei5t5j5xMHPmTGejjTbSvtxnn30y0uVyhUbBsbB40FGYccOGDdMwTCrgm8IaYyb/73//M//+97/dI8HgfOl09XSjR4VxAOrx2F922WVm1113jeQUePJFIdfv1sMfBvxjOGy32GILs+2227q1wXj44YfNl19+qd+HDBlixEjR76lAG0jd6dmzp+qhcazgvKKhORbWkrDv5Iw++OCDI60xi0cffVR1LazEl156ya0NBj6s//znP8ot0tFZoiDErHqTEIxytygsXLjQefHFF9UqTKVL3nXXXcq9hRidV155Ja22LliwQP176HQNCThWAYQlM7NBg1b//e9/zX777adcoFWrVkaIxuy99956LIxr4IV+5plnVNfBw17fPh70tY8++kitVThFrjgEz/PEE08ohxswYECsjInGBumTpQ3OsZiRzOKLLrrIKSkpUa5Fot3PP//snpFbYOkxo9PhBL8jPcCxGlzHgiPhozn99NONKPJah2ed2GBcEGT+8MMPk7E0eTb99IPcKeJuf//732OnxdQnPvnkkzUnAbChOZYX0qnO3/72N+eBBx5QX04criImv3PEEUeolYjfB+4X9jtSj+WRndLSUmfatGlubV288MILzvHHH+98+umnbk1d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";Bs=he('<div data-theme="skeleton"><section class="overflow-hidden h-full"><!></section> <div class="absolute top-2 right-2 z-1 select-none flex items-center gap-1"><a target="_blank" href="https://github.com/drunkg00se/Pixiv-Downloader" class="w-5 fill-current"><!></a> <button class="btn-icon btn-icon-sm bg-transparent font-bold hover:text-xl">✕</button></div></div>'),ce(["click"]);const pu={zh:{setting:{save_to:{title:"保存至",label:{directory:"保存位置",filename:"文件名"},options:{use_fsa:"使用FileSystemAccess API",fsa_directory:"选择保存文件夹",fsa_filename_conflict:"当文件名重复时",tag_language:"使用的标签语言",tag_language_tips:"无翻译的标签仍可能是其他语言"},button:{choose_fsa_directory:"浏览"},radio:{filename_conflict_option_uniquify:"重命名",filename_conflict_option_overwrite:"覆盖",filename_conflict_option_prompt:"提示"},placeholder:{sub_directory_unused:"如不需要保存到子目录，此行留空即可",vm_not_supported:"Violentmonkey不支持",need_browser_api:'请将下载模式设置为"Browser Api"',filename_requried:"必填"}},ugoira:{title:"动图转换",label:{format:"动图格式",quality:"动图质量"},options:{select_format:"将动图转换到所选格式",gif_tips:"数值越低颜色越好，但处理速度显著减慢",webm_tips:"0最差，99最好",webp_lossy:"无损转换",webp_quality:"图片质量",webp_quality_tips:"有损：0表示文件最小，100表示文件最大。无损：0最快，但文件较大，100最慢，但质量最好。",webp_method:"压缩方法",webp_method_tips:"0=快，6=慢但效果更好",png_tips:"颜色数量。0：所有颜色（无损PNG）"}},history:{title:"下载历史",label:{scheduled_backups:"定期备份",export:"导出",import:"导入",clear:"清理"},options:{scheduled_backups:"以选定的时间间隔自动备份下载历史",export_as_json:"将下载历史导出为JSON文件",export_as_csv:"将下载历史导出为CSV文件",import_json:"导入JSON格式下载历史",clear_history:"清除下载历史"},button:{export:"导出记录",import:"导入记录",clear:"清除记录"},select:{backup_interval_never:"不备份",backup_interval_every_day:"每天",backup_interval_every_7_day:"每7天",backup_interval_every_30_day:"每30天"},text:{confirm_clear_history:"真的要清除历史记录吗？"}},button_position:{title:"按钮位置",label:{common:"通用",my_bookmark:"我的收藏",gallery:"画廊"},options:{horizontal_position:"水平位置",vertical_position:"垂直位置",horizontal_alignment:"水平对齐",vertical_alignment:"垂直对齐"}},authorization:{title:"网站认证"},others:{title:"其它",options:{show_setting_button:"显示设置按钮",bundle_multipage_illust:"将多页插图打包为zip压缩包",bundle_manga:"将漫画作品打包为zip压缩包",like_illust_when_downloading:"下载作品时点赞",add_bookmark_when_downloading:"下载作品时收藏",add_bookmark_with_tags:"收藏时添加作品标签",add_bookmark_private_r18:"将R-18作品收藏到不公开类别",option_does_not_apply_to_batch_download:"批量下载不适用"}},feedback:{title:"反馈 / 赞赏",label:{feedback:"反馈",donate:"赞赏"},text:{feedback_desc:'如果你在使用中发现了问题或有改进建议，欢迎到<a href="https://github.com/drunkg00se/Pixiv-Downloader/issues" target="_blank" class="anchor">此链接</a>反馈。',give_me_a_star:'如果脚本有帮助到你，<a href="https://github.com/drunkg00se/Pixiv-Downloader" target="_blank" class="anchor">欢迎点此在GitHub中给我一个 ⭐Star。</a>',donate_desc:"或者，扫码请我喝杯可乐 ^_^"}}},downloader:{category:{tab_name:"类别",filter:{exclude_downloaded:"排除已下载",exclude_blacklist:"排除黑名单",image:"图片",video:"视频",download_all_pages:"下载所有页",download_selected_pages:"自定义页数",pixiv_illust:"插画",pixiv_manga:"漫画",pixiv_ugoira:"动图"}},tag_filter:{tab_name:"标签",placeholder:{blacklist_tag:"黑名单，将排除含有以下标签的作品。",whitelist_tag:"白名单，只下载包含以下标签的作品。"}},others:{tab_name:"其它",options:{retry_failed:"对首次下载失败的图片进行重试"}},download_type:{stop:"停止",pixiv_works:"作品",pixiv_bookmark:"收藏",pixiv_bookmark_public:"公开收藏",pixiv_bookmark_private:"不公开收藏",pixiv_follow_latest_all:"全部",pixiv_follow_latest_r18:"R-18",pixiv_series:"系列",moebooru_posts:"投稿",moebooru_pool:"图集",moebooru_popular_1d:"日",moebooru_popular_1w:"周",moebooru_popular_1m:"月",moebooru_popular_1y:"年",moebooru_popular_date:"人气"},file_handle_not_found:{title:"重复文件名 / 无效文件名",button:{save:"保存",cancel:"取消"}},failed_downloads:"下载失败"},button:{setting:"设置"},changelog:{feedback:"有问题or想建议？这里反馈",credit:"脚本还行？请点这里支持我！",give_me_a_star:"在GitHub中给我一个 ⭐Star，",buy_me_a_drink:"或者，扫码请我喝杯香草味冰可乐。^_^"},toast:{message:{pick_directory_handle:"请选择保存文件夹",file_handle_not_found:"文件名重复或无效，请手动保存",request_directory_handle_permission:"请授予权限以修改文件/文件夹"},actionLabel:{browse:"浏览",save:"保存",allow_permission:"同意"}}},en:{setting:{save_to:{title:"Save To",label:{directory:"Save Path",filename:"Filename"},options:{use_fsa:"Use FileSystemAccess API",fsa_directory:"Select directory",fsa_filename_conflict:"When filename conflicts",tag_language:"Tag Language",tag_language_tips:"Tags without translation may still be in another language"},button:{choose_fsa_directory:"Browse"},radio:{filename_conflict_option_uniquify:"Uniquify",filename_conflict_option_overwrite:"Overwrite",filename_conflict_option_prompt:"Prompt"},placeholder:{sub_directory_unused:"Leave folder name blank if not saving to a subdirectory",vm_not_supported:"Not supported by Violentmonkey",need_browser_api:"Browser API required",filename_requried:"Required"}},ugoira:{title:"Ugoira",label:{format:"Ugoira Format",quality:"Ugoira Quality"},options:{select_format:"Convert Ugoira to selected format",gif_tips:"Lower values produce better colors, but slow processing significantly",webm_tips:"0 (worst) to 99 (best)",webp_lossy:"Lossless Webp",webp_quality:"Image Quality",webp_quality_tips:"For lossy, 0 gives the smallest size and 100 the largest. For lossless, 0 is the fastest but gives larger files compared to the slowest, but best, 100.",webp_method:"Compression Method",webp_method_tips:"Quality/speed trade-off (0=fast, 6=slower-better)",png_tips:"Number of colors in the result; 0: all colors (lossless PNG)"}},history:{title:"History",label:{scheduled_backups:"Scheduled Backups",export:"Export",import:"Import",clear:"Clear"},options:{scheduled_backups:"Automatically back up download history at selected intervals.",export_as_json:"Export download history as JSON file",export_as_csv:"Export download history as CSV file",import_json:"Import JSON format download history",clear_history:"Clear download history"},button:{export:"Export",import:"Import",clear:"Clear"},select:{backup_interval_never:"Never",backup_interval_every_day:"Every day",backup_interval_every_7_day:"7 days",backup_interval_every_30_day:"30 days"},text:{confirm_clear_history:"Do you really want to clear history?"}},button_position:{title:"Button",label:{common:"Common",my_bookmark:"My Bookmark",gallery:"Gallery"},options:{horizontal_position:"Horizontal Position",vertical_position:"Vertical Position",horizontal_alignment:"Horizontal Alignment",vertical_alignment:"Vertical Alignment"}},authorization:{title:"Auth"},others:{title:"Others",options:{show_setting_button:"Show Setting Button",bundle_multipage_illust:"Bundle multipage illustrations into a zip file",bundle_manga:"Bundle manga into a zip file",like_illust_when_downloading:"Like the artwork when downloading",add_bookmark_when_downloading:"Bookmark artwork when downloading",add_bookmark_with_tags:"Add tags when bookmarking",add_bookmark_private_r18:"Bookmark R-18 artwork as private",option_does_not_apply_to_batch_download:"This option does not apply to batch download"}},feedback:{title:"Feedback",label:{feedback:"Feedback",donate:"Donate"},text:{feedback_desc:'If you encounter any issues or have suggestions for improvements, feel free to provide feedback <a href="https://github.com/drunkg00se/Pixiv-Downloader/issues" target="_blank" class=" anchor">here.</a>',give_me_a_star:'If the script is helpful to you, please <a href="https://github.com/drunkg00se/Pixiv-Downloader" target="_blank" class="anchor">click here and give me a ⭐Star on GitHub.</a>',donate_desc:"Or, buy me a cola. ^_^"}}},downloader:{category:{tab_name:"Category",filter:{exclude_downloaded:"Exclude Downloaded",exclude_blacklist:"Exclude Blacklist",image:"Image",video:"Video",download_all_pages:"All Pages",download_selected_pages:"Custom Pages",pixiv_illust:"Illustration",pixiv_manga:"Manga",pixiv_ugoira:"Ugoira"}},tag_filter:{tab_name:"Tags",placeholder:{blacklist_tag:"Blacklist: Exclude works with these tags.",whitelist_tag:"Whitelist: Only download works with these tags."}},others:{tab_name:"others",options:{retry_failed:"Retry failed image downloads."}},download_type:{stop:"Stop",pixiv_works:"Works",pixiv_bookmark:"Bookmarks",pixiv_bookmark_public:"Public",pixiv_bookmark_private:"Private",pixiv_follow_latest_all:"All",pixiv_follow_latest_r18:"R-18",pixiv_series:"Series",moebooru_posts:"Posts",moebooru_pool:"Pool",moebooru_popular_1d:"1d",moebooru_popular_1w:"1w",moebooru_popular_1m:"1m",moebooru_popular_1y:"1y",moebooru_popular_date:"Popular"},file_handle_not_found:{title:"Duplicate / Invalid File Name",button:{save:"Save",cancel:"Cancel"}},failed_downloads:"Failed downloads"},button:{setting:"Setting"},changelog:{feedback:"Feedback / Report an issue",credit:"Click here to support me!",give_me_a_star:"Give me a ⭐Star on GitHub.",buy_me_a_drink:"Or, buy me a vanilla-flavored iced cola. ^_^"},toast:{message:{pick_directory_handle:"Select a folder to save",file_handle_not_found:"The file name is duplicated or invalid. Please save it manually.",request_directory_handle_permission:"Please allow permission to edit files and folders."},actionLabel:{browse:"Browse",save:"Save",allow_permission:"Allow"}}}},hu=navigator.language.split("-")[0],{t:gu,setlocale:fu,locale:mu,availableLocales:wu}=function(t){let e=y(vt(t.locale));return{t:r=>{const a=r.split(".");let o=t.message[et(e)];for(const t of a)if(o=o[t],void 0===o)return"null";return o},setlocale:r=>{r!==et(e)&&Object.keys(t.message).includes(r)&&A(e,vt(r))},locale:{get current(){return et(e)}},get availableLocales(){return Object.keys(t.message)}}}({locale:hu in pu?hu:"en",message:pu});Ds=(t,e)=>A(e,!et(e)),Ns=he('<header class="modal-header text-2xl font-bold"></header> <article class="modal-body mt-4"><h4 class=" text-xl mt-2">新增</h4> <ul class="list-disc list-inside leading-loose"><li>为Pixiv首页信息流添加下载按钮。</li></ul></article> <footer class="modal-footer mt-4"><div class="flex justify-between items-center text-sm"><button> </button> <a target="_blank" href="https://github.com/drunkg00se/Pixiv-Downloader/issues"> </a></div> <div><div class="flex justify-center items-center min-h-0 gap-14 overflow-hidden"><img alt="credit" class="rounded-full"> <p class="flex flex-col h-full justify-evenly"><a href="https://github.com/drunkg00se/Pixiv-Downloader" target="_blank" class="anchor"> </a> <span> </span></p></div></div></footer>',1),ce(["click"]);const vu='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm-32-316v116h-67c-10.7 0-16 12.9-8.5 20.5l99 99c4.7 4.7 12.3 4.7 17 0l99-99c7.6-7.6 2.2-20.5-8.5-20.5h-67V140c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12z"></path></svg>',bu=(t,e)=>{Dt(()=>{t.value=String(e.get())}),Dt(()=>{const r=se(t,"input",function(){this.reportValidity()?(this.classList.remove("input-error"),e.set(+this.value)):this.classList.add("input-error")});return()=>{r()}})},yu=localStorage.getItem("pdl-downloader_option");yu&&localStorage.removeItem("pdl-downloader_option");const xu=yu?JSON.parse(yu):{},ku=jr("pdl-batch-downloader",{selectedFilters:xu.selectedFilters??null,blacklistTag:xu.blacklistTag??[],whitelistTag:xu.whitelistTag??[],downloadAllPages:xu.downloadAllPages??!0,pageStart:xu.pageStart??1,pageEnd:xu.pageEnd??1,retryFailed:xu.retryFailed??!1});let _u=(Va=class{constructor(t,e){vc(this,Ga),vc(this,Ya),bc(this,Ga,t),bc(this,Ya,Pr(e))}get current(){return wc(this,Ya).call(this),wc(this,Ga).call(this)}},Ga=new WeakMap,Ya=new WeakMap,Va);const Au=/\(.+\)/;class Eu{constructor(t,e){vc(this,Ja),vc(this,Qa),bc(this,Ja,t),bc(this,Qa,Pr(e))}get current(){return wc(this,Qa).call(this),wc(this,Ja).call(this)}}Ja=new WeakMap,Qa=new WeakMap;const Su="event-file-handle-not-fount",Cu="event-dir-handle-not-fount",Pu="event-request-user-activation";class Iu extends Error{constructor(t,e){super(e+" "+t),fc(this,"url"),fc(this,"status"),this.name="RequestError",this.url=t,this.status=e}}class Tu extends Error{constructor(){super("User aborted."),this.name="CancelError"}}class $u extends Error{constructor(t){super(t),this.name="JsonDataError"}}class Bu extends Error{constructor(t){super(t),this.name="TimoutError"}}class Du extends Error{constructor(){super("Permission denied."),this.name="PermissionError"}}class Nu extends Error{constructor(t){super(`Invalid post id: ${t}.`),this.name="InvalidPostError"}}Ms=he("<!> <!> <!>",1),Os=he('<label class="btn !py-2 rounded-none !transform-none cursor-pointer variant-soft-surface has-[:checked]:!variant-filled-primary text-sm w-full"><div class="w-0 h-0 overflow-hidden hidden"><input type="checkbox"></div> <div class="!m-0"> </div></label>'),Ls=he('<div class="flex justify-end items-center my-4"><div class="btn-group w-full"></div></div>'),js=he("<!> <!>",1),Rs=he('<!> <div class="flex justify-between items-center my-4 gap-4"><div class="flex-grow w-full"><!></div> <div class="flex justify-between items-center gap-4 w-full"><label class="input-group input-group-divider flex [&amp;>input]:!min-w-0 [&amp;>input]:!border-transparent border-surface-400/20 dark:border-surface-500/20 bg-surface-400/20 dark:bg-surface-500/20"><div class="input-group-shim !px-1 flex-none"><i class="w-6 fill-current"><!></i></div> <input class="w-20 pr-0 text-surface-700-200-token text-sm" type="number" min="1" step="1" required></label> <label class="input-group input-group-divider flex [&amp;>input]:!min-w-0 [&amp;>input]:!border-transparent border-surface-400/20 dark:border-surface-500/20 bg-surface-400/20 dark:bg-surface-500/20"><div class="input-group-shim !px-1 flex-none"><i class="w-6 fill-current"><!></i></div> <input class="w-20 pr-0 text-surface-700-200-token text-sm" type="number" min="1" step="1" required></label></div></div>',1),Fs=he("<!> <!>",1),zs=he('<div class="flex justify-between items-center text-base text-surface-700-200-token"><p> </p> <!></div>'),qs=he('<div class="downloader-filter"><!> <hr class="!border-t-1 my-4"></div>'),Hs=(t,e,r)=>{e(r())},Ws=he('<button class="btn rounded-none !transform-none !variant-filled-primary"><i class="w-5"><!></i> <span> </span></button>'),Us=he('<div class=" flex-none btn-group self-start"></div>'),Gs=(t,e,r)=>{var a;e((null==(a=et(r))?void 0:a[0][0])??"")},Ys=he('<button class="btn variant-filled-primary self-start"><i class="w-5"><!></i> <span> </span></button>'),Vs=he('<div class="flex justify-end flex-grow w-full gap-4"><div class="flex flex-grow flex-col justify-between overflow-hidden text-surface-700-200-token"><p class="truncate"> </p> <p class="break-words"> </p></div> <!></div>'),Js=(t,e)=>{e()},Qs=he('<div class="flex flex-grow w-full gap-6 items-center"><div class="flex flex-grow flex-col justify-between h-full overflow-hidden"><!> <div class="flex items-center justify-between gap-4 basis-0 text-surface-700-200-token"><p class="truncate"> </p> <p class=" flex-none"> </p></div></div> <button class="btn variant-filled-primary"><i class="w-5"><!></i> <span> </span></button></div>'),Xs=he('<li><div class="flex-1 flex flex-col overflow-hidden"><span class="text-base truncate"> </span> <span class="text-sm text-surface-400 truncate"> </span></div> <div><button class="btn variant-soft-surface"> </button> <button class="btn variant-soft-primary"> </button></div></li>'),Ks=he('<div class="text-surface-700-200-token mt-4"><h3 class="text-sm"> </h3> <ul class="relative list px-4 *:py-2 mt-2 bg-white/30 dark:bg-black/15 rounded-container-token *:!rounded-none max-h-80 scrollbar-track-transparent scrollbar-thumb-slate-400/50 scrollbar-corner-transparent scrollbar-thin overflow-y-auto divide-y-[1px] *:border-surface-300-600-token" style="scrollbar-gutter: stable"></ul></div>'),Zs=he('<span class="badge variant-soft-error"> </span>'),tl=he('<li><span class="flex-[0_0_20%] truncate"> </span> <span class="text-error-400"> </span></li>'),el=he('<ul class="list max-h-80 scrollbar-track-transparent scrollbar-thumb-slate-400/50 scrollbar-corner-transparent scrollbar-thin overflow-y-auto" style="scrollbar-gutter: stable"></ul>'),rl=he('<div data-theme="skeleton" class="card px-4 pb-4 fixed right-20 top-36 w-[600px] *:text-sm shadow-xl bg-scroll"><!> <div class="flex flex-col relative mt-4 gap-4"><!></div> <!> <!></div>'),al=(t,e)=>{A(e,!et(e))},ol=he('<img alt="batch download" class="object-cover object-center size-full">'),nl=he('<div class="!absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"><!></div>'),il=he('<div class="flex flex-col justify-center items-center px-3 font-bold text-[12px] leading-[14px] overflow-hidden text-surface-700-200-token"><span class=" truncate max-w-full"> </span> <hr class="!border-t-1 my-[1px] self-stretch !border-surface-700 dark:!border-surface-200"> <span class=" truncate max-w-full"> </span></div>'),sl=he('<i class="w-6 fill-slate-700 dark:fill-slate-200 mix-blend-hard-light mt-4"><!></i>'),ll=he('<div class="size-14 rounded-full fixed right-4 top-36 drop-shadow-xl cursor-pointer hover:brightness-110 backdrop-blur-sm"><div data-theme="skeleton" class="avatar absolute -z-10 size-14 rounded-full overflow-hidden bg-scroll transition-opacity duration-[250ms]"><!></div> <!> <div class="size-14 flex justify-center items-center relative"><!></div></div>'),cl=he("<!> <!>",1),ce(["click"]);const Mu={isFirefox:()=>navigator.userAgent.includes("Firefox"),isViolentmonkey:()=>"Violentmonkey"===$i.scriptHandler,isTampermonkey:()=>"Tampermonkey"===$i.scriptHandler,isBlobDlAvaliable(){return!this.isFirefox()||this.isFirefox()&&this.isTampermonkey()&&parseFloat($i.version??"")<4.18},isSupportSubpath(){return this.isBrowserDownloadMode()},isBrowserDownloadMode:()=>"browser"===$i.downloadMode,isConflictActionEnable(){return this.isTampermonkey()&&parseFloat($i.version??"")>=4.18&&this.isBrowserDownloadMode()},isConflictActionPromptEnable(){return!this.isFirefox()&&this.isConflictActionEnable()},isFileSystemAccessAvaliable:()=>"function"==typeof Ni.showDirectoryPicker&&"function"==typeof Ni.showSaveFilePicker,videoFrameSupported:()=>"function"==typeof Ni.VideoFrame,isPixiv:()=>"www.pixiv.net"===location.hostname,isYande:()=>"yande.re"===location.hostname,isRule34:()=>"rule34.xxx"===location.hostname,isNijie:()=>"nijie.info"===location.hostname},Ou='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>check</title><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" /></svg>',Lu={preloadData:/"meta-preload-data" content='(.*?)'>/,globalData:/"meta-global-data" content='(.*?)'>/,artworksPage:/artworks\/(\d+)$/,userPage:/\/users\/(\d+)$|\/users\/(\d+)\/(?!following|mypixiv|followers)/,bookmarkPage:/users\/(\d+)\/bookmarks\/artworks/,userPageTags:new RegExp("(?<=users\\/)([0-9]+)\\/(artworks|illustrations|manga|bookmarks(?=\\/artworks))(?:\\/artworks)?\\/?([^?]*)"),searchPage:/\/tags\/.*\/(artworks|illustrations|manga)/,activityHref:/illust_id=(\d+)/,originSrcPageNum:new RegExp("(?<=_p)\\d+"),followLatest:/\/bookmark_new_illust(?:_r18)?\.php/,historyPage:/\/history\.php/,historyThumbnailsId:/\d+(?=_)/,series:/\/user\/([0-9]+)\/series\/([0-9]+)/,unlisted:new RegExp("(?<=artworks\\/unlisted\\/)[A-Za-z0-9]+"),imageExt:/bmp|jp(e)?g|jfif|png|tif(f)?|gif|svg|ico|webp|heif|heic|raw|cr2|nef|arw|dng|avif/i,videoExt:/mp4|avi|mkv|mov|wmv|flv|webm|mpeg|mpg|3gp|m4v|ts|vob|ogv|rm|rmvb|m2ts|mxf|asf|swf/i};dl=(t=>(t.UNIQUIFY="uniquify",t.OVERWRITE="overwrite",t.PROMPT="prompt",t))(dl||{});let ju=null,Ru="dirHandle.unpick";const Fu=new Set,zu=[];let qu;jd.on("dirHandle.picking",()=>{Ld.info("channelEvnet:DirHandleStatus.PICKING"),Ru="dirHandle.picking"}),jd.on("dirHandle.unpick",async()=>{Ld.info("channelEvnet:DirHandleStatus.UNPICK"),Ru="dirHandle.unpick",ju=null,ca(new Error("Directory handle not found."))}),jd.on("dirHandle.picked",async t=>{Ld.info("channelEvnet:DirHandleStatus.PICKED"),Ru="dirHandle.picked",ju=t,"granted"===await ju.queryPermission({mode:"readwrite"})?la(ju):ca(new Du)});const Hu=Mu.isBlobDlAvaliable();Mu.isSupportSubpath()?qu=Hu?function(t,e,r){return new Promise((a,o)=>{null==r||r.throwIfAborted();const n=URL.createObjectURL(t),i=Ti({url:URL.createObjectURL(t),name:e,onerror:t=>{URL.revokeObjectURL(n),(null==r?void 0:r.aborted)?a():(Ld.error(t),o(new Error(`FileSave error: ${e}`)))},onload:()=>{URL.revokeObjectURL(n),a()}});null==r||r.addEventListener("abort",()=>i.abort(),{once:!0})})}:function(t,e,r){return function(t){return new Promise(e=>{const r=new FileReader;r.onload=()=>{e(r.result)},r.readAsDataURL(t)})}(t).then(t=>(null==r||r.throwIfAborted(),new Promise((a,o)=>{const n=Ti({url:t,name:e,onerror:t=>{(null==r?void 0:r.aborted)?a():(Ld.error(t),o(new Error(`FileSave error: ${e}`)))},onload:()=>{a()}});null==r||r.addEventListener("abort",()=>n.abort(),{once:!0})})))}:(qu=function(t,e){const r=e.lastIndexOf("/");-1!==r&&(e=e.slice(r+1));const a=document.createElement("a");a.href=URL.createObjectURL(t),a.download=e,a.click(),URL.revokeObjectURL(a.href)},Ld.warn("Download function is not fully supported:",$i.scriptHandler,$i.version));const Wu={isFileSystemAccessAvailable:Mu.isFileSystemAccessAvaliable(),getAdapter(t,e=dl.UNIQUIFY){return this.isFileSystemAccessAvailable&&t?ha.bind(void 0,e):qu}};!function(t){function e(){}function r(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function a(t,e,a,o,n){if("function"!=typeof a)throw new TypeError("The listener must be a function");var i=new r(a,o||t,n),l=s?s+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],i]:t._events[l].push(i):(t._events[l]=i,t._eventsCount++),t}function o(t,r){0===--t._eventsCount?t._events=new e:delete t._events[r]}function n(){this._events=new e,this._eventsCount=0}var i=Object.prototype.hasOwnProperty,s="~";Object.create&&(e.prototype=Object.create(null),(new e).__proto__||(s=!1)),n.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)i.call(t,e)&&r.push(s?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},n.prototype.listeners=function(t){var e,r,a,o=s?s+t:t,n=this._events[o];if(!n)return[];if(n.fn)return[n.fn];for(e=0,r=n.length,a=new Array(r);e<r;e++)a[e]=n[e].fn;return a},n.prototype.listenerCount=function(t){var e=s?s+t:t,r=this._events[e];return r?r.fn?1:r.length:0},n.prototype.emit=function(t,e,r,a,o,n){var i,l,c,d,u,p,h=s?s+t:t;if(!this._events[h])return!1;if(i=this._events[h],l=arguments.length,i.fn){switch(i.once&&this.removeListener(t,i.fn,void 0,!0),l){case 1:return i.fn.call(i.context),!0;case 2:return i.fn.call(i.context,e),!0;case 3:return i.fn.call(i.context,e,r),!0;case 4:return i.fn.call(i.context,e,r,a),!0;case 5:return i.fn.call(i.context,e,r,a,o),!0;case 6:return i.fn.call(i.context,e,r,a,o,n),!0}for(d=1,c=new Array(l-1);d<l;d++)c[d-1]=arguments[d];i.fn.apply(i.context,c)}else for(u=i.length,d=0;d<u;d++)switch(i[d].once&&this.removeListener(t,i[d].fn,void 0,!0),l){case 1:i[d].fn.call(i[d].context);break;case 2:i[d].fn.call(i[d].context,e);break;case 3:i[d].fn.call(i[d].context,e,r);break;case 4:i[d].fn.call(i[d].context,e,r,a);break;default:if(!c)for(p=1,c=new Array(l-1);p<l;p++)c[p-1]=arguments[p];i[d].fn.apply(i[d].context,c)}return!0},n.prototype.on=function(t,e,r){return a(this,t,e,r,!1)},n.prototype.once=function(t,e,r){return a(this,t,e,r,!0)},n.prototype.removeListener=function(t,e,r,a){var n,i,l,c,d=s?s+t:t;if(!this._events[d])return this;if(!e)return o(this,d),this;if((n=this._events[d]).fn)n.fn!==e||a&&!n.once||r&&n.context!==r||o(this,d);else{for(i=0,l=[],c=n.length;i<c;i++)(n[i].fn!==e||a&&!n[i].once||r&&n[i].context!==r)&&l.push(n[i]);l.length?this._events[d]=1===l.length?l[0]:l:o(this,d)}return this},n.prototype.removeAllListeners=function(t){var r;return t?(r=s?s+t:t,this._events[r]&&o(this,r)):(this._events=new e,this._eventsCount=0),this},n.prototype.off=n.prototype.removeListener,n.prototype.addListener=n.prototype.on,n.prefixed=s,n.EventEmitter=n,t.exports=n}(ul={exports:{}});const Uu=ga(ul.exports);class Gu extends Error{constructor(t){super(t),this.name="TimeoutError"}}class Yu extends Error{constructor(t){super(),this.name="AbortError",this.message=t}}const Vu=t=>void 0===globalThis.DOMException?new Yu(t):new DOMException(t),Ju=t=>{const e=void 0===t.reason?Vu("This operation was aborted."):t.reason;return e instanceof Error?e:Vu(e)};class Qu{constructor(){vc(this,Xa,[])}enqueue(t,e){const r={priority:(e={priority:0,...e}).priority,run:t};if(this.size&&wc(this,Xa)[this.size-1].priority>=e.priority)return void wc(this,Xa).push(r);const a=function(t,e,r){let a=0,o=t.length;for(;o>0;){const n=Math.trunc(o/2);let i=a+n;r(t[i],e)<=0?(a=++i,o-=n+1):o=n}return a}(wc(this,Xa),r,(t,e)=>e.priority-t.priority);wc(this,Xa).splice(a,0,r)}dequeue(){const t=wc(this,Xa).shift();return null==t?void 0:t.run}filter(t){return wc(this,Xa).filter(e=>e.priority===t.priority).map(t=>t.run)}get size(){return wc(this,Xa).length}}Xa=new WeakMap;class Xu extends Uu{constructor(t){var e,r;if(super(),vc(this,ho),vc(this,Ka),vc(this,Za),vc(this,to,0),vc(this,eo),vc(this,ro),vc(this,ao,0),vc(this,oo),vc(this,no),vc(this,io),vc(this,so),vc(this,lo,0),vc(this,co),vc(this,uo),vc(this,po),fc(this,"timeout"),!("number"==typeof(t={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Qu,...t}).intervalCap&&t.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(null==(e=t.intervalCap)?void 0:e.toString())??""}\` (${typeof t.intervalCap})`);if(void 0===t.interval||!(Number.isFinite(t.interval)&&t.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(null==(r=t.interval)?void 0:r.toString())??""}\` (${typeof t.interval})`);bc(this,Ka,t.carryoverConcurrencyCount),bc(this,Za,t.intervalCap===Number.POSITIVE_INFINITY||0===t.interval),bc(this,eo,t.intervalCap),bc(this,ro,t.interval),bc(this,io,new t.queueClass),bc(this,so,t.queueClass),this.concurrency=t.concurrency,this.timeout=t.timeout,bc(this,po,!0===t.throwOnTimeout),bc(this,uo,!1===t.autoStart)}get concurrency(){return wc(this,co)}set concurrency(t){if(!("number"==typeof t&&t>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${t}\` (${typeof t})`);bc(this,co,t),yc(this,ho,ko).call(this)}async add(t,e={}){return e={timeout:this.timeout,throwOnTimeout:wc(this,po),...e},new Promise((r,a)=>{wc(this,io).enqueue(async()=>{var o;xc(this,lo)._++,xc(this,to)._++;try{null==(o=e.signal)||o.throwIfAborted();let a=t({signal:e.signal});e.timeout&&(a=function(t,e){const{milliseconds:r,fallback:a,message:o,customTimers:n={setTimeout:setTimeout,clearTimeout:clearTimeout}}=e;let i,s;const l=new Promise((l,c)=>{if("number"!=typeof r||1!==Math.sign(r))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${r}\``);if(e.signal){const{signal:t}=e;t.aborted&&c(Ju(t)),s=()=>{c(Ju(t))},t.addEventListener("abort",s,{once:!0})}if(r===Number.POSITIVE_INFINITY)return void t.then(l,c);const d=new Gu;i=n.setTimeout.call(void 0,()=>{if(a)try{l(a())}catch(t){c(t)}else"function"==typeof t.cancel&&t.cancel(),!1===o?l():o instanceof Error?c(o):(d.message=o??`Promise timed out after ${r} milliseconds`,c(d))},r),(async()=>{try{l(await t)}catch(t){c(t)}})()}).finally(()=>{l.clear(),s&&e.signal&&e.signal.removeEventListener("abort",s)});return l.clear=()=>{n.clearTimeout.call(void 0,i),i=void 0},l}(Promise.resolve(a),{milliseconds:e.timeout})),e.signal&&(a=Promise.race([a,yc(this,ho,_o).call(this,e.signal)]));const n=await a;r(n),this.emit("completed",n)}catch(t){if(t instanceof Gu&&!e.throwOnTimeout)return void r();a(t),this.emit("error",t)}finally{yc(this,ho,mo).call(this)}},e),this.emit("add"),yc(this,ho,bo).call(this)})}async addAll(t,e){return Promise.all(t.map(async t=>this.add(t,e)))}start(){return wc(this,uo)?(bc(this,uo,!1),yc(this,ho,ko).call(this),this):this}pause(){bc(this,uo,!0)}clear(){bc(this,io,new(wc(this,so)))}async onEmpty(){0!==wc(this,io).size&&await yc(this,ho,Ao).call(this,"empty")}async onSizeLessThan(t){wc(this,io).size<t||await yc(this,ho,Ao).call(this,"next",()=>wc(this,io).size<t)}async onIdle(){0===wc(this,lo)&&0===wc(this,io).size||await yc(this,ho,Ao).call(this,"idle")}get size(){return wc(this,io).size}sizeBy(t){return wc(this,io).filter(t).length}get pending(){return wc(this,lo)}get isPaused(){return wc(this,uo)}}Ka=new WeakMap,Za=new WeakMap,to=new WeakMap,eo=new WeakMap,ro=new WeakMap,ao=new WeakMap,oo=new WeakMap,no=new WeakMap,io=new WeakMap,so=new WeakMap,lo=new WeakMap,co=new WeakMap,uo=new WeakMap,po=new WeakMap,ho=new WeakSet,go=function(){return wc(this,Za)||wc(this,to)<wc(this,eo)},fo=function(){return wc(this,lo)<wc(this,co)},mo=function(){xc(this,lo)._--,yc(this,ho,bo).call(this),this.emit("next")},wo=function(){yc(this,ho,xo).call(this),yc(this,ho,yo).call(this),bc(this,no,void 0)},vo=function(){const t=Date.now();if(void 0===wc(this,oo)){const e=wc(this,ao)-t;if(!(e<0))return void 0===wc(this,no)&&bc(this,no,setTimeout(()=>{yc(this,ho,wo).call(this)},e)),!0;bc(this,to,wc(this,Ka)?wc(this,lo):0)}return!1},bo=function(){if(0===wc(this,io).size)return wc(this,oo)&&clearInterval(wc(this,oo)),bc(this,oo,void 0),this.emit("empty"),0===wc(this,lo)&&this.emit("idle"),!1;if(!wc(this,uo)){const t=!wc(this,ho,vo);if(wc(this,ho,go)&&wc(this,ho,fo)){const e=wc(this,io).dequeue();return!!e&&(this.emit("active"),e(),t&&yc(this,ho,yo).call(this),!0)}}return!1},yo=function(){wc(this,Za)||void 0!==wc(this,oo)||(bc(this,oo,setInterval(()=>{yc(this,ho,xo).call(this)},wc(this,ro))),bc(this,ao,Date.now()+wc(this,ro)))},xo=function(){0===wc(this,to)&&0===wc(this,lo)&&wc(this,oo)&&(clearInterval(wc(this,oo)),bc(this,oo,void 0)),bc(this,to,wc(this,Ka)?wc(this,lo):0),yc(this,ho,ko).call(this)},ko=function(){for(;yc(this,ho,bo).call(this););},_o=async function(t){return new Promise((e,r)=>{t.addEventListener("abort",()=>{r(t.reason)},{once:!0})})},Ao=async function(t,e){return new Promise(r=>{const a=()=>{e&&!e()||(this.off(t,a),r())};this.on(t,a)})},Eo=new WeakMap,So=new WeakMap,Co=new WeakSet,Po=function(t,e){if(null==e?void 0:e.aborted)return Promise.resolve([e.reason,null]);const{src:r,onProgress:a,timeout:o,taskId:n,headers:i}=t;return new Promise(s=>{const l=Di({url:r,method:"GET",responseType:"blob",timeout:o,headers:i,ontimeout(){s([new Bu(`${n} | ${r}`),null])},onerror(e){let r;r=429===e.status?new Iu(t.src,e.status):new Error(`Download failed. ID: ${n}.`),s([r,null])},onprogress(e){if(e.loaded>0&&e.total>0){const r=Math.floor(e.loaded/e.total*100);null==a||a(r,t)}},onload(t){const{status:e,statusText:r,finalUrl:a}=t;s(e<200||e>299?[new Iu(r+" "+a,e),null]:[null,t.response])}});null==e||e.addEventListener("abort",()=>{l.abort(),s([e.reason,null])},{once:!0})})},Io=async function(t,e=0,r){var a,o,n,i;try{const{src:n,taskId:i,path:s,useFileSystemAccessApi:l,filenameConflictAction:c}=t,d=await wc(this,So).add(async({signal:e})=>{let r;null==e||e.throwIfAborted(),Ld.info("Download start:",n);let a=0;do{const o=await yc(this,Co,Po).call(this,t,e);if(null==e||e.throwIfAborted(),null===o[0]){r=o[1];break}{const t=o[0];if(!(t instanceof Bu)||++a>wc(this,Eo))throw t;Ld.error(`Download will be retried. Count: ${a}.`,t)}}while(a<=wc(this,Eo));return r},{signal:r,priority:e});if(!d)throw new Bu(`${i} | ${n}`);Ld.info("Xhr complete:",n),null==(a=t.onXhrLoaded)||a.call(t,t);const u=Wu.getAdapter(l,c);if("function"==typeof t.beforeFileSave){const e=await t.beforeFileSave(d,t);if(null==r||r.throwIfAborted(),!e)return;await u(e,s,r)}else await u(d,s,r);null==(o=t.onFileSaved)||o.call(t,t),Ld.info("Download complete:",s)}catch(e){throw e instanceof Tu?null==(n=t.onAbort)||n.call(t,t):null==(i=t.onError)||i.call(t,e,t),e}};const Ku=new class{constructor(){vc(this,Co),vc(this,Eo,3),vc(this,So,new Xu({concurrency:5,interval:1e3,intervalCap:4}))}async updateDirHandle(){return(await pa(()=>Ni.showDirectoryPicker({id:"pdl-dir-handle",mode:"readwrite"}))).name}async download(t,e={}){const{signal:r,priority:a}=e;if(null==r||r.throwIfAborted(),Ld.info("Downloader add:",t),Array.isArray(t)||(t=[t]),t.length<1)return;const o=t.map(t=>yc(this,Co,Io).call(this,t,a,r)),n=await Promise.allSettled(o);for(const t of n)if("rejected"===t.status)throw t.reason}},Zu=jr("pdl-download-setting",{directoryTemplate:eu.folderPattern??"",filenameTemplate:eu.filenamePattern??"{id}",useFileSystemAccessApi:eu.useFileSystemAccess??!1,filenameConflictAction:eu.fileSystemFilenameConflictAction??dl.UNIQUIFY},{get isSubpathSupported(){return this.useFileSystemAccessApi||Mu.isSupportSubpath()},setDirectoryTemplate(t){const e=t.split("/").map($r).filter(Boolean).join("/");return e!==this.directoryTemplate&&(this.directoryTemplate=e),e},setFilenameTemplate(t){const e=$r(t);return""===e?this.filenameTemplate:(e!==this.filenameTemplate&&(this.filenameTemplate=e),e)}});pl=(t=>(t.JAPANESE="ja",t.CHINESE="zh",t.TRADITIONAL_CHINESE="zh_tw",t.ENGLISH="en",t))(pl||{});const tp=jr("pdl-site-state",{ugoiraFormat:null,mixSeasonalEffect:null,tagLocale:null,compressMultiIllusts:null,compressManga:null,addBookmark:eu.addBookmark??null,bookmarkWithTags:null,privateBookmarkIfR18:null,likeIllustWhenDownloading:null});hl=he('<input type="text">'),gl=he('<input type="text" disabled>'),fl=he('<button class="chip variant-soft hover:variant-filled"><span> </span></button>'),ml=he("<!> <!> <!>",1),wl=he('<li><p class="flex-auto"> </p> <span class="text-sm italic"> </span> <button class="btn btn-sm variant-filled"> </button></li> <li><p class="flex-auto"> </p> <!></li>',1),vl=he('<button class="chip variant-soft hover:variant-filled"><span> </span></button>'),bl=he("<!> <!> <!> <!>",1),yl=he('<li><div class="flex-auto"><p> </p> <p> </p></div> <!></li>'),xl=he('<div><section><p> </p> <ul><li class=" flex-col gap-3"><div class="input-group input-group-divider grid-cols-[auto_1fr_auto_auto]"><button type="button" class="[&amp;:not([disabled])]:variant-soft-primary"><i class=" w-6 fill-current"><!></i></button> <!> <button type="button" class="variant-soft-surface [&amp;:not([disabled])]:variant-soft-primary"><i class=" w-6 fill-current"><!></i></button></div> <div class=" flex flex-wrap self-start gap-y-1 gap-x-2"></div></li> <li><p class="flex-auto"> </p> <!></li> <!></ul></section> <section><p> </p> <ul><li class=" flex-col gap-3"><div class="input-group input-group-divider grid-cols-[auto_1fr_auto]"><button type="button" class="[&amp;:not([disabled])]:variant-soft-primary"><i class=" w-6 fill-current"><!></i></button> <input type="text" required> <button type="button" class="variant-soft-surface dark:variant-fill-surface [&amp;:not([disabled])]:variant-soft-primary"><i class=" w-6 fill-current"><!></i></button></div> <div class=" flex flex-wrap self-start gap-y-1 gap-x-2"></div></li> <!></ul></section></div>'),ce(["click"]);const ep=jr("pdl-convert-setting",{mp4Bitrate:eu.mp4Bitrate??20,webmBitrate:eu.webmBitrate??20,gifQuality:eu.gifQuality??10,pngColor:eu.pngColor??256,losslessWebp:eu.losslessWebp??!1,webpQuality:eu.webpQuality??95,webpMehtod:eu.webpMehtod??4});kl=he("<!> <!> <!> <!> <!> <!>",1),_l=he("<option> </option>"),Al=he("<option> </option>"),El=he('<div><section><p> </p> <ul><li><p class="flex-auto"> </p> <!></li></ul></section> <section><p> </p> <ul><li><div class="flex-auto"><p>Webm</p> <p>Bitrate (Mbps)</p></div> <input type="number" required min="1" max="120" step="1"></li> <li><div class="flex-auto"><p>Mp4</p> <p>Bitrate (Mbps)</p></div> <input type="number" required min="1" max="99" step="1"></li> <li class="flex-col !items-stretch"><p>Webp</p> <ul><li class="items-center"><p class="flex-auto"> </p> <!></li> <li class="items-center"><div class="flex-auto"><p> </p> <p> </p></div> <input type="number" required min="0" max="100" step="1"></li> <li class="items-center"><div class="flex-auto"><p> </p> <p> </p></div> <select></select></li></ul></li> <li><div class="flex-auto"><p>Gif</p> <p> </p></div> <select></select></li> <li><div class="flex-auto"><p>Png</p> <p> </p></div> <input type="number" required min="0" max="256" step="1"></li></ul></section></div>'),Sl=(t=>(t[t.NEVER=0]="NEVER",t[t.EVERY_DAY=864e5]="EVERY_DAY",t[t.EVERY_7_DAY=6048e5]="EVERY_7_DAY",t[t.EVERY_30_DAY=2592e6]="EVERY_30_DAY",t))(Sl||{});const rp=jr("pdl-backup-setting",{interval:eu.historyBackupInterval??0,lastTimestamp:eu.lastHistoryBackup??0});Cl=he("<!> <span> </span>",1),Pl=he('<div><section><p> </p> <ul><li><p class="flex-auto"> </p> <select><option> </option><option> </option><option> </option><option> </option></select></li></ul></section> <section><p> </p> <ul><li><p class="flex-auto"> </p> <button class="btn variant-filled"><!> <span> </span></button></li> <li><p class="flex-auto"> </p> <button class="btn variant-filled"><!> <span> </span></button></li></ul></section> <section><p> </p> <ul><li><p class="flex-auto"> </p> <!></li></ul></section> <section><p> </p> <ul><li><p class="flex-auto"> </p> <button class="btn variant-filled"><!> <span> </span></button></li></ul></section></div>'),ce(["click"]),Il=he("<!> <!>",1),Tl=he('<button class="btn variant-filled rounded-r-none text-xl flex-[1]">+</button> <input type="number" class="input variant-form-material text-sm flex-[3]" min="0"> <button class=" btn variant-filled rounded-l-none text-xl flex-[1]">-</button>',1),$l=he("<!> <!>",1),Bl=he('<button class="btn variant-filled rounded-r-none text-xl flex-[1]">+</button> <input type="number" class="input variant-form-material text-sm flex-[3]" min="0"> <button class=" btn variant-filled rounded-l-none text-xl flex-[1]">-</button>',1),Dl=he('<div class="flex justify-between items-center"><p> </p> <div class="text-xs"> </div></div>'),Nl=he('<div class="flex justify-between items-center"><p> </p> <div class="text-xs"> </div></div>'),Ml=he('<section><p> </p> <ul><li class="flex-col !items-stretch md:flex-row md:!items-baseline gap-4 *:!m-0"><!> <!></li></ul></section>'),Ol=he("<i><!></i>"),Ll=he("<i><!></i>"),jl=he("<!> <!>",1),Rl=he("<i><!></i>"),Fl=he("<i><!></i>"),zl=he("<!> <!>",1),ql=he('<div><div class="flex items-center justify-center"><div></div></div> <section><p> </p> <ul><li class="flex-col !items-stretch md:flex-row md:!items-baseline gap-4 *:!m-0"><div class=" flex-1"><div class="flex justify-between items-center"><p> </p> <!></div> <div class="flex flex-row mt-2 gap-1 h-8"><!></div></div> <div class=" flex-1"><div class="flex justify-between items-center"><p> </p> <!></div> <div class="flex flex-row mt-2 gap-1 h-8"><!></div></div></li></ul></section> <!> <section><p> </p> <ul><li class="flex-col !items-stretch md:flex-row md:!items-center gap-4 *:!m-0"><div class="flex flex-1 justify-between items-center"><p> </p> <!></div> <div class="flex flex-1 justify-between items-center"><p> </p> <!></div></li></ul></section></div>'),ce(["click"]);let ap=new class extends _u{constructor(t,e){let r=Au.test(t)?t:`(${t})`;const a=window.matchMedia(r);super(()=>a.matches,t=>se(a,"change",t))}}("(prefers-color-scheme: dark)"),op=y(0);const np=jr("pdl-client-state",{theme:"auto",locale:mu.current,version:null,showPopupButton:eu.showPopupButton??!0},{get autoTheme(){return et(op),ap.current?"dark":"light"},setThemeWatcher(t){A(op,et(op)+1),ap=t}});Nt(()=>{Dt(()=>fu(np.locale))}),Hl=he('<li><p class="flex-auto"> </p> <!></li>'),Wl=he('<li><p class="flex-auto"> </p> <!></li> <li><div class="flex-auto"><p> </p> <p> </p></div> <!></li>',1),Ul=he('<li><label class="label flex flex-grow items-center justify-center"><p class="flex-auto"> </p> <!></label></li>'),Gl=he('<ul><li><label class="label flex flex-grow items-center justify-center"><p class="flex-auto"> </p> <!></label></li> <!></ul>'),Yl=he('<li class="flex-col !items-stretch"><div class="flex items-center"><div class="flex-auto"><p> </p> <p> </p></div> <!></div> <!></li>'),Vl=he('<section><p>实验性功能</p> <ul><li><div class="flex-auto"><p>为单页插图增加 #pixivGlow2024 效果</p> <p>* 转换至动图格式。如果插图尺寸过大，可能占用大量内存 / 转换失败</p></div> <!></li></ul></section>'),Jl=he('<div><ul><li><p class="flex-auto"> </p> <!></li> <!> <!> <!></ul> <!></div>'),Ql=he('<div><section><p> </p> <ul><li><span><!></span></li></ul></section> <section><p> </p> <ul><li><p><!></p></li> <li class=" justify-center"><figure><img alt="credit" class=" rounded-full m-auto"> <figcaption class="mt-4"> </figcaption></figure></li></ul></section></div>');const ip=jr("pdl-auth-state",{cf_clearance:(null==(To=eu.auth)?void 0:To.cf_clearance)??null,username:(null==($o=eu.auth)?void 0:$o.username)??null,apiKey:(null==(Bo=eu.auth)?void 0:Bo.apiKey)??null});Xl=he('<section><p> </p> <div><div><input type="text" class="input"></div></div></section>'),Kl=he("<div></div>"),Zl=(t,e)=>A(e,!et(e)),tc=he('<button type="button" class="btn-icon hover:variant-soft-surface ml-1"><i class="w-8 fill-current"><!></i></button>'),ec=he('<h3 class="h3"> </h3>'),rc=he('<div><!> <!> <div class="mt-4 pr-4 scrollbar-track-transparent scrollbar-thumb-slate-400/50 scrollbar-corner-transparent scrollbar-thin overflow-y-auto" style="scrollbar-gutter: stable"><!></div></div>'),ce(["click"]),ac=t=>t.stopImmediatePropagation(),oc=he('<button type="button" class="btn btn-sm variant-filled fixed bottom-24 rounded-none rounded-s-full opacity-40 hover:opacity-100 right-0 translate-x-[calc(100%-44px)] hover:translate-x-0 delay-100"><i class=" text-sm w-6 fill-current"><!></i> <span class="text-sm"> </span></button>'),nc=he('<div data-theme="skeleton"><!> <!> <!> <!></div>'),ce(["keydown","click"]);const sp=function(t,e,r,a,o,n){let i=class extends Md{constructor(){super(t,r,!0),this.$$p_d=e}static get observedAttributes(){return pi(e).map(t=>(e[t].attribute||t).toLowerCase())}};return pi(e).forEach(t=>{hi(i.prototype,t,{get(){return this.$$c&&t in this.$$c?this.$$c[t]:this.$$d[t]},set(r){var a,o;r=yr(t,r,e),this.$$d[t]=r,(o=this.$$c)&&((null==(a=gi(o,t))?void 0:a.get)?o[t]=r:o.$set({[t]:r}))}})}),["showChangelog","showSetting","toast"].forEach(t=>{hi(i.prototype,t,{get(){var e;return null==(e=this.$$c)?void 0:e[t]}})}),i=n(i),t.element=i,i}(function(t,e){function r(){p.trigger({type:"component",component:"changelog"})}function a(){p.trigger({type:"component",component:"setting"})}function o(t){let e;switch(t.type||"success"){case"success":e="variant-filled-primary";break;case"warning":e="variant-filled-warning";break;case"error":e="variant-filled-error";break;default:throw new Error("Unknown toast type.")}return t.type&&delete t.type,h.trigger({...t,background:e})}function n(t){if(!(t.target instanceof Element))return;const e=t.target.classList;(e.contains("modal-backdrop")||e.contains("modal-transition"))&&t.stopPropagation()}var i,s,l,c,d,u;lt(e,!0),nt("supportedTemplate",br(e,"supportedTemplate",19,()=>({}))()),function(){const t=function(){const{subscribe:t,set:e,update:r}=Sr([]);return{subscribe:t,set:e,update:r,trigger:t=>r(e=>(e.push(t),e)),close:()=>r(t=>(t.length>0&&t.shift(),t)),clear:()=>e([])}}();nt(ou,t)}(),function(){const t=function(){function t(t){if(!0===t.autohide)return setTimeout(()=>{o(t.id)},t.timeout)}const{subscribe:e,set:r,update:a}=Sr([]),o=t=>a(e=>{if(e.length>0){const r=e.findIndex(e=>e.id===t),a=e[r];a&&(a.callback&&a.callback({id:t,status:"closed"}),a.timeoutId&&clearTimeout(a.timeoutId),e.splice(r,1))}return e});return{subscribe:e,close:o,trigger:e=>{const r=function(){const t=Math.random();return Number(t).toString(32)}();return a(a=>{e&&e.callback&&e.callback({id:r,status:"queued"}),e.hideDismiss&&(e.autohide=!0);const o={...nu,...e,id:r};return o.timeoutId=t(o),a.push(o),a}),r},freeze:t=>a(e=>(e.length>0&&clearTimeout(e[t].timeoutId),e)),unfreeze:e=>a(r=>(r.length>0&&(r[e].timeoutId=t(r[e])),r)),clear:()=>r([])}}();nt(iu,t)}(),nt("drawerStore",function(){const{subscribe:t,set:e,update:r}=Sr({});return{subscribe:t,set:e,update:r,open:t=>r(()=>({open:!0,...t})),close:()=>r(t=>(t.open=!1,t))}}());const p=Rr(),h=Fr(),m=C(()=>"auto"===np.theme?"dark"===np.autoTheme:"dark"===np.theme);let w;const v={changelog:{ref:sa},setting:{ref:Ca}};return xr(()=>{const t=w.getRootNode();Br(t),t.host.setAttribute("style","position:fixed; z-index:99999"),"1.11.0"!==np.version&&(np.version="1.11.0",r()),globalThis.addEventListener(Cu,t=>{const e=t,{getFileHandle:r,abort:a}=e.detail;let n=!1;o({message:gu("toast.message.pick_directory_handle"),type:"warning",autohide:!1,action:{label:gu("toast.actionLabel.browse"),response:()=>{n=!0,r()}},callback({status:t}){"closed"!==t||n||a()}})}),globalThis.addEventListener(Su,t=>{const r=t;if(e.useBatchDownload){const{downloading:t,hasTask:a}=e.useBatchDownload(),{signal:o}=r.detail;if(o&&t.current&&a(o))return}const{getFileHandle:a,abort:n}=r.detail;let i=!1;o({message:gu("toast.message.file_handle_not_found"),type:"warning",autohide:!1,action:{label:gu("toast.actionLabel.save"),response:()=>{i=!0,a()}},callback({status:t}){"closed"!==t||i||n()}})}),globalThis.addEventListener(Pu,t=>{const e=t,{onAction:r,onClosed:a}=e.detail;let n=!1;o({message:gu("toast.message.request_directory_handle_permission"),type:"warning",autohide:!1,action:{label:gu("toast.actionLabel.allow_permission"),response:()=>{n=!0,r()}},callback({status:t}){"closed"!==t||n||a()}})})}),i=nc(),le("keydown",bi,function(t){(null==w?void 0:w.querySelector(".modal-backdrop"))&&("Escape"!==t.code?t.ctrlKey||t.shiftKey||t.composedPath().includes(w)||(t.stopImmediatePropagation(),t.preventDefault()):p.close())},!0),i.__keydown=[ac],function(t,e){function r(t){if(!(t.target instanceof Element))return;const e=t.target.classList;(e.contains("modal-backdrop")||e.contains("modal-transition"))&&(Z=!0)}function a(t){if(!(t.target instanceof Element))return;const e=t.target.classList;(e.contains("modal-backdrop")||e.contains("modal-transition"))&&Z&&(m()[0].response&&m()[0].response(void 0),ot.close(),_("backdrop",t)),Z=!1}function o(){m()[0].response&&m()[0].response(!1),ot.close()}function n(){m()[0].response&&m()[0].response(!0),ot.close()}function i(t){t.preventDefault(),m()[0].response&&(void 0!==m()[0].valueAttr&&"type"in m()[0].valueAttr&&"number"===m()[0].valueAttr.type?m()[0].response(parseInt(et(Q))):m()[0].response(et(Q))),ot.close()}var s,l,c,d;const u=mr(e,["children","$$slots","$$events","$$legacy"]);lt(e,!1);const[p,h]=fr(),m=()=>gr(ot,"$modalStore",p),w=k(),v=k(),b=k(),y=k(),x=k(),_=kr();let E=br(e,"components",24,()=>({})),S=br(e,"position",8,"items-center"),C=br(e,"background",8,"bg-surface-100-800-token"),P=br(e,"width",8,"w-modal"),I=br(e,"height",8,"h-auto"),T=br(e,"padding",8,"p-4"),$=br(e,"spacing",8,"space-y-4"),B=br(e,"rounded",8,"rounded-container-token"),D=br(e,"shadow",8,"shadow-xl"),N=br(e,"zIndex",8,"z-[999]"),M=br(e,"buttonNeutral",8,"variant-ghost-surface"),O=br(e,"buttonPositive",8,"variant-filled"),L=br(e,"buttonTextCancel",12,"Cancel"),j=br(e,"buttonTextConfirm",12,"Confirm"),F=br(e,"buttonTextSubmit",12,"Submit"),z=br(e,"regionBackdrop",8,""),q=br(e,"regionHeader",8,"text-2xl font-bold"),H=br(e,"regionBody",8,"max-h-[200px] overflow-hidden"),W=br(e,"regionFooter",8,"flex justify-end space-x-2"),U=br(e,"transitions",24,()=>!gr(cu,"$prefersReducedMotionStore",p)),G=br(e,"transitionIn",8,Yr),Y=br(e,"transitionInParams",24,()=>({duration:150,opacity:0,x:0,y:100})),V=br(e,"transitionOut",8,Yr),J=br(e,"transitionOutParams",24,()=>({duration:150,opacity:0,x:0,y:100})),Q=k();const X={buttonTextCancel:L(),buttonTextConfirm:j(),buttonTextSubmit:F()};let K=k(),Z=!1,tt=k(),rt=k(),at=k("overflow-y-hidden");const ot=Rr();Ot(()=>m(),()=>{var t;m().length&&("prompt"===(t=m())[0].type&&A(Q,t[0].value),L(t[0].buttonTextCancel||X.buttonTextCancel),j(t[0].buttonTextConfirm||X.buttonTextConfirm),F(t[0].buttonTextSubmit||X.buttonTextSubmit),A(K,"string"==typeof t[0].component?E()[t[0].component]:t[0].component))}),Ot(()=>et(tt),()=>{!function(t){var e;let r=null==t?void 0:t.clientHeight;r||(r=null==(e=null==t?void 0:t.firstChild)?void 0:e.clientHeight),r&&(r>et(rt)?A(at,"overflow-y-auto"):A(at,"overflow-y-hidden"))}(et(tt))}),Ot(()=>(m(),dt(S())),()=>{var t;A(w,(null==(t=m()[0])?void 0:t.position)??S())}),Ot(()=>(dt(z()),dt(N()),dt(u),m()),()=>{var t;A(v,`fixed top-0 left-0 right-0 bottom-0 bg-surface-backdrop-token p-4 ${z()} ${N()} ${u.class??""} ${(null==(t=m()[0])?void 0:t.backdropClasses)??""}`)}),Ot(()=>et(w),()=>{A(b,`w-full h-fit min-h-full overflow-y-auto flex justify-center ${et(w)??""}`)}),Ot(()=>(dt(C()),dt(P()),dt(I()),dt(T()),dt($()),dt(B()),dt(D()),m()),()=>{var t;A(y,`block overflow-y-auto ${C()} ${P()} ${I()} ${T()} ${$()} ${B()} ${D()} ${(null==(t=m()[0])?void 0:t.modalClasses)??""}`)}),Ot(()=>(dt(S()),dt(C()),dt(P()),dt(I()),dt(T()),dt($()),dt(B()),dt(D()),dt(M()),dt(O()),dt(L()),dt(j()),dt(F()),dt(z()),dt(q()),dt(H()),dt(W())),()=>{A(x,{position:S(),background:C(),width:P(),height:I(),padding:T(),spacing:$(),rounded:B(),shadow:D(),buttonNeutral:M(),buttonPositive:O(),buttonTextCancel:L(),buttonTextConfirm:j(),buttonTextSubmit:F(),regionBackdrop:z(),regionHeader:q(),regionBody:H(),regionFooter:W(),onClose:o})}),Lt(),ur(),s=me(),le("keydown",bi,function(t){m().length&&"Escape"===t.code&&o()}),l=Ct(s),c=t=>{var s=me();!function(t,e,r){var a,o,n,i;md&&gt(),a=t,o=Uc,i=R()?f:g,Ft(()=>{i(o,o=e())&&(n&&Yt(n),n=zt(()=>r(a)))}),md&&(a=fd)}(Ct(s),m,t=>{var s=Ss(),l=St(s),c=St(l),d=t=>{var e,r,a,s,l,c,d,u=As(),p=St(u),h=t=>{var e=vs();Ie(St(e),()=>m()[0].title),ft(e),Rt(()=>qe(e,`modal-header ${q()??""}`)),we(t,e)};ke(p,t=>{var e;(null==(e=m()[0])?void 0:e.title)&&t(h)}),e=Pt(p,2),r=t=>{var e=bs();Ie(St(e),()=>m()[0].body),ft(e),Rt(()=>qe(e,`modal-body ${H()??""}`)),we(t,e)},ke(e,t=>{var e;(null==(e=m()[0])?void 0:e.body)&&t(r)}),a=Pt(e,2),s=t=>{var e=ys();qe(e,"modal-image w-full h-auto"),Rt(()=>{var t;return je(e,"src",null==(t=m()[0])?void 0:t.image)}),we(t,e)},ke(a,t=>{var e,r;(null==(e=m()[0])?void 0:e.image)&&"string"==typeof(null==(r=m()[0])?void 0:r.image)&&t(s)}),l=Pt(a,2),c=t=>{var e=xs(),r=St(e),a=St(r,!0);ft(r),ft(e),Rt(()=>{qe(e,`modal-footer ${W()??""}`),qe(r,`btn ${M()??""}`),ve(a,L())}),le("click",r,o),we(t,e)},d=t=>{var e=me(),r=Ct(e),a=t=>{var e,r,a=ks(),i=St(a),s=St(i,!0);ft(i),e=Pt(i,2),r=St(e,!0),ft(e),ft(a),Rt(()=>{qe(a,`modal-footer ${W()??""}`),qe(i,`btn ${M()??""}`),ve(s,L()),qe(e,`btn ${O()??""}`),ve(r,j())}),le("click",i,o),le("click",e,n),we(t,a)},s=t=>{var e=me(),r=Ct(e),a=t=>{var e,r,a,n,s,l=_s(),c=St(l);let d;Oe(c),e=Pt(c,2),r=St(e),a=St(r,!0),ft(r),n=Pt(r,2),s=St(n,!0),ft(n),ft(e),ft(l),Rt(()=>{d=Re(c,d,{class:"modal-prompt-input input",name:"prompt",type:"text",...m()[0].valueAttr}),qe(e,`modal-footer ${W()??""}`),qe(r,`btn ${M()??""}`),ve(a,L()),qe(n,`btn ${O()??""}`),ve(s,F())}),Ze(c,()=>et(Q),t=>A(Q,t)),le("click",r,o),le("submit",l,i),we(t,l)};ke(r,t=>{"prompt"===m()[0].type&&t(a)},!0),we(t,e)};ke(r,t=>{"confirm"===m()[0].type?t(a):t(s,!1)},!0),we(t,e)},ke(l,t=>{"alert"===m()[0].type?t(c):t(d,!1)}),ft(u),dr(u,t=>A(tt,t),()=>et(tt)),Rt(()=>{qe(u,`modal ${et(y)??""}`),je(u,"aria-label",m()[0].title??"")}),we(t,u)},u=t=>{var e=Es(),r=St(e),a=t=>{var e=me();Be(Ct(e),()=>{var t;return null==(t=et(K))?void 0:t.ref},(t,e)=>{e(t,wr(()=>{var t;return null==(t=et(K))?void 0:t.props},{get parent(){return et(x)},children:t=>{var e=me();Ie(Ct(e),()=>{var t;return null==(t=et(K))?void 0:t.slot}),we(t,e)},$$slots:{default:!0}}))}),we(t,e)},o=t=>{var e=me();Be(Ct(e),()=>{var t;return null==(t=et(K))?void 0:t.ref},(t,e)=>{e(t,wr(()=>{var t;return null==(t=et(K))?void 0:t.props},{get parent(){return et(x)}}))}),we(t,e)};ke(r,t=>{var e;(null==(e=et(K))?void 0:e.slot)?t(a):t(o,!1)}),ft(e),dr(e,t=>A(tt,t),()=>et(tt)),Rt(()=>{var t;qe(e,`modal contents ${(null==(t=m()[0])?void 0:t.modalClasses)??""??""}`),je(e,"aria-label",m()[0].title??"")}),we(t,e)};ke(c,t=>{"component"!==m()[0].type?t(d):t(u,!1)}),ft(l),ft(s),Mt(()=>le("mousedown",s,r)),Mt(()=>le("mouseup",s,a)),Mt(()=>le("touchstart",s,function(t){hr.call(this,e,t)},void 0,!0)),Mt(()=>le("touchend",s,function(t){hr.call(this,e,t)},void 0,!0)),De(s,(t,e)=>null==Hr?void 0:Hr(t,e),()=>!0),Rt(()=>{qe(s,`modal-backdrop ${et(v)??""} ${et(at)??""}`),qe(l,`modal-transition ${et(b)??""}`)}),Xe(5,l,()=>Qr,()=>({transition:G(),params:Y(),enabled:U()})),Xe(6,l,()=>Qr,()=>({transition:V(),params:J(),enabled:U()})),Xe(7,s,()=>Qr,()=>({transition:Gr,params:{duration:150},enabled:U()})),we(t,s)}),we(t,s)},ke(l,t=>{m().length>0&&t(c)}),d=t=>A(rt,t),function(t,e,r,a=!0){for(var o of(a&&r(),e))t.addEventListener(o,r);Bt(()=>{for(var a of e)t.removeEventListener(a,r)})}(window,["resize"],()=>oe(()=>d(window.innerHeight))),we(t,s),ct(),h()}(s=St(i),{components:v,class:"!p-0"}),l=Pt(s,2),c=t=>{!function(t,e){function r(t){t.preventDefault(),t.returnValue=!0}function a(t){if(!f.current)return;const e=t,{signal:r}=e.detail;r&&w(r)&&(et($).push(e.detail),_(x()+1))}function o(t){return v(t).catch(Ld.error)}var n,i,s,l,c;lt(e,!0);const d=[],{artworkCount:u,successd:p,failed:h,excluded:g,downloading:f,log:m,hasTask:w,batchDownload:v,abort:b,getConcurrency:x,setConcurrency:_}=e.useBatchDownload(),E=new Eu(()=>location.href,t=>{if("navigation"in window){let e,r;navigation.addEventListener("navigatesuccess",()=>{e!==r&&t()}),navigation.addEventListener("navigate",t=>{e=location.href,r=t.destination.url})}else{const e=e=>{const r=history[e];return function(...e){const a=location.href,o=r.apply(this,e);return a!==location.href&&t(),o}};history.pushState=e("pushState"),history.replaceState=e("replaceState")}});let S,P,I,T;null===ku.selectedFilters&&(ku.selectedFilters=e.downloaderConfig.filterOption.filters.filter(t=>t.checked).map(t=>t.id));let $=y(vt([]));const B={};let D=y(""),N=y(0),M=y(!1);const O=C(()=>{if(!e.downloaderConfig)return null;const t=E.current;Ld.info("Navigating to ",t);const{pageOption:r}=e.downloaderConfig,a=[];for(const e in r){const o=r[e],{match:n}=o;"string"==typeof n?t.match(n)&&a.push([e,o]):"function"==typeof n?n(t)&&a.push([e,o]):n.test(t)&&a.push([e,o])}return a.length?a:null}),L=C(()=>f.current||!!et(O)),j=C(()=>p.current.length+h.current.length+g.current.length),R=C(()=>u.current?et(j)/u.current*100:void 0),F=C(()=>!f.current&&u.current?`Completed: ${p.current.length}. Failed: ${h.current.length}. Excluded: ${g.current.length}.`:"");Dt(()=>{if(!e.downloaderConfig.avatar)return;if("string"==typeof e.downloaderConfig.avatar)return void A(D,vt(e.downloaderConfig.avatar));const t=E.current;if(f.current)return;if(t in B){const e=B[t];return void(et(D)!==e&&A(D,vt(e)))}const r=e.downloaderConfig.avatar(t);if("string"==typeof r)return B[t]=r,void(et(D)!==r&&A(D,vt(r)));r.then(e=>{B[t]=e,et(D)!==e&&A(D,vt(e))})}),Dt(()=>{et(L)||A(M,!1)}),Dt(()=>{f.current?globalThis.addEventListener("beforeunload",r):globalThis.removeEventListener("beforeunload",r)}),Dt(()=>{f.current?globalThis.addEventListener(Su,a):(globalThis.removeEventListener(Su,a),rt(()=>{0!==et($).length&&(et($).forEach(t=>t.abort()),A($,vt([])),_())}))}),i=Ct(n=cl()),s=t=>{var r,a,n,i,s,l,c,p,g=rl(),w=St(g),v=t=>{var r=qs();!function(t,e){var r,a,o,n;const i=$e(e),s=mr(e,["children","$$slots","$$events","$$legacy"]);lt(e,!1);const l=k(),c=k(),d=k();let u=br(e,"justify",8,"justify-start"),p=br(e,"border",8,"border-b border-surface-400-500-token"),h=br(e,"active",8,"border-b-2 border-surface-900-50-token"),g=br(e,"hover",8,"hover:variant-soft"),f=br(e,"flex",8,"flex-none"),m=br(e,"padding",8,"px-4 py-2"),w=br(e,"rounded",8,"rounded-tl-container-token rounded-tr-container-token"),v=br(e,"spacing",8,"space-y-1"),b=br(e,"regionList",8,""),y=br(e,"regionPanel",8,""),x=br(e,"labelledby",8,""),_=br(e,"panel",8,"");nt("active",h()),nt("hover",g()),nt("flex",f()),nt("padding",m()),nt("rounded",w()),nt("spacing",v()),Ot(()=>dt(s),()=>{A(l,`space-y-4 ${s.class??""}`)}),Ot(()=>(dt(u()),dt(p()),dt(b())),()=>{A(c,`flex overflow-x-auto hide-scrollbar ${u()} ${p()} ${b()}`)}),Ot(()=>dt(y()),()=>{A(d,` ${y()}`)}),Lt(),ur(),r=fs(),a=St(r),Te(St(a),e,"default",{},null),ft(a),o=Pt(a,2),n=t=>{var r=gs();Te(St(r),e,"panel",{},null),ft(r),Rt(()=>{qe(r,`tab-panel ${et(d)??""}`),je(r,"aria-labelledby",_())}),we(t,r)},ke(o,t=>{i.panel&&t(n)}),ft(r),Rt(()=>{qe(r,`tab-group ${et(l)??""}`),qe(a,`tab-list ${et(c)??""}`),je(a,"aria-labelledby",x())}),we(t,r),ct()}(St(r),{regionList:"text-surface-700-200-token",class:"text-sm",children:t=>{var r,a,o=Ms(),n=Ct(o);na(n,{name:"category",value:0,get group(){return et(N)},set group(t){A(N,vt(t))},children:t=>{mt();var e=fe();Rt(()=>ve(e,gu("downloader.category.tab_name"))),we(t,e)},$$slots:{default:!0}}),r=Pt(n,2),a=t=>{na(t,{name:"tag_filter",value:1,get group(){return et(N)},set group(t){A(N,vt(t))},children:t=>{mt();var e=fe();Rt(()=>ve(e,gu("downloader.tag_filter.tab_name"))),we(t,e)},$$slots:{default:!0}})},ke(r,t=>{e.downloaderConfig.filterOption.enableTagFilter&&t(a)}),na(Pt(r,2),{name:"tag_filter",value:2,get group(){return et(N)},set group(t){A(N,vt(t))},children:t=>{mt();var e=fe();Rt(()=>ve(e,gu("downloader.others.tab_name"))),we(t,e)},$$slots:{default:!0}}),we(t,o)},$$slots:{default:!0,panel:t=>{var r=me(),a=Ct(r),o=t=>{var r,a,o,n,i,s,l,c,u,p,h,g=Rs(),f=Ct(g),m=t=>{var r=Ls(),a=St(r);Ae(a,21,()=>e.downloaderConfig.filterOption.filters,_e,(t,e)=>{var r,a,o,n,i,s;let l=()=>et(e).id,c=()=>et(e).name;a=St(r=Os()),Oe(o=St(a)),ft(a),i=Pt(a,2),s=St(i,!0),Rt(()=>ve(s,"function"==typeof c()?c()():c())),ft(i),ft(r),Rt(()=>{n!==(n=l())&&(o.value=null==(o.__value=l())?"":l())}),tr(d,[],o,()=>(l(),ku.selectedFilters),t=>ku.selectedFilters=t),we(t,r)}),ft(a),ft(r),we(t,r)};ke(f,t=>{e.downloaderConfig.filterOption.filters.length&&t(m)}),a=St(r=Pt(f,2)),ea(St(a),{regionLabel:"text-surface-700-200-token",active:"variant-filled-primary",background:"bg-surface-400/20 dark:bg-surface-500/20",border:"",display:"flex",children:t=>{var e=js(),r=Ct(e);ra(r,{class:"text-sm !py-[7px]",name:"justify",value:!0,get group(){return ku.downloadAllPages},set group(t){ku.downloadAllPages=t},children:t=>{mt();var e=fe();Rt(()=>ve(e,gu("downloader.category.filter.download_all_pages"))),we(t,e)},$$slots:{default:!0}}),ra(Pt(r,2),{class:"text-sm !py-[7px]",name:"justify",value:!1,get group(){return ku.downloadAllPages},set group(t){ku.downloadAllPages=t},children:t=>{mt();var e=fe();Rt(()=>ve(e,gu("downloader.category.filter.download_selected_pages"))),we(t,e)},$$slots:{default:!0}}),we(t,e)},$$slots:{default:!0}}),ft(a),n=St(o=Pt(a,2)),i=St(n),s=St(i),Ie(St(s),()=>'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M10,16.5L16,12L10,7.5V16.5Z" /></svg>'),ft(s),ft(i),De(l=Pt(i,2),(t,e)=>null==bu?void 0:bu(t,e),()=>({get:()=>ku.pageStart,set(t){ku.pageStart=t}})),ft(n),u=St(c=Pt(n,2)),p=St(u),Ie(St(p),()=>'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4M9,9V15H15V9" /></svg>'),ft(p),ft(u),De(h=Pt(u,2),(t,e)=>null==bu?void 0:bu(t,e),()=>({get:()=>ku.pageEnd,set(t){ku.pageEnd=t}})),ft(c),ft(o),ft(r),Rt(()=>{l.disabled=ku.downloadAllPages,h.disabled=ku.downloadAllPages}),we(t,g)},n=t=>{var e=me(),r=Ct(e),a=t=>{var e,r,a=Fs(),o=Ct(a),n=C(()=>gu("downloader.tag_filter.placeholder.blacklist_tag"));Zr(o,{allowUpperCase:!0,name:"blacklist",chips:"variant-filled-primary",get placeholder(){return et(n)},get value(){return ku.blacklistTag},set value(t){ku.blacklistTag=t}}),e=Pt(o,2),r=C(()=>gu("downloader.tag_filter.placeholder.whitelist_tag")),Zr(e,{allowUpperCase:!0,name:"whitelist",chips:"variant-filled-primary",get placeholder(){return et(r)},class:"my-4",get value(){return ku.whitelistTag},set value(t){ku.whitelistTag=t}}),we(t,a)},o=t=>{var e=me(),r=Ct(e),a=t=>{var e=zs(),r=St(e),a=St(r,!0);Rt(()=>ve(a,gu("downloader.others.options.retry_failed"))),ft(r),oa(Pt(r,2),{size:"sm",name:"download-retry",get checked(){return ku.retryFailed},set checked(t){ku.retryFailed=t}}),ft(e),we(t,e)};ke(r,t=>{2===et(N)&&t(a)},!0),we(t,e)};ke(r,t=>{1===et(N)?t(a):t(o,!1)},!0),we(t,e)};ke(a,t=>{0===et(N)?t(o):t(n,!1)}),we(t,r)}}}),mt(2),ft(r),Xe(3,r,()=>Vr),we(t,r)};ke(w,t=>{f.current||t(v)}),a=St(r=Pt(w,2)),n=t=>{var e,r,a,n,i,s=Vs(),l=St(s),c=St(l),d=St(c,!0);ft(c),e=Pt(c,2),r=St(e,!0),ft(e),ft(l),a=Pt(l,2),n=t=>{var e=Us();Ae(e,21,()=>et(O),_e,(t,e)=>{var r,a,n;let i=()=>et(e)[0],s=()=>et(e)[1];a=Ct(r=me()),n=t=>{var e,r,a,n=Ws();n.__click=[Hs,o,i],e=St(n),Ie(St(e),()=>vu),ft(e),r=Pt(e,2),a=St(r,!0),Rt(()=>ve(a,"function"==typeof s().name?s().name():s().name)),ft(r),ft(n),we(t,n)},ke(a,t=>{"fn"in s()&&t(n)}),we(t,r)}),ft(e),we(t,e)},i=t=>{var e=me(),r=Ct(e),a=t=>{var e,r,a,n=Ys();n.__click=[Gs,o,O],e=St(n),Ie(St(e),()=>vu),ft(e),r=Pt(e,2),a=St(r,!0),Rt(()=>ve(a,"function"==typeof et(O)[0][1].name?et(O)[0][1].name():et(O)[0][1].name)),ft(r),ft(n),we(t,n)};ke(r,t=>{et(O)&&"fn"in et(O)[0][1]&&t(a)},!0),we(t,e)},ke(a,t=>{et(O)&&et(O).length>1?t(n):t(i,!1)}),ft(s),dr(s,t=>S=t,()=>S),Rt(()=>{var t,a;ve(d,et(F)),We(e,"text-error-500","Error"===(null==(t=m.current)?void 0:t.type)),ve(r,(null==(a=m.current)?void 0:a.message)??"")}),le("introstart",s,()=>S.classList.remove("absolute")),le("outrostart",s,()=>S.classList.add("absolute")),Xe(3,s,()=>Gr,()=>({duration:250})),we(t,s)},i=t=>{var e,r,a,o,n,i,s,l,c,d=Qs(),p=St(d),h=St(p);!function(t,e){var r,a;const o=mr(e,["children","$$slots","$$events","$$legacy"]);lt(e,!1);const n=k(),i=k(),s=k(),l=k(),c=k();let d=br(e,"value",24,()=>{}),u=br(e,"min",8,0),p=br(e,"max",8,100),h=br(e,"height",8,"h-2"),g=br(e,"rounded",8,"rounded-token"),f=br(e,"transition",8,"transition-[width]"),m=br(e,"animIndeterminate",8,"anim-indeterminate"),w=br(e,"meter",8,"bg-surface-900-50-token"),v=br(e,"track",8,"bg-surface-200-700-token"),b=br(e,"labelledby",8,"");Ot(()=>(dt(d()),dt(u()),dt(p())),()=>{A(n,d()?100*(d()-u())/(p()-u()):0)}),Ot(()=>dt(d()),()=>{A(i,void 0===d()||d()<0)}),Ot(()=>(et(i),dt(m())),()=>{A(s,et(i)?m():"")}),Ot(()=>(dt(v()),dt(h()),dt(g()),dt(o)),()=>{A(l,`w-full overflow-hidden ${v()} ${h()} ${g()} ${o.class??""}`)}),Ot(()=>(dt(w()),dt(g()),et(s),dt(f())),()=>{A(c,`h-full ${w()} ${g()} ${et(s)} ${f()}`)}),Lt(),ur(),r=rs(),a=St(r),ft(r),Rt(()=>{qe(r,`progress-bar ${et(l)??""} svelte-12wvf64`),je(r,"aria-labelledby",b()),je(r,"aria-valuenow",d()),je(r,"aria-valuemin",u()),je(r,"aria-valuemax",p()-u()),qe(a,`progress-bar-meter ${et(c)??""} svelte-12wvf64`),Ue(a,"width",`${(et(i)?100:et(n))??""}%`)}),we(t,r),ct()}(h,{height:"h-4",rounded:"rounded-md",meter:"bg-primary-500",track:"bg-primary-500/30",max:100,get value(){return et(R)}}),e=Pt(h,2),r=St(e),a=St(r,!0),ft(r),o=Pt(r,2),n=St(o,!0),ft(o),ft(e),ft(p),(i=Pt(p,2)).__click=[Js,b],s=St(i),Ie(St(s),()=>'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm101.8-262.2L295.6 256l62.2 62.2c4.7 4.7 4.7 12.3 0 17l-22.6 22.6c-4.7 4.7-12.3 4.7-17 0L256 295.6l-62.2 62.2c-4.7 4.7-12.3 4.7-17 0l-22.6-22.6c-4.7-4.7-4.7-12.3 0-17l62.2-62.2-62.2-62.2c-4.7-4.7-4.7-12.3 0-17l22.6-22.6c4.7-4.7 12.3-4.7 17 0l62.2 62.2 62.2-62.2c4.7-4.7 12.3-4.7 17 0l22.6 22.6c4.7 4.7 4.7 12.3 0 17z"></path></svg>\n'),ft(s),l=Pt(s,2),c=St(l,!0),Rt(()=>ve(c,gu("downloader.download_type.stop"))),ft(l),ft(i),ft(d),dr(d,t=>P=t,()=>P),Rt(()=>{var t,e;We(r,"text-error-500","Error"===(null==(t=m.current)?void 0:t.type)),ve(a,(null==(e=m.current)?void 0:e.message)??""),ve(n,u.current?`${et(j)} / ${u.current}`:"")}),le("introstart",d,()=>P.classList.remove("absolute")),le("outrostart",d,()=>P.classList.add("absolute")),Xe(3,d,()=>Gr,()=>({duration:250})),we(t,d)},ke(a,t=>{f.current?t(i,!1):t(n)}),ft(r),s=Pt(r,2),l=t=>{var e,r=Ks(),a=St(r),o=St(a,!0);Rt(()=>ve(o,gu("downloader.file_handle_not_found.title"))),ft(a),Ae(e=Pt(a,2),22,()=>et($),t=>t,(t,e,r)=>{var a,o,n,i,s,l,c,d,u,p,h=Xs();const g=C(()=>e.path.lastIndexOf("/")),f=C(()=>-1!==et(g));a=St(h),o=St(a),n=St(o,!0),Rt(()=>ve(n,et(f)?e.path.slice(et(g)+1):e.path)),ft(o),i=Pt(o,2),s=St(i,!0),Rt(()=>ve(s,et(f)?e.path.slice(0,et(g)):"")),ft(i),ft(a),(c=St(l=Pt(a,2))).__click=()=>{e.abort(),et($).splice(et(r),1),_(x()-1)},d=St(c,!0),Rt(()=>ve(d,gu("downloader.file_handle_not_found.button.cancel"))),ft(c),(u=Pt(c,2)).__click=async()=>{await e.getFileHandle(),et($).splice(et(r),1),_(x()-1)},p=St(u,!0),Rt(()=>ve(p,gu("downloader.file_handle_not_found.button.save"))),ft(u),ft(l),ft(h),Xe(3,h,()=>Vr,()=>({duration:250})),we(t,h)}),ft(e),ft(r),Xe(3,r,()=>Vr,()=>({duration:250})),we(t,r)},ke(s,t=>{et($).length&&t(l)}),c=Pt(s,2),p=t=>{const e=C(()=>h.current.toSorted(t=>t.reason instanceof Nu?-1:1));!function(t,e){var r;const a=mr(e,["children","$$slots","$$events","$$legacy"]);lt(e,!1);const[o,n]=fr(),i=k();let s=br(e,"autocollapse",8,!1),l=br(e,"width",8,"w-full"),c=br(e,"spacing",8,"space-y-1"),d=br(e,"disabled",8,!1),u=br(e,"padding",8,"py-2 px-4"),p=br(e,"hover",8,"hover:bg-primary-hover-token"),h=br(e,"rounded",8,"rounded-container-token"),g=br(e,"caretOpen",8,"rotate-180"),f=br(e,"caretClosed",8,""),m=br(e,"regionControl",8,""),w=br(e,"regionPanel",8,"space-y-4"),v=br(e,"regionCaret",8,""),b=br(e,"transitions",24,()=>!gr(cu,"$prefersReducedMotionStore",o)),y=br(e,"transitionIn",8,Vr),x=br(e,"transitionInParams",24,()=>({duration:200})),_=br(e,"transitionOut",8,Vr),E=br(e,"transitionOutParams",24,()=>({duration:200}));nt("active",Sr(null)),nt("autocollapse",s()),nt("disabled",d()),nt("padding",u()),nt("hover",p()),nt("rounded",h()),nt("caretOpen",g()),nt("caretClosed",f()),nt("regionControl",m()),nt("regionPanel",w()),nt("regionCaret",v()),nt("transitions",b()),nt("transitionIn",y()),nt("transitionInParams",x()),nt("transitionOut",_()),nt("transitionOutParams",E()),Ot(()=>(dt(l()),dt(c()),dt(a)),()=>{A(i,`${l()} ${c()} ${a.class??""}`)}),Lt(),ur(),Te(St(r=Mi()),e,"default",{},null),ft(r),Rt(()=>qe(r,`accordion ${et(i)??""}`)),we(t,r),ct(),n()}(t,{class:"text-surface-700-200-token mt-4",children:t=>{!function(t,e){function r(t){!0===$()?B().set(I()):P(!P()),function(t){const e=$()?w()===I():P();C("toggle",{event:t,id:I(),panelId:`accordion-panel-${I()}`,open:e,autocollapse:$()})}(t)}var a,o,n,i,s,l,c,d,u,p;const h=$e(e),g=mr(e,["children","$$slots","$$events","$$legacy"]);lt(e,!1);const[f,m]=fr(),w=()=>gr(B(),"$active",f),v=k(),b=k(),y=k(),x=k(),_=k(),E=k(),S=k(),C=kr();let P=br(e,"open",12,!1),I=br(e,"id",24,()=>String(Math.random()));const T="fill-current w-3 transition-transform duration-[200ms]";let $=br(e,"autocollapse",24,()=>ot("autocollapse")),B=br(e,"active",24,()=>ot("active")),D=br(e,"disabled",24,()=>ot("disabled")),N=br(e,"padding",24,()=>ot("padding")),M=br(e,"hover",24,()=>ot("hover")),O=br(e,"rounded",24,()=>ot("rounded")),L=br(e,"caretOpen",24,()=>ot("caretOpen")),j=br(e,"caretClosed",24,()=>ot("caretClosed")),R=br(e,"regionControl",24,()=>ot("regionControl")),F=br(e,"regionPanel",24,()=>ot("regionPanel")),z=br(e,"regionCaret",24,()=>ot("regionCaret")),q=br(e,"transitions",24,()=>ot("transitions")),H=br(e,"transitionIn",24,()=>ot("transitionIn")),W=br(e,"transitionInParams",24,()=>ot("transitionInParams")),U=br(e,"transitionOut",24,()=>ot("transitionOut")),G=br(e,"transitionOutParams",24,()=>ot("transitionOutParams"));const Y='\n\t\t<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">\n\t\t\t<path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" />\n\t\t</svg>';$()&&P()&&r(),Ot(()=>(dt(P()),dt($())),()=>{P()&&$()&&r()}),Ot(()=>(dt($()),w(),dt(I()),dt(P())),()=>{A(v,$()?w()===I():P())}),Ot(()=>dt(g),()=>{A(b,` ${g.class??""}`)}),Ot(()=>(dt(N()),dt(M()),dt(O()),dt(R())),()=>{A(y,`text-start w-full flex items-center space-x-4 ${N()} ${M()} ${O()} ${R()}`)}),Ot(()=>(et(v),dt(L()),dt(j())),()=>{A(x,et(v)?L():j())}),Ot(()=>(dt(z()),et(x)),()=>{A(_,`${T} ${z()} ${et(x)}`)}),Ot(()=>dt(z()),()=>{A(E,`${T} ${z()}`)}),Ot(()=>(dt(N()),dt(O()),dt(F())),()=>{A(S,` ${N()} ${O()} ${F()}`)}),Lt(),ur(),a=Fi(),o=St(a),n=St(o),i=t=>{var r=Oi();Te(St(r),e,"lead",{},null),ft(r),we(t,r)},ke(n,t=>{h.lead&&t(i)}),Te(St(s=Pt(n,2)),e,"summary",{},t=>{we(t,fe("(summary)"))}),ft(s),l=Pt(s,2),c=t=>{var r=Li(),a=St(r),o=t=>{var r=me();Te(Ct(r),e,"iconClosed",{},t=>{var e=me();Ie(Ct(e),()=>Y),we(t,e)}),we(t,r)},n=t=>{var r=me();Te(Ct(r),e,"iconOpen",{},t=>{var e=me();Ie(Ct(e),()=>Y),we(t,e)}),we(t,r)};ke(a,t=>{et(v)?t(o):t(n,!1)}),ft(r),Rt(()=>qe(r,`accordion-summary-icons ${et(E)??""}`)),we(t,r)},d=t=>{var e=ji();Ie(St(e),()=>Y),ft(e),Rt(()=>qe(e,`accordion-summary-caret ${et(_)??""}`)),we(t,e)},ke(l,t=>{h.iconClosed||h.iconOpen?t(c):t(d,!1)}),ft(o),u=Pt(o,2),p=t=>{var r=Ri();Te(St(r),e,"content",{},t=>{we(t,fe("(content)"))}),ft(r),Rt(()=>{qe(r,`accordion-panel ${et(S)??""}`),je(r,"id",`accordion-panel-${I()??""}`),je(r,"aria-hidden",!et(v)),je(r,"aria-labelledby",I())}),Xe(1,r,()=>Qr,()=>({transition:H(),params:W(),enabled:q()})),Xe(2,r,()=>Qr,()=>({transition:U(),params:G(),enabled:q()})),we(t,r)},ke(u,t=>{et(v)&&t(p)}),ft(a),Rt(()=>{qe(a,`accordion-item ${et(b)??""}`),qe(o,`accordion-control ${et(y)??""}`),je(o,"id",I()),je(o,"aria-expanded",et(v)),je(o,"aria-controls",`accordion-panel-${I()??""}`),o.disabled=D()}),le("click",o,r),le("click",o,function(t){hr.call(this,e,t)}),le("keydown",o,function(t){hr.call(this,e,t)}),le("keyup",o,function(t){hr.call(this,e,t)}),le("keypress",o,function(t){hr.call(this,e,t)}),we(t,a),ct(),m()}(t,{class:"bg-white/30 dark:bg-black/15 rounded-container-token",lead:t=>{var r=Zs(),a=St(r,!0);ft(r),Rt(()=>ve(a,et(e).length)),we(t,r)},summary:t=>{mt();var e=fe();Rt(()=>ve(e,gu("downloader.failed_downloads"))),we(t,e)},content:t=>{var r=el();Ae(r,20,()=>et(e),t=>t,(t,e)=>{var r,a,o=tl(),n=St(o),i=St(n,!0);ft(n),r=Pt(n,2),a=St(r,!0),ft(r),ft(o),Rt(()=>{ve(i,e.id),ve(a,e.reason)}),we(t,o)}),ft(r),we(t,r)},$$slots:{lead:!0,summary:!0,content:!0}})},$$slots:{default:!0}})},ke(c,t=>{!f.current&&h.current.length&&t(p)}),ft(g),Xe(3,g,()=>Yr,()=>({x:50,opacity:0})),we(t,g)},ke(i,t=>{et(M)&&et(L)&&t(s)}),l=Pt(i,2),c=t=>{var e,r,a,o,n,i,s,l,c,d=ll();d.__click=[al,M],e=St(d),r=St(e),a=t=>{var e=ol();Rt(()=>je(e,"src",et(D))),we(t,e)},ke(r,t=>{et(D)&&t(a)}),ft(e),o=Pt(e,2),n=t=>{var e=nl();ta(St(e),{width:"w-16",stroke:32,meter:"stroke-primary-500",track:"stroke-primary-500/30",fill:"fill-primary-500",strokeLinecap:"butt",get value(){return et(R)}}),ft(e),Xe(3,e,()=>Gr,()=>({duration:250})),we(t,e)},ke(o,t=>{f.current&&!et(M)&&t(n)}),s=St(i=Pt(o,2)),l=t=>{var e,r,a=il(),o=St(a),n=St(o,!0);ft(o),e=Pt(o,4),r=St(e,!0),ft(e),ft(a),dr(a,t=>I=t,()=>I),Rt(()=>{ve(n,et(j)),ve(r,u.current)}),le("introstart",a,()=>I.classList.remove("absolute")),le("outrostart",a,()=>I.classList.add("absolute")),Xe(3,a,()=>Gr,()=>({duration:250})),we(t,a)},c=t=>{var e=me(),r=Ct(e),a=t=>{var e=sl();Ie(St(e),()=>'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9,1V7H5L12,14L19,7H15V1H9M5,16V18H19V16H5M5,20V22H19V20H5Z" /></svg>'),ft(e),dr(e,t=>T=t,()=>T),le("introstart",e,()=>T.classList.remove("absolute")),le("outrostart",e,()=>T.classList.add("absolute")),Xe(3,e,()=>Gr,()=>({duration:250})),we(t,e)};ke(r,t=>{et(M)||t(a)},!0),we(t,e)},ke(s,t=>{f.current&&u.current&&!et(M)?t(l):t(c,!1)}),ft(i),ft(d),Rt(()=>{We(e,"opacity-70",!et(M)),We(e,"blur-[1px]",!et(M))}),Xe(3,d,()=>Yr,()=>({opacity:0,x:50})),we(t,d)},ke(l,t=>{et(L)&&t(c)}),we(t,n),ct()}(t,{get downloaderConfig(){return e.downloaderConfig},get useBatchDownload(){return e.useBatchDownload}})},ke(l,t=>{e.downloaderConfig&&e.useBatchDownload&&t(c)}),d=Pt(l,2),u=t=>{var e,r,o,n=oc();n.__click=a,e=St(n),Ie(St(e),()=>'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z" /></svg>'),ft(e),r=Pt(e,2),o=St(r,!0),Rt(()=>ve(o,gu("button.setting"))),ft(r),ft(n),we(t,n)},ke(d,t=>{np.showPopupButton&&t(u)}),function(t,e){var r,a,o;const n=mr(e,["children","$$slots","$$events","$$legacy"]);lt(e,!1);const[i,s]=fr(),l=()=>gr(h,"$toastStore",i),c=k(),d=k(),u=k(),p=k(),h=Fr();let g=br(e,"position",8,"b"),f=br(e,"max",8,3),m=br(e,"background",8,"variant-filled-secondary"),w=br(e,"width",8,"max-w-[640px]"),v=br(e,"color",8,""),b=br(e,"padding",8,"p-4"),y=br(e,"spacing",8,"space-x-4"),x=br(e,"rounded",8,"rounded-container-token"),_=br(e,"shadow",8,"shadow-lg"),E=br(e,"zIndex",8,"z-[888]"),S=br(e,"buttonAction",8,"btn variant-filled"),C=br(e,"buttonDismiss",8,"btn-icon btn-icon-sm variant-filled"),P=br(e,"buttonDismissLabel",8,"✕"),I=br(e,"transitions",24,()=>!gr(cu,"$prefersReducedMotionStore",i)),T=br(e,"transitionIn",8,Yr),$=br(e,"transitionInParams",24,()=>({duration:250})),B=br(e,"transitionOut",8,Yr),D=br(e,"transitionOutParams",24,()=>({duration:250})),N=k(),M=k(),O=k({x:0,y:0});switch(g()){case"t":A(N,"justify-center items-start"),A(M,"items-center"),A(O,{x:0,y:-100});break;case"b":A(N,"justify-center items-end"),A(M,"items-center"),A(O,{x:0,y:100});break;case"l":A(N,"justify-start items-center"),A(M,"items-start"),A(O,{x:-100,y:0});break;case"r":A(N,"justify-end items-center"),A(M,"items-end"),A(O,{x:100,y:0});break;case"tl":A(N,"justify-start items-start"),A(M,"items-start"),A(O,{x:-100,y:0});break;case"tr":A(N,"justify-end items-start"),A(M,"items-end"),A(O,{x:100,y:0});break;case"bl":A(N,"justify-start items-end"),A(M,"items-start"),A(O,{x:-100,y:0});break;case"br":A(N,"justify-end items-end"),A(M,"items-end"),A(O,{x:100,y:0})}let L=k(!1);Ot(()=>(et(N),dt(E()),dt(n)),()=>{A(c,`flex fixed top-0 left-0 right-0 bottom-0 pointer-events-none ${et(N)} ${E()} ${n.class||""}`)}),Ot(()=>(et(M),dt(b())),()=>{A(d,`flex flex-col gap-y-2 ${et(M)} ${b()}`)}),Ot(()=>(dt(w()),dt(v()),dt(b()),dt(y()),dt(x()),dt(_())),()=>{A(u,`flex justify-between items-center pointer-events-auto ${w()} ${v()} ${b()} ${y()} ${x()} ${_()}`)}),Ot(()=>(l(),dt(f())),()=>{A(p,Array.from(l()).slice(0,f()))}),Ot(()=>et(p),()=>{et(p).length&&A(L,!0)}),Lt(),ur(),a=Ct(r=me()),o=t=>{var e=$s(),r=St(e);Ae(r,15,()=>et(p),t=>t,(t,e,r)=>{var a,o,n=Ts(),i=St(n),s=St(i);Ie(St(s),()=>et(e).message),ft(s),a=Pt(s,2),o=t=>{var a,o,n,i,s=Is();qe(s,"toast-actions flex items-center space-x-2"),a=St(s),o=t=>{var a=Cs();Ie(St(a),()=>et(e).action.label),ft(a),Rt(()=>qe(a,Me(S()))),le("click",a,()=>{return t=et(r),null==(a=null==(e=l()[t])?void 0:e.action)||a.response(),void h.close(l()[t].id);var t,e,a}),we(t,a)},ke(a,t=>{et(e).action&&t(o)}),n=Pt(a,2),i=t=>{var r=Ps(),a=St(r,!0);ft(r),Rt(()=>{qe(r,Me(C())),ve(a,P())}),le("click",r,()=>h.close(et(e).id)),we(t,r)},ke(n,t=>{et(e).hideDismiss||t(i)}),ft(s),we(t,s)},ke(a,t=>{!et(e).action&&et(e).hideDismiss||t(o)}),ft(i),ft(n),Rt(()=>{je(n,"role",et(e).hideDismiss?"alert":"alertdialog"),qe(i,`toast ${et(u)??""} ${et(e).background??m()??""} ${et(e).classes??""??""}`)}),Qe(n,()=>Kr,()=>({duration:I()?250:0})),Xe(5,n,()=>Qr,()=>({transition:T(),params:{x:et(O).x,y:et(O).y,...$()},enabled:I()})),Xe(6,n,()=>Qr,()=>({transition:B(),params:{x:et(O).x,y:et(O).y,...D()},enabled:I()})),le("outroend",n,()=>{0===et(p).length&&A(L,!1)}),le("mouseenter",n,()=>{return t=et(r),void((null==(e=l()[t])?void 0:e.hoverable)&&(h.freeze(t),A(d,et(d)+" scale-[105%]")));var t,e}),le("mouseleave",n,()=>{return t=et(r),void((null==(e=l()[t])?void 0:e.hoverable)&&(h.unfreeze(t),A(d,et(d).replace(" scale-[105%]",""))));var t,e}),we(t,n)}),ft(r),ft(e),Rt(()=>{qe(e,`snackbar-wrapper ${et(c)??""}`),qe(r,`snackbar ${et(d)??""}`)}),we(t,e)},ke(a,t=>{(et(p).length>0||et(L))&&t(o)}),we(t,r),ct(),s()}(Pt(d,2),{}),ft(i),dr(i,t=>w=t,()=>w),Rt(()=>qe(i,Me({contents:!0,dark:et(m)}))),le("mousedown",i,n,!0),le("mouseup",i,n,!0),we(t,i),ct({showChangelog:r,showSetting:a,toast:o})},{supportedTemplate:{},downloaderConfig:{},useBatchDownload:{}},[],0,0,t=>class extends t{constructor(t){super(),fc(this,"supportedTemplate"),fc(this,"downloaderConfig"),fc(this,"useBatchDownload"),this.supportedTemplate=t.supportedTemplate}initBatchDownloader(t){return this.downloaderConfig=t,this.useBatchDownload=function(t){function e(t){return"string"==typeof t[0]}function r(t){if(et(v)&&t)throw new Error("Already downloading.");A(v,vt(t))}function a(t){let e;Array.isArray(t)?(et(f).push(...t),e=t[t.length-1]):(et(f).push(t),e=t);const{id:r,reason:a}=e;(a instanceof Error||"string"==typeof a)&&n("Fail",r,a)}function o(t){if(Array.isArray(t))e(t)?et(m).push(...t):et(m).push(...t.map(t=>t.id)),n("Info",t.length+" task"+(t.length>1?"s were":" was")+" excluded...");else{const e="string"==typeof t?t:t.id;et(m).push(e),n("Info",`${e} was excluded...`)}}function n(t,e,r){const a={type:t,message:""};switch(t){case"Error":if(!(e instanceof Error))throw new TypeError("error` is expected to be error, but got "+typeof e);a.message=`[${e.name}] ${e.message}`;break;case"Fail":if("string"!=typeof e)throw new TypeError("`id` is expected to be string, but got "+typeof e);a.message="string"==typeof r?`[Fail] ${e}...${r}`:`[Fail] ${e}...${r?r.name+":"+r.message:""}`;break;default:a.message=`[${t}] ${e}`}A(b,vt(a))}function i(t,e){if(!("tags"in t)||!Array.isArray(t.tags))return!0;const{whitelistTag:r,blacklistTag:a}=p;return e??(e=(t,e)=>t.some(t=>e.includes(t))),r.length?e(r,t.tags):!a.length||!e(a,t.tags)}async function s(e){try{const{enableTagFilter:r}=t.filterOption;if(!0===r){if(!i(e))return!1}else if(r&&!i(e,r))return!1;if(!S.length)return!1;for(let t=0;t<C.length;t++){const r=C[t];if(await r(e))return!1}for(let t=0;t<S.length;t++){const r=S[t];if(await r(e))return!0}}catch(t){console.error(t)}return!1}async function l(r,i,l){l.throwIfAborted();const c=new Promise((t,e)=>{l.addEventListener("abort",()=>{e(l.reason),0!==T.size&&T.clear(),I.forEach(t=>t.abort(l.reason)),I.clear()},{once:!0})}),{parseMetaByArtworkId:d,downloadArtworkByMeta:u}=t;let p;for(;(p=await Promise.race([r.next(),c]))&&!p.done;){l.throwIfAborted();const{total:t,avaliable:r,invalid:f,unavaliable:m}=p.value;if(Ld.info(t,r,f,m),t!==et(h)&&A(h,vt(t)),f.length&&o(f),m.length&&(e(m)?(a(m.map(t=>({id:t,reason:new Nu(t)}))),_.push(...m)):(a(m.map(t=>({id:t.id,reason:new Nu(t.id)}))),E.push(...m))),r.length){for(const t of r){const e=new AbortController,r=e.signal;I.set(r,e),T.add(async({signal:e})=>{if(!e)throw new Error("Expect `QueueAddOptions.signal` to be a AbortSignal but got undefined.");const r="string"==typeof t,c=r?t:t.id;try{let a;if(e.throwIfAborted(),r){if(a=await d(c),e.throwIfAborted(),!i&&!await s(a))return void o(c)}else a=t;n("Add",c),await u(a,e),!e.aborted&&(p=c,Array.isArray(p)?(et(g).push(...p),n("Complete",p[p.length-1])):(et(g).push(p),n("Complete",p)))}catch(o){if(e.aborted)return;if(a({id:c,reason:o}),o instanceof Du)return void(null==P||P.abort(o));const i=o instanceof Nu;r?(i?_:x).push(t):(i?E:k).push(t),o instanceof Iu&&429===o.status&&!T.isPaused&&(T.pause(),setTimeout(()=>{!l.aborted&&T.start()},3e4),n("Error",new Error("Http status: 429, wait for 30 seconds."))),Ld.error(o)}var p},{signal:r}).catch(Ld.warn).finally(()=>{I.delete(r)})}await Promise.race([c,T.onEmpty()])}else await Promise.race([Tr(1500),c])}return Promise.race([c,T.onIdle()])}const{requestDownload:c,cancelDownloadRequest:d,processNextDownload:u}=function(){const t=String(Math.random()),e=[];let r,a,o=!1,n=!1;return jd.on("batchdownload.query",()=>{o&&jd.emit("batchdownload.set-pending")}),jd.on("batchdownload.set-pending",()=>{!n&&(n=!0)}),jd.on("batchdownload.set-idle",()=>{n&&(n=!1)}),jd.on("batchdownload.add-queue",t=>{o&&e.push(t)}),jd.on("batchdownload.remove-queue",t=>{if(!o)return;const r=e.findIndex(e=>e===t);-1!==r&&e.splice(r,1)}),jd.on("batchdownload.process-next",a=>{a[0]===t&&(e.push(...a.slice(1)),n=!1,o=!0,r())}),window.addEventListener("unload",()=>{n?jd.emit("batchdownload.remove-queue",t):o&&(e.length?jd.emit("batchdownload.process-next",e):jd.emit("batchdownload.set-idle"))}),jd.emit("batchdownload.query"),{async requestDownload(){if(!n)return o=!0,jd.emit("batchdownload.set-pending"),void Ld.info("channel post: SET_PENDING");const e=new Promise((t,e)=>{r=t,a=e});return jd.emit("batchdownload.add-queue",t),Ld.info("channel post: ADD_QUEUE",t),e},cancelDownloadRequest(e){n&&(jd.emit("batchdownload.remove-queue",t),Ld.info("channel post: REMOVE_QUEUE",t),a(e))},processNextDownload(){o&&(o=!1,e.length?(n=!0,jd.emit("batchdownload.process-next",e),e.length=0,Ld.info("channel post: PROCESS_NEXT")):(jd.emit("batchdownload.set-idle"),Ld.info("channel post: SET_IDLE")))}}}();let p=null,h=y(0),g=y(vt([])),f=y(vt([])),m=y(vt([])),v=y(!1),b=y(void 0);const x=[],k=[],_=[],E=[],S=[],C=[];let P;const I=new Map,T=new Xu({concurrency:5,interval:1100,intervalCap:1}),$={artworkCount:{get current(){return et(h)}},successd:{get current(){return et(g)}},failed:{get current(){return et(f)}},excluded:{get current(){return et(m)}},downloading:{get current(){return et(v)}},log:{get current(){return et(b)}},batchDownload:async function(e,...a){r(!0),n("Info","Download start..."),T.start(),p=w(ku.$state),(p.selectedFilters??[]).forEach(e=>{const r=t.filterOption.filters.find(t=>t.id===e);r&&("include"===r.type?S.push(r.fn):C.push(r.fn))}),A(h,0),A(g,vt([])),A(f,vt([])),A(m,vt([])),x.length=0,_.length=0,k.length=0,E.length=0,n("Info","Reset store.");const{beforeDownload:o,afterDownload:i}=t;let v,b;P=new AbortController;const y=P.signal;y.addEventListener("abort",()=>{var e;d(y.reason),null==(e=t.onDownloadAbort)||e.call(t)},{once:!0});try{const r=function(e){const{pageOption:r}=t;for(const t in r)if(t===e)return r[t]}(e);if(!r||!("fn"in r))throw new Error("Invalid generator id: "+e);const{filterInGenerator:i,beforeDownload:d,afterDownload:u}=r;v=u,"function"==typeof o&&await o(),"function"==typeof d&&await d(),b=function(t,...e){let r;const{downloadAllPages:a,pageEnd:o,pageStart:n}=p;if(!a&&o<n)throw new Error("End page must not be less than the start page.");const i=a?null:[n,o];return r="filterInGenerator"in t&&!t.filterInGenerator?t.fn(i,...e):t.fn(i,s,...e),r}(r,...a),n("Info","Waiting for other downloads to finish..."),await c(),n("Info","Starting..."),await l(b,i,y),p.retryFailed&&(x.length||k.length)&&(x.length?(b=function*(t,e,r){yield{total:t,page:0,avaliable:e,invalid:[],unavaliable:r}}(et(h),x.slice(),_.slice()),x.length=0,_.length=0):k.length&&(b=function*(t,e,r){yield{total:t,page:0,avaliable:e,invalid:[],unavaliable:r}}(et(h),k.slice(),E.slice()),k.length=0,E.length=0),A(f,vt([])),n("Info","Retry..."),await l(b,i,y)),n("Info","Download complete.")}catch(t){throw null==b||b.return(),y.aborted||P.abort(t),t instanceof Error&&n("Error",t),t}finally{"function"==typeof v&&v(),"function"==typeof i&&i(),P=null,p=null,S.length=0,C.length=0,T.pause(),r(!1),u()}},abort(){P&&P.abort(new Tu)},hasTask:t=>I.has(t),getConcurrency:()=>T.concurrency,setConcurrency(t){T.concurrency=void 0!==t?t:5}};return function(){return $}}(t)}});customElements.define("pdl-app",sp);class lp{constructor(){fc(this,"app"),fc(this,"useBatchDownload"),this.app=this.createApp(),this.backupIfNeeded()}static get hostname(){throw new Error("`hostname` should be overwritten by a subclass.")}createApp(){return new sp({supportedTemplate:this.getSupportedTemplate()})}backupIfNeeded(){const{interval:t,lastTimestamp:e}=rp;if(t===Sl.NEVER)return;const r=(new Date).getTime();e+t>r||(xa().exportAsJSON(),rp.lastTimestamp=r)}toast(t){return this.app.toast(t)}inject(){Bi(gu("button.setting"),()=>{var t;(null==(t=this.app.shadowRoot)?void 0:t.querySelector(".modal"))||this.app.showSetting()},"s"),document.body.append(this.app)}}ic=(t=>(t[t.VALID=0]="VALID",t[t.INVALID=1]="INVALID",t[t.UNAVAILABLE=2]="UNAVAILABLE",t))(ic||{});class cp{constructor(){fc(this,"UNKNOWN_ARTIST","UnknownArtist"),fc(this,"UNKNOWN_CHARACTER","UnknownCharacter")}async*paginationGenerator(t,e,r,a){const[o=1,n=0]=t??[];let i=o,{lastPage:s,data:l}=await e(i);if(!l||!l.length)throw new Error(`There is no post in page ${i}.`);let c=l.length,d=null;do{let t,o=!0;if(i!==n&&!s)try{const{lastPage:r,data:a}=await e(i+1),n=(null==a?void 0:a.length)??0;n&&(c+=n,t=a,o=r)}catch(t){d=t}const u=[],p=[],h=[];if("function"==typeof a)for(const t of l){const e=await a(t),o=r(t);0===e?u.push(o):1===e?p.push(o):h.push(o)}else for(const t of l)u.push(r(t));yield{total:c,page:i,avaliable:u,invalid:p,unavaliable:h},i++,l=t,s=o}while(l);if(d)throw d}}class dp extends cp{parseArtworkSrc(t){return t.querySelector('meta[property="og:image"]').getAttribute("content")}parseArtworkNameBySrc(t){const e=new RegExp("(?<=\\/)\\w+\\.\\w+(?=\\?|$)").exec(t);if(!e)throw new Error("Can not parse image name from src.");return e[0].split(".")}parseTags(t){const e=[],r=[],a=[];return t.querySelectorAll('li[class*="tag-type"]').forEach(t=>{var o;const n=new RegExp("(?<=tag-type-)\\w+").exec(t.className);if(!n)throw new Error("Unknown tag: "+t.className);const i=n[0],s=((null==(o=t.querySelector('a[href*="page=post"]'))?void 0:o.textContent)||"").replaceAll(" ","_");"artist"===i?e.push(s):"character"===i&&r.push(s),a.push(i+":"+s)}),{artist:e,character:r,tags:a}}parseStatistics(t){var e,r,a,o,n,i;const s=t.querySelector('a[href*="page=account&s=profile"]'),l=null==(r=null==(e=null==s?void 0:s.parentElement)?void 0:e.firstChild)?void 0:r.nodeValue,c=l?l.split(": ")[1]:"";let d="";const u=null==(o=null==(a=null==s?void 0:s.parentElement)?void 0:a.nextElementSibling)?void 0:o.nextElementSibling;if(u&&/^source:/i.test(u.textContent??"")){const t=u.querySelector("a");d=t?t.href:(null==(n=u.textContent)?void 0:n.replace(/^source: ?/i,""))??""}const p=/Rating: ?(General|Explicit|Questionable|Safe|Sensitive)/.exec(t.documentElement.innerHTML)[1].toLowerCase(),h=null==(i=t.querySelector("span[id^=psc]"))?void 0:i.textContent;if(!h)throw new Error("Cannot parse score");return{postDate:c,score:+h,source:d,rating:p}}buildMeta(t,e){const r=this.parseArtworkSrc(e),[a,o]=this.parseArtworkNameBySrc(r),{artist:n,character:i,tags:s}=this.parseTags(e),{postDate:l,source:c,rating:d,score:u}=this.parseStatistics(e);return{id:t,src:r,extendName:o,artist:n.join(",")||this.UNKNOWN_ARTIST,character:i.join(",")||this.UNKNOWN_CHARACTER,title:a,tags:s,createDate:l,score:u,source:c,rating:d}}parseBlacklistTags(){const[t]=new RegExp("(?<=tag_blacklist=).*?(?=;|$)").exec(document.cookie)??[];return t?decodeURIComponent(decodeURIComponent(t)).split(" "):[]}parseFavoriteByDoc(t){const e=t.querySelectorAll("span + script");return Array.from(e).map(t=>{const e=t.textContent,[r]=new RegExp("(?<=posts\\[)[0-9]+?(?=\\])").exec(e),[a]=e.match(/{.+}/),{tags:o,rating:n,score:i,user:s}=JSON.parse(a.replace(".split(/ /g)","").replaceAll("'",'"'));return{id:r,tags:decodeURIComponent(o).split(/\s/g),rating:n.toLowerCase(),score:+i,user:s}})}parsePostsByDoc(t){const e=Array.from(t.querySelectorAll("span[id]:has(a > img), .thumbnail-preview > a[id]:has(img)")).map(t=>{const e=t.querySelector("img").title.trim().replaceAll(/ +/g," ").split(" "),r=t.id.slice(1),a=[];let o="",n=0,i="";for(let t=0;t<e.length;t++){const r=e[t];r.startsWith("rating:")?o=r.slice(7):r.startsWith("score:")?n=+r.slice(6):r.startsWith("user:")?i=r.slice(5):a.push(r)}return{id:r,tags:a,rating:o,score:+n,user:i}});return Ld.info(`Parse posts in ${t.URL}:`,e),e}}const up=function(){const t=new n;return{add(e,r,a){var o;null==(o=t.folder(e))||o.file(r,a)},bundle(e,r){const a=t.folder(e);if(!a)throw new TypeError("no such folder:"+e);return a.generateAsync({type:"blob",comment:r})},remove(e){t.remove(e)},fileCount(e){var r;let a=0;return null==(r=t.folder(e))||r.forEach(()=>a++),a},async unzip(e){const r=Math.random().toString(36);let a=t.folder(r);if(!a)throw TypeError("Can not get new root folder");const o=[];a=await a.loadAsync(e),a.forEach((t,e)=>{o.push(e.async("blob"))});const n=await Promise.all(o);return t.remove(r),n}}}();sc=(t=>(t.ID="id",t.ARTIST="artist",t.ARTISTID="artistID",t.CHARACTER="character",t.DATE="date",t.MD5="md5",t.SCORE="score",t.TAGS="tags",t.TITLE="title",t.PAGE="page",t))(sc||{});class pp{constructor(t){vc(this,Do),fc(this,"id"),fc(this,"src"),fc(this,"ext"),fc(this,"artist"),fc(this,"title"),fc(this,"tags"),fc(this,"createDate"),fc(this,"imageTimeout",6e4),fc(this,"videoTimeout"),fc(this,"taskId"),fc(this,"downloaded"),fc(this,"total"),fc(this,"onDownloadCompleted");const{id:e,src:r,extendName:a,artist:o,title:n,tags:i,createDate:s}=t;this.id=e,this.src=r,this.ext=a,this.artist=o,this.title=n,this.tags=i,this.createDate=s,this.total=Array.isArray(r)?r.length:1,this.downloaded=0}static get supportedTemplate(){throw new Error("Should be overwritten by a subclass")}normalizeString(t){return $r(function(t){if("string"!=typeof t)throw new TypeError("expect string but got "+typeof t);if(!t)return"";const e=document.createElement("p");return e.innerHTML=t,e.innerText}(t))}isStringArray(t){return Array.isArray(t)}isImageExt(t){return Lu.imageExt.test(t)}getTaskId(){return this.taskId??(this.taskId=this.id+"_"+Math.random().toString(36).slice(2))}getSrc(t=0){return Array.isArray(this.src)?this.src[t]:this.src}getExt(t=0){return Array.isArray(this.ext)?this.ext[t]:this.ext}getDownloadTimeout(t=0){return this.isImageExt(Array.isArray(this.ext)?this.ext[t]:this.ext)?this.imageTimeout:this.videoTimeout}getMultipleMediaDownloadCB(t){return this.onDownloadCompleted??(this.onDownloadCompleted=()=>{t(++this.downloaded/this.total*100)})}getPathTemplate(t,e){return t?`${t}/${e}`:e}getSavePath(t,e,r,a){return`${yc(this,Do,No).call(this,this.getPathTemplate(t,e),a)}.${r}`}}Do=new WeakSet,No=function(t,e){const r=new RegExp("{(artist|artistID|character|id|md5|page|score|tags|title)}","g"),a=t.replace(r,(t,r)=>{if(!(r in e))return t;const a=e[r];return a?this.normalizeString(a):t}),n=new RegExp("{(date)(\\((.+?)\\))?}","g");return a.replace(n,(t,r,a,n)=>{if(!e.date)return t;const i=n||"YYYY-MM-DD",s=e.date;return o(s).format(i)})};class hp extends pp{constructor(){super(...arguments),fc(this,"handleBeforeSaveCb"),fc(this,"handleErrorCb"),fc(this,"handleAbortCb"),fc(this,"filenames")}handleBundleFactory(t){return this.filenames??(this.filenames=t),this.handleBeforeSaveCb??(this.handleBeforeSaveCb=async(e,r,a)=>{null==a||a.throwIfAborted();const{taskId:o,src:n}=r,i=this.src.indexOf(n);if(-1===i)throw new Error("No src matches.");if(up.add(o,this.filenames[i],e),up.fileCount(o)!==t.length)return;const s=await up.bundle(o,this.getZipComment());return null==a||a.throwIfAborted(),up.remove(o),s})}handleBundleErrorFactory(){return this.handleErrorCb??(this.handleErrorCb=()=>{up.remove(this.getTaskId())})}handleBundleAbortFactory(){return this.handleAbortCb??(this.handleAbortCb=()=>{up.remove(this.getTaskId())})}}class gp extends pp{constructor(t){super(t),fc(this,"character"),fc(this,"score"),this.character=t.character,this.score=t.score}static get supportedTemplate(){return{id:"{id}",artist:"{artist}",character:"{character}",date:"{date}, {date(YYYY-MM-DD)}",md5:"{md5}",score:"{score}"}}getHeaders(t){return{cookie:`cf_clearance=${t}`}}getTemplateData(){return{id:this.id,artist:this.artist,character:this.character,date:this.createDate,md5:this.title,title:this.title,score:String(this.score)}}create(t){const{filenameTemplate:e,filenameConflictAction:r,directoryTemplate:a,useFileSystemAccessApi:o,setProgress:n,cfClearance:i}=t;return{headers:i?this.getHeaders(i):void 0,taskId:this.getTaskId(),src:this.getSrc(),path:this.getSavePath(a,e,this.getExt(),this.getTemplateData()),timeout:this.getDownloadTimeout(),onProgress:n,useFileSystemAccessApi:o,filenameConflictAction:r}}}class fp extends lp{constructor(){null===np.version&&(tp.addBookmark??(tp.addBookmark=!1)),super(),vc(this,Mo),fc(this,"searchParams",new URLSearchParams(location.search)),fc(this,"useBatchDownload",this.app.initBatchDownloader({avatar:this.getAvatar.bind(this),parseMetaByArtworkId:async t=>{const e=await this.api.getPostDoc(t);return this.parser.buildMeta(t,e)},downloadArtworkByMeta:async(t,e)=>{const r=new gp(t).create({...Zu,cfClearance:ip.cf_clearance||void 0});await Ku.download(r,{signal:e});const{id:a,tags:o,artist:n,title:i,source:s,rating:l}=t;zd.add({pid:Number(a),user:n,title:i,tags:o,source:s,rating:l})},filterOption:{filters:[{id:"exclude_downloaded",type:"exclude",name:()=>gu("downloader.category.filter.exclude_downloaded"),checked:!1,fn:t=>!!t.id&&zd.has(t.id)},{id:"allow_image",type:"include",name:()=>gu("downloader.category.filter.image"),checked:!0,fn:t=>!!t.tags&&!t.tags.includes("video")},{id:"allow_video",type:"include",name:()=>gu("downloader.category.filter.video"),checked:!0,fn:t=>!!t.tags&&t.tags.includes("video")}],enableTagFilter:!0},pageOption:{favorites:{name:"Favorites",match:/(?=.*page=favorites)(?=.*s=view)(?=.*id=[0-9]+)/,filterInGenerator:!0,fn:(t,e,r)=>(r??(r=new RegExp("(?<=id=)[0-9]+").exec(location.search)[0]),this.parser.paginationGenerator(t,async t=>{const e=50*(t-1),a=await this.api.getFavoriteDoc(r,e),o=this.parser.parseFavoriteByDoc(a);return{lastPage:o.length<50,data:o}},t=>t.id,yc(this,Mo,Oo).call(this,e)))},pools:{name:"Pools",match:/(?=.*page=pool)(?=.*s=show)(?=.*id=[0-9]+)/,filterInGenerator:!0,fn:(t,e,r)=>(r??(r=new RegExp("(?<=id=)[0-9]+").exec(location.search)[0]),this.parser.paginationGenerator([1,1],async()=>{const t=await this.api.getPoolDoc(r);return{lastPage:!0,data:this.parser.parsePostsByDoc(t)}},t=>t.id,yc(this,Mo,Oo).call(this,e)))},posts:{name:"Posts",match:/(?=.*page=post)(?=.*s=list)/,filterInGenerator:!0,fn:(t,e,r)=>(r??(r=new URLSearchParams(location.search).get("tags")??"all"),this.parser.paginationGenerator(t,async t=>{const e=42*(t-1),a=await this.api.getPostsDoc(e,r),o=this.parser.parsePostsByDoc(a);return{lastPage:o.length<42,data:o}},t=>t.id,yc(this,Mo,Oo).call(this,e)))}}}))}getSupportedTemplate(){return gp.supportedTemplate}getAvatar(){return"/favicon.ico"}async downloadArtwork(t){const e=t.dataset.id,r=await this.api.getPostDoc(e),a=this.parser.buildMeta(e,r),o=new gp(a).create({...Zu,cfClearance:ip.cf_clearance||void 0,setProgress:e=>{t.setProgress(e)}});tp.addBookmark&&yc(this,Mo,Lo).call(this,e),await Ku.download(o,{priority:1});const{tags:n,artist:i,title:s,source:l,rating:c}=a;zd.add({pid:Number(e),user:i,title:s,tags:n,source:l,rating:c})}setThumbnailStyle(t){t.style.position="relative"}createThumbnailBtn(){const t=document.querySelectorAll(this.getThumbnailSelector());t.length&&t.forEach(t=>{this.setThumbnailStyle(t);const e=new RegExp("(?<=&id=)\\d+").exec(t.href);if(!e)return;const r=e[0];t.appendChild(new Hd({id:r,onClick:this.downloadArtwork.bind(this)}))})}createArtworkBtn(t){const e=document.querySelector("div.flexi > div");e.style.position="relative",e.appendChild(new au({id:t,site:"gelbooru",onClick:this.downloadArtwork.bind(this)}))}isPostsList(){return"post"===this.searchParams.get("page")&&"list"===this.searchParams.get("s")}isPostView(){return"post"===this.searchParams.get("page")&&"view"===this.searchParams.get("s")}isPool(){return"pool"===this.searchParams.get("page")&&"show"===this.searchParams.get("s")}isMyfavorites(){return"favorites"===this.searchParams.get("page")&&"view"===this.searchParams.get("s")}isAccountProfile(){return"account"===this.searchParams.get("page")&&"profile"===this.searchParams.get("s")}inject(){if(super.inject(),0!==this.searchParams.size)if(this.isPostView()){if(!document.querySelector("#image, #gelcomVideoPlayer"))return;const t=this.searchParams.get("id");this.createArtworkBtn(t)}else this.createThumbnailBtn()}}Mo=new WeakSet,Oo=function(t){return async e=>{const{id:r,tags:a}=e;return await t({id:r,tags:a})?ic.VALID:ic.INVALID}},Lo=function(t){Ni.addFav(t)};class mp{constructor(t={rateLimit:4}){fc(this,"queue"),fc(this,"fetch");const{rateLimit:e}=t;this.queue=new Xu({interval:1e3,intervalCap:e}),this.fetch=(t,e)=>this.queue.add(()=>fetch(t,e),{throwOnTimeout:!0})}async getHtml(t){Ld.info("Fetch url:",t);const e=await this.fetch(t);if(!e.ok)throw new Iu(e.url,e.status);return await e.text()}async getDoc(t){const e=await this.getHtml(t);return(new DOMParser).parseFromString(e,"text/html")}async getJSON(t,e){Ld.info("Fetch url:",t);const r=await this.fetch(t,e);if(!r.ok)throw new Iu(r.url,r.status);return await r.json()}}class wp extends mp{async getPosts(t){let e="/index.php?page=dapi&s=post&q=index&json=1";Object.entries(t).forEach(([t,r])=>{"number"==typeof r?r=String(r):Array.isArray(r)&&(r=r.join("+")),e+=`&${t}=${r}`});const r=await this.fetch(e);if(!r.ok)throw new Iu(e,r.status);try{return await r.json()}catch(t){if(t instanceof SyntaxError)return[];throw t}}getPostDoc(t){return this.getDoc("index.php?page=post&s=view&id="+t)}getPostsDoc(t=0,e="all"){return Array.isArray(e)&&(e=e.join("+")),this.getDoc(`/index.php?page=post&s=list&tags=${e}&pid=${t}`)}getFavoriteDoc(t,e=0){return this.getDoc(`/index.php?page=favorites&s=view&id=${t}&pid=${e}`)}getPoolDoc(t){return this.getDoc(`/index.php?page=pool&s=show&id=${t}`)}}class vp extends dp{parseArtworkSrc(t){var e;return(null==(e=t.querySelector("#gelcomVideoPlayer > source"))?void 0:e.src)||t.querySelector('meta[property="og:image"]').getAttribute("content")}parseFavoriteByDoc(t){const e=t.querySelectorAll(".image-list > span + script");return Array.from(e).map(t=>{const e=t.textContent,[r]=new RegExp("(?<=posts\\[)[0-9]+?(?=\\])").exec(e),[a]=new RegExp("(?<=tags: [\"']).*?(?=[\"']\\.)").exec(e),[o]=new RegExp("(?<=rating: [\"']).*?(?=[\"'],)").exec(e),[n]=new RegExp("(?<=score: [\"'])[0-9]+(?=[\"'],)").exec(e),[i]=new RegExp("(?<=user: [\"']).*?(?=[\"']\\s+})").exec(e);return{id:r,tags:a.split(/\s/g),rating:o.toLowerCase(),score:+n,user:i}})}}class bp extends fp{constructor(){null===np.version&&(Zu.setDirectoryTemplate(eu.folderPattern??"rule34/{artist}"),Zu.setFilenameTemplate(eu.filenamePattern??"{id}_{artist}_{character}"),ip.cf_clearance??(ip.cf_clearance="")),np.setThemeWatcher({get current(){return!!document.head.querySelector('link[href*="dark.css"]')}}),super(),fc(this,"api",new wp),fc(this,"parser",new vp)}static get hostname(){return"rule34.xxx"}getAvatar(){return"/images/r34chibi.png"}getThumbnailSelector(){return".thumb > a:first-child:not(:has(.blacklist-img))"}setThumbnailStyle(t){t.setAttribute("style","position: relative; align-self: center; width: auto; height: auto;");const e=t.querySelector("img"),r=()=>{e.naturalHeight/e.naturalWidth>1&&(t.style.height="inherit")};r(),e.onload=r}createArtworkBtn(t){var e;let r=!1,a=document.querySelector("#gelcomVideoContainer");if(a)a.style.fontSize="0px";else{r=!0;const t=document.querySelector("#image");a=document.createElement("div"),null==(e=t.parentElement)||e.insertBefore(a,t),a.append(t)}a.style.position="relative",a.appendChild(new au({id:t,site:r?void 0:"fluid_video",onClick:this.downloadArtwork.bind(this)}))}}class yp extends cp{constructor(){super(...arguments),vc(this,jo)}getBlacklistValidationTags(t){const{tag_string:e,rating:r,uploader_id:a,is_deleted:o,is_flagged:n,is_pending:i}=t,s=e.match(/\S+/g)??[];return s.push("rating:"+r),s.push("uploaderid:"+a),o&&s.push("status:deleted"),n&&s.push("status:flagged"),i&&s.push("status:pending"),s}parseCsrfToken(){var t;return(null==(t=document.head.querySelector('meta[name="csrf-token"]'))?void 0:t.content)||null}getBlacklistByHtml(){var t;return(null==(t=document.querySelector('meta[name="blacklisted-tags"]'))?void 0:t.content)??""}getBlacklistItem(t,e="api"){let r;return r="html"===e?/,/:/\n+/,t.replace(/(rating:\w)\w+/gi,"$1").toLowerCase().split(r).filter(t=>""!==t.trim()).map(yc(this,jo,Ro))}isBlacklisted(t,e){const r=/score:(-?[0-9]+)/,a=(t.find(t=>r.test(t))??"").match(r),o=a?+a[1]:a;return e.some(e=>{const{require:r,exclude:a,optional:n,min_score:i}=e,s=e=>t.includes(e),l=null===i||null===o||o<i;return r.every(s)&&l&&(!n.length||function(t,e){const r=new Set(t),a=[];return e.forEach(t=>{r.has(t)&&a.push(t)}),a}(t,n).length)&&!a.some(s)})}buildMetaByDoc(t){var e,r;const a=null==(e=t.querySelector("a[download]"))?void 0:e.href;if(!a)throw new Error("Can not get media src");const o=t.querySelector('meta[property="og:image"]').getAttribute("content"),n=o.slice(o.lastIndexOf("/")+1).split(".")[0],i=(t.querySelector('meta[property="og:video:type"]')||t.querySelector('meta[property="og:image:type"]')).getAttribute("content"),s=i.slice(i.lastIndexOf("/")+1),l=[],c=[],d=[],u=t.querySelectorAll('section#tag-list  ul[class*="-tag-list"]');u.length&&u.forEach(t=>{const e=/[a-zA-Z]+(?=-tag-list)/.exec(t.className);if(!e)throw new Error("Unknown tag: "+t.className);const r=e[0],a=t.children;let o;"artist"===r?o=l:"character"===r&&(o=c);for(let t=0;t<a.length;t++){const e=a[t].getAttribute("data-tag-name");e&&(o&&o.push(e),d.push(r+":"+e))}});const p=(null==(r=t.querySelector("time"))?void 0:r.getAttribute("datetime"))??"";let h="";const g=t.querySelector("#original-artist-commentary");g&&(h=Dr(g));const f=t.querySelector("section.image-container"),{score:m="0",source:w="",rating:v="",id:b}=f.dataset;if(!b)throw new Error("Can not parse post id.");return{id:b,src:a,extendName:s,artist:l.join(",")||this.UNKNOWN_ARTIST,character:c.join(",")||this.UNKNOWN_CHARACTER,title:n,comment:h,tags:d,createDate:p,score:+m,source:w,rating:v}}buildMetaByApi(t,e){const{id:r,created_at:a,file_ext:o,file_url:n,md5:i,tag_string_artist:s,tag_string_character:l,tag_string_copyright:c,tag_string_general:d,tag_string_meta:u,score:p,source:h,rating:g}=t,{original_title:f="",original_description:m=""}=e??{},w=(t,e)=>e.split(" ").map(e=>t+":"+e),v=[...w("artist",s),...w("character",l),...w("copyright",c),...w("general",d),...w("meta",u)],b=f&&m?f+"\n"+m:f||m;return{id:String(r),src:n??"",extendName:o,artist:s.replaceAll(" ",",")||this.UNKNOWN_ARTIST,character:l.replaceAll(" ",",")||this.UNKNOWN_CHARACTER,title:i,comment:b,tags:v,createDate:a,rating:g??"",score:p,source:h}}}jo=new WeakSet,Ro=function(t){const e=t.split(" "),r=[],a=[],o=[];let n=null;return e.forEach(t=>{if("-"===t.charAt(0))a.push(t.slice(1));else if("~"===t.charAt(0))o.push(t.slice(1));else if(t.match(/^score:<.+/)){const e=t.match(/^score:<(.+)/)[1];n=Number.parseInt(e)}else r.push(t)}),{tags:t,require:r,exclude:a,optional:o,min_score:n}};class xp extends Hd{constructor(t){super({...t,shouldObserveDb:!1}),fc(this,"downloadingStore");const{downloading:e}=t;this.downloadingStore=Ir(()=>e.current)}static get tagNameLowerCase(){return"pdl-danbooru-pool-button"}connectedCallback(){super.connectedCallback(),this.unsubscriber=this.downloadingStore.subscribe(t=>{t?this.setAttribute("disabled",""):this.removeAttribute("disabled")})}}customElements.define(xp.tagNameLowerCase,xp);class kp extends mp{async getJSON(t,e){Ld.info("Fetch url:",t);const r=await this.fetch(t,e);if(r.status>=500)throw new Iu(r.url,r.status);const a=await r.json();if("success"in a&&!a.success){const{error:t,message:e}=a;throw new $u(t+", "+e)}return a}getPool(t){return this.getJSON(`/pools/${t}.json`)}getPost(t){return this.getJSON(`/posts/${t}.json`)}getPostDoc(t){return this.getDoc("/posts/"+t)}getPostList(t){const{tags:e=[],limit:r=0,page:a=0}=t??{},o=new URLSearchParams;return(null==e?void 0:e.length)&&o.append("tags",e.join(" ")),r&&o.append("limit",String(r)),a&&o.append("page",String(a)),this.getJSON(`/posts.json?${o.toString()}`)}getArtistCommentary(t){return this.getJSON(`/posts/${t}/artist_commentary.json`)}getFavoriteGroups(t){return this.getJSON(`/favorite_groups/${t}.json`)}getProfile(){return this.getJSON("/profile.json")}async addFavorite(t,e){const r=await this.fetch(`/favorites?post_id=${t}`,{method:"POST",headers:{"X-Csrf-Token":e}});if(!r.ok)throw new Iu(r.url,r.status);return await r.text()}}class _p extends lp{constructor(){null===np.version&&(tp.addBookmark??(tp.addBookmark=!1));const t=document.body.getAttribute("data-current-user-theme");"auto"!==t&&np.setThemeWatcher({get current(){return"dark"===t}}),super(),vc(this,Fo),fc(this,"profile",null),fc(this,"blacklist",null),fc(this,"useBatchDownload",this.app.initBatchDownloader({avatar:()=>this.getAvatar(),beforeDownload:async()=>{this.profile=await this.api.getProfile();const t=this.profile.blacklisted_tags;this.blacklist=t?this.parser.getBlacklistItem(t):null},afterDownload:()=>{this.profile=null,this.blacklist=null},parseMetaByArtworkId:async t=>this.getMetaByPostId(t),downloadArtworkByMeta:async(t,e)=>{const r=new gp(t).create({...Zu});await Ku.download(r,{signal:e});const{id:a,tags:o,artist:n,title:i,comment:s,source:l,rating:c}=t;zd.add({pid:Number(a),user:n,title:i,comment:s,tags:o,source:l,rating:c})},filterOption:{filters:[{id:"exclude_downloaded",type:"exclude",name:()=>gu("downloader.category.filter.exclude_downloaded"),checked:!1,fn:t=>!!t.id&&zd.has(t.id)},{id:"exclude_blacklist",type:"exclude",name:()=>gu("downloader.category.filter.exclude_blacklist"),checked:!0,fn:async t=>!!t.blacklistValidationTags&&this.parser.isBlacklisted(t.blacklistValidationTags,this.blacklist)},{id:"allow_image",type:"include",name:()=>gu("downloader.category.filter.image"),checked:!0,fn:t=>!!t.extendName&&/bmp|jp(e)?g|png|tif|gif|exif|svg|webp/i.test(t.extendName)},{id:"allow_video",type:"include",name:()=>gu("downloader.category.filter.video"),checked:!0,fn:t=>!!t.extendName&&/mp4|avi|mov|mkv|flv|wmv|webm|mpeg|mpg|m4v/i.test(t.extendName)}],enableTagFilter:!0},pageOption:{pool:{name:"Pool",match:new RegExp("(?<=\\/pools\\/)[0-9]+"),filterInGenerator:!0,fn:(t,e)=>{var r;const a=null==(r=new RegExp("(?<=\\/pools\\/)[0-9]+").exec(location.pathname))?void 0:r[0];if(!a)throw new Error("Invalid pool id");const o=this.profile.per_page;return this.parser.paginationGenerator(t,async t=>{const e=await this.api.getPostList({tags:[`ordpool:${a}`],limit:o,page:t});return{lastPage:e.length<o,data:e}},t=>String(t.id),yc(this,Fo,zo).call(this,e))}},favorite_groups:{name:"FavoriteGroups",match:new RegExp("(?<=\\/favorite_groups\\/)[0-9]+"),filterInGenerator:!0,fn:(t,e)=>{var r;const a=null==(r=new RegExp("(?<=\\/favorite_groups\\/)[0-9]+").exec(location.pathname))?void 0:r[0];if(!a)throw new Error("Invalid pool id");const o=this.profile.per_page;return this.parser.paginationGenerator(t,async t=>{const e=await this.api.getPostList({tags:[`ordfavgroup:${a}`],limit:o,page:t});return{lastPage:e.length<o,data:e}},t=>String(t.id),yc(this,Fo,zo).call(this,e))}},post_list:{name:"Post",match:()=>"/"===location.pathname||"/posts"===location.pathname,filterInGenerator:!0,fn:(t,e)=>{var r;const a=this.profile.per_page,o=new URLSearchParams(location.search),n=(null==(r=o.get("tags"))?void 0:r.split(" "))??[],i=o.get("limit"),s=i?Number(i):a,l=(null==n?void 0:n.includes("status:deleted"))||this.profile.show_deleted_posts;return this.parser.paginationGenerator(t,async t=>{const e=await this.api.getPostList({tags:n,limit:s,page:t});return{lastPage:e.length<s,data:e}},t=>String(t.id),yc(this,Fo,zo).call(this,e,l))}},pool_gallery_button:{name:"pool_gallery_button",match:()=>!1,filterInGenerator:!0,fn:(t,e,r)=>{if(!r)throw new Error("Invalid pool id");const a=this.profile.per_page;return this.parser.paginationGenerator(t,async t=>{const e=await this.api.getPostList({tags:[`ordpool:${r}`],limit:a,page:t});return{lastPage:e.length<a,data:e}},t=>String(t.id),yc(this,Fo,zo).call(this,e))}},show_downloader_in_pool_gallery:{name:"pool_gallery",match:/\/pools\/gallery/}}}))}getSupportedTemplate(){return gp.supportedTemplate}async getPostAndComment(t){const[e,r]=await Promise.allSettled([this.api.getPost(t),this.api.getArtistCommentary(t)]);if("rejected"===e.status)throw e.reason;let a;if("rejected"===r.status){if(!(r.reason instanceof $u))throw r.reason}else a=r.value;return{post:e.value,comment:a}}async getMetaByPostId(t){const{post:e,comment:r}=await this.getPostAndComment(t);return this.parser.buildMetaByApi(e,r)}async addBookmark(t){try{const e=this.parser.parseCsrfToken();if(!e)throw new Error("Can not get csrf-token");const r=await this.api.addFavorite(t,e),a=new RegExp("(?<=^\\/posts\\/)\\d+").exec(location.pathname);a&&t===a[0]&&function(t){const e=document.createElement("script");e.text=t,document.head.appendChild(e).parentNode.removeChild(e)}(r),this.toast({message:"You have favorited this post",timeout:2e3})}catch(t){Ld.error(t),this.toast({message:t.message,type:"error"})}}async downloadArtwork(t){const e=t.dataset.id,r=await this.getMetaByPostId(e),a=new gp(r).create({...Zu,setProgress:e=>{t.setProgress(e)}});tp.addBookmark&&this.addBookmark(e),await Ku.download(a,{priority:1});const{tags:o,artist:n,title:i,comment:s,source:l,rating:c}=r;zd.add({pid:Number(e),user:n,title:i,comment:s,tags:o,source:l,rating:c})}createThumbnailBtn(){const t=document.querySelectorAll("article a.post-preview-link");t.length&&t.forEach(t=>{var e;const r=null==(e=new RegExp("(?<=\\/posts\\/)\\d+").exec(t.href))?void 0:e[0];if(!r)return;const a=new Hd({id:r,onClick:this.downloadArtwork});t.appendChild(a)})}createArtworkBtn(){const t=document.querySelector("section.image-container:has(:is(picture, video))");if(!t)return;const e=t.getAttribute("data-id");t.appendChild(new au({id:e,site:t.querySelector("video")?"native_video":void 0,onClick:this.downloadArtwork}))}createPoolThumbnailBtn(){const t=document.querySelectorAll("article a.post-preview-link");if(!t.length)return;const{downloading:e,batchDownload:r}=this.useBatchDownload(),a=t=>{const e=t.dataset.id;return r("pool_gallery_button",e)};t.forEach(t=>{var r;const o=null==(r=new RegExp("(?<=\\/pools\\/)\\d+").exec(t.href))?void 0:r[0];if(!o)return;const n=new xp({id:o,downloading:e,onClick:a});t.appendChild(n)})}inject(){super.inject(),this.downloadArtwork=this.downloadArtwork.bind(this);const t=location.pathname;/^\/posts\/\d+/.test(t)?(this.createArtworkBtn(),this.createThumbnailBtn()):/^\/pools\/gallery/.test(t)?this.createPoolThumbnailBtn():this.createThumbnailBtn()}}Fo=new WeakSet,zo=function(t,e=!0){return async r=>{const{id:a,is_deleted:o,file_ext:n,file_url:i,tag_string:s}=r;if(!i)return ic.UNAVAILABLE;if(o&&!e)return ic.INVALID;const l=this.parser.getBlacklistValidationTags(r);return await t({id:String(a),extendName:n,tags:s.split(" "),blacklistValidationTags:l})?ic.VALID:ic.INVALID}};class Ap extends _p{constructor(){null===np.version&&(Zu.setDirectoryTemplate(eu.folderPattern??"danbooru/{artist}"),Zu.setFilenameTemplate(eu.filenamePattern??"{id}_{artist}_{character}")),super(),fc(this,"api",new kp),fc(this,"parser",new yp)}static get hostname(){return"danbooru.donmai.us"}getAvatar(){return"/packs/static/danbooru-logo-128x128-ea111b6658173e847734.png"}}lc=(t=>(t[t.illusts=0]="illusts",t[t.manga=1]="manga",t[t.ugoira=2]="ugoira",t))(lc||{}),cc=(t=>(t[t.public=0]="public",t[t.private=1]="private",t))(cc||{});const Ep=new class extends mp{async getJSON(t,e){const r=await super.getJSON(t,e);if(r.error)throw new $u(r.message);return r.body}async getArtworkHtml(t,e){const r=await this.fetch(`/artworks/${t}?lang=${e}`);if(!r.ok)throw new Iu(r.url,r.status);return await r.text()}getArtworkDoc(t,e){return this.getDoc(`/artworks/${t}?lang=${e}`)}getArtworkDetail(t,e){return this.getJSON(`/ajax/illust/${t}?lang=${e}`)}getUnlistedArtworkDetail(t,e){return this.getJSON(`/ajax/illust/unlisted/${t}?lang=${e}`)}addBookmark(t,e,r=[],a=cc.public){return this.getJSON("/ajax/illusts/bookmarks/add",{method:"POST",headers:{accept:"application/json","content-type":"application/json; charset=utf-8","x-csrf-token":e},body:JSON.stringify({illust_id:t,restrict:a,comment:"",tags:r})})}likeIllust(t,e){return this.getJSON("/ajax/illusts/like",{method:"POST",headers:{accept:"application/json","content-type":"application/json; charset=utf-8","x-csrf-token":e},body:JSON.stringify({illust_id:t})})}getFollowLatestWorks(t,e="all"){return this.getJSON(`/ajax/follow_latest/illust?p=${t}&mode=${e}&lang=jp`)}getUserAllProfile(t){return this.getJSON("/ajax/user/"+t+"/profile/all")}getUgoiraMeta(t){return this.getJSON("/ajax/illust/"+t+"/ugoira_meta")}getUserData(t){return this.getJSON("/ajax/user/"+t)}getSeriesData(t,e){return this.getJSON(`/ajax/series/${t}?p=${e}`)}},Sp={async parse(t,e){let r,a;const{tagLang:o,type:n}=e;if("api"===n)r=await Ep.getArtworkDetail(t,o),a="";else if("unlisted"===n)r=await Ep.getUnlistedArtworkDetail(t,o),a="";else{const e=await Ep.getArtworkDoc(t,o),n=e.querySelector('meta[name="preload-data"]'),i=e.querySelector('meta[name="global-data"]');if(n&&i)r=JSON.parse(n.content).illust[t],a=JSON.parse(i.content).token;else{const n=e.querySelector("script#__NEXT_DATA__");if(!n)throw new Error("Cannot get csrf token.");const i=JSON.parse(n.textContent);a=JSON.parse(i.props.pageProps.serverSerializedPreloadedState).api.token,r=await Ep.getArtworkDetail(t,o)}}const{id:i,illustType:s,userName:l,userId:c,illustTitle:d,illustComment:u,tags:p,pageCount:h,createDate:g,urls:f,bookmarkData:m,likeData:w,bookmarkCount:v}=r,b=[],y=[];p.tags.forEach(t=>{var e;b.push(t.tag),y.push((null==(e=t.translation)?void 0:e.en)||t.tag)});const x=u.replaceAll(/&lt;|&amp;lt;/g,"<").replaceAll(/&gt;|&amp;gt;/g,">"),k=document.createElement("p");k.innerHTML=x;const _=Dr(k),A={id:i,src:f.original,extendName:f.original.slice(-3),artist:l,title:d,tags:b,tagsTranslated:y,userId:c,comment:_,bookmarkData:m,createDate:g,likeData:w,token:a,bookmarkCount:v};if(s===lc.ugoira){const e=await Ep.getUgoiraMeta(t),r=e.frames.length,a=Array.from({length:r},(t,e)=>A.src.replace("ugoira0","ugoira"+e)),o=Array.from({length:r}).fill(A.extendName);return{...A,src:a,extendName:o,illustType:s,ugoiraMeta:e}}if(h>1){const t=Array.from({length:h},(t,e)=>A.src.replace("_p0","_p"+e)),e=Array.from({length:h}).fill(A.extendName);return{...A,src:t,extendName:e,illustType:s}}return{...A,illustType:s}},async*illustMangaGenerator(t,e,r){const a=await Ep.getUserAllProfile(r);let o,n,i=[];if("object"==typeof a.illusts&&i.push(...Object.keys(a.illusts)),"object"==typeof a.manga&&i.push(...Object.keys(a.manga)),!i.length)throw new Error(`User ${r} has no illusts or mangas.`);i=i.sort((t,e)=>Number(e)-Number(t));const[s=null,l=null]=t??[];let c=s??1;o=null===s?0:48*(s-1),n=null===l?i.length:48*l;const d=i.slice(o,n);if(!d.length)throw new RangeError(`Page ${c} exceeds the limit.`);const u=`https://www.pixiv.net/ajax/user/${r}/profile/illusts?`,p=d.length;do{const t=d.splice(0,48).map(t=>"ids[]="+t).join("&")+"&work_category=illustManga&is_first_page=0&lang=ja",r=await Ep.getJSON(u+t),a=Object.values(r.works).sort((t,e)=>Number(e.id)-Number(t.id)),o=[],n=[],i=[];for(let t=0;t<a.length;t++){const r=a[t],{id:s,isMasked:l}=r;l?i.push(String(s)):await e(r)?o.push(s):n.push(s)}yield{total:p,page:c,avaliable:o,invalid:n,unavaliable:i},c++}while(d.length>0)},async*chunkGenerator(t,e,r,a,o,n="show"){const[i=null,s=null]=t??[];if(!r)throw new Error('Require argument "userId".');let l,c,d,u=i??1;l=null===i?0:48*(i-1);do{let t;t="bookmarks"===a?`/ajax/user/${r}/illusts/bookmarks?tag=${o}&offset=${l}&limit=48&rest=${n}&lang=ja`:`/ajax/user/${r}/${a}/tag?tag=${o}&offset=${l}&limit=48&lang=ja`;const i=await Ep.getJSON(t),{works:p,total:h}=i;if(0===h)throw new Error(`User ${r} has no ${a} tagged with ${o}.`);if(!c){if(c=null===s||48*s>h?h:48*s,c<=l)throw new RangeError(`Page ${u} exceeds the limit.`);d=c-l}const g=[],f=[],m=[];for(let t=0;t<p.length;t++){const r=p[t],{id:a,isMasked:o}=r;o?m.push(String(a)):await e(r)?g.push(a):f.push(a)}yield{total:d,page:u,avaliable:g,invalid:f,unavaliable:m},u++}while((l+=48)<c)},async*bookmarkGenerator(t,e,r,a="show",o=""){yield*this.chunkGenerator(t,e,r,"bookmarks",o,a)},async*taggedArtworkGenerator(t,e,r,a,o,n="show"){"bookmarks"===a?yield*this.bookmarkGenerator(t,e,r,n,o):yield*this.chunkGenerator(t,e,r,a,o)},async*followLatestGenerator(t,e,r="all"){function a(t){return Math.min(...t)}async function*o(t,r){const a=[],o=[],n=[],{illust:s}=t.thumbnails;for(let t=0;t<s.length;t++){const r=s[t],{id:i,isMasked:l}=r;l?n.push(String(i)):await e(r)?a.push(i):o.push(i)}const{ids:l}=t.page;if(l.length!==s.length){const t=l.filter(t=>!s.some(e=>+e.id===t));n.push(...t.map(t=>String(t)))}yield{total:i,page:r,avaliable:a,invalid:o,unavaliable:n}}let n,i,s,[l=null,c=null]=t??[];if(null===l&&(l=1),(null===c||c>34)&&(c=34),l>34)throw new RangeError(`Page ${l} exceeds the limit.`);let d=l;const u=await Ep.getFollowLatestWorks(d,r),p=u.page.ids;if(i=p.length,n=a(p),c!==l){if(60===i){const t=await Ep.getFollowLatestWorks(++d,r),e=t.page.ids,o=a(e);o<n&&(n=o,s=t,i+=e.length)}if(yield*o(u,l),60!==i)if(i<120||c-l===1)yield*o(s,d);else{for(;++d<=c;){const t=await Ep.getFollowLatestWorks(d,r),e=t.page.ids,l=a(e);if(l>=n){Ld.info("getFollowLatestGenerator: got duplicate works"),yield*o(s,d-1);break}n=l,i+=e.length,yield*o(s,d-1),s=t}yield*o(s,d-1)}}else yield*o(u,l)},async*seriesGenerator(t,e,r){const[a=1,o=0]=t??[];let n=0,i=0,s=a;do{const t=await Ep.getSeriesData(r,s),{series:l}=t.page;if(!l.length)throw new Error(`Invalid page: ${s}`);const{illust:c}=t.thumbnails;if(!i){const e=l.some(({order:t})=>1===t),r=t.page.total;if(e)i=l.length;else if(0===o)i=r;else{const t=l.length,e=Math.ceil(r/t);i=o>=e?(e-a)*t+(r%t||t):(o-a+1)*t}}const d=[],u=[],p=[];for(let t=0;t<l.length;t++){const{workId:r}=l[t],a=c.find(t=>t.id===r);a&&!a.isMasked?await e(a)?d.push(r):u.push(r):p.push(r)}yield{total:i,page:s,avaliable:d,invalid:u,unavaliable:p},n+=l.length,s++}while(n<i)}};let Cp,Pp;class Ip extends HTMLElement{constructor(t){super(),fc(this,"props"),this.props=t}static get tagNameLowerCase(){return"pdl-unlisted-artwork-toolbar"}render(){if(this.shadowRoot)return;const t=this.attachShadow({mode:"open"});t.innerHTML='<style>.button-wrapper{display:flex;justify-content:flex-end;align-items:center;height:32px;padding:8px 12px}</style><div class="button-wrapper"></div>';const e=new Hd({...this.props,type:Ai.PixivToolbar});t.querySelector(".button-wrapper").appendChild(e)}connectedCallback(){this.render()}}customElements.define(Ip.tagNameLowerCase,Ip);class Tp extends HTMLElement{constructor(t,e,r){super(),fc(this,"btn"),fc(this,"downloadingStore"),fc(this,"unsubscriber"),this.tagUrl=t,this.handleDownload=r,this.downloadingStore=Ir(()=>e.current),this.dispatchDownload=this.dispatchDownload.bind(this)}static get tagNameLowerCase(){return"pdl-tag-list-button"}async render(){if(this.shadowRoot)return;const t=this.attachShadow({mode:"open"});Br(t),t.innerHTML=` \n  <div class=" flex items-center">    \n    <hr class="!border-t-0 border-l h-6 ml-4 mr-2" />\n    <button class=" h-[38px] w-[38px] btn-icon [&:not([disabled])]:hover:bg-slate-400/30 disabled:cursor-wait disabled:opacity-70">\n      <i class="text-sm w-6 fill-current mx-2">\n      ${vu}\n      </i>\n    </button>\n  </div>\n  `}getTagProps(){const t=new URL(this.tagUrl),{searchParams:e,pathname:r}=t,a=Lu.userPageTags.exec(r);if(!a)throw new Error(`Could not extract tag props from: ${r}`);const[,o,n,i]=a;if(!i)throw new Error(`Could not extract tag from: ${r}`);let s;return s="illustrations"===n||"artworks"===n?"illusts":n,{userId:o,category:s,tag:i,rest:"hide"===e.get("rest")?"hide":"show"}}dispatchDownload(t){null==t||t.preventDefault(),this.handleDownload(this.getTagProps()).catch(Ld.error)}connectedCallback(){this.render(),this.btn??(this.btn=this.shadowRoot.querySelector("button")),this.btn.addEventListener("click",this.dispatchDownload),this.unsubscriber=this.downloadingStore.subscribe(t=>{t?this.setAttribute("disabled",""):this.removeAttribute("disabled")})}disconnectedCallback(){var t,e;null==(t=this.unsubscriber)||t.call(this),null==(e=this.btn)||e.removeEventListener("click",this.dispatchDownload)}static get observedAttributes(){return["disabled"]}attributeChangedCallback(t,e,r){var a,o;"string"==typeof r?null==(a=this.btn)||a.setAttribute("disabled",""):null==(o=this.btn)||o.removeAttribute("disabled")}}customElements.define(Tp.tagNameLowerCase,Tp);class $p extends HTMLElement{constructor(t,e,r){super(),fc(this,"btn"),fc(this,"ob"),fc(this,"downloadingStore"),fc(this,"unsubscriber"),this.tagElement=t,this.handleDownload=r,this.downloadingStore=Ir(()=>e.current),this.dispatchDownload=this.dispatchDownload.bind(this),this.ob=new MutationObserver(()=>{this.changeBtnColor()})}static get tagNameLowerCase(){return"pdl-artwork-tag"}resetTagStyle(){this.tagElement.style.borderTopRightRadius="0px",this.tagElement.style.borderBottomRightRadius="0px"}changeBtnColor(){if(!this.btn)return;const{color:t,backgroundColor:e}=getComputedStyle(this.tagElement);this.btn.style.color=t,this.btn.style.backgroundColor=e}async render(){if(this.shadowRoot)return;const t=this.attachShadow({mode:"open"});Br(t),t.innerHTML=`  <button class="flex h-full items-center pr-2 rounded-e-[4px] disabled:cursor-wait disabled:opacity-70">\n    <hr class="!border-t-0 border-l h-6 pr-2" />\n    <i class="text-sm w-6 fill-current">\n      ${vu}\n    </i>\n  </button>`,this.resetTagStyle()}getTagProps(){const t=this.tagElement.querySelectorAll("div[title]"),e=t[t.length-1].getAttribute("title"),r=e.startsWith("#")?e.slice(1):"未分類",a=new URL(this.tagElement.href),{searchParams:o,pathname:n}=a,i=Lu.userPageTags.exec(n);if(!i)throw new Error(`Could not extract tag props from: ${n}`);const[,s,l]=i;let c;return c="illustrations"===l||"artworks"===l?"illusts":l,{userId:s,category:c,tag:r,rest:"hide"===o.get("rest")?"hide":"show"}}dispatchDownload(){this.handleDownload(this.getTagProps()).catch(Ld.error)}connectedCallback(){this.render(),this.btn??(this.btn=this.shadowRoot.querySelector("button")),this.changeBtnColor(),this.btn.addEventListener("click",this.dispatchDownload),this.unsubscriber=this.downloadingStore.subscribe(t=>{t?this.setAttribute("disabled",""):this.removeAttribute("disabled")}),this.ob.observe(this.tagElement,{attributes:!0,attributeFilter:["class"]})}disconnectedCallback(){var t,e;null==(t=this.unsubscriber)||t.call(this),null==(e=this.btn)||e.removeEventListener("click",this.dispatchDownload),this.ob.disconnect()}static get observedAttributes(){return["disabled"]}attributeChangedCallback(t,e,r){var a,o;"string"==typeof r?null==(a=this.btn)||a.setAttribute("disabled",""):null==(o=this.btn)||o.removeAttribute("disabled")}}customElements.define($p.tagNameLowerCase,$p),qo=new WeakMap,Ho=new WeakMap,Wo=new WeakSet,Uo=async function(t){const{id:e,qualityOption:r,frames:a,delays:o,signal:n,onProgress:i}=t;Ld.info("Start convert:",e);const s=Zd.getAdapter(r),l=performance.now(),c=await s(a,o,n,i),d=performance.now();return Ld.info(`Convert finished: ${e} ${d-l}ms.`),c};const Bp=new class{constructor(){vc(this,Wo),vc(this,qo,{}),vc(this,Ho,new Xu({concurrency:2}))}addFrame(t){var e;const{id:r,frame:a,delay:o,order:n}=t;(e=wc(this,qo))[r]??(e[r]={ugoiraFrames:[],delays:[]});const{ugoiraFrames:i,delays:s}=wc(this,qo)[r];if(void 0===n){const t=frames.length;i[t]=a,s[t]=o}else i[n]=a,s[n]=o}clearFrames(t){t in wc(this,qo)&&delete wc(this,qo)[t]}framesCount(t){return t in wc(this,qo)?wc(this,qo)[t].ugoiraFrames.filter(Boolean).length:0}async convert(t){const{id:e,signal:r,onProgress:a}=t;null==r||r.throwIfAborted();const o=await wc(this,Ho).add(({signal:r})=>{if(null==r||r.throwIfAborted(),!(e in wc(this,qo)))throw new Error("No frame data matched with taskId: "+e);const{ugoiraFrames:o,delays:n}=wc(this,qo)[e];if(!o.length||!n.length)throw new Error("No frame data found in taskId: "+e);return this.clearFrames(e),null==a||a(0),yc(this,Wo,Uo).call(this,{...t,frames:o,delays:n})},{signal:r});if(!o)throw new Error(`Task ${e} has no result returned.`);return o}async appendPixivEffect(t){const{id:e,signal:r,illust:a,seasonalEffect:o,onProgress:n}=t;null==r||r.throwIfAborted();const i=await wc(this,Ho).add(async({signal:r})=>{null==r||r.throwIfAborted(),Ld.info("Append Effect:",e),null==n||n(0);const i=Zd.getMixEffectFn(),s=performance.now(),{frames:l,delays:c}=await i(a,o,r),d=performance.now();return Ld.info(`Effect appended: ${e} ${d-s}ms.`),yc(this,Wo,Uo).call(this,{...t,frames:l,delays:c,signal:r})},{signal:r});if(!i)throw new Error(`Task ${e} has no result returned.`);return i}};class Dp extends hp{constructor(t){super(t),fc(this,"ugoiraMeta"),fc(this,"illustType"),fc(this,"userId"),fc(this,"comment"),fc(this,"translatedTags"),fc(this,"bookmarkCount"),this.ugoiraMeta="ugoiraMeta"in t?t.ugoiraMeta:void 0,this.illustType=t.illustType,this.userId=t.userId,this.comment=t.comment,this.translatedTags=t.tagsTranslated,this.bookmarkCount=t.bookmarkCount}static get supportedTemplate(){return{[sc.ID]:"{id}",[sc.ARTIST]:"{artist}",[sc.ARTISTID]:"{artistID}",[sc.DATE]:"{date} {date(YYYY-MM-DD)}",[sc.PAGE]:"{page}",[sc.SCORE]:"{score}: bookmarkCount",[sc.TAGS]:"{tags}",[sc.TITLE]:"{title}"}}getHeaders(){return{referer:"https://www.pixiv.net"}}getZipComment(){if(!this.ugoiraMeta)return this.comment;const t=this.ugoiraMeta.frames.map(({delay:t})=>t);return this.comment+"\n"+JSON.stringify(t)}getTemplateData(t){return{id:this.id,artist:this.normalizeString(this.artist)||this.userId,artistID:this.userId,date:this.createDate,score:String(this.bookmarkCount),title:this.normalizeString(this.title)||this.id,tags:this.tags.join("_"),...t}}handleConvertFactory(t,e){return this.handleBeforeSaveCb??(this.handleBeforeSaveCb=async(r,a,o)=>{null==o||o.throwIfAborted();const{taskId:n,src:i}=a,s=this.src.indexOf(i);if(-1===s)throw new Error("No src matches.");if(this.ugoiraMeta&&(this.handleAbortCb??(this.handleAbortCb=()=>{Bp.clearFrames(n)}),null==o||o.addEventListener("abort",this.handleAbortCb,{once:!0}),Bp.addFrame({id:n,frame:r,delay:this.ugoiraMeta.frames[s].delay,order:s}),Bp.framesCount(n)===this.ugoiraMeta.frames.length))return await Bp.convert({id:n,qualityOption:t,onProgress:e,signal:o})})}handleSeasonalEffectFactory(t,e){return this.handleBeforeSaveCb??(this.handleBeforeSaveCb=async(r,a,o)=>{null==o||o.throwIfAborted();const n="pixivGlow2024",{taskId:i}=a,s=await zd.getImageEffect(n);if(s&&!("width"in s)){const{data:a}=s;return await Bp.appendPixivEffect({id:i,qualityOption:t,illust:r,seasonalEffect:a,onProgress:e,signal:o})}{const a=await new Promise((t,e)=>{Di({url:"https://source.pixiv.net/special/seasonal-effect-tag/pixiv-glow-2024/effect.png",headers:{referer:"https://www.pixiv.net"},responseType:"blob",onload(e){t(e.response)},onerror:e,ontimeout:()=>e(new Error("Timeout"))})}),s=await Bp.appendPixivEffect({id:i,qualityOption:t,illust:r,seasonalEffect:await a.arrayBuffer(),onProgress:e,signal:o});return zd.addImageEffect({id:n,data:await a.arrayBuffer()}),s}})}create(t){const{filenameTemplate:e,directoryTemplate:r,setProgress:a,useTranslatedTags:o,useFileSystemAccessApi:n,filenameConflictAction:i}=t,s="index"in t?t.index:0,l=this.getHeaders(),c=this.getTemplateData(o?{tags:this.translatedTags.join("_"),page:String(s)}:{page:String(s)});return{headers:l,taskId:this.getTaskId(),src:this.getSrc(s),path:this.getSavePath(r,e,this.getExt(s),c),timeout:this.getDownloadTimeout(s),onProgress:a,useFileSystemAccessApi:n,filenameConflictAction:i}}createMulti(t){if(!this.isStringArray(this.src))throw new Error(`Artwork ${this.id} only have one media.`);const{filenameTemplate:e,directoryTemplate:r,setProgress:a,useTranslatedTags:o,useFileSystemAccessApi:n,filenameConflictAction:i}=t,s=this.getTaskId(),l=this.getHeaders(),c=a?this.getMultipleMediaDownloadCB(a):void 0,d=o?{tags:this.translatedTags.join("_")}:{};return this.src.map((t,a)=>({headers:l,taskId:s,src:t,path:this.getSavePath(r,e,this.getExt(a),this.getTemplateData({...d,page:String(a)})),timeout:this.getDownloadTimeout(),onFileSaved:c,useFileSystemAccessApi:n,filenameConflictAction:i}))}createBundle(t){if(!this.isStringArray(this.src))throw new Error(`Artwork ${this.id} only have one media.`);const{filenameTemplate:e,directoryTemplate:r,setProgress:a,useTranslatedTags:o,useFileSystemAccessApi:n,filenameConflictAction:i}=t,s=this.getTaskId(),l=this.getHeaders(),c=a?this.getMultipleMediaDownloadCB(a):void 0,d=o?{tags:this.translatedTags.join("_")}:{},u=this.getSavePath(r,e,"zip",this.getTemplateData({...d,page:String(this.src.length)})),p=e.includes(`{${sc.PAGE}}`)?e:e+`_{${sc.PAGE}}`,h=this.src.map((t,e)=>this.getSavePath("",p,this.getExt(e),this.getTemplateData({...d,page:String(e)})));return this.src.map((t,e)=>({headers:l,taskId:s,src:t,path:u,timeout:this.getDownloadTimeout(e),onXhrLoaded:c,beforeFileSave:this.handleBundleFactory(h),onError:this.handleBundleErrorFactory(),onAbort:this.handleBundleAbortFactory(),useFileSystemAccessApi:n,filenameConflictAction:i}))}createConvert(t){if(!this.isStringArray(this.src))throw new Error(`Artwork ${this.id} only have one media.`);const{filenameTemplate:e,directoryTemplate:r,setProgress:a,qualityOption:o,useTranslatedTags:n,useFileSystemAccessApi:i,filenameConflictAction:s}=t,l=this.getTaskId(),c=this.getHeaders(),d=a?this.getMultipleMediaDownloadCB(a):void 0,u=this.handleConvertFactory(o,a),p=this.getTemplateData(n?{tags:this.translatedTags.join("_"),page:String(0)}:{page:String(0)}),h=this.getSavePath(r,e,o.format,p);return this.src.map((t,e)=>({headers:c,taskId:l,src:t,path:h,timeout:this.getDownloadTimeout(e),onXhrLoaded:d,beforeFileSave:u,useFileSystemAccessApi:i,filenameConflictAction:s}))}createSeasonalEffect(t){const{filenameTemplate:e,directoryTemplate:r,setProgress:a,qualityOption:o,useTranslatedTags:n,useFileSystemAccessApi:i,filenameConflictAction:s}=t,l="index"in t?t.index:0,c=this.getTemplateData(n?{tags:this.translatedTags.join("_"),page:String(l)}:{page:String(l)});return{headers:this.getHeaders(),taskId:this.getTaskId(),src:this.getSrc(l),path:this.getSavePath(r,e,o.format,c),timeout:this.getDownloadTimeout(l),onProgress:a,beforeFileSave:this.handleSeasonalEffectFactory(o,a),useFileSystemAccessApi:i,filenameConflictAction:s}}}class Np extends lp{constructor(){null===np.version&&(Zu.setDirectoryTemplate(eu.folderPattern??"pixiv/{artist}"),Zu.setFilenameTemplate(eu.filenamePattern??"{artist}_{title}_{id}_p{page}"),tp.$update(t=>({...t,ugoiraFormat:eu.ugoiraFormat??"zip",mixSeasonalEffect:eu.mixEffect??!1,tagLocale:eu.tagLang??pl.JAPANESE,compressMultiIllusts:eu.bundleIllusts??!1,compressManga:eu.bundleManga??!1,addBookmark:!1,bookmarkWithTags:eu.addBookmarkWithTags??!1,privateBookmarkIfR18:eu.privateR18??!1,likeIllustWhenDownloading:eu.likeIllust??!1})));const t=new Eu(()=>"dark"===document.documentElement.getAttribute("data-theme"),t=>{const e=new MutationObserver(e=>{e.some(t=>"data-theme"===t.attributeName)&&t()});return e.observe(document.documentElement,{attributes:!0,childList:!1,subtree:!1}),()=>{e.disconnect()}});np.setThemeWatcher(t),super(),fc(this,"firstObserverCbRunFlag",!0),fc(this,"useBatchDownload",this.app.initBatchDownloader({async avatar(t){let e,r;if(e=(r=Lu.series.exec(t))?r[1]:(r=Lu.userPage.exec(t))?r[1]||r[2]:Pa()??"",!e)return"";try{return(await Ep.getUserData(e)).imageBig}catch(t){return Ld.error(t),""}},parseMetaByArtworkId:t=>{const e=tp.tagLocale??pl.JAPANESE;return Sp.parse(t,{tagLang:e,type:"api"})},downloadArtworkByMeta:async(t,e)=>{const r=this.getDownloadConfig(t);await Ku.download(r,{signal:e});const{comment:a,id:o,tags:n,artist:i,userId:s,title:l}=t,c={pid:Number(o),user:i,userId:Number(s),title:l,comment:a,tags:n};zd.add(c)},filterOption:{filters:[{id:"exclude_downloaded",type:"exclude",name:()=>gu("downloader.category.filter.exclude_downloaded"),checked:!1,fn:t=>!!t.id&&zd.has(t.id)},{id:"illust",type:"include",name:()=>gu("downloader.category.filter.pixiv_illust"),checked:!0,fn:t=>t.illustType===lc.illusts},{id:"manga",type:"include",name:()=>gu("downloader.category.filter.pixiv_manga"),checked:!0,fn:t=>t.illustType===lc.manga},{id:"ugoira",type:"include",name:()=>gu("downloader.category.filter.pixiv_ugoira"),checked:!0,fn:t=>t.illustType===lc.ugoira}],enableTagFilter:!0},pageOption:{self_bookmark_public:{name:()=>gu("downloader.download_type.pixiv_bookmark_public"),match(t){const e=Lu.userPage.exec(t);return!!e&&(e[1]||e[2])===Pa()},filterInGenerator:!0,fn:(t,e)=>Sp.bookmarkGenerator(t,e,Pa())},self_bookmark_private:{name:()=>gu("downloader.download_type.pixiv_bookmark_private"),match(t){const e=Lu.userPage.exec(t);return!!e&&(e[1]||e[2])===Pa()},filterInGenerator:!0,fn:(t,e)=>Sp.bookmarkGenerator(t,e,Pa(),"hide")},user_page_works:{name:()=>gu("downloader.download_type.pixiv_works"),match:Lu.userPage,filterInGenerator:!0,fn:(t,e)=>{const r=Lu.userPage.exec(location.href),a=r[1]||r[2];return Sp.illustMangaGenerator(t,e,a)}},user_page_bookmark:{name:()=>gu("downloader.download_type.pixiv_bookmark"),match:Lu.userPage,filterInGenerator:!0,fn:(t,e)=>{const r=Lu.userPage.exec(location.href),a=r[1]||r[2];return Sp.bookmarkGenerator(t,e,a)}},follow_latest_all:{name:()=>gu("downloader.download_type.pixiv_follow_latest_all"),match:Lu.followLatest,filterInGenerator:!0,fn:(t,e)=>Sp.followLatestGenerator(t,e,"all")},follow_latest_r18:{name:()=>gu("downloader.download_type.pixiv_follow_latest_r18"),match:Lu.followLatest,filterInGenerator:!0,fn:(t,e)=>Sp.followLatestGenerator(t,e,"r18")},series:{name:()=>gu("downloader.download_type.pixiv_series"),match:Lu.series,filterInGenerator:!0,fn:(t,e)=>{const r=Lu.series.exec(location.pathname);return Sp.seriesGenerator(t,e,r[2])}},tagged_artwork:{name:"tagged_artwork",match:()=>!1,filterInGenerator:!0,fn:(t,e,r,a,o,n="show")=>"bookmarks"===a?Sp.taggedArtworkGenerator(t,e,r,a,o,n):Sp.taggedArtworkGenerator(t,e,r,a,o)}}}))}static get hostname(){return"www.pixiv.net"}inject(){super.inject(),this.downloadArtwork=this.downloadArtwork.bind(this),new MutationObserver(t=>{const e=t.flatMap(t=>t.addedNodes.length?Array.from(t.addedNodes).filter(t=>t.nodeType===Node.ELEMENT_NODE&&t.tagName.toLowerCase()!==Hd.tagNameLowerCase&&"IMG"!==t.tagName):[]);this.injectThumbnailButtons(e),this.pageActions(e)}).observe(document.body,{childList:!0,subtree:!0})}getSupportedTemplate(){return Dp.supportedTemplate}injectThumbnailButtons(t){var e;t.length&&(this.firstObserverCbRunFlag?(Ia(document.querySelectorAll("a"),this.downloadArtwork),this.firstObserverCbRunFlag=!1):(e=t,Lu.searchPage.test(location.pathname)&&e.forEach(t=>{var e;null==(e=t.querySelector(Hd.tagNameLowerCase))||e.remove()}),Ia(t.reduce((t,e)=>t.concat(e instanceof HTMLAnchorElement?[e]:Array.from(e.querySelectorAll("a"))),[]),this.downloadArtwork)))}pageActions(t){var e,r,a;const o=location.pathname;let n;switch(!0){case!!(n=Lu.artworksPage.exec(o)):{const t=n[1];!function(t,e){const r=document.querySelector("main section section");if(!r||r.querySelector(Hd.tagNameLowerCase))return;const a=new Hd({id:t,type:Ai.PixivToolbar,onClick:e}),o=r.lastElementChild.cloneNode();o.appendChild(a),r.appendChild(o)}(t,this.downloadArtwork),Ta(t,this.downloadArtwork),$a(t,this.downloadArtwork),Ba(t,this.downloadArtwork),Da(t,this.downloadArtwork);break}case Lu.userPageTags.test(o):{const{downloading:t,batchDownload:e}=this.useBatchDownload(),r=t=>{const{userId:r,category:a,tag:o,rest:n}=t;return e("tagged_artwork",r,a,o,n)};!function(t,e){const r=Array.from(document.querySelectorAll("a[status]"));r.length&&r.forEach(r=>{var a;if((null==(a=r.nextElementSibling)?void 0:a.tagName.toLowerCase())===$p.tagNameLowerCase)return;const o=new $p(r,t,e);r.parentElement.appendChild(o)})}(t,r),function(t,e){var r;const a=document.querySelector('div[style*="position: relative"]');if(!a)return;const o=null==a?void 0:a.closest('div[role="presentation"], div[class="charcoal-token"]'),n=null==(r=null==o?void 0:o.querySelector("svg"))?void 0:r.parentElement;a.querySelectorAll('div[style*="position: absolute"] a').forEach(r=>{if(r.querySelector(Tp.tagNameLowerCase))return;const a=new Tp(r.href,t,t=>(null==n||n.click(),e(t)));r.appendChild(a)})}(t,r);break}case Lu.historyPage.test(o):Ia(document.querySelectorAll("span[style]._history-item"),this.downloadArtwork);break;case!!(n=Lu.unlisted.exec(o)):{const t=n[0],r=document.head.querySelector('link[rel="canonical"]')||document.head.querySelector('link[data-next-head][href^="https://www.pixiv.net/artworks/"]'),a=null==r?void 0:r.getAttribute("href");if(!a)throw new Error(`Cannot get canonical url for ${t}`);const o=null==(e=Lu.artworksPage.exec(a))?void 0:e[1];if(!o)throw new Error(`Cannot get artwork id for ${t}`);!function(t,e,r){if(document.querySelector(Ip.tagNameLowerCase))return;const a=document.querySelector('div[style^="transform: translateY"]');if(!a)return;const o=new Ip({id:t,onClick:e,extraData:{unlistedId:r}});a.appendChild(o);const n=a.querySelector('button[type="button"]:not([style])');n&&(n.style.bottom="48px")}(o,this.downloadArtwork,t),Ta(o,this.downloadArtwork,t),$a(o,this.downloadArtwork,t),Ba(o,this.downloadArtwork,t),Da(o,this.downloadArtwork,t);break}case"/"===o||"/en/"===o:r=t,a=this.downloadArtwork,0!==r.length&&r.forEach(t=>{var e,r;const o=t.querySelector('[data-ga4-entity-id^="manga"], [data-ga4-entity-id^="illust"]'),n=null==o?void 0:o.querySelector('div.justify-between > [data-ga4-label="bookmark_button"]');if(!o||!n)return;const i=null==(r=null==(e=o.dataset.ga4EntityId)?void 0:e.match(/([0-9]+)/))?void 0:r[0];if(!i)throw new Error("ID not found in data-ga4-entity-id");n.previousElementSibling.style.maxWidth="calc(100% - 68px)";const s=new Hd({id:i,type:Ai.PixivToolbar,onClick:a}),l=document.createElement("div");l.className="flex flex-row gap-4",l.appendChild(s),n.parentElement.insertBefore(l,n),l.appendChild(n)})}}isMultiImageMeta(t){return Array.isArray(t.src)&&t.src.length>1}getConvertQualityOption(t){switch(t){case Ei.GIF:return{format:Ei.GIF,quality:ep.gifQuality};case Ei.PNG:return{format:Ei.PNG,cnum:ep.pngColor};case Ei.WEBM:return{format:Ei.WEBM,bitrate:ep.webmBitrate};case Ei.WEBP:{const{losslessWebp:t,webpQuality:e,webpMehtod:r}=ep;return{format:Ei.WEBP,lossless:t,quality:e,method:r}}case Ei.MP4:return{format:Ei.MP4,bitrate:ep.mp4Bitrate};default:return}}getDownloadConfig(t,e,r){const{compressManga:a,compressMultiIllusts:o,mixSeasonalEffect:n,ugoiraFormat:i,tagLocale:s}=tp,l=Ei.MP4,c=this.getConvertQualityOption(i),d={...Zu,useTranslatedTags:!!s&&s!==pl.JAPANESE,setProgress:e};return"ugoiraMeta"in t?c?new Dp(t).createConvert({...d,qualityOption:c}):new Dp(t).createBundle(d):this.isMultiImageMeta(t)?void 0!==r?n?new Dp(t).createSeasonalEffect({...d,index:r,qualityOption:c||this.getConvertQualityOption(l)}):new Dp(t).create({...d,index:r}):t.illustType===lc.manga&&a||t.illustType===lc.illusts&&o?new Dp(t).createBundle(d):new Dp(t).createMulti(d):n?new Dp(t).createSeasonalEffect({...d,qualityOption:c||this.getConvertQualityOption(l)}):new Dp(t).create(d)}async downloadArtwork(t){const{id:e,page:r,unlistedId:a}=t.dataset,o=void 0!==r?+r:void 0,n=tp.tagLocale??pl.JAPANESE;let i;if(a)i=await Sp.parse(a,{tagLang:n,type:"unlisted"});else{const r=tp.addBookmark,a=tp.likeIllustWhenDownloading;if(r||a){i=await Sp.parse(e,{tagLang:n,type:"html"});const{bookmarkData:o,token:s,tags:l,likeData:c}=i;if(!o&&r){const r=tp.bookmarkWithTags?l:void 0,a=tp.privateBookmarkIfR18&&l.includes("R-18")?cc.private:cc.public;!async function(t,e,r){const{btn:a,tags:o,restrict:n}=r;try{if(await Ep.addBookmark(t,e,o,n),!a)return;const r=function(t){var e,r,a,o,n;const i={};if(t.dataset.type){if(t.dataset.type!==Ai.PixivToolbar)return Ld.warn(new Error("Can not find bookmark button."));{const e=null==(n=null==(o=t.parentElement)?void 0:o.parentElement)?void 0:n.querySelector("button.gtm-main-bookmark");e&&(i.kind="main",i.button=e)}}else{const o=null==(r=null==(e=t.parentElement)?void 0:e.nextElementSibling)?void 0:r.querySelector('button[type="button"]');if(o)i.kind="sub",i.button=o;else{const e=null==(a=t.parentElement)?void 0:a.querySelector("div._one-click-bookmark");e&&(i.kind="rank",i.button=e)}}return i}(a);if(!r)return;switch(r.kind){case"main":{const t=r.button.querySelector("svg g path");t&&(t.style.color="rgb(255, 64, 96)");break}case"sub":{const t=r.button.querySelector("path");t&&(t.style.color="rgb(255, 64, 96)");break}case"rank":r.button.style.backgroundColor="rgb(255, 64, 96)"}}catch(t){Ld.error(t)}}(e,s,{btn:t,tags:r,restrict:a})}!c&&a&&async function(t,e){var r,a,o;if(await Ep.likeIllust(t,e),!function(t){return location.pathname.includes(`/artworks/${t}`)}(t))return;const n=null==(o=null==(a=null==(r=document.querySelector(`${Hd.tagNameLowerCase}[data-type="pixiv-toolbar"]`))?void 0:r.parentElement)?void 0:a.previousElementSibling)?void 0:o.firstElementChild;n&&(n.disabled=!0,n.style.color="#0096fa",n.style.cursor="default")}(e,s)}else i=await Sp.parse(e,{tagLang:n,type:"api"})}const s=this.getDownloadConfig(i,e=>{e>0?t.setProgress(e):t.setStatus(_i.Loading)},o);await Ku.download(s,{priority:1});const{comment:l,tags:c,artist:d,userId:u,title:p}=i,h={pid:Number(e),user:d,userId:Number(u),title:p,comment:l,tags:c};void 0!==r&&(h.page=Number(r)),a&&(h.unlistedId=a),zd.add(h)}}class Mp extends cp{constructor(){super(...arguments),vc(this,Go)}parseCsrfToken(){const t=document.querySelector('meta[name="csrf-token"]');if(!t)throw new Error("Can not find csrf-token element.");return t.content}isLatestData(t){return"file_ext"in t}buildMeta(t,e){if("deleted"===t.status)throw new Error(`Post ${t.id} is deleted.`);const{id:r,file_url:a,md5:o,created_at:n,source:i,rating:s,score:l}=t,c=this.isLatestData(t)?t.file_ext:a.match(/\.(\w+)$/)[1],d=[],u=[],p=t.tags.split(" ").map(t=>{const r=e[t]??"unknown";return"artist"===r?d.push(t):"character"===r&&u.push(t),r+":"+t});return{id:String(r),src:a,extendName:c,artist:d.join(",")||this.UNKNOWN_ARTIST,character:u.join(",")||this.UNKNOWN_CHARACTER,title:o,tags:p,createDate:new Date(1e3*n).toISOString(),rating:s,score:l,source:i}}isFavorite(t,e){return t in e&&3===e[t]}parsePostsList(t){return{posts:yc(this,Go,Yo).call(this,t),tags:yc(this,Go,Vo).call(this,t)}}parsePostAndPool(t){const[e]=new RegExp("(?<=Post\\.register_resp\\().+(?=\\);)").exec(t);return JSON.parse(e)}parseBlacklistByDoc(t){const e=t.querySelector("script#user-blacklisted-tags");if(!e)throw new Error("Can not get blacklist.");const r=JSON.parse(e.textContent??"[]");return yc(this,Go,Jo).call(this,r)}parseBlacklistByCookie(){const t=document.cookie.match(new RegExp("(?<=blacklisted_tags=).+?(?=;)"));let e=t?decodeURIComponent(t[0]):"[]";return'[""]'===e&&(e="[]"),yc(this,Go,Jo).call(this,JSON.parse(e))}isBlacklisted(t,e){return e.some(e=>{const{require:r,exclude:a}=e,o=e=>t.includes(e);return r.every(o)&&!a.some(o)})}}Go=new WeakSet,Yo=function(t){return t.match(new RegExp("(?<=Post\\.register\\().+(?=\\))","g")).map(t=>JSON.parse(t))},Vo=function(t){const[e]=t.match(new RegExp("(?<=Post\\.register_tags\\().+(?=\\))"));return JSON.parse(e)},Jo=function(t){return t.map(t=>{const e=t.replace(/(rating:[qes])\w+/,"$1").split(" "),r=[],a=[];return e.forEach(t=>{"-"===t.charAt(0)?a.push(t.slice(1)):r.push(t)}),{tags:e,original_tag_string:t,require:r,exclude:a}})};class Op extends mp{isBadResponse(t){return"success"in t&&!t.success}async getJSON(t,e){const r=await super.getJSON(t,e);if(this.isBadResponse(r))throw new $u(r.reason);return r}async getPost(t){const[e]=await this.getJSON(`/post.json?tags=id:${t}`);return e}async getPosts(t){let e="/post.json?";return Object.entries(t).forEach(([t,r])=>{"number"==typeof r?r=String(r):Array.isArray(r)&&(r=r.join("+")),e+=`&${t}=${r}`}),this.getJSON(e)}async getPool(t,e=1){return this.getJSON(`/pool/show.json?id=${t}&page=${e}`)}async getPopularByDate(t){let e;const{month:r="",year:a=""}=t;return e="month"===t.period?`/post/popular_by_month.json?month=${r}&year=${a}`:`/post/popular_by_${t.period}.json?day=${t.day??""}&month=${r}&year=${a}`,this.getJSON(e)}async getPostHtml(t){return this.getHtml(`/post/show/${t}`)}async getPostsHtml(t,e){return Array.isArray(t)&&t.join("+"),this.getHtml(`/post?page=${e}&tags=${t}`)}async getPopularHtmlByPeriod(t){return this.getHtml(`/post/popular_recent?period=${t}`)}async getPoolHtml(t){return this.getHtml(`/pool/show/${t}`)}async getBlacklistDoc(){return this.getDoc("/static/more")}async getPopularHtmlByDate(t){let e;const{month:r="",year:a=""}=t;return e="month"===t.period?`/post/popular_by_month?month=${r}&year=${a}`:`/post/popular_by_${t.period}?day=${t.day??""}&month=${r}&year=${a}`,this.getHtml(e)}async addFavorite(t,e){const r=await this.fetch("/post/vote.json",{method:"POST",headers:{"x-csrf-token":e,"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},body:`id=${t}&score=3`});if(!r.ok)throw new Iu(r.url,r.status)}}class Lp extends lp{constructor(){null===np.version&&(tp.addBookmark??(tp.addBookmark=!1)),super(),vc(this,Qo),fc(this,"blacklist",null),fc(this,"useBatchDownload",this.app.initBatchDownloader({avatar:"/favicon.ico",parseMetaByArtworkId:async t=>{const e=await this.api.getPostHtml(t),{posts:r,tags:a}=this.parser.parsePostAndPool(e);return this.parser.buildMeta(r[0],a)},downloadArtworkByMeta:async(t,e)=>{const r=new gp(t).create({...Zu,cfClearance:ip.cf_clearance||void 0});await Ku.download(r,{signal:e});const{id:a,tags:o,artist:n,title:i,rating:s,source:l}=t;zd.add({pid:Number(a),user:n,title:i,tags:o,rating:s,source:l})},afterDownload:()=>{this.blacklist&&(this.blacklist=null)},filterOption:{filters:[{id:"exclude_downloaded",type:"exclude",name:()=>gu("downloader.category.filter.exclude_downloaded"),checked:!1,fn:t=>!!t.id&&zd.has(t.id)},{id:"exclude_blacklist",type:"exclude",name:()=>gu("downloader.category.filter.exclude_blacklist"),checked:!0,fn:async t=>!!t.tags&&(this.blacklist??(this.blacklist=await this.getBlacklist()),this.parser.isBlacklisted(t.tags,this.blacklist))},{id:"allow_image",type:"include",name:()=>gu("downloader.category.filter.image"),checked:!0,fn:()=>!0}],enableTagFilter:!0},pageOption:{posts:{name:()=>gu("downloader.download_type.moebooru_posts"),match:()=>"/post"===location.pathname,filterInGenerator:!0,fn:(t,e,r)=>(r??(r=new URLSearchParams(location.search).get("tags")??""),this.parser.paginationGenerator(t,async t=>{const e=await this.api.getPostsHtml(r,t),{posts:a,tags:o}=this.parser.parsePostsList(e),n=a.map(t=>({...t,tagType:o}));return{lastPage:n.length<40,data:n}},yc(this,Qo,Ko).bind(this),yc(this,Qo,Xo).call(this,e)))},popular_1d:{name:()=>gu("downloader.download_type.moebooru_popular_1d"),match:()=>"/post/popular_recent"===location.pathname,filterInGenerator:!0,fn:(t,e)=>this.parser.paginationGenerator([1,1],yc(this,Qo,Zo).call(this,"1d"),yc(this,Qo,Ko).bind(this),yc(this,Qo,Xo).call(this,e))},popular_1w:{name:()=>gu("downloader.download_type.moebooru_popular_1w"),match:()=>"/post/popular_recent"===location.pathname,filterInGenerator:!0,fn:(t,e)=>this.parser.paginationGenerator([1,1],yc(this,Qo,Zo).call(this,"1w"),yc(this,Qo,Ko).bind(this),yc(this,Qo,Xo).call(this,e))},popular_1m:{name:()=>gu("downloader.download_type.moebooru_popular_1m"),match:()=>"/post/popular_recent"===location.pathname,filterInGenerator:!0,fn:(t,e)=>this.parser.paginationGenerator([1,1],yc(this,Qo,Zo).call(this,"1m"),yc(this,Qo,Ko).bind(this),yc(this,Qo,Xo).call(this,e))},popular_1y:{name:()=>gu("downloader.download_type.moebooru_popular_1y"),match:()=>"/post/popular_recent"===location.pathname,filterInGenerator:!0,fn:(t,e)=>this.parser.paginationGenerator([1,1],yc(this,Qo,Zo).call(this,"1y"),yc(this,Qo,Ko).bind(this),yc(this,Qo,Xo).call(this,e))},popular_by_date:{name:()=>gu("downloader.download_type.moebooru_popular_date"),match:/\/post\/popular_by_(day|week|month)/,filterInGenerator:!0,fn:(t,e)=>{const r=new RegExp("(?<=popular_by_)day|week|month").exec(location.pathname)[0],a=new URLSearchParams(location.search);let o;return 0===a.size?o={period:r}:(o={period:r,month:a.get("month")||void 0,year:a.get("year")||void 0},"month"!==o.period&&(o.day=a.get("day")||void 0)),this.parser.paginationGenerator([1,1],async()=>{const t=await this.api.getPopularHtmlByDate(o),{posts:e,tags:r}=this.parser.parsePostsList(t);return{lastPage:!0,data:e.map(t=>({...t,tagType:r}))}},yc(this,Qo,Ko).bind(this),yc(this,Qo,Xo).call(this,e))}},pool:{name:()=>gu("downloader.download_type.moebooru_pool"),match:/\/pool\/show\//,filterInGenerator:!0,fn:(t,e,r)=>(r??(r=new RegExp("(?<=show\\/)[0-9]+").exec(location.pathname)[0]),this.parser.paginationGenerator([1,1],async()=>{const t=await this.api.getPoolHtml(r),{posts:e,tags:a}=this.parser.parsePostAndPool(t);return{lastPage:!0,data:e.map(t=>({...t,tagType:a}))}},yc(this,Qo,Ko).bind(this),yc(this,Qo,Xo).call(this,e)))}}}))}getSupportedTemplate(){return gp.supportedTemplate}createThumbnailBtn(t){t.length&&t.forEach(t=>{const e=new RegExp("(?<=\\/post\\/show\\/)\\d+|(?<=\\/post\\/browse#)\\d+").exec(t.href);if(!e)return;const r=e[0],a=t.querySelector(Hd.tagNameLowerCase);if(a){if(a.dataset.id===r)return;a.remove()}else{if(t.href.includes("/post/show")&&(t.style.height="fit-content",!t.classList.contains("thumb"))){const e=t.querySelector("img");if(e.src.includes("blacklisted-preview.png"))return;e.onload=()=>{e.src.includes("blacklisted-preview.png")&&e.nextElementSibling&&e.nextElementSibling.remove()},t.style.marginBottom="1em",e.style.marginBottom="0px"}t.parentElement.style.display="flex",t.style.position="relative"}t.appendChild(new Hd({id:r,onClick:yc(this,Qo,en).bind(this)}))})}createArtworkBtn(t){const e=document.querySelector("#post-view > .content > div:has(:is(img, video))");if(!e)throw new Error("Can not find button container");e.style.position="relative",e.style.width="max-content",e.appendChild(new au({id:t,site:e.querySelector("video")?"vjs_video":"moebooru_image",onClick:yc(this,Qo,en).bind(this)}))}createScrollerBtn(){const t=document.querySelector("ul.post-browser-posts");t&&new MutationObserver(t=>{const e=[];t.forEach(t=>{t.addedNodes.length&&t.addedNodes.forEach(t=>{if(!(t instanceof HTMLElement))return;const r=t.querySelectorAll("a.thumb");r.length&&e.push(...r)})}),this.createThumbnailBtn(e)}).observe(t,{subtree:!0,childList:!0})}createImageBrowseBtn(){const t=document.querySelector("span.post-id");if(!t)return;const e=()=>{var e;null==(e=document.querySelector(`${Hd.tagNameLowerCase}[data-type="${Ai.YandeBrowse}"]`))||e.remove();const r=t.textContent;r&&document.body.appendChild(new Hd({id:r,type:Ai.YandeBrowse,onClick:yc(this,Qo,en).bind(this)}))};e(),new MutationObserver(e).observe(t,{childList:!0})}inject(){super.inject();const t=location.pathname,e=t.match(new RegExp("(?<=\\/post\\/show\\/)\\d+"));if(e)this.createArtworkBtn(e[0]);else if("/post/browse"===t)this.createScrollerBtn(),this.createImageBrowseBtn();else{const t=document.querySelectorAll("a.thumb, div.post div.col1 a");this.createThumbnailBtn(Array.from(t))}}}Qo=new WeakSet,Xo=function(t){return async e=>{const r=e.tags.split(" ");return r.push("rating:"+e.rating.charAt(0)),r.push("status:"+e.status),await t({id:String(e.id),tags:r})?ic.VALID:ic.INVALID}},Ko=function(t){return this.parser.buildMeta(t,t.tagType)},Zo=function(t){return async()=>{const e=await this.api.getPopularHtmlByPeriod(t),{posts:r,tags:a}=this.parser.parsePostsList(e);return{lastPage:!0,data:r.map(t=>({...t,tagType:a}))}}},tn=async function(t){try{const e=this.parser.parseCsrfToken();await this.api.addFavorite(t,e),this.toast({message:"You have favorited this post",timeout:2e3})}catch(t){Ld.error(t),this.toast({message:t.message,type:"error"})}},en=async function(t){const e=t.dataset.id,r=await this.api.getPostHtml(e),{posts:a,tags:o,votes:n}=this.parser.parsePostAndPool(r),i=this.parser.buildMeta(a[0],o),s=new gp(i).create({...Zu,cfClearance:ip.cf_clearance||void 0,setProgress:e=>{t.setProgress(e)}});tp.addBookmark&&!this.parser.isFavorite(e,n)&&yc(this,Qo,tn).call(this,e),await Ku.download(s,{priority:1});const{tags:l,artist:c,title:d,rating:u,source:p}=i;zd.add({pid:Number(e),user:c,title:d,tags:l,rating:u,source:p})};class jp extends Lp{constructor(){null===np.version&&(Zu.setDirectoryTemplate(eu.folderPattern??"yande/{artist}"),Zu.setFilenameTemplate(eu.filenamePattern??"{id}_{artist}_{character}")),super(),fc(this,"api",new Op),fc(this,"parser",new Mp)}async getBlacklist(){const t=await this.api.getBlacklistDoc();return this.parser.parseBlacklistByDoc(t)}static get hostname(){return"yande.re"}}class Rp extends _p{constructor(){null===np.version&&(Zu.setDirectoryTemplate(eu.folderPattern??"ATFbooru/{artist}"),Zu.setFilenameTemplate(eu.filenamePattern??"{id}_{artist}_{character}")),super(),fc(this,"api",new kp),fc(this,"parser",new yp),fc(this,"commentaryAccessible")}static get hostname(){return"booru.allthefallen.moe"}getAvatar(){return"/favicon.svg"}async isCommentaryAccessible(){try{await this.api.getArtistCommentary("703816")}catch(t){if(!(t instanceof Iu))return!1;throw t}return!0}async getMetaByPostId(t){let e;if(this.commentaryAccessible??(this.commentaryAccessible=await this.isCommentaryAccessible())){const{post:r,comment:a}=await this.getPostAndComment(t);e=this.parser.buildMetaByApi(r,a)}else{const r=await this.api.getPostDoc(t);e=this.parser.buildMetaByDoc(r)}return e}}class Fp extends Lp{constructor(){null===np.version&&(Zu.setDirectoryTemplate(eu.folderPattern??"konachan/{artist}"),Zu.setFilenameTemplate(eu.filenamePattern??"{id}_{artist}_{character}"),ip.cf_clearance??(ip.cf_clearance="")),super(),vc(this,rn),fc(this,"api",new Op),fc(this,"parser",new Mp)}async getBlacklist(){return this.parser.parseBlacklistByCookie()}static get hostname(){return["konachan.com","konachan.net"]}inject(){super.inject(),/pool\/show\//.test(location.pathname)&&yc(this,rn,an).call(this)}}rn=new WeakSet,an=function(){document.querySelectorAll("ul#post-list-posts li").forEach(t=>{t.style.width="auto";const e=t.firstElementChild;e.style.width="auto",e.style.height="auto"})};class zp extends Lp{constructor(){null===np.version&&(Zu.setDirectoryTemplate(eu.folderPattern??"sakugabooru/{artist}"),Zu.setFilenameTemplate(eu.filenamePattern??"{id}_{artist}_{character}")),super(),fc(this,"api",new Op),fc(this,"parser",new Mp)}async getBlacklist(){const t=await this.api.getBlacklistDoc();return this.parser.parseBlacklistByDoc(t)}static get hostname(){return"www.sakugabooru.com"}}class qp extends fp{constructor(){null===np.version&&(Zu.setDirectoryTemplate(eu.folderPattern??"safebooru/{artist}"),Zu.setFilenameTemplate(eu.filenamePattern??"{id}_{artist}_{character}"),ip.cf_clearance??(ip.cf_clearance="")),super(),fc(this,"api",new wp),fc(this,"parser",new dp)}static get hostname(){return"safebooru.org"}getThumbnailSelector(){return".thumb:not(.blacklisted-image) > a:first-child"}}class Hp extends wp{async getPosts(){throw new Error("This is a Gelbooru v0.2.0 method, do not use.")}async getPostsV025(t){let e="/index.php?page=dapi&s=post&q=index&json=1";Object.entries(t).forEach(([t,r])=>{"number"==typeof r?r=String(r):Array.isArray(r)&&(r=r.join("+")),e+=`&${t}=${r}`});const r=await this.fetch(e);if(!r.ok)throw new Iu(e,r.status);const a=await r.json();return a.post?a.post:[]}}class Wp extends fp{constructor(){null===np.version&&(Zu.setDirectoryTemplate(eu.folderPattern??"gelbooru/{artist}"),Zu.setFilenameTemplate(eu.filenamePattern??"{id}_{artist}_{character}")),np.setThemeWatcher({get current(){return!!document.head.querySelector('link[href*="dark.css"]')}}),super(),fc(this,"api",new Hp),fc(this,"parser",new dp)}static get hostname(){return"gelbooru.com"}getAvatar(){return"/user_avatars/honkonymous.png"}getThumbnailSelector(){return'.thumb > a:first-child,     .thumbnail-preview > a[id],     .commentThumbnail > a:first-child,     .thumbnail-container > span[id] > a,     a:has(img[style*="max-height: 100px"]),     a:has(div.profileThumbnailPadding)'}setThumbnailStyle(t){switch(!0){case this.isMyfavorites():t.setAttribute("style","position: relative; display: inline-block;");break;case this.isPool():{t.setAttribute("style","position: relative; display: inline-block; margin: 10px;");const e=t.querySelector("img");e.style.margin="0px",e.style.padding="0px";break}case this.isPostsList():t.style.position="relative";break;case this.isPostView():t.setAttribute("style","position: relative; display: inline-block; margin: 10px;"),t.querySelector("img").style.margin="0px";break;case this.isAccountProfile():t.setAttribute("style","position: relative; display: inline-block"),t.firstElementChild.style.padding="0px"}}createArtworkBtn(t){let e=document.querySelector(".image-container > picture");if(e)e.setAttribute("style","position: relative; display: inline-block;");else{const t=document.querySelector("#gelcomVideoPlayer");if(!t)return;e=document.createElement("div"),e.setAttribute("style","position: relative; width: fit-content; font-size: 0px;"),t.parentElement.insertBefore(e,t),e.appendChild(t)}e.appendChild(new au({id:t,site:"DIV"===e.nodeName?"native_video":void 0,onClick:this.downloadArtwork.bind(this)}))}inject(){super.inject(),this.isPostView()&&this.createThumbnailBtn()}}class Up extends mp{constructor(t){super(t),vc(this,on);const[e,r]=t.authorization;bc(this,on,new URLSearchParams({username:e,apiKey:r,_client:"Pixiv Downloader/1.11.0 (by drunkg00se on e621)"}))}get username(){return wc(this,on).get("username")}set username(t){t!==wc(this,on).get("username")&&wc(this,on).set("username",t)}get apiKey(){return wc(this,on).get("apiKey")}set apiKey(t){t!==wc(this,on).get("apiKey")&&wc(this,on).set("apiKey",t)}async getJSON(t,e){t+=""===new URL(t,location.origin).search?"?":"&",t+=wc(this,on).toString(),Ld.info("Fetch url:",t);const r=await this.fetch(t,e);if(!r.ok)throw new Iu(r.url,r.status);return await r.json()}getFavorites(t){const e=new URLSearchParams(Object.entries(t).map(([t,e])=>[t,String(e)]));return this.getJSON(`/favorites.json?${e.toString()}`)}getPool(t){return this.getJSON(`/pools/${t}.json`)}getPosts(t){const{limit:e,page:r}=t;if(e<0||e>320)throw new RangeError("limit should between 0 and 320.");if(r<1||r>750)throw new RangeError("Page should between 1 and 750.");const a=new URLSearchParams(Object.entries(t).map(([t,e])=>"string"==typeof e?[t,e]:[t,String(e)]));return this.getJSON(`/posts.json?${a.toString()}`)}getPost(t){return this.getJSON(`/posts/${t}.json`)}getCurrentUserProfile(t){return this.getJSON(`/users/${t}.json`)}async addFavorites(t,e){const r=await this.fetch(`/favorites.json?${wc(this,on).toString()}`,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-csrf-token":e},body:`post_id=${t}`});if(!r.ok)throw new Iu("/favorites.json",r.status);return r.json()}}on=new WeakMap;class Gp extends cp{buildMeta(t){const{id:e,file:r,tags:a,description:o,created_at:n,rating:i,sources:s,score:l,is_favorited:c}=t,{ext:d,url:u,md5:p}=r;if(!u)throw new Error(`Url can not be null: Post ${e}`);const h=[];for(const[t,e]of Object.entries(a))e.forEach(e=>h.push(`${t}:${e}`));return{id:String(e),src:u,extendName:d,artist:("artist"in a?a.artist:a.director).join(",")||this.UNKNOWN_ARTIST,character:a.character.join(",")||this.UNKNOWN_CHARACTER,title:p,comment:o,tags:h,createDate:n,score:l.total,source:s.join("\n"),rating:i,isFavorited:c}}parseCsrfToken(){var t;return null==(t=document.head.querySelector('meta[name="csrf-token"]'))?void 0:t.content}parseCurrentUserId(){var t;return null==(t=document.head.querySelector('meta[name="current-user-id"]'))?void 0:t.content}}class Yp extends lp{constructor(){null===np.version&&(Zu.setDirectoryTemplate(eu.folderPattern??"e621/{artist}"),Zu.setFilenameTemplate(eu.filenamePattern??"{id}_{artist}_{character}"),tp.addBookmark??(tp.addBookmark=!1),ip.$update(t=>({...t,apiKey:"",username:""}))),super(),vc(this,nn),fc(this,"api",new Up({rateLimit:2,authorization:[ip.username??"",ip.apiKey??""]})),fc(this,"parser",new Gp),fc(this,"profile",null),fc(this,"useBatchDownload",this.app.initBatchDownloader({avatar:"/packs/static/main-logo-2653c015c5870ec4ff08.svg",parseMetaByArtworkId:async t=>{const{post:e}=await this.api.getPost(+t);return this.parser.buildMeta(e)},downloadArtworkByMeta:async(t,e)=>{const r=new gp(t).create({...Zu});await Ku.download(r,{priority:1,signal:e});const{tags:a,artist:o,title:n,comment:i,source:s,rating:l}=t;zd.add({pid:Number(t.id),user:o,title:n,comment:i,tags:a,source:s,rating:l})},beforeDownload:async()=>{yc(this,nn,hn).call(this);const t=this.parser.parseCurrentUserId();if(!t)throw new Error("Cannot get user id.");this.profile=await this.api.getCurrentUserProfile(+t)},afterDownload:()=>{this.profile=null},filterOption:{filters:[{id:"exclude_downloaded",type:"exclude",name:()=>gu("downloader.category.filter.exclude_downloaded"),checked:!1,fn:t=>!!t.id&&zd.has(t.id)},{id:"allow_image",type:"include",name:()=>gu("downloader.category.filter.image"),checked:!0,fn:t=>!!t.extendName&&/bmp|jp(e)?g|png|tif|gif|exif|svg|webp/i.test(t.extendName)},{id:"allow_video",type:"include",name:()=>gu("downloader.category.filter.video"),checked:!0,fn:t=>!!t.extendName&&/mp4|avi|mov|mkv|flv|wmv|webm|mpeg|mpg|m4v/i.test(t.extendName)}],enableTagFilter:!0},pageOption:{pool:{name:"Pool",match:()=>yc(this,nn,ln).call(this),filterInGenerator:!0,fn:(t,e)=>{var r;const a=null==(r=new RegExp("(?<=\\/pools\\/)[0-9]+").exec(location.pathname))?void 0:r[0];if(!a)throw new Error("Invalid pool id");const o=this.profile.per_page;return this.parser.paginationGenerator(t,async t=>{const e=(await this.api.getPosts({limit:o,page:t,tags:`pool:${a} order:id`})).posts;return{lastPage:e.length<o,data:e}},t=>this.parser.buildMeta(t),yc(this,nn,gn).call(this,e))}},post_list:{name:"Posts",match:()=>yc(this,nn,un).call(this),filterInGenerator:!0,fn:(t,e)=>{const r=new URLSearchParams(new URL(location.href).search),a=r.get("tags")||"",o=+(r.get("limit")||this.profile.per_page);return this.parser.paginationGenerator(t,async t=>{const e=(await this.api.getPosts({limit:o,page:t,tags:a})).posts;return{lastPage:e.length<o,data:e}},t=>this.parser.buildMeta(t),yc(this,nn,gn).call(this,e))}},favorites:{name:"Favorites",match:()=>yc(this,nn,dn).call(this),filterInGenerator:!0,fn:(t,e)=>{const r=new URLSearchParams(new URL(location.href).search),a=+(r.get("limit")||this.profile.per_page),o=+(r.get("user_id")||this.profile.id);if(!o)throw new Error("Cannot get user id.");return this.parser.paginationGenerator(t,async t=>{const e=(await this.api.getFavorites({limit:a,page:t,user_id:o})).posts;return{lastPage:e.length<a,data:e}},t=>this.parser.buildMeta(t),yc(this,nn,gn).call(this,e))}},pool_gallery_button:{name:"pool_gallery_button",match:()=>!1,filterInGenerator:!0,fn:(t,e,r)=>{if(!r)throw new Error("Invalid pool id");return this.parser.paginationGenerator(t,async t=>{const e=this.profile.per_page,a=(await this.api.getPosts({limit:e,page:t,tags:`pool:${r}`})).posts;return{lastPage:a.length<e,data:a}},t=>this.parser.buildMeta(t),yc(this,nn,gn).call(this,e))}},show_downloader_in_pool_gallery:{name:"pool_gallery",match:/\/pools\/gallery/}}})),Ir(()=>[ip.username,ip.apiKey]).subscribe(([t,e])=>{this.api.username=t,this.api.apiKey=e})}static get hostname(){return["e621.net","e926.net","e6ai.net"]}getSupportedTemplate(){return gp.supportedTemplate}async downloadArtwork(t){yc(this,nn,hn).call(this);const e=+t.dataset.id,{post:r}=await this.api.getPost(e),a=this.parser.buildMeta(r),o=new gp(a).create({...Zu,setProgress:e=>{t.setProgress(e)}});tp.addBookmark&&!r.is_favorited&&yc(this,nn,fn).call(this,e),await Ku.download(o,{priority:1});const{tags:n,artist:i,title:s,comment:l,source:c,rating:d}=a;zd.add({pid:e,user:i,title:s,comment:l,tags:n,source:c,rating:d})}createArtworkBtn(){const t=document.querySelector("#image-container");if(!t)return;t.style.width="fit-content",t.style.position="relative";const e=t.dataset.id;t.appendChild(new au({id:e,site:t.querySelector("video")?"native_video":void 0,onClick:this.downloadArtwork}))}createPoolThumbnailBtn(){const t=document.querySelectorAll("article.thumbnail > a");t.length&&t.forEach(t=>{var e;const r=null==(e=new RegExp("(?<=\\/pools\\/)[0-9]+").exec(t.href))?void 0:e[0];if(!r)return;const{downloading:a,batchDownload:o}=this.useBatchDownload(),n=new xp({id:r,downloading:a,onClick:t=>{const e=t.dataset.id;return o("pool_gallery_button",e)}});t.style.position="relative",t.appendChild(n)})}createThumbnailBtn(){const t=document.querySelectorAll("article.thumbnail > a");t.length&&t.forEach(t=>{var e;const r=null==(e=new RegExp("(?<=\\/posts\\/)[0-9]+").exec(t.href))?void 0:e[0];if(!r)return;t.style.position="relative";const a=new Hd({id:r,onClick:this.downloadArtwork});t.appendChild(a)})}inject(){super.inject(),this.downloadArtwork=this.downloadArtwork.bind(this),yc(this,nn,cn).call(this)?this.createArtworkBtn():yc(this,nn,sn).call(this)?this.createPoolThumbnailBtn():this.createThumbnailBtn()}}nn=new WeakSet,sn=function(){return"/pools/gallery"===location.pathname},ln=function(){return/\/pools\/[0-9]+/.test(location.pathname)},cn=function(){return/\/posts\/[0-9]+/.test(location.pathname)},dn=function(){return"/favorites"===location.pathname},un=function(){return"/posts"===location.pathname},pn=function(){return this.api.username&&this.api.apiKey},hn=function(){if(!yc(this,nn,pn).call(this)){const t="Please input your username and apiKey in setting.";throw this.toast({message:t,type:"error"}),new Error(t)}},gn=function(t){return async e=>{const{id:r,file:a,tags:o}=e,n=[];for(const t of Object.values(o))t.forEach(t=>{n.push(t)});return await t({id:String(r),extendName:a.ext,tags:n})?ic.VALID:ic.INVALID}},fn=async function(t){try{const e=this.parser.parseCsrfToken();if(!e)throw new Error("Cannot get csrf-token.");await this.api.addFavorites(t,e),this.toast({message:"You have favorited this post",timeout:2e3})}catch(t){Ld.error(t),this.toast({message:t.message,type:"error"})}};class Vp extends cp{constructor(){super(...arguments),vc(this,mn)}buildMetaByView(t,e){var r,a,o,n;const[i,s]=((null==(r=e.querySelector('meta[property="og:title"]'))?void 0:r.content)??"").split(" | "),l=(null==(a=e.querySelector("#illust_text p, #dojin_text p:not(.title), #view-honbun > p.m-bottom15:not(.gray)"))?void 0:a.textContent)??"",c=e.querySelector("#img_filter :is(img, video), p.image img, #gallery_new img#view_img").src,d=null==(n=null==(o=e.querySelector('a[href*="members_illust"]'))?void 0:o.href.match(new RegExp("(?<=id=)[0-9]+$")))?void 0:n[0];if(!(i&&s&&c&&d))throw new Error("Can not parse necessary data");const u=c.match(new RegExp("(?<=\\.)[a-z0-9]{3,4}$","i"));if(!u)throw new Error("Can not parse ext.");const p=/[0-9:\- ]+$/.exec(e.querySelector("#view-honbun > p, #created").textContent),h=e.querySelector("#good_cnt").textContent??0,g=Array.from(e.querySelectorAll("[tag_id].tag .tag_name")).map(t=>t.textContent),f=!!e.querySelector('a[href*="bookmark_edit"]');return{id:t,userId:d,src:c,extendName:u[0],artist:s,title:i,tags:g,createDate:p[0],comment:l,score:+h,isBookmarked:f}}parseDiffSrcByDoc(t){return Array.from(t.querySelectorAll('#img_filter :is(img[src*="pic.nijie.net"], video)')).map(t=>{const e=t.src,r=e.match(new RegExp("(?<=\\.)[a-z0-9]{3,4}$","i"));if(!r)throw new Error("Can not parse ext.");return{src:e,extendName:r[0]}})}mergeImageDiff(t,e){const r=[],a=[];for(const t of e)r.push(t.src),a.push(t.extendName);return{...t,src:r,extendName:a}}parseUserPageArtworkIdByDoc(t){const e=t.querySelectorAll('.mem-index .nijiedao > a[href^="/view.php?id="]');return yc(this,mn,wn).call(this,Array.from(e))}parseUserFeedArtworkIdByDoc(t){const e=t.querySelectorAll('#main-left-main [illust_id] .picture > a[href^="/view.php?id="]');return yc(this,mn,wn).call(this,Array.from(e))}parseHistoryIllustArtworkIdByDoc(t){const e=t.querySelectorAll('.history_block > .picture > a[href*="id="]:has(img)');return yc(this,mn,wn).call(this,Array.from(e))}parseHistoryNuitaArtworkIdByDoc(t){const e=t.querySelectorAll('#center_column div[illust_id].illust_list .picture a[href*="id="]:has(img)');return yc(this,mn,wn).call(this,Array.from(e))}parseOkiniiriArtworkIdByDoc(t){const e=t.querySelectorAll('#content_delete .picture a[href*="id="]:has(img)');return yc(this,mn,wn).call(this,Array.from(e))}parseSearchArtworkIdByDoc(t){const e=t.querySelectorAll('#main-left-main [illust_id] .picture a[href*="id="]:has(img)');return yc(this,mn,wn).call(this,Array.from(e))}docHasDiff(t){return!!t.querySelector('a[href*="#diff_"]')}docIsDojin(t){return!!t.querySelector("#dojin_left")}docHasNextPagination(t){return!!t.querySelector('.page_button > a[rel="next"]')}}mn=new WeakSet,wn=function(t){return t.length?t.map(t=>new RegExp("(?<=id=)[0-9]+$").exec(t.href)[0]):[]};class Jp extends mp{getViewDoc(t){return this.getDoc(`/view.php?id=${t}`)}getViewPopupDoc(t){return this.getDoc(`/view_popup.php?id=${t}`)}getUserIllustsDoc(t,e){return this.getDoc(`/members_illust.php?id=${t}&p=${e}`)}getUserDojinDoc(t){return this.getDoc(`/members_dojin.php?id=${t}`)}getUserBookmarkDoc(t,e){return this.getDoc(`/user_like_illust_view.php?p=${e}&id=${t}`)}getUserFeedDoc(t){return this.getDoc(`/like_user_view.php?p=${t}`)}getHistoryIllustDoc(){return this.getDoc("/history_illust.php")}getHistoryNuitaDoc(){return this.getDoc("/history_nuita.php")}getOkiniiriDoc(t,e,r){return this.getDoc(`/okiniiri.php?p=${e}&id=${t}&sort=${r}`)}getIllustSearchDoc(t){const{mode:e=0,type:r="partial",sort:a=0,illustType:o=0,period:n=0,userId:i="0",word:s,page:l}=t,c=new URLSearchParams;return c.append("mode",String(e)),c.append("type",String(r)),c.append("sort",String(a)),c.append("illust_type",String(o)),c.append("period",String(n)),c.append("user_id",i),c.append("word",s),c.append("p",String(l)),this.getDoc(`/search.php?${c.toString()}`)}async addBookmark(t,e){const r=new URLSearchParams;r.append("id",t),r.append("tag",(null==e?void 0:e.join(" "))??"");const a="/bookmark_add.php",o=await this.fetch(a,{method:"POST",redirect:"manual",body:r});if("opaqueredirect"!==o.type)throw new Iu(a,o.status)}}class Qp extends hp{constructor(t){super(t),fc(this,"userId"),fc(this,"comment"),fc(this,"score"),this.userId=t.userId,this.comment=t.comment,this.score=t.score}static get supportedTemplate(){return{[sc.ID]:"{id}",[sc.ARTIST]:"{artist}",[sc.ARTISTID]:"{artistID}",[sc.DATE]:"{date} {date(YYYY-MM-DD)}",[sc.PAGE]:"{page}",[sc.SCORE]:"{score}: likeCount",[sc.TAGS]:"{tags}",[sc.TITLE]:"{title}"}}getZipComment(){return this.comment}getTemplateData(t){return{id:this.id,artist:this.normalizeString(this.artist)||this.userId,artistID:this.userId,date:this.createDate,score:String(this.score),title:this.normalizeString(this.title)||this.id,tags:this.tags.join("_"),...t}}create(t){const{filenameTemplate:e,directoryTemplate:r,setProgress:a,useFileSystemAccessApi:o,filenameConflictAction:n}=t,i="index"in t?t.index:0;return{taskId:this.getTaskId(),src:this.getSrc(i),path:this.getSavePath(r,e,this.getExt(i),this.getTemplateData({page:String(i)})),timeout:this.getDownloadTimeout(i),onProgress:a,useFileSystemAccessApi:o,filenameConflictAction:n}}createMulti(t){if(!this.isStringArray(this.src))throw new Error(`Artwork ${this.id} only have one media.`);const{filenameTemplate:e,directoryTemplate:r,setProgress:a,useFileSystemAccessApi:o,filenameConflictAction:n}=t,i=this.getTaskId(),s=a?this.getMultipleMediaDownloadCB(a):void 0;return this.src.map((t,a)=>({taskId:i,src:t,path:this.getSavePath(r,e,this.getExt(a),this.getTemplateData({page:String(a)})),timeout:this.getDownloadTimeout(),onFileSaved:s,useFileSystemAccessApi:o,filenameConflictAction:n}))}createBundle(t){if(!this.isStringArray(this.src)||!this.isStringArray(this.ext))throw new Error(`Artwork ${this.id} only have one media.`);const{filenameTemplate:e,directoryTemplate:r,setProgress:a,useFileSystemAccessApi:o,filenameConflictAction:n}=t,i=this.getTaskId(),s=a?this.getMultipleMediaDownloadCB(a):void 0,l=this.getSavePath(r,e,"zip",this.getTemplateData({page:String(this.src.length)})),c=e.includes(`{${sc.PAGE}}`)?e:e+`_{${sc.PAGE}}`,d=this.src.map((t,e)=>this.getSavePath("",c,this.getExt(e),this.getTemplateData({page:String(e)})));return this.src.map((t,e)=>({taskId:i,src:t,path:l,timeout:this.getDownloadTimeout(e),onXhrLoaded:s,beforeFileSave:this.handleBundleFactory(d),onError:this.handleBundleErrorFactory(),onAbort:this.handleBundleAbortFactory(),useFileSystemAccessApi:o,filenameConflictAction:n}))}}class Xp extends lp{constructor(){null===np.version&&(Zu.setDirectoryTemplate(eu.folderPattern??"nijie/{artist}"),Zu.setFilenameTemplate(eu.filenamePattern??"{artist}_{title}_{id}_p{page}"),tp.$update(t=>({...t,compressMultiIllusts:eu.bundleIllusts??!1,addBookmark:t.addBookmark??!1,bookmarkWithTags:t.bookmarkWithTags??!1}))),np.setThemeWatcher({get current(){return!!document.querySelector('link[type="text/css"][href*="night_mode"]')}}),super(),vc(this,bn),fc(this,"parser",new Vp),fc(this,"api",new Jp({rateLimit:3})),vc(this,vn,new URLSearchParams(location.search)),fc(this,"useBatchDownload",this.app.initBatchDownloader({avatar:()=>{const t=document.querySelector('a[href*="members.php"].name img');return t?t.src:"/pic/icon/nijie.png"},parseMetaByArtworkId:async t=>{const e=await this.api.getViewDoc(t),r=this.parser.buildMetaByView(t,e);if(this.parser.docHasDiff(e)){const e=await this.api.getViewPopupDoc(t),a=this.parser.parseDiffSrcByDoc(e);return this.parser.mergeImageDiff(r,a)}return r},downloadArtworkByMeta:async(t,e)=>{let r;const a={...Zu},o=tp.compressMultiIllusts;r=Array.isArray(t.src)?o?new Qp(t).createBundle(a):new Qp(t).createMulti(a):new Qp(t).create(a),await Ku.download(r,{signal:e});const{id:n,artist:i,userId:s,title:l,comment:c,tags:d}=t,u={pid:Number(n),user:i,userId:Number(s),title:l,comment:c,tags:d};zd.add(u)},filterOption:{filters:[{id:"exclude_downloaded",type:"exclude",name:()=>gu("downloader.category.filter.exclude_downloaded"),checked:!1,fn:t=>!!t.id&&zd.has(t.id)},{id:"allow_image",type:"include",name:()=>gu("downloader.category.filter.image"),checked:!0,fn:t=>void 0!==t.extendName&&(Array.isArray(t.extendName)?t.extendName.some(t=>Lu.imageExt.test(t)):Lu.imageExt.test(t.extendName))},{id:"allow_video",type:"include",name:()=>gu("downloader.category.filter.video"),checked:!0,fn:t=>void 0!==t.extendName&&(Array.isArray(t.extendName)?t.extendName.some(t=>Lu.videoExt.test(t)):Lu.videoExt.test(t.extendName))}],enableTagFilter:!0},pageOption:{illusts:{name:"投稿イラスト",match:t=>yc(this,bn,_n).call(this,t),filterInGenerator:!1,fn:t=>{const e=yc(this,bn,En).call(this);if(!e)throw new Error("Invalid user ID.");return this.parser.paginationGenerator(t,async t=>{const r=await this.api.getUserIllustsDoc(e,t);return{lastPage:!this.parser.docHasNextPagination(r),data:this.parser.parseUserPageArtworkIdByDoc(r)}},t=>t)}},dojin:{name:"同人",match:t=>yc(this,bn,_n).call(this,t),filterInGenerator:!1,fn:()=>{const t=yc(this,bn,En).call(this);if(!t)throw new Error("Invalid user ID.");return this.parser.paginationGenerator([1,1],async()=>{const e=await this.api.getUserDojinDoc(t);return{lastPage:!0,data:this.parser.parseUserPageArtworkIdByDoc(e)}},t=>t)}},bookmark:{name:"ブックマーク",match:t=>yc(this,bn,_n).call(this,t),filterInGenerator:!1,fn:t=>{const e=yc(this,bn,En).call(this);if(!e)throw new Error("Invalid user ID.");return this.parser.paginationGenerator(t,async t=>{const r=await this.api.getUserBookmarkDoc(e,t);return{lastPage:!this.parser.docHasNextPagination(r),data:this.parser.parseUserPageArtworkIdByDoc(r)}},t=>t)}},feed:{name:"新着2次絵",match:/like_user_view\.php/,filterInGenerator:!1,fn:t=>this.parser.paginationGenerator(t,async t=>{const e=await this.api.getUserFeedDoc(t);return{lastPage:!this.parser.docHasNextPagination(e),data:this.parser.parseUserFeedArtworkIdByDoc(e)}},t=>t)},nuita:{name:"抜いた",match:t=>yc(this,bn,An).call(this,t),filterInGenerator:!1,fn:()=>this.parser.paginationGenerator([1,1],async()=>{const t=await this.api.getHistoryNuitaDoc();return{lastPage:!0,data:this.parser.parseHistoryNuitaArtworkIdByDoc(t)}},t=>t)},history:{name:"閲覧",match:t=>yc(this,bn,An).call(this,t),filterInGenerator:!1,fn:()=>this.parser.paginationGenerator([1,1],async()=>{const t=await this.api.getHistoryIllustDoc();return{lastPage:!0,data:this.parser.parseHistoryIllustArtworkIdByDoc(t)}},t=>t)},okiniiri:{name:"お気に入り",match:/okiniiri\.php/,filterInGenerator:!1,fn:t=>{const e=wc(this,vn).get("id")??"0",r=wc(this,vn).get("sort")??"0";if("0"!==r&&"1"!==r)throw new RangeError('Invalid sort params, must be "0" or "1"');return this.parser.paginationGenerator(t,async t=>{const a=await this.api.getOkiniiriDoc(e,String(t),r);return{lastPage:!this.parser.docHasNextPagination(a),data:this.parser.parseOkiniiriArtworkIdByDoc(a)}},t=>t)}},userIllustTagSearch:{name:"イラスト検索",match:/search\.php.+user_id=[0-9]+/,filterInGenerator:!1,fn:t=>{const e=Number(wc(this,vn).get("mode")),r=wc(this,vn).get("type")||void 0,a=Number(wc(this,vn).get("sort")),o=Number(wc(this,vn).get("illust_type")),n=Number(wc(this,vn).get("p")),i=wc(this,vn).get("user_id"),s=wc(this,vn).get("word")??"";if(!i)throw new Error("User id is required.");return this.parser.paginationGenerator(t,async t=>{const l=await this.api.getIllustSearchDoc({mode:e,type:r,sort:a,illustType:o,period:n,userId:i,word:s,page:t});return{lastPage:!this.parser.docHasNextPagination(l),data:this.parser.parseSearchArtworkIdByDoc(l)}},t=>t)}}}}))}static get hostname(){return"nijie.info"}getSupportedTemplate(){return Qp.supportedTemplate}async downloadArtwork(t){const{id:e,page:r}=t.dataset;let a,o;a=yc(this,bn,yn).call(this)&&e===yc(this,bn,En).call(this)?document:await this.api.getViewDoc(e);const n=this.parser.buildMetaByView(e,a),{userId:i,comment:s,tags:l,artist:c,title:d,isBookmarked:u}=n;!u&&tp.addBookmark&&yc(this,bn,Sn).call(this,e,tp.bookmarkWithTags?l:void 0);const p={...Zu,setProgress:e=>{t.setProgress(e)}},h=r?+r:void 0;let g;if(0!==h&&this.parser.docHasDiff(a)){o=yc(this,bn,xn).call(this)&&e===yc(this,bn,En).call(this)?document:await this.api.getViewPopupDoc(e);const t=this.parser.parseDiffSrcByDoc(o),r=this.parser.mergeImageDiff(n,t);g=h?new Qp(r).create({...p,index:h}):tp.compressMultiIllusts?new Qp(r).createBundle(p):new Qp(r).createMulti(p)}else g=new Qp(n).create(p);await Ku.download(g,{priority:1});const f={pid:Number(e),user:c,userId:Number(i),title:d,comment:s,tags:l};void 0!==r&&(f.page=Number(r)),zd.add(f)}createThumbnailBtn(){const t={thumbnails:{selector:"p.nijiedao:has(> img.ngtag)",setStyle:void 0,diff:void 0},memberAndHotImage:{selector:"p.nijiedao > a:has(img.ngtag)",setStyle:t=>{t.style.display="inline-block"},diff:void 0},imgDiff:{selector:'a[href*="#diff_"]:has(img.ngtag:not([data-original]))',setStyle:t=>{const e=t.querySelector("img"),r=getComputedStyle(e).margin;e.style.margin="0px",t.style.display="inline-block",t.style.margin=r},diff:t=>{var e;return null==(e=new RegExp("(?<=#diff_)[0-9]+$").exec(t.href))?void 0:e[0]}},dojinDiff:{selector:'a[href*="#diff_"]:has(img[data-original].ngtag)',setStyle:t=>{t.querySelector("img").style.width="auto",t.style.display="inline-block"},diff:t=>{var e;return null==(e=new RegExp("(?<=#diff_)[0-9]+$").exec(t.href))?void 0:e[0]}},otherDojin:{selector:'a[href*="id="]:has(>.other_dojin_block)',setStyle:t=>{t.style.display="block"},diff:void 0},similar:{selector:"#nuitahito li:has(img.ngtag)",setStyle:void 0,diff:void 0},rank:{selector:"p.illust:has(> img.ngtag)",setStyle:t=>{const e=t.previousElementSibling;e&&(e.style.zIndex="1")},diff:void 0},dictionary:{selector:'a[href*="id="]:has(> :is(img.tagsimage, img.mozamoza:not([illust_id])))',setStyle:t=>{const e=t.querySelector("img"),r=getComputedStyle(e).width;t.style.width=r,e.style.width="100%",t.style.display="inline-block"},diff:void 0},responseOdai:{selector:'#response_odai li a[href*="id="]:has(img)',setStyle:t=>{t.style.display="inline-block"},diff:void 0},historyIllust:{selector:'.history_block > .picture > a[href*="id="]:has(img)',setStyle:t=>{t.style.display="inline-block"},diff:void 0}};for(const{selector:e,setStyle:r,diff:a}of Object.values(t)){const t=document.querySelectorAll(e);t.length&&t.forEach(t=>{if(t.querySelector(Hd.tagNameLowerCase))return;let e;e=t instanceof HTMLAnchorElement?new RegExp("(?<=id=)[0-9]+").exec(t.href)[0]:t.querySelector("img.ngtag").getAttribute("illust_id");const o=null==a?void 0:a(t);null==r||r(t),t.style.position="relative",t.appendChild(new Hd({id:e,page:o?+o:void 0,onClick:this.downloadArtwork}))})}}createIllustSettingBtn(){const t=yc(this,bn,En).call(this),e=document.querySelector("#illust_setting");t&&e&&e.appendChild(new Hd({id:t,type:Ai.NijieIllust,onClick:this.downloadArtwork}))}createImgFilterBtn(){const t=yc(this,bn,En).call(this),e=document.querySelectorAll("#img_filter");if(t&&e.length){if(1===e.length){if(e[0].dataset.index)return;if(!document.querySelector('#img_diff > a[href*="diff_"]'))return}e.forEach((e,r)=>{const a=e.querySelector('img[src*="pic.nijie.net"], video');if(!a)return;const{marginBottom:o}=getComputedStyle(a);e.style.marginBottom=o,a.style.marginBottom="0px";const n=e.querySelector("img.filter");n&&(n.style.zIndex="auto"),e.appendChild(new au({id:t,page:r,site:"nijie",onClick:this.downloadArtwork}))})}}createDojinHeaderBtn(){const t=document.querySelector("#dojin_header > .right > ul"),e=yc(this,bn,En).call(this);t&&e&&t.appendChild(new Hd({id:e,type:Ai.NijieIllust,onClick:this.downloadArtwork}))}createDojinCoverBtn(){const t=document.querySelector('#dojin_left .image > a[href*="view_popup"]'),e=yc(this,bn,En).call(this);t&&e&&(t.style.display="inline-block",t.style.position="relative",t.style.width="fit-content",t.appendChild(new au({id:e,page:0,onClick:this.downloadArtwork})))}createOdaiBtn(){const t=yc(this,bn,En).call(this),e=document.querySelector("#gallery_new > p > a:has(img#view_img)");if(!t||!e)return;const r=e.querySelector("img:not(.filter)"),{marginBottom:a}=getComputedStyle(r);r.style.marginBottom="0px",e.style.marginBottom=a,e.style.display="inline-block",e.style.position="relative",e.appendChild(new au({id:t,page:0,onClick:this.downloadArtwork}))}observeOzakuListChange(){const t=document.querySelector("#okazu_list");t&&new MutationObserver(()=>this.createThumbnailBtn()).observe(t,{subtree:!0,childList:!0})}inject(){super.inject(),this.downloadArtwork=this.downloadArtwork.bind(this),this.createThumbnailBtn(),yc(this,bn,yn).call(this)?(this.createIllustSettingBtn(),this.createImgFilterBtn(),this.createDojinHeaderBtn(),this.createDojinCoverBtn(),this.createOdaiBtn()):yc(this,bn,xn).call(this)?(this.createIllustSettingBtn(),this.createImgFilterBtn()):yc(this,bn,kn).call(this)&&this.observeOzakuListChange()}}vn=new WeakMap,bn=new WeakSet,yn=function(){return"/view.php"===location.pathname},xn=function(){return"/view_popup.php"===location.pathname},kn=function(){return"/okazu.php"===location.pathname},_n=function(t){return/members\.php|members_illust\.php|members_dojin\.php|user_like_illust_view\.php/.test(t)},An=function(t){return/history_nuita\.php|history_illust\.php/.test(t)},En=function(){return wc(this,vn).get("id")},Sn=async function(t,e){var r;try{if(await this.api.addBookmark(t,e),(yc(this,bn,yn).call(this)||yc(this,bn,xn).call(this))&&yc(this,bn,En).call(this)===t){const t=document.querySelector("a#bukuma-do");if(!t)return;t.id="bukuma",t.setAttribute("href",t.getAttribute("href").replace("bookmark.php","bookmark_edit.php")),null==(r=t.lastChild)||r.remove();const e=document.createElement("span");e.textContent="ブックマーク編集",t.appendChild(e)}}catch(t){Ld.error(t)}};class Kp extends gp{static get supportedTemplate(){return{[sc.ID]:"{id}",[sc.ARTIST]:"{artist}",[sc.CHARACTER]:"{character}",[sc.DATE]:"{date}, {date(YYYY-MM-DD)}",[sc.SCORE]:"{score}"}}getTemplateData(){return{id:this.id,artist:this.artist,character:this.character,date:this.createDate,score:String(this.score)}}create(t){return super.create({...t,cfClearance:void 0})}}dc=(t=>(t[t.JPG=0]="JPG",t[t.MP4=1]="MP4",t))(dc||{}),uc=(t=>(t[t.GENERAL=1]="GENERAL",t[t.COPYRIGHT=2]="COPYRIGHT",t[t.CHARACTER=4]="CHARACTER",t[t.ARTIST=8]="ARTIST",t))(uc||{}),pc=(t=>(t[t.LATEST=0]="LATEST",t[t.TOP_RATED=1]="TOP_RATED",t[t.MOST_VIEWED=2]="MOST_VIEWED",t))(pc||{});class Zp extends mp{constructor(){super(...arguments),vc(this,Cn)}getPostData(t){return this.getJSON(`/api/v2/post/${t}`)}getUserProfile(t){return this.getJSON(`/api/v2/account/user/${t}`)}searchPlaylist(t,e,r){return yc(this,Cn,Pn).call(this,`/api/v2/post/search/playlist/${t}`,e,r)}searchTags(t,e){return yc(this,Cn,Pn).call(this,"/api/v2/post/search/root",t,e)}searchUserBookmark(t,e,r){return yc(this,Cn,Pn).call(this,`/api/v2/post/search/bookmarked/${t}`,e,r)}searchUserSubscriptions(t,e,r){return yc(this,Cn,Pn).call(this,`/api/v2/post/search/tag-subscriptions/${t}`,{...e,sortBy:0},r)}addBookmark(t,e){return this.getJSON("/api/v2/post/action/bookmark",{method:"POST",headers:{"content-type":"application/json; charset=utf-8",authorization:`Bearer ${e}`},body:`{"postId":${t}}`})}}Cn=new WeakSet,Pn=function(t,e,r){return this.getJSON(t,{method:"POST",headers:{"content-type":"application/json; charset=utf-8",...r?{authorization:`Bearer ${r}`}:{}},body:JSON.stringify(e)})};class th extends cp{constructor(){super(...arguments),vc(this,In,{[uc.GENERAL]:"general",[uc.COPYRIGHT]:"copyright",[uc.CHARACTER]:"character",[uc.ARTIST]:"artist"})}buildMeta(t){const{id:e,type:r,data:a,posted:o,likes:n=0,tags:i}=t,s=[],l=[],c=[],d=[];for(const{value:t,type:e}of i){s.push(t);const r=t.replaceAll(" ","_");l.push(`${wc(this,In)[e]}:${r}`),e===uc.ARTIST?c.push(r):e===uc.CHARACTER&&d.push(r)}const u=r===dc.JPG?"jpg":"mp4",p=`https://r34xyz.b-cdn.net/posts/${e/1e3|0}/${e}/${e}.${u}`;return{id:String(e),src:p,extendName:u,artist:c.join(",")||this.UNKNOWN_ARTIST,character:d.join(",")||this.UNKNOWN_CHARACTER,tags:s,tagsToStore:l,score:n,source:a.sources?a.sources.join("\n"):"",createDate:o,title:""}}getCurrentUserToken(){return localStorage.getItem("token")||void 0}getCurrentUserProfile(){const t=localStorage.getItem("user");return t?JSON.parse(t):void 0}}In=new WeakMap;class eh extends lp{constructor(){null===np.version&&(Zu.setDirectoryTemplate("Rule34Vault/{artist}"),Zu.setFilenameTemplate("{id}_{artist}_{character}"),ru.$update(t=>({...t,thumbnailBtnUnitY:Ci.PX,"--pdl-btn-left-percent":100,"--pdl-btn-top-px":40})),tp.addBookmark??(tp.addBookmark=!1)),super(),vc(this,Bn),fc(this,"api",new Zp),fc(this,"parser",new th),fc(this,"pageType",["app-home-page","app-post-page","app-highest-posts-page","app-hot-posts-page","app-playlists-page","app-playlist-page","app-comments-page","app-upgrade-to-premium-page","app-user-page","app-feed-page","app-sign-in-page","app-sign-up-page"]),vc(this,Tn),vc(this,$n),fc(this,"useBatchDownload",this.app.initBatchDownloader({avatar:async t=>{try{let e;e=/\/playlists\/view\/[0-9]+/.test(t)?await function(t,e=3e3){const r=document.querySelector(t);return r?Promise.resolve(r):new Promise(r=>{let a;const o=new MutationObserver(()=>{const e=document.querySelector(t);e&&(r(e),o.disconnect(),a&&clearTimeout(a))});o.observe(document,{childList:!0,subtree:!0}),a=setTimeout(()=>{r(null),o.disconnect()},e)})}("app-playlist-page-content app-user-avatar div.img"):document.body.querySelector("mat-sidenav app-user-avatar div.img");const r=e.getAttribute("style");return new RegExp('(?<=url\\(").+(?="\\))').exec(r)[0]}catch(t){return"/assets/icons/icon-512x512.png"}},parseMetaByArtworkId:async t=>{const e=await this.api.getPostData(t);return this.parser.buildMeta(e)},downloadArtworkByMeta:async(t,e)=>{const r=new Kp(t).create({...Zu});await Ku.download(r,{signal:e});const{id:a,tagsToStore:o,artist:n,title:i,source:s}=t;zd.add({pid:Number(a),user:n,title:i,tags:o,source:s})},filterOption:{filters:[{id:"exclude_downloaded",type:"exclude",name:()=>gu("downloader.category.filter.exclude_downloaded"),checked:!1,fn:t=>!!t.id&&zd.has(t.id)},{id:"allow_image",type:"include",name:()=>gu("downloader.category.filter.image"),checked:!0,fn:t=>!!t.extendName&&Lu.imageExt.test(t.extendName)},{id:"allow_video",type:"include",name:()=>gu("downloader.category.filter.video"),checked:!0,fn:t=>!!t.extendName&&Lu.videoExt.test(t.extendName)}],enableTagFilter:!0},pageOption:{playlist:{name:"Playlist",match:()=>"app-playlist-page"===wc(this,Tn).current,filterInGenerator:!1,fn:t=>{const e=new RegExp("(?<=\\/playlists\\/view\\/)[0-9]+").exec(location.pathname);if(!e)throw new Error("Cannot get playlist id.");const r=e[0],a=this.parser.getCurrentUserToken();let o;return this.parser.paginationGenerator(t,async t=>{const e={checkHasMore:!0,countTotal:!1,skip:30*(t-1),take:30};o&&(e.cursor=o);const{cursor:n,hasMore:i,items:s}=await this.api.searchPlaylist(r,e,a);return o=n,{lastPage:!i,data:s}},t=>String(t.id))}},tagSearch:{name:"All Posts",match:()=>"app-home-page"===wc(this,Tn).current,filterInGenerator:!1,fn:t=>{const{includeTags:e,sortBy:r,type:a}=yc(this,Bn,Dn).call(this),o=this.parser.getCurrentUserToken();let n;return this.parser.paginationGenerator(t,async t=>{const i={includeTags:e,sortBy:r,checkHasMore:!0,countTotal:!0,skip:30*(t-1),take:30};n&&(i.cursor=n),void 0!==a&&(i.type=a);const{cursor:s,hasMore:l,items:c}=await this.api.searchTags(i,o);return n=s,{lastPage:!l,data:c}},t=>String(t.id))}},bookmarkSearch:{name:"Bookmarks",match:()=>"app-home-page"===wc(this,Tn).current,filterInGenerator:!1,fn:t=>{var e;const r=this.parser.getCurrentUserToken(),a=null==(e=this.parser.getCurrentUserProfile())?void 0:e.id;if(!r||!a)throw new Error("Please sign in.");const{includeTags:o,sortBy:n,type:i}=yc(this,Bn,Dn).call(this);let s;return this.parser.paginationGenerator(t,async t=>{const e={includeTags:o,sortBy:n,checkHasMore:!0,countTotal:!0,skip:30*(t-1),take:30};s&&(e.cursor=s),void 0!==i&&(e.type=i);const{cursor:l,hasMore:c,items:d}=await this.api.searchUserBookmark(String(a),e,r);return s=l,{lastPage:!c,data:d}},t=>String(t.id))}},subscriptionSearch:{name:"Subscriptions",match:()=>"app-home-page"===wc(this,Tn).current,filterInGenerator:!1,fn:t=>{var e;const r=this.parser.getCurrentUserToken(),a=null==(e=this.parser.getCurrentUserProfile())?void 0:e.id;if(!r||!a)throw new Error("Please sign in.");const{includeTags:o,type:n}=yc(this,Bn,Dn).call(this);let i;return this.parser.paginationGenerator(t,async t=>{const e={includeTags:o,checkHasMore:!0,countTotal:!0,skip:30*(t-1),take:30};i&&(e.cursor=i),void 0!==n&&(e.type=n);const{cursor:s,hasMore:l,items:c}=await this.api.searchUserSubscriptions(String(a),e,r);return i=s,{lastPage:!l,data:c}},t=>String(t.id))}}}})),bc(this,Tn,new Eu(()=>document.querySelector(this.pageType.join(",")).tagName.toLowerCase(),t=>(bc(this,$n,t),()=>{bc(this,$n,void 0)})))}static get hostname(){return"rule34vault.com"}getSupportedTemplate(){return Kp.supportedTemplate}inject(){super.inject();const t=document.querySelector("app-root");t&&new MutationObserver(t=>{const e=Hd.tagNameLowerCase.toUpperCase(),r=t.filter(t=>"childList"===t.type&&t.addedNodes.length).flatMap(t=>Array.from(t.addedNodes)).filter(t=>t.nodeType===Node.ELEMENT_NODE&&t.tagName!==e);if(!r.length)return;const a=t=>{var e;return(null==(e=new RegExp("(?<=\\/post\\/)[0-9]+$").exec(t.getAttribute("href")))?void 0:e[0])??""};r.forEach(t=>{switch(!0){case t.matches('a[href^="/post/"].box'):{const e=a(t);if(!e)return;yc(this,Bn,Ln).call(this,e,t.querySelector("div.box-inner"));break}case t.matches('a[href^="/post/"].masonry-item'):{const e=a(t);if(!e)return;yc(this,Bn,Ln).call(this,e,t);break}case t.matches('div.post-con:has(a[href^="/post/"])'):{const e=t.querySelector('a[href^="/post/"]'),r=a(e);if(!r)return;yc(this,Bn,Ln).call(this,r,t.querySelector("div.con"));break}case t.matches("app-post-page-content, app-tag-list"):yc(this,Bn,On).call(this);break;case t.matches(this.pageType.join(",")):if(!wc(this,$n))throw new TypeError("Type of #notifyPageChange is undefined.");wc(this,$n).call(this)}})}).observe(t,{subtree:!0,childList:!0})}}Tn=new WeakMap,$n=new WeakMap,Bn=new WeakSet,Dn=function(){const t=new URLSearchParams(location.search),e=t.get("sort"),r=t.get("type"),a="likes"===e?pc.TOP_RATED:"views"===e?pc.MOST_VIEWED:pc.LATEST,o="image"===r?dc.JPG:"video"===r?dc.MP4:void 0,n=location.pathname.slice(1);return{includeTags:n?decodeURIComponent(decodeURIComponent(n)).replaceAll("_"," ").split("|"):[],sortBy:a,type:o}},Nn=async function(t){try{const e=this.parser.getCurrentUserToken();if(!e)throw new Error("Token not found, please sign in");await this.api.addBookmark(t,e),this.toast({message:"You have favorited this post",timeout:2e3})}catch(t){Ld.error(t),this.toast({message:t.message,type:"error"})}},Mn=async function(t){const e=t.dataset.id,r=await this.api.getPostData(e),a=this.parser.buildMeta(r),o=new Kp(a).create({...Zu,setProgress:e=>{t.setProgress(e)}});tp.addBookmark&&yc(this,Bn,Nn).call(this,e),await Ku.download(o,{priority:1});const{tagsToStore:n,artist:i,title:s,source:l}=a;zd.add({pid:Number(e),user:i,title:s,tags:n,source:l})},On=function(){var t;const e=null==(t=new RegExp("(?<=\\/post\\/)[0-9]+").exec(location.pathname))?void 0:t[0];if(!e)return;const r=document.querySelector("app-post-actions div.con");if(!r)return;const a=r.querySelector(Hd.tagNameLowerCase);if(a)a.dataset.id=e;else{const t=document.createElement("div");t.setAttribute("style","margin-right: 8px;"),t.classList.add("chip"),t.appendChild(new Hd({id:e,type:Ai.Rule34VaultPostAction,onClick:t=>yc(this,Bn,Mn).call(this,t)})),r.insertBefore(t,r.firstElementChild)}},Ln=function(t,e){e.querySelector(Hd.tagNameLowerCase)||e.appendChild(new Hd({id:t,onClick:t=>yc(this,Bn,Mn).call(this,t)}))};class rh extends mp{getPostViewDoc(t){return this.getDoc(`/post/view/${t}`)}getPostListDoc(t,e){let r="/post/list/";return r+=void 0!==e?`${e}/${t}`:String(t),this.getDoc(r)}}class ah extends cp{constructor(){super(...arguments),vc(this,jn)}buildMetaByDoc(t,e){var r;const a=e.querySelector("#main_image");if(!a)throw new Error("Cannot find media element.");let o,n;if("IMG"===a.tagName){const t=a.getAttribute("data-mime");if(!t)throw new Error("Cannot get mimetype.");n=t.split("/")[1],o=a.src}else{const t=a.querySelector("source");if(!t)throw new Error("Cannot get video source.");const e=t.getAttribute("type");if(!e)throw new Error("Cannot get mimetype.");n=e.split("/")[1],o=t.src}const i=o.slice(o.lastIndexOf("/")+1),s=Array.from(e.querySelectorAll('tr[data-row="Tags"] .tag')).map(t=>t.textContent.toLowerCase()),l=null==(r=e.querySelector('tr[data-row="Uploader"] time'))?void 0:r.dateTime;if(!l)throw new Error("Cannot get upload date.");const c=e.querySelector('tr[data-row="Source Link"] td a');return{id:t,src:o,extendName:n,artist:"",title:i,tags:s,createDate:l,source:(null==c?void 0:c.href)||""}}buildMetasByPostsListDoc(t){const e=t.querySelectorAll(".shm-image-list  .shm-thumb.thumb");return e.length?Array.from(e).map(t=>yc(this,jn,Rn).call(this,t)):[]}docHasNextPage(t){return Array.from(t.querySelectorAll("#paginator a")).some(t=>"Next"===t.textContent)}}jn=new WeakSet,Rn=function(t){const e=t.querySelector("img"),r=t.querySelector('a[href*="r34i.paheal-cdn.net"]');if(!e||!r)throw new Error("Cannot find image or flie link.");const a=r.href,o=a.slice(a.lastIndexOf("/")+1),{ext:n,tags:i,postId:s}=t.dataset,l=e.title.split("\n"),c=l[l.length-1];return{id:s,src:a,extendName:n,artist:"",title:o,tags:i.split(" "),createDate:c}};class oh extends pp{constructor(t){super(t)}static get supportedTemplate(){return{[sc.ID]:"{id}",[sc.DATE]:"{date}, {date(YYYY-MM-DD)}",[sc.TAGS]:"{tags}",[sc.MD5]:"{md5}"}}getTemplateData(){return{id:this.id,tags:this.tags.join(" "),date:this.createDate,md5:this.title}}create(t){const{filenameTemplate:e,filenameConflictAction:r,directoryTemplate:a,useFileSystemAccessApi:o,setProgress:n}=t;return{taskId:this.getTaskId(),src:this.getSrc(),path:this.getSavePath(a,e,this.getExt(),this.getTemplateData()),timeout:this.getDownloadTimeout(),onProgress:n,useFileSystemAccessApi:o,filenameConflictAction:r}}}class nh extends lp{constructor(){null===np.version&&Zu.setDirectoryTemplate("Rule34Paheal"),super(),vc(this,qn),vc(this,Fn,new rh),vc(this,zn,new ah),fc(this,"useBatchDownload",this.app.initBatchDownloader({avatar:"/favicon.ico",parseMetaByArtworkId:async t=>{const e=await wc(this,Fn).getPostViewDoc(t);return wc(this,zn).buildMetaByDoc(t,e)},downloadArtworkByMeta:async(t,e)=>{const r=new oh(t).create({...Zu});await Ku.download(r,{signal:e});const{tags:a,title:o,source:n,id:i}=t;zd.add({pid:Number(i),title:o,tags:a,source:n})},filterOption:{filters:[{id:"exclude_downloaded",type:"exclude",name:()=>gu("downloader.category.filter.exclude_downloaded"),checked:!1,fn:t=>!!t.id&&zd.has(t.id)},{id:"allow_image",type:"include",name:()=>gu("downloader.category.filter.image"),checked:!0,fn:t=>!!t.extendName&&Lu.imageExt.test(t.extendName)},{id:"allow_video",type:"include",name:()=>gu("downloader.category.filter.video"),checked:!0,fn:t=>!!t.extendName&&Lu.videoExt.test(t.extendName)}],enableTagFilter:!0},pageOption:{posts:{name:"Posts",match:()=>yc(this,qn,Hn).call(this),filterInGenerator:!0,fn:(t,e)=>{if(t&&t[0]>500)throw new Error("Only 500 pages of results are searchable");const r=location.pathname.slice(11),[a,o]=r.split("/");let n;return n=void 0===o&&/^[0-9]+$/.test(a)||""===a?void 0:a,wc(this,zn).paginationGenerator(t,async t=>{const e=await wc(this,Fn).getPostListDoc(t,n);return{lastPage:!wc(this,zn).docHasNextPage(e),data:wc(this,zn).buildMetasByPostsListDoc(e)}},t=>t.id,async t=>await e(t)?ic.VALID:ic.INVALID)}}}}))}static get hostname(){return"rule34.paheal.net"}getSupportedTemplate(){return oh.supportedTemplate}inject(){super.inject(),yc(this,qn,Wn).call(this)?yc(this,qn,Gn).call(this):yc(this,qn,Yn).call(this)}}Fn=new WeakMap,zn=new WeakMap,qn=new WeakSet,Hn=function(){return location.pathname.startsWith("/post/list")},Wn=function(){return/\/post\/view\/[0-9]+/.test(location.pathname)},Un=async function(t){const e=t.dataset.id,r=await wc(this,Fn).getPostViewDoc(e),a=wc(this,zn).buildMetaByDoc(e,r),o=new oh(a).create({...Zu,setProgress:e=>{t.setProgress(e)}});await Ku.download(o,{priority:1});const{tags:n,title:i,source:s}=a;zd.add({pid:Number(e),title:i,tags:n,source:s})},Gn=function(){const t=new RegExp("(?<=view\\/)[0-9]+").exec(location.pathname);if(!t)return;const e=t[0],r=document.querySelector(":is(#Imagemain, #Videomain) .blockbody"),a=document.querySelector("#main_image");if(!r||!a)throw new Error("Cannot find container or media.");const o=document.createElement("div");o.classList.add("pdl-wrapper"),o.appendChild(a),o.appendChild(new au({id:e,site:"VIDEO"===a.tagName?"native_video":void 0,onClick:t=>yc(this,qn,Un).call(this,t)})),r.appendChild(o);const n=new CSSStyleSheet;n.replaceSync(".pdl-wrapper { position: relative; width: fit-content; margin: 0 auto; font-size: 0px; } #main_image { max-width: 100% !important; }"),document.adoptedStyleSheets=[...document.adoptedStyleSheets,n]},Yn=function(){const t=document.querySelectorAll(".shm-thumb.thumb");t.length&&t.forEach(t=>{const e=t.dataset.postId;if(!e)throw new Error("Cannot get post id.");const r=t.querySelector("a.shm-thumb-link");if(!r)throw new Error("Cannot find button container");r.setAttribute("style","display: inline-block; position: relative; font-size: 0px;"),r.appendChild(new Hd({id:e,onClick:t=>yc(this,qn,Un).call(this,t)}))})};class ih extends mp{getPostViewDoc(t){return this.getDoc(`/index.php?r=posts/view&id=${t}`)}getPostListDoc(t,e="all"){return this.getDoc(`/index.php?r=posts/index&page=${t}&q=${e}`)}getFavoritesDoc(t,e){return this.getDoc(`/index.php?r=favorites/view&id=${t}&page=${e}`)}addBookmark(t){return this.fetch(`/index.php?r=favorites/create&id=${t}`)}}class sh extends cp{constructor(){super(...arguments),vc(this,Vn)}buildMetaByDoc(t,e){var r;const a=e.querySelector(".content_push > :is(video, img[width])");if(!a)throw new Error("Cannot find media element.");let o;if("IMG"===a.tagName)o=a.src;else{const t=a.querySelector("source");if(t)o=t.src;else{if(!a.src)throw new Error("Cannot get src of the video");o=a.src}}const[n,i]=o.slice(o.lastIndexOf("/")+1).split("."),s=e.querySelector("ul.tag-list-left"),l=yc(this,Vn,Jn).call(this,s,"ul > .artist-tag > a"),c=yc(this,Vn,Jn).call(this,s,"ul > .character-tag > a"),d=yc(this,Vn,Jn).call(this,s,"ul > .copyright-tag > a"),u=yc(this,Vn,Jn).call(this,s,"ul > .metadata-tag > a"),p=yc(this,Vn,Jn).call(this,s,"ul > .general-tag > a"),h=[...l,...c,...d,...u,...p],g=[...l.map(t=>"artist:"+t),...c.map(t=>"character:"+t),...d.map(t=>"copyright:"+t),...u.map(t=>"metadata:"+t),...p.map(t=>"general:"+t)],f=null==(r=s.querySelector('span[id^="psc"]'))?void 0:r.textContent;return{id:t,src:o,extendName:i,title:n,artist:l.join(",")||this.UNKNOWN_ARTIST,character:c.join(",")||this.UNKNOWN_CHARACTER,tags:h,tagsWithType:g,createDate:"",score:f?+f:0,source:""}}parsePostIdsByDoc(t){const e=t.querySelectorAll('a[href*="posts/view&id="]');return e.length?Array.from(e).map(t=>{const e=new RegExp("(?<=id=)[0-9]+$").exec(t.href);if(!e)throw new Error("Cannot match post id.");return e[0]}):[]}}Vn=new WeakSet,Jn=function(t,e){return Array.from(t.querySelectorAll(e)).map(t=>t.textContent.replaceAll(" ","_"))};class lh extends gp{static get supportedTemplate(){return{[sc.ID]:"{id}",[sc.ARTIST]:"{artist}",[sc.CHARACTER]:"{character}",[sc.MD5]:"{md5}",[sc.SCORE]:"{score}"}}getTemplateData(){return{id:this.id,artist:this.artist,character:this.character,md5:this.title,title:this.title,score:String(this.score)}}}class ch extends lp{constructor(){null===np.version&&(Zu.setDirectoryTemplate("Rule34us/{artist}"),tp.addBookmark??(tp.addBookmark=!1)),super(),vc(this,Zn),vc(this,Qn,new ih),vc(this,Xn,new sh),vc(this,Kn,new URLSearchParams(location.search)),fc(this,"useBatchDownload",this.app.initBatchDownloader({avatar:"/v1/counter/7.gif",parseMetaByArtworkId:async t=>{const e=await wc(this,Qn).getPostViewDoc(t);return wc(this,Xn).buildMetaByDoc(t,e)},downloadArtworkByMeta:async(t,e)=>{const r=new lh(t).create({...Zu});await Ku.download(r,{signal:e});const{tagsWithType:a,title:o,artist:n,id:i}=t;zd.add({pid:Number(i),title:o,tags:a,user:n})},filterOption:{filters:[{id:"exclude_downloaded",type:"exclude",name:()=>gu("downloader.category.filter.exclude_downloaded"),checked:!1,fn:t=>!!t.id&&zd.has(t.id)},{id:"allow_image",type:"include",name:()=>gu("downloader.category.filter.image"),checked:!0,fn:t=>!!t.extendName&&Lu.imageExt.test(t.extendName)},{id:"allow_video",type:"include",name:()=>gu("downloader.category.filter.video"),checked:!0,fn:t=>!!t.extendName&&Lu.videoExt.test(t.extendName)}],enableTagFilter:!0},pageOption:{posts:{name:"Posts",match:()=>yc(this,Zn,ti).call(this),filterInGenerator:!1,fn:t=>{const e=yc(this,Zn,ai).call(this)||void 0;return wc(this,Xn).paginationGenerator(t,async t=>{const r=await wc(this,Qn).getPostListDoc(t-1,e),a=wc(this,Xn).parsePostIdsByDoc(r);return{lastPage:a.length<42,data:a}},t=>t)}},favorites:{name:"Favorites",match:()=>yc(this,Zn,ri).call(this),filterInGenerator:!1,fn:t=>{const e=yc(this,Zn,oi).call(this);if(!e)throw new Error("Cannot get user id.");return wc(this,Xn).paginationGenerator(t,async t=>{const r=await wc(this,Qn).getFavoritesDoc(e,t-1),a=wc(this,Xn).parsePostIdsByDoc(r);return{lastPage:a.length<30,data:a}},t=>t)}}}}))}static get hostname(){return"rule34.us"}getSupportedTemplate(){return lh.supportedTemplate}inject(){super.inject(),yc(this,Zn,ei).call(this)?yc(this,Zn,li).call(this):yc(this,Zn,si).call(this)}}Qn=new WeakMap,Xn=new WeakMap,Kn=new WeakMap,Zn=new WeakSet,ti=function(){return"posts/index"===wc(this,Kn).get("r")},ei=function(){return"posts/view"===wc(this,Kn).get("r")},ri=function(){return"favorites/view"===wc(this,Kn).get("r")},ai=function(){return wc(this,Kn).get("q")},oi=function(){return wc(this,Kn).get("id")},ni=function(t){Ni.addFav(t)},ii=async function(t){const e=t.dataset.id,r=await wc(this,Qn).getPostViewDoc(e),a=wc(this,Xn).buildMetaByDoc(e,r),o=new lh(a).create({...Zu,setProgress:e=>{t.setProgress(e)}});tp.addBookmark&&yc(this,Zn,ni).call(this,e),await Ku.download(o,{priority:1});const{tagsWithType:n,title:i,artist:s}=a;zd.add({pid:Number(e),title:i,tags:n,user:s})},si=function(){const t=document.querySelectorAll('a[href*="posts/view&id="]');if(!t.length)return;const e=!yc(this,Zn,ri).call(this);t.forEach(t=>{const r=new RegExp("(?<=id=)[0-9]+$").exec(t.href);if(!r)throw new Error("Cannot match post id.");const a=r[0];t.setAttribute("style","display: block; position: relative; height: inherit; font-size: 0px"),e&&(t.style.width="fit-content"),t.appendChild(new Hd({id:a,onClick:t=>yc(this,Zn,ii).call(this,t)}))})},li=function(){var t;const e=yc(this,Zn,oi).call(this);if(!e)throw new Error("Cannot get post id.");const r=document.querySelector(".content_push > :is(video, img[width])");if(!r)throw new Error("Cannot find media element.");const a=document.createElement("div");a.setAttribute("style","position: relative; width: fit-content; margin: 0 auto; font-size: 0px"),null==(t=r.parentElement)||t.insertBefore(a,r),a.appendChild(r),a.appendChild(new au({id:e,site:"VIDEO"===r.tagName?"native_video":void 0,onClick:t=>yc(this,Zn,ii).call(this,t)}))};const dh=function(){const t=[Np,Ap,bp,jp,Rp,Fp,zp,qp,Wp,Yp,Xp,eh,nh,ch],e=location.hostname;for(const r of t)if("string"==typeof r.hostname){if(e===r.hostname)return r}else if(r.hostname.includes(e))return r}();dh&&(new dh).inject()}(Dexie,GIF,WebMMuxer,Mp4Muxer,dayjs,JSZip);