// ==UserScript==
// @name         4chan XT
// @version      2.24.1
// @minGMVer     1.14
// @minFFVer     78
// @namespace    4chan-XT
// @license      MIT; https://github.com/TuxedoTako/4chan-xt/blob/project-XT/LICENSE
// @include      https://boards.4chan.org/*
// @include      https://sys.4chan.org/*
// @include      https://www.4chan.org/*
// @include      https://i.4cdn.org/*
// @include      https://is.4chan.org/*
// @include      https://is2.4chan.org/*
// @include      https://erischan.org/*
// @include      https://www.erischan.org/*
// @include      https://fufufu.moe/*
// @include      https://kakashinenpo.com/*
// @include      https://www.kakashinenpo.com/*
// @include      https://kissu.moe/*
// @include      https://www.kissu.moe/*
// @include      https://original.kissu.moe/*
// @include      https://lainchan.org/*
// @include      https://www.lainchan.org/*
// @include      https://merorin.com/*
// @include      https://ota-ch.com/*
// @include      https://www.ota-ch.com/*
// @include      https://ponyville.us/*
// @include      https://www.ponyville.us/*
// @include      https://smuglo.li/*
// @include      https://notso.smuglo.li/*
// @include      https://smugloli.net/*
// @include      https://smug.nepu.moe/*
// @include      https://sportschan.org/*
// @include      https://www.sportschan.org/*
// @include      https://sushigirl.us/*
// @include      https://www.sushigirl.us/*
// @include      https://tvch.moe/*
// @exclude      https://www.4chan.org/advertise
// @exclude      https://www.4chan.org/advertise?*
// @exclude      https://www.4chan.org/donate
// @exclude      https://www.4chan.org/donate?*
// @exclude      https://www.4chan.org/
// @connect      4chan.org
// @connect      4channel.org
// @connect      4cdn.org
// @connect      4chenz.github.io
// @connect      archive.4plebs.org
// @connect      warosu.org
// @connect      desuarchive.org
// @connect      boards.fireden.net
// @connect      arch.b4k.dev
// @connect      archived.moe
// @connect      thebarchive.com
// @connect      archiveofsins.com
// @connect      archive.palanq.win
// @connect      eientei.xyz
// @connect      api.clyp.it
// @connect      api.dailymotion.com
// @connect      api.github.com
// @connect      soundcloud.com
// @connect      api.streamable.com
// @connect      vimeo.com
// @connect      www.youtube.com
// @connect      *
// @grant        GM_getValue
// @grant        GM_setValue
// @grant        GM_deleteValue
// @grant        GM_listValues
// @grant        GM_addValueChangeListener
// @grant        GM_openInTab
// @grant        GM_xmlhttpRequest
// @grant        GM.getValue
// @grant        GM.setValue
// @grant        GM.deleteValue
// @grant        GM.listValues
// @grant        GM.openInTab
// @grant        GM.xmlHttpRequest
// @run-at       document-start
// @updateURL https://raw.githubusercontent.com/king1x32/compiledUserscripts/release/release/4chanXT.meta.js
// @downloadURL https://raw.githubusercontent.com/king1x32/compiledUserscripts/release/release/4chanXT.user.js
// @icon         data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAACVBMVEUAAGcAAABmzDNZt9VtAAAAAXRSTlMAQObYZgAAAF5JREFUeNrtkTESABAQxPD/R6tsE2dUGYUtFJvLDKf93KevHJAjpBorAQWSBIKqFASC4G0pCAkm4GfaEvgYXl0T6HBaE97f0vmnfYHbZOMLZCx9ISdKWwjOWZSC8GYm4SUGwfYgqI4AAAAASUVORK5CYII=
// @license      MIT
// ==/UserScript==
!function(){"use strict";function e(e,t,...n){let o=e===We?"":`<${e}`;if(t)for(const[e,n]of Object.entries(t))(n||0===n)&&(o+=` ${e}`,!0!==n&&(o+=`="${Se(n.toString())}"`));e!==We&&(o+=">");const a=e!==We&&ze.has(e);if(a){if(n.length)throw new TypeError(`${e} is a void html element and can't have child elements`)}else for(const e of n)null!=e&&""!==e&&(e instanceof Object&&"innerHTML"in e&&e[Qe]?o+=e.innerHTML:o+=Se(e.toString()));return a||e===We||(o+=`</${e}>`),{innerHTML:o,[Qe]:!0}}var t,n,o,a,i,s,r,l,d,c,h,u,p,g,f,m,b,A,v,x,w,y,k,I,C,D,E,S,T,R,B,L,N,M,P,F,$,O,q,H,j,U,V,Q,z,W,J,_,G,Y,K,X,Z,ee,te,ne,oe,ae,ie,se,re,le,de,ce,he,ue,pe,ge,fe,me,be,Ae,ve,xe,we,ye,ke,Ie,Ce={name:"4chan XT",path:"4chan-XT",fork:"TuxedoTako",page:"https://github.com/TuxedoTako/4chan-xt",downloads:"https://github.com/TuxedoTako/4chan-xt/releases",oldVersions:"https://raw.githubusercontent.com/ccd0/4chan-x/",faq:"https://github.com/TuxedoTako/4chan-xt/wiki/Frequently-Asked-Questions",upstreamFaq:"https://github.com/ccd0/4chan-x/wiki/Frequently-Asked-Questions",captchaFAQ:"https://github.com/ccd0/4chan-x/wiki/Captcha-FAQ",cssGuide:"https://github.com/ccd0/4chan-x/wiki/Styling-Guide",license:"https://github.com/TuxedoTako/4chan-xt/blob/project-XT/LICENSE",changelog:"https://github.com/TuxedoTako/4chan-xt/blob/project-XT/CHANGELOG.md",issues:"https://github.com/TuxedoTako/4chan-xt/issues",newIssue:"https://github.com/TuxedoTako/4chan-xt/issues",newIssueMaxLength:8181,alternatives:"https://www.4chan-x.net/4chan_alternatives.html",appid:"lacclbnghgdicfifcamcmcnilckjamag",appidGecko:"4chan-x@4chan-x.net",recaptchaKey:"6Ldp2bsSAAAAAAJ5uyx_lx34lJeEpTLVkP5k04qc",min:{chrome:"90",firefox:"78",greasemonkey:"1.14"}};const De=Object.create(null),Ee={VERSION:"2.24.1",VERSION_DATE:new Date("2025-05-17T18:20:00Z"),NAMESPACE:Ce.name,sites:Object.create(null),boards:Object.create(null)},Se=function(){const e={"&":"&amp;","'":"&#039;",'"':"&quot;","<":"&lt;",">":"&gt;"},t=/[&"'<>]/g,n=function(t){return e[t]},o=function(e){return e.toString().replace(t,n)};return o.cat=function(e){let t="";for(let n=0;n<e.length;n++)t+=e[n].innerHTML;return t},o}(),Te=document,Re=Te.documentElement,Be=console,Le=function(){return Re};class Ne{static initClass(){this.Post=new Ne("Post"),this.Thread=new Ne("Thread"),this.CatalogThread=new Ne("Catalog Thread"),this.CatalogThreadNative=new Ne("Catalog Thread")}constructor(e){this.type=e,this.keys=[]}push({name:e,cb:t}){return this[e]||this.keys.push(e),this[e]=t}execute(e,t=this.keys,n=!1){let o;if(!e.callbacksExecuted||n){for(var a of(e.callbacksExecuted=!0,t))try{this[a]?.call(e)}catch(t){o||(o=[]),o.push({message:['"',a,'" crashed on node ',this.type," No.",e.ID," (",e.board,")."].join(""),error:t,html:e.nodes?.root?.outerHTML})}return o?ke.handleErrors(o):void 0}}}Ne.initClass(),t=["0.jpg","1.jpg","2.jpg","4.jpg","6.jpg","7.jpg","8.jpg","9.jpg","10.jpg","11.jpg","12.jpg","13.jpg","14.jpg","16.jpg","17.jpg","18.jpg","19.jpg","20.jpg","21.jpg","22.jpg","24.jpg","25.jpg","26.jpg","28.jpg","29.jpg","33.jpg","38.jpg","39.jpg","43.jpg","44.jpg","45.jpg","46.jpg","47.jpg","52.jpg","54.jpg","57.jpg","59.jpg","60.jpg","61.jpg","64.jpg","66.jpg","67.jpg","69.jpg","71.jpg","72.jpg","76.jpg","77.jpg","81.jpg","82.jpg","83.jpg","84.jpg","88.jpg","90.jpg","91.jpg","96.jpg","98.jpg","99.jpg","100.jpg","104.jpg","106.jpg","116.jpg","119.jpg","137.jpg","140.jpg","148.jpg","149.jpg","150.jpg","154.jpg","156.jpg","157.jpg","158.jpg","159.jpg","161.jpg","162.jpg","164.jpg","165.jpg","166.jpg","167.jpg","168.jpg","169.jpg","170.jpg","171.jpg","172.jpg","173.jpg","174.jpg","175.jpg","176.jpg","178.jpg","179.jpg","180.jpg","181.jpg","182.jpg","183.jpg","186.jpg","189.jpg","190.jpg","192.jpg","193.jpg","194.jpg","197.jpg","198.jpg","200.jpg","201.jpg","202.jpg","203.jpg","205.jpg","206.jpg","207.jpg","208.jpg","210.jpg","213.jpg","214.jpg","215.jpg","216.jpg","218.jpg","219.jpg","220.jpg","221.jpg","222.jpg","223.jpg","224.jpg","227.jpg","0.png","1.png","2.png","3.png","5.png","6.png","9.png","10.png","11.png","12.png","14.png","16.png","19.png","20.png","21.png","22.png","23.png","24.png","26.png","27.png","28.png","29.png","30.png","31.png","32.png","33.png","34.png","37.png","39.png","40.png","41.png","42.png","43.png","44.png","45.png","48.png","49.png","50.png","51.png","52.png","53.png","57.png","58.png","59.png","64.png","66.png","67.png","68.png","69.png","70.png","71.png","72.png","76.png","78.png","79.png","81.png","82.png","85.png","86.png","87.png","89.png","95.png","98.png","100.png","101.png","102.png","105.png","106.png","107.png","109.png","110.png","111.png","112.png","113.png","114.png","115.png","116.png","118.png","119.png","120.png","121.png","122.png","123.png","126.png","128.png","130.png","134.png","136.png","138.png","139.png","140.png","142.png","145.png","146.png","149.png","150.png","151.png","152.png","153.png","154.png","155.png","156.png","157.png","158.png","159.png","160.png","163.png","164.png","165.png","166.png","167.png","168.png","169.png","170.png","171.png","172.png","173.png","174.png","178.png","179.png","180.png","181.png","182.png","184.png","186.png","188.png","190.png","192.png","193.png","194.png","195.png","196.png","197.png","198.png","200.png","202.png","203.png","205.png","206.png","207.png","209.png","212.png","213.png","214.png","216.png","217.png","218.png","219.png","220.png","221.png","222.png","223.png","224.png","225.png","226.png","229.png","231.png","232.png","233.png","234.png","235.png","237.png","238.png","239.png","240.png","241.png","242.png","244.png","245.png","246.png","247.png","248.png","249.png","250.png","253.png","254.png","255.png","256.png","257.png","258.png","259.png","260.png","262.png","268.png","0.gif","1.gif","2.gif","3.gif","4.gif","5.gif","6.gif","7.gif","8.gif","9.gif","10.gif","12.gif","13.gif","14.gif","15.gif","16.gif","18.gif","19.gif","20.gif","21.gif","22.gif","23.gif","24.gif","28.gif","29.gif","30.gif","33.gif","34.gif","35.gif","36.gif","37.gif","39.gif","40.gif","42.gif","44.gif","45.gif","46.gif","48.gif","50.gif","52.gif","54.gif","55.gif","57.gif","58.gif","59.gif","60.gif","61.gif","63.gif","64.gif","66.gif","67.gif","68.gif","69.gif","70.gif","72.gif","73.gif","75.gif","76.gif","77.gif","78.gif","80.gif","81.gif","82.gif","83.gif","86.gif","87.gif","88.gif","92.gif","93.gif","94.gif","95.gif","96.gif","97.gif","98.gif","99.gif","100.gif","101.gif","102.gif","103.gif","104.gif","105.gif","106.gif","108.gif","109.gif","110.gif","111.gif","112.gif","113.gif","115.gif","116.gif","117.gif","118.gif","119.gif","120.gif","122.gif","123.gif","124.gif","127.gif","129.gif","130.gif","131.gif","134.gif","135.gif","136.gif","138.gif","139.gif","141.gif","144.gif","146.gif","148.gif","149.gif","153.gif","154.gif","155.gif","157.gif","158.gif","159.gif","160.gif","161.gif","162.gif","164.gif","166.gif","167.gif","168.gif","169.gif","170.gif","171.gif","172.gif","173.gif","174.gif","175.gif","176.gif","177.gif","178.gif","181.gif","182.gif","183.gif","185.gif","186.gif","187.gif","188.gif","189.gif","190.gif","191.gif","192.gif","193.gif","195.gif","196.gif","197.gif","200.gif","201.gif","202.gif","203.gif","204.gif","205.gif","206.gif","207.gif","208.gif","209.gif","210.gif","211.gif","212.gif","213.gif","214.gif","215.gif","216.gif","217.gif","219.gif","220.gif","221.gif","222.gif","224.gif","225.gif","226.gif","227.gif","228.gif","230.gif","232.gif","233.gif","234.gif","235.gif","238.gif","240.gif","241.gif","243.gif","244.gif","245.gif","246.gif","247.gif","249.gif","250.gif","251.gif","253.gif"];const Me={main:{Miscellaneous:{"JSON Index":[!0,"Replace the original board index with one supporting searching, sorting, infinite scrolling, and a catalog mode."],[`Use ${Ce.name} Catalog`]:[!0,`Link to ${Ce.name}'s catalog instead of the native 4chan one.`,1],"Index Refresh Notifications":[!1,"Show a notice at the top of the page when the index is refreshed.",1],"Follow Cursor":[!0,"Image Hover and Quote Preview move with the mouse cursor."],"Open Threads in New Tab":[!1,`Make links to threads in the index / ${Ce.name} catalog open in a new tab.`],"External Catalog":[!1,"Link to external catalog instead of the internal one."],"Catalog Links":[!1,"Add toggle link in header menu to turn Navigation links into links to each board's catalog."],"Announcement Hiding":[!0,"Add button to hide 4chan announcements."],"Desktop Notifications":[!0,`Enables desktop notifications across various ${Ce.name} features.`],"404 Redirect":[!0,"Redirect dead threads and images to the archives."],"Archive Report":[!0,"Enable reporting posts to supported archives."],"Exempt Archives from Encryption":[!1,"Permit loading content from, and warningless redirects to, HTTP-only archives from HTTPS pages."],Keybinds:[!0,"Bind actions to keyboard shortcuts."],"Time Formatting":[!0,'Localize and format timestamps. Has more options on the "Advanced" tab.'],"Comment Expansion":[!0,"Expand comments that are too long to display on the index. Not applicable with JSON Index."],"File Info Formatting":[!0,"Reformat the file information."],"Thread Expansion":[!0,"Add buttons to expand threads."],"Index Navigation":[!1,"Add buttons to navigate between threads."],"Reply Navigation":[!1,"Add buttons to navigate to top / bottom of thread."],"Unique ID and Capcode Navigation":[!1,"Add buttons to navigate to posts having the same unique ID or capcode."],"Custom Board Titles":[!0,"Allow editing of the board title and subtitle by ctrl/âŒ˜+clicking them."],"Persistent Custom Board Titles":[!1,"Force custom board titles to be persistent, even if the board titles are updated.",1],"Show Updated Notifications":[!0,`Show notifications when ${Ce.name} is successfully updated.`],"Color User IDs":[!0,"Assign unique colors to user IDs on boards that use them"],"Count Posts by ID":[!0,"Display number of posts in the thread when hovering over an ID."],"Remove Spoilers":[!1,"Remove all spoilers in text."],"Reveal Spoilers":[!1,"Indicate spoilers if Remove Spoilers is enabled, or make the text appear hovered if Remove Spoiler is disabled."],"Normalize URL":[!0,"Rewrite the URL of the current page, removing slugs and excess slashes, and changing /res/ to /thread/."],"Disable Autoplaying Sounds":[!1,"Prevent sounds on the page from autoplaying."],"Disable Native Extension":[!0,`${Ce.name} is NOT designed to work with the native extension.`],"Enable Native Flash Embedding":[!0,"Activate the native extension's Flash embedding if the native extension is disabled."],"Export History":[!0,"Export last read, your posts, etc. when exporting the setting"],"Ask to Export History":[!0,"Ask if history should be exported when settings are exported."],"Scroll Markers":[!0,'Mark your posts and replies to them on the scroll bar. Relies on the "Highlight Posts Quoting You" and "Highlight Own Posts" settings']},Linkification:{Linkify:[!0,"Convert text into links where applicable."],"Link Title":[!0,"Replace the link of a supported site with its actual title.",1],"Link Title in the catalog":[!1,"Replace the link of a supported site with its actual title in the catalog too. Speed up performance for boards that have many embeds (e.g /vt/) if turned off",2],"Cover Preview":[!0,"Show preview of supported links on hover.",1],Embedding:[!0,"Embed supported services. Note: Some services don't work on HTTPS.",1],"Auto-embed":[!1,"Auto-embed Linkify Embeds.",2],"Floating Embeds":[!1,"Embed content in a frame that remains in place when the page is scrolled.",2]},Filtering:{Anonymize:[!1,"Make everyone Anonymous."],Filter:[!0,"Self-moderation placebo."],"Filtered Backlinks":[!1,"When enabled, shows backlinks to filtered posts with a line-through decoration. Otherwise, hides the backlinks.",1],"Filter in Native Catalog":[!0,"Apply 4chan X filters in native catalog.",1],"MD5 Quick Filter Notifications":[!0,"Show notification when quick filtering MD5s using the button or keybind.",1],"MD5 Quick Filter in the Catalog":[!0,"Quick filter by MD5 when clicking a thumbnail in the catalog and holding Shift. Disabling falls back on just hiding the thread.",1],"MD5 Quick Filter in Threads":[!0,"Quick filter by MD5 when clicking a thumbnail in a thread while holding shift.",1],"Recursive Hiding":[!0,"Hide replies of hidden posts, recursively."],"Thread Hiding Buttons":[!0,"Add buttons to hide entire threads."],"Reply Hiding Buttons":[!0,"Add buttons to hide single replies."],Stubs:[!0,"Show stubs of hidden threads / replies."],"Filter Reason":[!0,"Show the reason the post was hidden in the stub. If disabled, you can hover over the stub to see the reason."]},"Images and Videos":{"Image Expansion":[!0,"Expand images / videos."],"Image Hover":[!0,"Show full image / video on mouseover."],"Image Hover in Catalog":[!0,`Show full image / video on mouseover in ${Ce.name} catalog.`],Gallery:[!0,"Adds a simple and cute image gallery. Has more options in the gallery menu."],"Fullscreen Gallery":[!1,"Open gallery in fullscreen mode.",1],"PDF in Gallery":[!1,"Show PDF files in gallery.",1],Sauce:[!0,"Add sauce links to images."],"WEBM Metadata":[!0,"Add link to fetch title metadata from webm videos."],"Reveal Spoiler Thumbnails":[!1,"Replace spoiler thumbnails with the original image."],"Replace GIF":[!1,"Replace gif thumbnails with the actual image."],"Replace JPG":[!1,"Replace jpg thumbnails with the actual image."],"Replace PNG":[!1,"Replace png thumbnails with the actual image."],"Replace WEBM":[!1,"Replace webm, mp4, and ogv thumbnails with the actual video. Probably will degrade browser performance ;)"],"Image Prefetching":[!0,"Add a shortcut icon to the header to turn on image preloading."],"Fappe Tyme":[!0,"Hide posts without images when header menu item is checked. *hint* *hint*"],"Werk Tyme":[!0,"Hide all post images when header menu item is checked."],Autoplay:[!0,"Videos begin playing immediately when opened."],"Restart when Opened":[!1,"Restart GIFs and WebMs when you hover over or expand them."],"Show Controls":[!0,"Show controls on videos expanded inline."],"Click Passthrough":[!1,"Clicks on videos trigger your browser's default behavior. Videos can be contracted with button / dragging to the left.",1],"Allow Sound":[!0,"Open videos with the sound unmuted."],"Mouse Wheel Volume":[!0,"Adjust volume of videos with the mouse wheel over the thumbnail/filename/gallery."],"Loop in New Tab":[!0,"Loop videos opened in their own tabs."],"Volume in New Tab":[!0,`Apply ${Ce.name} mute and volume settings to videos opened in their own tabs.`],"Enable sound posts":[!0,"Enable loading audio from [sound=] file names. This audio is fetched from third parties."]},Menu:{Menu:[!0,"Add a drop-down menu to posts."],"Report Link":[!0,"Add a report link to the menu.",1],"Copy Text Link":[!0,"Add a link to copy the post's text.",1],"Thread Hiding Link":[!0,"Add a link to hide entire threads.",1],"Reply Hiding Link":[!0,"Add a link to hide single replies.",1],"Delete Link":[!0,"Add post and image deletion links to the menu.",1],"Archive Link":[!0,"Add an archive link to the menu.",1],"Edit Link":[!0,"Add a link to edit the image in Tegaki, /i/'s painting program. Requires Quick Reply.",1],"Download Link":[!1,"Add a download with original filename link to the menu.",1]},Monitoring:{"Thread Updater":[!0,'Fetch and insert new replies. Has more options in the header menu and the "Advanced" tab.'],"Unread Count":[!0,"Show the unread posts count in the tab title."],"Quoted Title":[!1,"Change the page title to reflect you've been quoted.",1],"Hide Unread Count at (0)":[!1,"Hide the unread posts count in the tab title when it reaches 0.",1],"Unread Favicon":[!0,"Show a different favicon when there are unread posts."],"Unread Line":[!0,"Show a line to distinguish read posts from unread ones."],"Remember Last Read Post":[!0,"Remember how far you've read after you close the thread."],"Scroll to Last Read Post":[!0,"Scroll back to the last read post when reopening a thread.",1],"Unread Line in Index":[!1,"Show a line between read and unread posts in threads in the index.",1],"Remove Thread Excerpt":[!1,"Replace the excerpt of the thread in the tab title with the board title."],"Thread Stats":[!0,"Display reply and image count."],"IP Count in Stats":[!0,"Display the unique IP count in the thread stats.",1],"Page Count in Stats":[!0,"Display the page count in the thread stats.",1],"Purge Position":[!1,"Update stats more often and add purge position when a thread is close to getting purged, for anons who manage general threads.",2],"Updater and Stats in Header":[!0,"Places the thread updater and thread stats in the header instead of floating them."],"Thread Watcher":[!0,"Bookmark threads. Has more options in the thread watcher menu."],"Fixed Thread Watcher":[!0,"Makes the thread watcher scroll with the page.",1],"Persistent Thread Watcher":[!1,"The thread watcher will be visible when the page is loaded.",1],"Mark New IPs":[!1,"Label each post from a new IP with the thread's current IP count."],"Reply Pruning":[!0,"Add option in header menu to hide old replies in long threads. Activated by default in stickies."],"Prune All Threads":[!1,"Activate Reply Pruning by default in all threads.",1]},"Posting and Captchas":{"Quick Reply":[!0,"All-in-one form to reply, create threads, automate dumping and more."],"Persistent QR":[!1,"The Quick reply won't disappear after posting.",1],"Auto Hide QR":[!0,"Automatically hide the quick reply when posting.",2],"Open Post in New Tab":[!0,"Open new threads in a new tab, and open replies in a new tab if you're not already in the thread.",1],"Remember QR Size":[!1,"Remember the size of the Quick reply.",1],"Remember Spoiler":[!1,"Remember the spoiler state, instead of resetting after posting.",1],"Randomize Filename":[!1,"Set the filename to a random timestamp within the past year. Disabled on /f/.",1],"Show New Thread Option in Threads":[!0,"Show the option to post a new / different thread from inside a thread.",1],"Show Upload Progress":[!0,"Track progress of file uploads as percentage in submit button.",1],Cooldown:[!0,"Indicate the remaining time before posting again.",1],"Posting Success Notifications":[!0,"Show notifications on successful post creation or file uploading.",1],"Auto-load captcha":[!1,"Automatically load the captcha in the QR even if your post is empty.",1],"Post on Captcha Completion":[!1,"Submit the post immediately when the captcha is completed.",1],"Avoid OffscreenCanvas":[!1,'Do not use OffscreenCanvas when converting images, workaround for <a href="https://github.com/TuxedoTako/4chan-xt/issues/132">this LibreWolf bug</a>',1],"Force Noscript Captcha":[!1,"Use the non-Javascript fallback captcha even if Javascript is enabled."],"Pass Link":[!1,"Add a 4chan Pass login link to the bottom of the page."]},"Quote Links":{"Quote Backlinks":[!0,"Add quote backlinks."],"OP Backlinks":[!0,"Add backlinks to the OP.",1],"Bottom Backlinks":[!1,"Place backlinks at the bottom of posts.",1],"Quote Inlining":[!0,"Inline quoted post on click."],"Inline Cross-thread Quotes Only":[!1,"Don't inline quote links when the posts are visible in the thread.",1],"Quote Hash Navigation":[!1,"Include an extra link after quotes for autoscrolling to quoted posts.",1],"Forward Hiding":[!0,"Hide original posts of inlined backlinks.",1],"Quote Previewing":[!0,"Show quoted post on hover."],"Quote Highlighting":[!0,"Highlight the previewed post.",1],"Resurrect Quotes":[!0,"Link dead quotes to the archives, and support inlining/previewing of archive links like quote links."],"Remember Your Posts":[!0,"Remember your posting history."],"Mark Quotes of You":[!0,"Add '(You)' to quotes linking to your posts.",1],"Highlight Posts Quoting You":[!0,"Highlights any posts that contain a quote to your post.",1],"Highlight Own Posts":[!0,"Highlights own posts.",1],"Mark OP Quotes":[!0,"Add '(OP)' to OP quotes."],"Mark Cross-thread Quotes":[!0,"Add '(Cross-thread)' to cross-threads quotes."],"Quote Threading":[!0,"Add option in header menu to thread conversations."]}},imageExpansion:{"Fit width":[!0,""],"Fit height":[!1,""],"Scroll into view":[!0,"Scroll down when expanding images to bring the full image into view."],"Expand spoilers":[!0,"Expand all images along with spoilers."],"Expand videos":[!0,"Expand all images also expands videos."],"Expand from here":[!1,"Expand all images only from current position to thread end."],"Expand thread only":[!1,"In index, expand all images only within the current thread."],"Advance on contract":[!1,"Advance to next post when contracting an expanded image."]},gallery:{"Hide Thumbnails":[!1],"Fit Width":[!0],"Fit Height":[!0],"Stretch to Fit":[!1],"Scroll to Post":[!0],"Slide Delay":[6]},"Default Volume":1,threadWatcher:{"Current Board":[!1,"Only show watched threads from the current board."],"Auto Update Thread Watcher":[!0,"Periodically check status of watched threads."],"Auto Watch":[!0,"Automatically watch threads you start."],"Auto Watch Reply":[!0,"Automatically watch threads you reply to."],"Auto Prune":[!1,"Automatically remove dead threads."],"Show Page":[!0,"Show what page watched threads are on."],"Show Unread Count":[!0,"Show number of unread posts in watched threads."],"Show Site Prefix":[!0,"When multiple sites are shown in the thread watcher, add a prefix to board names to distinguish them."],"Require OP Quote Link":[!1,"For purposes of thread watcher highlighting, only consider posts with a quote link to the OP as replies to the OP."]},filter:{general:"",postID:"# Highlight dubs on [s4s]:\n#/(\\d)\\1$/;highlight;top:no;boards:s4s",name:"# Filter any namefags:\n#/^(?!Anonymous$)/",uniqueID:"# Filter a specific ID:\n#/Txhvk1Tl/",tripcode:"# Filter any tripfag\n#/^!/",capcode:"# Set a custom class for mods:\n#/Mod$/;highlight:mod;op:yes\n# Set a custom class for admins:\n#/Admin$/;highlight:admin;op:yes",pass:"# Filter anyone using since4pass:\n#/./",email:"",subject:"# Filter Generals on /v/:\n#/general/i;boards:v;op:only",comment:"# Filter Stallman copypasta on /g/:\n#/what you're refer+ing to as linux/i;boards:g\n# Filter posts with 20 or more quote links:\n#/(?:>>\\d(?:(?!>>\\d)[^])*){20}/\n# Filter posts like T H I S / H / I / S:\n#/^>?\\s?\\w\\s?(\\w)\\s?(\\w)\\s?(\\w).*$[\\s>]+\\1[\\s>]+\\2[\\s>]+\\3/im",flag:"",filename:"",dimensions:"# Highlight potential wallpapers:\n#/1920x1080/;op:yes;highlight;top:no;boards:w,wg",filesize:"",MD5:""},sauces:'# Known filename formats:\nhttps://www.pixiv.net/member_illust.php?mode=medium&illust_id=%$1;regexp:/^(\\d+)_p\\d+/\njavascript:void(open("https://www.deviantart.com/"+%$1.replace(/_/g,"-")+"/art/"+parseInt(%$2,36)));regexp:/^\\w+_by_(\\w+)[_-]d([\\da-z]{6})\\b/\nhttps://imgur.com/%$1;regexp:/^(?![a-zA-Z][a-z]{6})(?![A-Z]{7})(?!\\d{7})([\\da-zA-Z]{7})(?: \\(\\d+\\))?\\.\\w+$/\nhttps://flickr.com/photo.gne?id=%$1;regexp:/^(\\d+)_[\\da-f]{10}(?:_\\w)*\\b/\nhttps://www.facebook.com/photo.php?fbid=%$1;regexp:/^\\d+_(\\d+)_\\d+_[no]\\b/\n\n# Reverse image search:\nhttps://www.google.com/searchbyimage?sbisrc=4chanx&image_url=%IMG&safe=off\nhttps://yandex.com/images/search?rpt=imageview&url=%IMG\n#//tineye.com/search?url=%IMG\n#//www.bing.com/images/search?q=imgurl:%IMG&view=detailv2&iss=sbi#enterInsights\n#https://lens.google.com/uploadbyurl?url=%IMG;text:lens\n\n# Specialized reverse image search:\n//iqdb.org/?url=%IMG\nhttps://trace.moe/?auto&url=%IMG;text:wait\n#//3d.iqdb.org/?url=%IMG\n#//saucenao.com/search.php?url=%IMG\n\n# "View Same" in archives:\nhttp://eye.swfchan.com/search/?q=%name;types:swf\n#https://desuarchive.org/_/search/image/%sMD5/\n#https://archive.4plebs.org/_/search/image/%sMD5/\n#https://boards.fireden.net/_/search/image/%sMD5/\n#https://foolz.fireden.net/_/search/image/%sMD5/\n\n# Other tools:\n#http://exif.regex.info/exif.cgi?imgurl=%URL\n#//imgops.com/start?url=%URL;types:gif,jpg,png\n#//www.gif-explode.com/%URL;types:gif',FappeT:{werk:!1},"Custom CSS":!0,Index:{"Index Mode":"paged","Previous Index Mode":"paged","Index Size":"small","Show Replies":[!0,'Show replies in the index, and also in the catalog if "Catalog hover expand" is checked.'],"Catalog Hover Expand":[!1,"Expand the comment and show more details when you hover over a thread in the catalog."],"Catalog Hover Toggle":[!0,'Turn "Catalog hover expand" on and off by clicking in the catalog.'],"Pin Watched Threads":[!1,"Move watched threads to the start of the index."],"Anchor Hidden Threads":[!0,"Move hidden threads to the end of the index."],"Refreshed Navigation":[!1,"Refresh index when navigating through pages."]},Header:{"Fixed Header":!0,"Header auto-hide":!1,"Header auto-hide on scroll":!1,"Bottom Header":!1,"Centered links":!1,"Header catalog links":!1,"Bottom Board List":!0,"Shortcut Icons":!0,"Custom Board Navigation":!0},archives:{archiveLists:"https://4chenz.github.io/archives.json/archives.json",lastarchivecheck:0,archiveAutoUpdate:!0},externalCatalogURLs:"//catalog.neet.tv/%board/;boards:4chan.org:3,a,adv,an,asp,biz,c,cgl,ck,cm,co,diy,f,fa,fit,g,gd,his,i,int,jp,k,lgbt,lit,m,mlp,mu,n,news,o,out,p,po,pol,s4s,sci,sp,tg,toy,trv,tv,v,vg,vip,vp,vr,w,wg,wsg,wsr,x",boardnav:`[ toggle-all ]\n[current-index-text:"Index"\ncurrent-catalog-text:"Catalog"\ncurrent-expired-text:"Expired"\ncurrent-archive-text:"Archive"]\n[external-text:"FAQ","${Ce.faq}"]`,QR:{"QR.personas":'#options:"sage";boards:jp;always',sjisPreview:!1},jsWhitelist:"",captchaLanguage:"",time:"%m/%d/%y(%a)%H:%M:%S",timeLocale:"",RelativeTime:"Hover",backlink:">>%id",pastedname:"file",fileInfo:"%l %d (%p%s, %r%g)",favicon:"ferongr",usercss:"/* Board title rice */\ndiv.boardTitle {\n  font-weight: 400 !important;\n}\n:root.yotsuba div.boardTitle {\n  font-family: sans-serif !important;\n  text-shadow: 1px 1px 1px rgba(100,0,0,0.6);\n}\n:root.yotsuba-b div.boardTitle {\n  font-family: sans-serif !important;\n  text-shadow: 1px 1px 1px rgba(105,10,15,0.6);\n}\n:root.photon div.boardTitle {\n  font-family: sans-serif !important;\n  text-shadow: 1px 1px 1px rgba(0,74,153,0.6);\n}\n:root.tomorrow div.boardTitle {\n  font-family: sans-serif !important;\n  text-shadow: 1px 1px 1px rgba(167,170,168,0.6);\n}",hotkeys:{"Toggle board list":["Ctrl+b","Toggle the full board list."],"Toggle header":["Shift+h","Toggle the auto-hide option of the header."],"Open empty QR":["q","Open QR without post number inserted."],"Open QR":["Shift+q","Open QR with post number inserted."],"Open settings":["Alt+o","Open Settings."],Close:["Esc","Close dialogs or notifications."],"Spoiler tags":["Ctrl+s","Insert spoiler tags."],"Code tags":["Alt+c","Insert code tags."],"Eqn tags":["Alt+e","Insert eqn tags."],"Math tags":["Alt+m","Insert math tags."],"SJIS tags":["Alt+a","Insert SJIS tags."],"Toggle sage":["Alt+s","Toggle sage in options field."],"Toggle Cooldown":["Alt+Comma","Toggle custom cooldown timer."],"Post from URL":["Alt+l","Post from URL."],"Add new post":["Alt+n","Add new post to the QR dump list."],"Submit QR":["Ctrl+Enter","Submit post."],Watch:["w","Watch thread."],Update:["r","Update the thread / refresh the index."],"Update thread watcher":["Shift+r","Manually refresh thread watcher."],"Toggle thread watcher":["t","Toggle visibility of thread watcher."],"Toggle threading":["Shift+t","Toggle threading."],"Mark thread read":["Ctrl+0",'Mark thread read from index (requires "Unread Line in Index").'],"Expand image":["Shift+e","Expand selected image."],"Expand images":["e","Expand all images."],"Open Gallery":["g","Opens the gallery."],"Next Gallery Image":["Right","Go to the next image in gallery mode."],"Previous Gallery Image":["Left","Go to the previous image in gallery mode."],"Advance Gallery":["Enter","Go to next image or, if Autoplay is off, play video."],Pause:["p","Pause/play videos in the gallery."],Slideshow:["Ctrl+Right","Toggle the gallery slideshow mode."],"Rotate image clockwise":["Shift+Right","Rotate image clockwise in gallery."],"Rotate image anticlockwise":["Shift+Left","Rotate image anticlockwise in gallery."],"Download Gallery Image":["Shift+j","Download current image in gallery."],fappeTyme:["f","Toggle Fappe Tyme."],werkTyme:["Shift+w","Toggle Werk Tyme."],"Front page":["1","Jump to front page."],"Open front page":["Shift+1","Open front page in a new tab."],"Next page":["Ctrl+Right","Jump to the next page."],"Previous page":["Ctrl+Left","Jump to the previous page."],"Paged mode":["Alt+1","Open the index in paged mode."],"Infinite scrolling mode":["Alt+2","Open the index in infinite scrolling mode."],"All pages mode":["Alt+3","Open the index in all threads mode."],"Open catalog":["Shift+c","Open the catalog of the current board."],"Search form":["Ctrl+Alt+s","Focus the search field on the board index."],"Cycle sort type":["Alt+x","Cycle through index sort types."],"Next thread":["Ctrl+Down","See next thread."],"Previous thread":["Ctrl+Up","See previous thread."],"Expand thread":["Ctrl+e","Expand thread."],"Open thread":["o","Open thread in current tab."],"Open thread tab":["Shift+o","Open thread in new tab."],"Next reply":["j","Select next reply."],"Previous reply":["k","Select previous reply."],"Deselect reply":["Shift+d","Deselect reply."],Hide:["x","Hide thread."],"Quick Filter MD5":["5","Add the MD5 of the selected image to the filter list."],"Previous Post Quoting You":["Alt+Up","Scroll to the previous post that quotes you."],"Next Post Quoting You":["Alt+Down","Scroll to the next post that quotes you."]},updater:{checkbox:{Beep:[!1,"Beep on new post to completely read thread."],"Beep Quoting You":[!1,"Beep on new post quoting you."],"Auto Scroll":[!1,"Scroll updated posts into view. Only enabled at bottom of page."],"Bottom Scroll":[!1,"Always scroll to the bottom, not the first new post. Useful for event threads."],"Scroll BG":[!1,"Auto-scroll background tabs."],"Auto Update":[!0,"Automatically fetch new posts."],"Optional Increase":[!1,"Increase the intervals between updates on threads without new posts."]},Interval:5},customCooldown:0,customCooldownEnabled:!0,"Thread Quotes":!1,"Max Replies":1e3,"Autohiding Scrollbar":!1,position:{"embedding.position":"top: 50px; right: 0px;","thread-stats.position":"bottom: 0px; right: 0px;","updater.position":"bottom: 0px; left: 0px;","thread-watcher.position":"top: 50px; left: 0px;","qr.position":"top: 50px; right: 0px;"},fourchanImageHost:"i.4cdn.org",hiddenPSAList:[{}],knownBanners:t.join(","),passMessageClosed:!1,PSAseen:[[]],XEmbedder:"fxt",fxtLang:"",fxtUrl:"https://api.fxtwitter.com",fxtMaxReplies:5,beepSource:"",beepVolume:1},Pe=(e,t,n=!0)=>{let o=0,a=null,i=null,s=null;const r=function(){return o=Date.now(),t.apply(i,s)};return function(){s=arguments,i=this,n&&o<Date.now()-e?r():(null!==a&&clearTimeout(a),a=setTimeout(r,e))}},Fe=()=>Object.create(null);Fe.clone=function(e){var t,n;if("object"!=typeof e||null===e)return e;if(e instanceof Array){const t=[];for(let n=0,o=e.length;n<o;n++)t.push(Fe.clone(e[n]));return t}{const o=Object.create(null);for(t in e)n=e[t],o[t]=Fe.clone(n);return o}},Fe.json=e=>Fe.clone(JSON.parse(e));const $e=1e3,Oe=6e4,qe=36e5,He=24*qe,je=window.GM_xmlhttpRequest?"userscript":"crx",Ue={stubCloneTopNav:()=>{window.cloneTopNav=function(){}},disableNativeExtension:()=>{try{const e=JSON.parse(localStorage.getItem("4chan-settings"))||{};if(e.disableAll)return;e.disableAll=!0,localStorage.setItem("4chan-settings",JSON.stringify(e))}catch(e){Object.defineProperty(window,"Config",{value:{disableAll:!0}})}},disableNativeExtensionNoStorage:()=>{Object.defineProperty(window,"Config",{value:{disableAll:!0}})},prettyPrint:({id:e})=>{window.prettyPrint?.(function(){},document.getElementById(e).parentNode)},exposeVersion:({buildDate:e,version:t})=>{const n=+e;Object.defineProperty(window,"fourchanXT",{value:Object.freeze({version:t,get buildDate(){return new Date(n)}}),writable:!1})},initMain:()=>{document.documentElement.classList.add("js-enabled"),window.FCX={}},initFlash:()=>{JSON.parse(localStorage["4chan-settings"]||"{}").disableAll&&window.SWFEmbed.init()},initFlashNoStorage:()=>{window.SWFEmbed.init()},setThreadId:()=>{window.Main.tid=location.pathname.split(/\/+/)[3]},fourChanPrettyPrintListener:()=>{window.addEventListener("prettyprint",e=>window.dispatchEvent(new CustomEvent("prettyprint:cb",{detail:{ID:e.detail.ID,i:e.detail.i,html:window.prettyPrintOne(e.detail.html)}})),!1)},fourChanMathjaxListener:()=>{window.addEventListener("mathjax",function(e){window.MathJax?window.MathJax.Hub.Queue(["Typeset",window.MathJax.Hub,e.target]):(document.querySelector('script[src^="//cdn.mathjax.org/"]')||(window.loadMathJax(),window.loadMathJax=function(){}),e.target.classList.contains("postMessage")||document.querySelector('script[src^="//cdn.mathjax.org/"]').addEventListener("load",()=>window.MathJax.Hub.Queue(["Typeset",window.MathJax.Hub,e.target]),!1))},!1)},disable4chanIdHl:()=>{for(var e of(window.clickable_ids=!1,document.querySelectorAll(".posteruid, .capcode")))e.removeEventListener("click",window.idClick,!1)},initTinyBoard:({boardID:e,threadID:t})=>{t=+t;const n=document.querySelector('form[name="post"]');window.$(document).ajaxComplete(function(a,i,s){let r;if(s.url!==n.action)return;if(!(r=+i.responseJSON?.id))return;const l={boardID:e,threadID:t,postID:r};try{const{redirect:e,noko:t}=i.responseJSON;!e||null==o||o||t||(l.redirect=e)}catch(e){}a=new CustomEvent("QRPostSuccessful",{bubbles:!0,detail:l}),document.dispatchEvent(a)});var o=window.tb_settings?.ajax?.always_noko_replies;let a;((a=window.tb_settings||(window.tb_settings={})).ajax||(a.ajax={})).always_noko_replies=!0},setupCaptcha:({recaptchaKey:e})=>{const t=function(){const{classList:t}=document.documentElement,n=document.querySelector("#qr .captcha-container");n.dataset.widgetID=window.grecaptcha.render(n,{sitekey:e,theme:t.contains("tomorrow")||t.contains("spooky")||t.contains("dark-captcha")?"dark":"light",callback(e){window.dispatchEvent(new CustomEvent("captcha:success",{detail:e}))}})};if(window.grecaptcha)t();else{const e=window.onRecaptchaLoaded;if(window.onRecaptchaLoaded=function(){t(),e()},!document.head.querySelector('script[src^="https://www.google.com/recaptcha/api.js"]')){const e=document.createElement("script");e.src="https://www.google.com/recaptcha/api.js?onload=onRecaptchaLoaded&render=explicit",document.head.appendChild(e)}}},resetCaptcha:()=>{window.grecaptcha.reset(document.querySelector("#qr .captcha-container").dataset.widgetID)},setupTCaptcha:({boardID:e,threadID:t,autoLoad:n})=>{const{TCaptcha:o}=window;o.init(document.querySelector("#qr .captcha-container"),e,+t),o.setErrorCb(e=>window.dispatchEvent(new CustomEvent("CreateNotification",{detail:{type:"warning",content:""+e}}))),"1"===n&&o.load(e,t)},destroyTCaptcha:()=>{window.TCaptcha.destroy()},TCaptchaClearChallenge:()=>{window.TCaptcha.clearChallenge()},setupQR:()=>{window.FCX.oekakiCB=()=>window.Tegaki.flatten().toBlob(function(e){const t=`oekaki-${Date.now()}`;window.FCX.oekakiLatest=t,document.dispatchEvent(new CustomEvent("QRSetFile",{bubbles:!0,detail:{file:e,name:window.FCX.oekakiName,source:t}}))}),window.Tegaki&&(document.querySelector("#qr .oekaki").hidden=!1)},qrTegakiDraw:()=>{const{Tegaki:e,FCX:t}=window;e.bg&&e.destroy(),t.oekakiName="tegaki.png",e.open({onDone:t.oekakiCB,onCancel(){e.bgColor="#ffffff"},width:+document.querySelector("#qr [name=oekaki-width]").value,height:+document.querySelector("#qr [name=oekaki-height]").value,bgColor:document.querySelector("#qr [name=oekaki-bg]").checked?document.querySelector("#qr [name=oekaki-bgcolor]").value:"transparent"})},qrTegakiLoad:()=>{const{Tegaki:e,FCX:t}=window,n=document.getElementById("qr-filename").value.replace(/\.\w+$/,"")+".png",{source:o}=document.getElementById("file-n-submit").dataset,a=e=>document.dispatchEvent(new CustomEvent("CreateNotification",{bubbles:!0,detail:{type:"warning",content:e,lifetime:20}}));var i=function(o){o&&this.removeEventListener("QRMetadata",i,!1);const s=document.getElementById("selected");if(!s?.dataset.type)return a("No file to edit.");if(!/^(image|video)\//.test(s.dataset.type))return a("Not an image.");if(!s.dataset.height)return a("Metadata not available.");if("loading"===s.dataset.height)return void s.addEventListener("QRMetadata",i,!1);e.bg&&e.destroy(),t.oekakiName=n,e.open({onDone:t.oekakiCB,onCancel(){e.bgColor="#ffffff"},width:+s.dataset.width,height:+s.dataset.height,bgColor:"transparent"});const r=document.createElement("canvas");r.width=r.naturalWidth=+s.dataset.width,r.height=r.naturalHeight=+s.dataset.height,r.hidden=!0,document.body.appendChild(r),r.addEventListener("QRImageDrawn",function(){this.remove(),e.onOpenImageLoaded.call(this)},!1),r.dispatchEvent(new CustomEvent("QRDrawFile",{bubbles:!0}))};e.bg&&e.onDoneCb===t.oekakiCB&&o===t.oekakiLatest?(t.oekakiName=n,e.resume()):i()},testNativeExtension:(e={})=>(window.Parser?.postMenuIcon&&(e.enabled="true"),e)},Ve=(e,t=document.body)=>t.querySelector(e);Ve.id=e=>Te.getElementById(e),Ve.ready=function(e){if("loading"===Te.readyState){var t=function(){Ve.off(Te,"DOMContentLoaded",t),e()};Ve.on(Te,"DOMContentLoaded",t)}else Ve.queueTask(e)},Ve.formData=function(e){var t,n;if(e instanceof HTMLFormElement)return new FormData(e);const o=new FormData;for(t in e)(n=e[t])&&("object"==typeof n&&"newName"in n?o.append(t,n,n.newName):o.append(t,n));return o},Ve.extend=function(e,t){var n,o;for(n in t)o=t[n],e[n]=o},Ve.hasOwn=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),Ve.getOwn=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0},Ve.ajax=function(){let e=XMLHttpRequest;if(window.wrappedJSObject&&!XMLHttpRequest.wrappedJSObject)try{e=XPCNativeWrapper(window.wrappedJSObject.XMLHttpRequest)}catch(e){}return function(t,n={}){var o,a;null==n.responseType&&(n.responseType="json"),n.type||(n.type=n.form?"post":"get"),t=t.replace(/^((?:https?:)?\/\/(?:\w+\.)?(?:4chan|4channel|4cdn)\.org)\/adv\//,"$1//adv/");const{onloadend:i,timeout:s,responseType:r,withCredentials:l,type:d,onprogress:c,form:h,headers:u}=n,p=new e;try{p.open(d,t,!0);const e=u||{};for(o in e)a=e[o],p.setRequestHeader(o,a);Ve.extend(p,{onloadend:i,timeout:s,responseType:r,withCredentials:l}),Ve.extend(p.upload,{onprogress:c}),Ve.on(p,"error",function(){p.status||Be.warn(`${Ce.name} failed to load: ${t}`)}),p.send(h)}catch(e){if(2153644038!==e.result)throw e;p.onloadend=i,Ve.queueTask(Ve.event,"error",null,p),Ve.queueTask(Ve.event,"loadend",null,p)}return p}}(),Ve.lastModified=Fe(),Ve.whenModified=function(e,t,n,o={}){let a;const{timeout:i,ajax:s}=o,r=Fe();return null!=(a=Ve.lastModified[t]?.[e])&&(r["If-Modified-Since"]=a),(s||Ve.ajax)(e,{onloadend(){return(Ve.lastModified[t]||(Ve.lastModified[t]=Fe()))[e]=this.getResponseHeader("Last-Modified"),n.call(this)},timeout:i,headers:r})},function(){const e=Fe();Ve.cache=function(t,n,o={}){let a;const{ajax:i}=o;return(a=e[t])?(a.callbacks?a.callbacks.push(n):Ve.queueTask(()=>n.call(a,{isCached:!0})),a):(a=(i||Ve.ajax)(t,{onloadend:function(){for(n of(this.status||delete e[t],this.callbacks))(e=>{Ve.queueTask(()=>e.call(this,{isCached:!1}))})(n);return delete this.callbacks}}),a.callbacks=[n],e[t]=a)},Ve.cleanCache=function(t){for(var n in e)t(n)&&delete e[n]}}(),Ve.cb={checked(){if(Ve.hasOwn(De,this.name))return Ve.set(this.name,this.checked),De[this.name]=this.checked},value(){if(Ve.hasOwn(De,this.name))return Ve.set(this.name,this.value.trim()),De[this.name]=this.value}},Ve.asap=function(e,t){return e()?t():setTimeout(Ve.asap,25,e,t)},Ve.onExists=function(e,t,n){let o;if(o=Ve(t,e))n(o);else{var a=new MutationObserver(function(){(o=Ve(t,e))&&(a.disconnect(),n(o))});a.observe(e,{childList:!0,subtree:!0})}},Ve.addStyle=function(e,t,n="head"){const o=Ve.el("style",{textContent:e});return null!=t&&(o.id=t),Ve.onExists(Re,n,()=>Ve.add(Te.head,o)),o},Ve.addCSP=function(e){const t=Ve.el("meta",{httpEquiv:"Content-Security-Policy",content:e});if(Te.head)return Ve.add(Te.head,t),Ve.rm(t);{const e=Ve.add(Re||Te,Ve.el("head"));return Ve.add(e,t),Ve.rm(e)}},Ve.x=function(e,t){return t||(t=Te.body),Te.evaluate(e,t,null,8,null).singleNodeValue},Ve.X=function(e,t){return t||(t=Te.body),Te.evaluate(e,t,null,7,null)},Ve.addClass=function(e,...t){e.classList.add(...t)},Ve.rmClass=function(e,...t){e.classList.remove(...t)},Ve.toggleClass=(e,t)=>e.classList.toggle(t),Ve.hasClass=(e,t)=>e.classList.contains(t),Ve.rm=e=>e?.remove(),Ve.rmAll=e=>e.textContent=null,Ve.tn=e=>Te.createTextNode(e),Ve.frag=()=>Te.createDocumentFragment(),Ve.nodes=function(e){if(!(e instanceof Array))return e;const t=Ve.frag();for(var n of e)t.appendChild(n);return t},Ve.add=(e,t)=>e.appendChild(Ve.nodes(t)),Ve.prepend=(e,t)=>e.insertBefore(Ve.nodes(t),e.firstChild),Ve.after=(e,t)=>e.parentNode.insertBefore(Ve.nodes(t),e.nextSibling),Ve.before=(e,t)=>e.parentNode.insertBefore(Ve.nodes(t),e),Ve.replace=(e,t)=>e.parentNode.replaceChild(Ve.nodes(t),e),Ve.el=function(e,t,n){const o=Te.createElement(e);return t&&Ve.extend(o,t),n&&Ve.extend(o,n),o},Ve.on=function(e,t,n){for(var o of t.split(" "))e.addEventListener(o,n,!1)},Ve.off=function(e,t,n){for(var o of t.split(" "))e.removeEventListener(o,n,!1)},Ve.one=function(e,t,n){var o=function(a){return Ve.off(e,t,o),n.call(this,a)};return Ve.on(e,t,o)},Ve.event=function(e,t,n=Te){return globalThis.chrome?.extension||null!=t&&"function"==typeof cloneInto&&(t=cloneInto(t,Te.defaultView)),n.dispatchEvent(new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:t}))},function(){if(/PaleMoon\//.test(navigator.userAgent)&&!(+GM_info?.version?.split(".")[0]<2)&&"undefined"==typeof cloneInto)try{return new CustomEvent("x",{detail:{}})}catch(t){const n={Object:unsafeWindow.Object,Array:unsafeWindow.Array};var e=function(t){var o,a;let i;if(null!=t&&"object"==typeof t&&(i=n[t.constructor.name])){const n=new i;for(o in t)a=t[o],n[o]=e(a);return n}return t};return Ve.event=(t,n,o=Te)=>o.dispatchEvent(new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:e(n)}))}}(),Ve.modifiedClick=e=>e.shiftKey||e.altKey||e.ctrlKey||e.metaKey||0!==e.button,Ve.open=globalThis.chrome?.extension?e=>window.open(e,"_blank"):null!=GM?.openInTab?GM.openInTab:"undefined"!=typeof GM_openInTab&&null!==GM_openInTab?GM_openInTab:e=>window.open(e,"_blank"),Ve.debounce=function(e,t){let n=0,o=null,a=null,i=null;const s=function(){return n=Date.now(),t.apply(a,i)};return function(){return i=arguments,a=this,n<Date.now()-e?s():(clearTimeout(o),o=setTimeout(s,e))}},Ve.queueTask=function(){const e=[],t=function(){const[t,...n]=e.shift();t(...n)};return function(){e.push(arguments),Promise.resolve().then(t)}}(),Ve.global=async function(e,t){if("crx"===je&&3===chrome.runtime.getManifest().manifest_version)return Ve.eventPageRequest({type:"runInPageContext",fn:e,data:t});if(Re){const n=Ve.el("script",{textContent:`(${Ue[e]})(document.currentScript.dataset);`});return t&&Ve.extend(n.dataset,t),Ve.add(Te.head||Re,n),Ve.rm(n),n.dataset}try{Ue[e](t)}catch(e){console.error(e)}return t},Ve.bytesToString=function(e){let t=0;for(;e>=1024;)e/=1024,t++;return`${e=t>1?Math.round(100*e)/100:Math.round(e)} ${["B","KB","MB","GB"][t]}`},Ve.minmax=(e,t,n)=>e<t?t:e>n?n:e,Ve.hasAudio=e=>e.mozHasAudio||!!e.webkitAudioDecodedByteCount||"AUDIO"===e.nextElementSibling?.tagName,Ve.luma=e=>.299*e[0]+.587*e[1]+.114*e[2],Ve.unescape=function(e){return null==e?e:e.replace(/<[^>]*>/g,"").replace(/&(amp|#039|quot|lt|gt|#44);/g,e=>({"&amp;":"&","&#039;":"'","&quot;":'"',"&lt;":"<","&gt;":">","&#44;":","}[e]))},Ve.isImage=e=>/\.(jpe?g|jfif|png|gif|bmp|webp|avif|jxl)$/i.test(e),Ve.isVideo=e=>/\.(webm|mp4|ogv)$/i.test(e),Ve.engine=/Edge\//.test(navigator.userAgent)?"edge":/Chrome\//.test(navigator.userAgent)?"blink":/WebKit\//.test(navigator.userAgent)?"webkit":/Gecko\/|Goanna/.test(navigator.userAgent)?"gecko":void 0,Ve.hasStorage=function(){try{return"true"===localStorage.getItem(Ee.NAMESPACE+"hasStorage")||(localStorage.setItem(Ee.NAMESPACE+"hasStorage","true"),"true"===localStorage.getItem(Ee.NAMESPACE+"hasStorage"))}catch(e){return!1}}(),Ve.item=function(e,t){const n=Fe();return n[e]=t,n},Ve.oneItemSugar=e=>function(t,n,o){return"string"==typeof t?e(Ve.item(t,n),o):e(t,n)},Ve.syncing=Fe(),Ve.securityCheck=function(e){if("https:"!==location.protocol)return delete e["Redirect to HTTPS"]},null==GM?.deleteValue||!window.BroadcastChannel||"undefined"!=typeof GM_addValueChangeListener&&null!==GM_addValueChangeListener?("undefined"!=typeof GM_deleteValue&&null!==GM_deleteValue?(Ve.getValue=GM_getValue,Ve.listValues=()=>GM_listValues()):Ve.hasStorage?(Ve.getValue=e=>localStorage.getItem(e),Ve.listValues=()=>(()=>{const e=[];for(var t in localStorage)t.slice(0,Ee.NAMESPACE.length)===Ee.NAMESPACE&&e.push(t);return e})()):(Ve.getValue=function(){},Ve.listValues=()=>[]),"undefined"!=typeof GM_addValueChangeListener&&null!==GM_addValueChangeListener?(Ve.setValue=GM_setValue,Ve.deleteValue=GM_deleteValue):"undefined"!=typeof GM_deleteValue&&null!==GM_deleteValue?(Ve.oldValue=Fe(),Ve.setValue=function(e,t){if(GM_setValue(e,t),e in Ve.syncing&&(Ve.oldValue[e]=t,Ve.hasStorage))return localStorage.setItem(e,t)},Ve.deleteValue=function(e){if(GM_deleteValue(e),e in Ve.syncing&&(delete Ve.oldValue[e],Ve.hasStorage))return localStorage.removeItem(e)},Ve.hasStorage||(Ve.cantSync=!0)):Ve.hasStorage?(Ve.oldValue=Fe(),Ve.setValue=function(e,t){return e in Ve.syncing&&(Ve.oldValue[e]=t),localStorage.setItem(e,t)},Ve.deleteValue=function(e){return e in Ve.syncing&&delete Ve.oldValue[e],localStorage.removeItem(e)}):(Ve.setValue=function(){},Ve.deleteValue=function(){},Ve.cantSync=Ve.cantSet=!0),"undefined"!=typeof GM_addValueChangeListener&&null!==GM_addValueChangeListener?(Ve.sync=(e,t)=>Ve.syncing[e]=GM_addValueChangeListener(Ee.NAMESPACE+e,function(n,o,a,i){if(i)return void 0!==a&&(a=Fe.json(a)),t(a,e)}),Ve.forceSync=function(){}):"undefined"!=typeof GM_deleteValue&&null!==GM_deleteValue||Ve.hasStorage?(Ve.sync=function(e,t){return e=Ee.NAMESPACE+e,Ve.syncing[e]=t,Ve.oldValue[e]=Ve.getValue(e)},function(){const e=function({key:e,newValue:t}){let n;if(n=Ve.syncing[e]){if(null!=t){if(t===Ve.oldValue[e])return;return Ve.oldValue[e]=t,n(Fe.json(t),e.slice(Ee.NAMESPACE.length))}if(null!=Ve.oldValue[e])return delete Ve.oldValue[e],n(void 0,e.slice(Ee.NAMESPACE.length))}};Ve.on(window,"storage",e),Ve.forceSync=function(t){return t=Ee.NAMESPACE+t,e({key:t,newValue:Ve.getValue(t)})}}()):(Ve.sync=function(){},Ve.forceSync=function(){}),Ve.delete=function(e){for(var t of(e instanceof Array||(e=[e]),e))Ve.deleteValue(Ee.NAMESPACE+t)},Ve.get=Ve.oneItemSugar((e,t)=>Ve.queueTask(Ve.getSync,e,t)),Ve.getSync=function(e,t){var n,o;for(n in e)if(o=Ve.getValue(Ee.NAMESPACE+n))try{e[n]=Fe.json(o)}catch(e){if(!/^(?:undefined)*$/.test(o))throw e}return t(e)},Ve.set=Ve.oneItemSugar(function(e,t){return Ve.securityCheck(e),Ve.queueTask(function(){var n,o;for(n in e)o=e[n],Ve.setValue(Ee.NAMESPACE+n,JSON.stringify(o));return t?.()})}),Ve.clear=function(e){Ve.delete(Object.keys(De)),Ve.delete(["previousversion","QR Size","QR.persona"]);try{Ve.delete(Ve.listValues().map(e=>e.replace(Ee.NAMESPACE,"")))}catch(e){}return e?.()}):(Ve.syncChannel=new BroadcastChannel(Ee.NAMESPACE+"sync"),Ve.on(Ve.syncChannel,"message",e=>(()=>{var t,n,o;const a=[];for(t in e.data)o=e.data[t],(n=Ve.syncing[t])&&a.push(n(Fe.json(JSON.stringify(o)),t));return a})()),Ve.sync=(e,t)=>Ve.syncing[e]=t,Ve.forceSync=function(){},Ve.delete=function(e,t){let n;e instanceof Array||(e=[e]),Promise.all(e.map(e=>GM.deleteValue(Ee.NAMESPACE+e))).then(function(){const o=Fe();for(n of e)o[n]=void 0;Ve.syncChannel.postMessage(o),t?.()})},Ve.get=Ve.oneItemSugar(function(e,t){const n=Object.keys(e);return Promise.all(n.map(e=>GM.getValue(Ee.NAMESPACE+e))).then(function(o){for(let t=0;t<o.length;t++){var a=o[t];a&&(e[n[t]]=Fe.json(a))}return t(e)})}),Ve.set=Ve.oneItemSugar(function(e,t){return Ve.securityCheck(e),Promise.all((()=>{var t,n;const o=[];for(t in e)n=e[t],o.push(GM.setValue(Ee.NAMESPACE+t,JSON.stringify(n)));return o})()).then(function(){return Ve.syncChannel.postMessage(e),t?.()})}),Ve.clear=e=>GM.listValues().then(t=>Ve.delete(t.map(e=>e.replace(Ee.NAMESPACE,"")),e)).catch(()=>Ve.delete(Object.keys(De).concat(["previousversion","QR Size","QR.persona"]),e))),n={url(e,t,...n){let o,a;return(a=Ee.sites[t.siteID])&&(o=Ve.getOwn(a.urls,e))?o(t,...n):void 0},threadExcerpt(e){const{OP:t}=e,n=`/${decodeURIComponent(e.board.ID)}/ - `+(t.info.subject?.trim()||t.commentDisplay().replace(/\n+/g," // ")||t.file?.name||`No.${t}`);return n.length>73?`${n.slice(0,70)}...`:n},threadFromRoot(e){if(null==e)return null;const{board:t}=e.dataset;return Ee.threads.get(`${t?encodeURIComponent(t):Ee.BOARD.ID}.${e.id.match(/\d*$/)[0]}`)},threadFromNode:e=>n.threadFromRoot(Ve.x(`ancestor-or-self::${Ee.SITE.xpath.thread}`,e)),postFromRoot(e){if(null==e)return null;const t=Ee.posts.get(e.dataset.fullID),n=e.dataset.clone;return n?t.clones[+n]:t},postFromNode:e=>n.postFromRoot(Ve.x(`ancestor-or-self::${Ee.SITE.xpath.postContainer}[1]`,e)),postDataFromLink(e){let t,n,o;if(e.dataset.postID)({boardID:t,threadID:o,postID:n}=e.dataset),o||(o=0);else{const a=e.href.match(Ee.SITE.regexp.quotelink);[t,o,n]=a.slice(1),n||(n=o)}return{boardID:t,threadID:+o,postID:+n}},allQuotelinksLinkingTo(e){var t,o;const a=[],{posts:i}=Ee,{fullID:s}=e,r=function(e,t){for(var n of(a.push(...e.nodes[t]||[]),e.clones))a.push(...n.nodes[t]||[])};if(i.forEach(function(e){if(e.quotes.includes(s))return r(e,"quotelinks")}),De["Quote Backlinks"])for(t of e.quotes)(o=i.get(t))&&r(o,"backlinks");return a.filter(function(t){const{boardID:o,postID:a}=n.postDataFromLink(t);return o===e.board.ID&&a===e.ID})}};const Qe=Symbol("isEscaped"),ze=new Set(["area","base","br","col","embed","hr","img","input","link","meta","source","track","wbr"]),We=Symbol("hFragment"),Je="Â |Â ",_e=e("div",{id:"fourchanx-settings",class:"dialog"},e("nav",null,e("div",{class:"sections-list"}),e("p",{class:"imp-exp-result warning"}),e("div",{class:"credits"},e("a",{href:"javascript:;",class:"export"},"Export"),Je,e("a",{href:"javascript:;",class:"import"},"Import"),Je,e("a",{href:"javascript:;",class:"reset"},"Reset Settings"),Je,e("input",{type:"file",hidden:!0,accept:".json,application/json"}),e("a",{href:Ce.page,target:"_blank"},Ce.name),Je,e("a",{href:Ce.changelog,target:"_blank"},Ee.VERSION),Je,e("a",{href:Ce.issues,target:"_blank"},"Issues"),Je,e("a",{href:"javascript:;",class:"close",title:"Close"},"âœ•"))),e("div",{class:"section-container"},e("section",null))),Ge=(e,t=Te.body)=>Array.from(t.querySelectorAll(e));o={init(){if((this.useFaster=/\S/.test(De.fourchanImageHost))&&"yotsuba"===Ee.SITE.software&&["index","thread"].includes(Ee.VIEW))return Ne.Post.push({name:"Image Host Rewriting",cb:this.node})},suggestions:["i.4cdn.org","is2.4chan.org"],host:()=>De.fourchanImageHost.trim()||"i.4cdn.org",flashHost:()=>"i.4cdn.org",thumbHost:()=>"i.4cdn.org",test:e=>"i.4cdn.org"===e||o.regex.test(e),regex:/^is\d*\.4chan(?:nel)?\.org$/,node(){if(this.isClone)return;const e=o.host();return this.file&&o.test(this.file.url.split("/")[2])&&!/\.swf$/.test(this.file.url)&&(this.file.link.hostname=e,this.file.thumbLink&&(this.file.thumbLink.hostname=e),this.file.url=this.file.link.href),o.fixLinks(Ge("a",this.nodes.comment))},fixLinks(e){var t,n;for(t of e)o.test(t.hostname)&&!/\.swf$/.test(t.pathname)&&(n=o.host(),t.hostname!==n&&(t.hostname=n))}};const Ye={boards:'/* General */\n.dialog {\n  border: 1px solid;\n  display: block;\n  background-color: inherit;\n}\n.dialog:not(#qr):not(#thread-watcher):not(#header-bar) {\n  box-shadow: 0 1px 2px rgba(0, 0, 0, .15);\n}\n#qr,\n#thread-watcher {\n  box-shadow: -1px 2px 2px rgba(0, 0, 0, 0.25);\n}\n.field {\n  background-color: #FFF;\n  padding: 2px 4px 3px;\n  border: 1px solid #CCC;\n  box-sizing: border-box;\n  color: #333;\n  font: 13px sans-serif;\n  outline: none;\n  margin: 0px;\n  transition: color .25s, border-color .25s;\n}\n.field::placeholder {\n  color: #AAA;\n  opacity: 1;\n}\n.field:hover {\n  border-color: #999;\n}\n.field:hover, .field:focus, .field.focus {\n  color: #000;\n}\n.field[disabled] {\n  background-color: #F2F2F2;\n  color: #888;\n}\n.move {\n  cursor: move;\n  overflow: hidden;\n}\nlabel {\n  cursor: pointer;\n}\na[href="javascript:;"] {\n  text-decoration: none;\n}\n.warning {\n  color: red;\n}\n:root.sw-yotsuba #boardNavDesktop, :root.sw-yotsuba #boardNavMobile {\n  display: none !important;\n}\n:root.hide-bottom-board-list $site$boardListBottom {\n  display: none;\n}\nbody.hasDropDownNav{\n  margin-top: 5px;\n}\n.painted {\n  border-radius: 3px;\n  padding: 0px 2px;\n}\n[hidden] {\n  display: none !important;\n}\n\n/* 4chan style fixes */\n/* overrides 4chan CSS on div.opContainer, div.op */\n:root.sw-yotsuba .opContainer, :root.sw-yotsuba .op {\n  display: block;\n  overflow: visible;\n}\n:root.sw-yotsuba .reply > .file > .fileText {\n  margin: 0 20px;\n}\n:root.sw-yotsuba #arc-list span.quote {\n  color: #789922;\n}\n:root.sw-yotsuba .fileText a {\n  unicode-bidi: isolate;\n}\n:root.sw-yotsuba #g-recaptcha {\n  min-height: 78px;\n  height: auto;\n}\n:root.sw-yotsuba:not(.js-enabled) #postForm {\n  display: table;\n}\n:root.sw-yotsuba #captchaContainerAlt td:nth-child(2) {\n  display: table-cell !important;\n}\n:root.sw-yotsuba canvas#tegaki-canvas {\n  background: none;\n}\n/* Disable obnoxious captcha fade-in. */\n:root.sw-yotsuba > body > div:last-of-type {\n  transition: none !important;\n}\n/* Fix captcha scrolling to top of page. */\n:root.sw-yotsuba > body > div[style*=" top: -10000px;"] {\n  visibility: hidden !important;\n}\n/* Make long filenames wrap properly: https://github.com/ccd0/4chan-x/issues/1082 */\n:root.sw-yotsuba .post > .file {\n  word-break: break-word;\n}\n:root.sw-yotsuba:not(.ua-webkit):not(.ua-blink) .fileText {\n  word-wrap: break-word;\n  max-width: calc(100vw - 90px);\n}\n:root.sw-yotsuba > body.is_catalog .thread > a > img {\n  display: inline-block;\n}\n/* Links to NSFW boards */\n:root.sw-yotsuba .nwsb {\n  display: inline;\n}\n:root.sw-yotsuba .fileText {\n  max-width: auto;\n  white-space: normal;\n}\n\n/* Ads */\n:root.sw-yotsuba .ad-cnt > *, :root.sw-yotsuba .adg-rects > *, :root.sw-yotsuba .bsa-cnt {\n  height: auto !important;\n}\n:root.sw-yotsuba:not(.ads-loaded) hr.abovePostForm,\n:root.sw-yotsuba:not(.ads-loaded) .adg-rects > hr,\n:root.sw-yotsuba #adg-ol + hr,\n:root.sw-yotsuba .danbo-slot:empty {\n  display: none;\n}\n:root.sw-yotsuba .adg-rects {\n  margin: 0;\n  font-size: 0;\n}\n:root.sw-yotsuba div.center[style] {\n  display: none !important;\n}\n\n/* Tinyboard / vichan conflicts */\n#menu > .hide-thread-link {\n  width: auto;\n  height: auto;\n  overflow: visible;\n  background-image: none;\n}\n#menu label.entry {\n  display: block;\n}\n#fourchanx-settings label {\n  display: inline;\n}\n.intro a[href="javascript:;"],\n#menu a {\n  margin: 0;\n}\n.gal-buttons.gal-buttons a {\n  font-size: inherit;\n}\n:root.sw-tinyboard.fixed.top-header:not(.autohide) .boardlist,\n:root.sw-tinyboard.fixed.top-header:not(.autohide) .bar.top {\n  position: static;\n}\n:root.sw-tinyboard.fixed.top-header:not(.autohide) div.pages.top {\n  top: auto;\n  bottom: 0;\n}\n:root.sw-tinyboard.fixed.top-header.autohide .boardlist,\n:root.sw-tinyboard.fixed.top-header.autohide .bar.top {\n  z-index: 3;\n}\n\n/* Tinyboard site style conflicts */\n:root[data-host="fufufu.moe"].fixed.top-header:not(.autohide) div.pages.top {\n  top: 26px;\n  bottom: auto;\n}\n:root[data-host="merorin.com"].fixed.top-header:not(.autohide) span.settings {\n  top: 26px;\n}\n:root[data-host="fufufu.moe"]:not(.fixed) #header-bar {\n  margin-top: 38px;\n}\n:root[data-host="lainchan.org"]:not(.fixed) #header-bar {\n  margin-top: 17px;\n}\n:root[data-host="smuglo.li"]:not(.fixed) #header-bar {\n  margin-top: 8px;\n}\n\n/* Anti-autoplay */\naudio.controls-added {\n  display: block;\n  margin: auto;\n  white-space: normal;\n}\n:root.anti-autoplay div.embed {\n  position: static;\n  width: auto;\n  height: auto;\n  text-align: center;\n}\n:root.anti-autoplay .autoplay-removed {\n  visibility: visible !important;\n  min-width: 640px;\n  min-height: 360px;\n}\n\n/* fixed, z-index */\n#overlay,\n#qp, #ihover,\n#navlinks, .fixed #header-bar,\n:root.float #updater,\n:root.float #thread-stats,\n#qr,\n#export-dialog {\n  position: fixed;\n}\n#overlay {\n  z-index: 999;\n}\n#qp, #ihover {\n  z-index: 60;\n}\n#menu, .gal-buttons {\n  z-index: 50;\n}\n#updater, #thread-stats {\n  z-index: 40;\n}\n:root.fixed #header-bar, #notifications {\n  z-index: 35;\n}\n#a-gallery {\n  z-index: 30;\n}\n#navlinks {\n  z-index: 25;\n}\n#qr {\n  z-index: 20;\n}\n#embedding {\n  z-index: 11;\n}\n#export-dialog {\n  z-index: 1001;\n}\n:root.fixed-watcher #thread-watcher {\n  z-index: 10;\n}\n:root.fixed:not(.gallery-open) #header-bar:not(:hover) {\n  z-index: 8;\n}\n#thread-watcher {\n  z-index: 5;\n}\n\n/* Header */\n.fixed.top-header body {\n  padding-top: 2em;\n}\n.fixed.bottom-header body {\n  padding-bottom: 2em;\n}\n.fixed #header-bar {\n  right: 0;\n  left: 0;\n  padding: 4px;\n  font-size: 13px;\n}\n.fixed.top-header #header-bar {\n  top: 0;\n}\n.fixed.bottom-header #header-bar {\n  bottom: 0;\n}\n#header-bar {\n  border-width: 0;\n  transition: all .1s .05s ease-in-out;\n}\n:root.fixed #header-bar {\n  box-shadow: -5px 1px 10px rgba(0, 0, 0, 0.20);\n}\n:root.centered-links #shortcuts {\n  width: 300px;\n  text-align: right;\n  justify-content: right;\n}\n:root.centered-links #header-bar {\n  text-align: center;\n}\n:root.centered-links #custom-board-list {\n  position: relative;\n  left: 150px;\n}\n.fixed.top-header #header-bar {\n  border-bottom-width: 1px;\n}\n.fixed.bottom-header #header-bar {\n  box-shadow: 0 -1px 2px rgba(0, 0, 0, .15);\n  border-top-width: 1px;\n}\n.fixed.bottom-header #header-bar .menu-button .icon {\n  transform: rotate(180deg) translateY(-.125em);\n}\n.fixed #header-bar.autohide:not(:hover) {\n  box-shadow: none;\n  transition: all .8s .6s cubic-bezier(.55, .055, .675, .19);\n}\n.fixed.top-header #header-bar.autohide:not(:hover) {\n  margin-bottom: -1em;\n  transform: translateY(-100%);\n}\n.fixed.bottom-header #header-bar.autohide:not(:hover) {\n  transform: translateY(100%);\n}\n#scroll-marker {\n  left: 0;\n  right: 0;\n  height: 10px;\n  position: absolute;\n}\n#header-bar:not(.autohide) #scroll-marker {\n  pointer-events: none;\n}\n#header-bar #scroll-marker {\n  display: none;\n}\n.fixed #header-bar #scroll-marker {\n  display: block;\n}\n.fixed.top-header #header-bar #scroll-marker {\n  top: 100%;\n}\n.fixed.bottom-header #header-bar #scroll-marker {\n  bottom: 100%;\n}\n#board-list a {\n  text-decoration: none;\n  padding: 1px;\n}\n#shortcuts:empty {\n  display: none;\n}\n.dead-thread,\n.disabled:not(.replies-quoting-you) {\n  opacity: .45;\n}\n#shortcuts {\n  float: right;\n  display: flex;\n  gap: 4px;\n}\n#shortcuts .icon {\n  font-size: 14px;\n}\n:root.autohiding-scrollbar #shortcuts {\n  margin-right: 12px;\n}\n:root.shortcut-icons .native-settings {\n  font-size: 0;\n  color: transparent;\n  display: inline-block;\n  vertical-align: top;\n  height: 14px;\n  width: 14px;\n  background: url(\'//s.4cdn.org/image/favicon.ico\') -1px -1px no-repeat;\n}\n#navbotright,\n#navtopright {\n  display: none;\n}\n#toggleMsgBtn {\n  display: none !important;\n}\n.current,\n:root.sw-yotsuba div#boardNavDesktopFoot a.current {\n  font-weight: bold;\n}\n/* 4chan X link brackets */\n.brackets-wrap::before {\n  content: "[";\n}\n.brackets-wrap::after {\n  content: "]";\n}\n/* Notifications */\n#notifications {\n  position: fixed;\n  top: 0;\n  height: 0;\n  text-align: center;\n  right: 0;\n  left: 0;\n  visibility: visible;\n}\n#notifications:empty {\n  display: none;\n}\n:root.fixed.top-header:not(.gallery-open) #header-bar #notifications,\n:root.fixed.top-header #header-bar.autohide #notifications {\n  position: absolute;\n  top: 100%;\n}\n.notification {\n  color: #FFF;\n  font-weight: 700;\n  text-shadow: 0 1px 2px rgba(0, 0, 0, .5);\n  box-shadow: 0 1px 2px rgba(0, 0, 0, .15);\n  border-radius: 2px;\n  margin: 1px auto;\n  width: 550px;\n  max-width: 100%;\n  position: relative;\n  transition: all .25s ease-in-out;\n  padding: 6px 5px 6px 20px;\n  display: flex;\n  gap: 5px;\n  align-items: center;\n}\n.notification.error {\n  background-color: hsla(0, 100%, 38%, .9);\n}\n.notification.warning {\n  background-color: hsla(36, 100%, 38%, .9);\n}\n.notification.info {\n  background-color: hsla(200, 100%, 38%, .9);\n}\n.notification.success {\n  background-color: hsla(104, 100%, 38%, .9);\n}\n.notification a {\n  color: white;\n}\n.notification > .close {\n  order: 1;\n}\n.message {\n  overflow-wrap: break-word;\n  box-sizing: border-box;\n  padding: 0 5px;\n  max-height: 200px;\n  width: 100%;\n  overflow: auto;\n  white-space: pre-line;\n}\n.message a {\n  text-decoration: underline;\n}\n:root.tainted .report-error {\n  display: none;\n}\n\n/* Settings */\n:root.fourchan-x body {\n  box-sizing: border-box;\n}\n#overlay {\n  background-color: rgba(0, 0, 0, .5);\n  display: flex;\n  top: 0;\n  left: 0;\n  height: 100%;\n  width: 100%;\n}\n#fourchanx-settings {\n  box-sizing: border-box;\n  box-shadow: 0 0 15px rgba(0, 0, 0, .15);\n  height: 600px;\n  max-height: 100%;\n  width: 900px;\n  max-width: 100%;\n  margin: auto;\n  padding: 5px;\n  display: flex;\n  flex-direction: column;\n}\n#fourchanx-settings > nav {\n  padding: 2px 2px 8px;\n  display: flex;\n}\n#fourchanx-settings > nav a {\n  text-decoration: underline;\n}\n#fourchanx-settings > nav a.close {\n  text-decoration: none;\n  padding: 0 2px;\n  margin: 0;\n}\n.section-container {\n  flex: 1;\n  position: relative;\n  overflow: auto;\n  padding-right: 5px;\n  overscroll-behavior: contain;\n}\n.sections-list {\n  flex: 1;\n}\n.export, .import, .reset {\n  cursor: pointer;\n  text-decoration: none !important;\n}\n.tab-selected {\n  font-weight: 700;\n}\n.section-sauce ul,\n.section-advanced ul {\n  list-style: none;\n  margin: 0;\n}\n.section-sauce ul {\n  padding: 8px;\n}\n.section-advanced ul {\n  padding: 0px;\n}\n.section-sauce li,\n.section-advanced li {\n  padding-left: 4px;\n}\n.section-main ul {\n  margin: 0;\n  padding: 0 0 0 16px;\n}\n.section-main li {\n  white-space: pre-line;\n  list-style: disc;\n}\n.section-main li:not(:first-of-type) {\n  margin-top: 4px;\n}\n.section-main label {\n  text-decoration: underline;\n}\ndiv[data-checked="false"] > .suboption-list {\n  display: none;\n}\n.suboption-list {\n  position: relative;\n}\n.suboption-list::before {\n  content: "";\n  display: inline-block;\n  position: absolute;\n  left: .7em;\n  width: 0;\n  height: 100%;\n  border-left: 1px solid;\n}\n.suboption-list > div {\n  position: relative;\n  padding-left: 1.4em;\n}\n.suboption-list > div::before {\n  content: "";\n  display: inline-block;\n  position: absolute;\n  left: .7em;\n  width: .7em;\n  height: .6em;\n  border-left: 1px solid;\n  border-bottom: 1px solid;\n}\n#fourchanx-settings .section-main p {\n  margin: .5em 0 0;\n}\n.section-filter ul {\n  padding: 0;\n}\n.section-filter li {\n  margin: 10px 40px;\n  list-style: disc;\n}\n.section-filter textarea {\n  height: 500px;\n}\n.section-main a, .section-filter a, .section-advanced a {\n  text-decoration: underline;\n}\n#sauce-doc-expand:not(:checked) ~ #sauce-doc {\n  max-height: 130px;\n  overflow: auto;\n}\n#sauce-doc > label {\n  float: right;\n  margin: 0 5px;\n}\n/* XXX for OneeChan */\n#sauce-doc-expand + .riceCheck {\n  display: none;\n}\n.section-sauce textarea {\n  height: 430px;\n}\n.section-advanced .field.wide {\n  width: 100%;\n}\n.section-advanced textarea {\n  height: 150px;\n}\n.section-advanced textarea[name="archiveLists"],\n.section-advanced textarea[name="externalCatalogURLs"],\n.section-advanced textarea[name="knownBanners"] {\n  height: 75px;\n}\n.section-advanced .archive-cell {\n  min-width: 160px;\n  text-align: center;\n}\n.section-advanced #archive-board-select {\n  position: absolute;\n}\n.section-advanced .note {\n  font-size: 0.8em;\n  font-style: italic;\n  margin-left: 10px;\n}\n.section-advanced .note code {\n  font-style: normal;\n  font-size: 11px;\n}\n.favicon-preview > img {\n    vertical-align: middle;\n}\n.favicon-preview > img:nth-of-type(3n+1) {\n    margin-left: 4px;\n}\n.section-keybinds .field {\n  font-family: monospace;\n}\n#fourchanx-settings fieldset {\n  border: 1px solid;\n  border-radius: 3px;\n  padding: 0.35em 0.625em 0.75em;\n  margin: 0px 2px;\n}\n#fourchanx-settings legend {\n  font-weight: 700;\n  color: inherit;\n}\n#fourchanx-settings textarea {\n  font-family: monospace;\n  width: 100%;\n  resize: vertical;\n}\n#fourchanx-settings code {\n  color: #000;\n  background-color: #FFF;\n  padding: 0 2px;\n}\n#fourchanx-settings th {\n  text-align: center;\n  font-weight: bold;\n}\n#fourchanx-settings p {\n  margin: 1em 0px;\n}\n#fourchanx-settings table {\n  margin: auto;\n}\n\n/* Index */\n:root.index-loading .navLinks:not(.json-index),\n:root.index-loading .board:not(.json-index),\n:root.index-loading .pagelist:not(.json-index),\n:root.infinite-mode .pagelist,\n:root.all-pages-mode .pagelist,\n:root.catalog-mode .pagelist,\n:root:not(.catalog-mode) .indexlink,\n:root.catalog-mode .cataloglink,\n:root:not(.catalog-mode) #hidden-label,\n:root:not(.catalog-mode) #index-size {\n  display: none;\n}\n#index-search {\n  padding-right: 1.5em;\n  width: 100px;\n  transition: color .25s, border-color .25s, width .25s;\n}\n#index-search:focus,\n#index-search[data-searching] {\n  width: 200px;\n}\n#index-search-clear {\n  color: gray;\n  position: relative;\n  left: -1.5em;\n}\n#index-search::-webkit-search-cancel-button {\n  display: none;\n}\n#index-search:not([data-searching]) + #index-search-clear {\n  display: none;\n}\n#index-options {\n  float: right;\n}\n#lastlong-options {\n  display: inline-block;\n  vertical-align: middle;\n  height: 28px;\n  margin: -14px 0;\n}\n#lastlong-options > input {\n  padding: 0;\n  border: 0 !important;\n  text-align: center;\n  background: transparent;\n  display: block;\n  font-size: 12px;\n  height: 12px;\n  width: 30px;\n  margin: 1px 0;\n}\n.summary {\n  text-decoration: none;\n}\n\n/* Catalog */\n:root.catalog-mode .board {\n  text-align: center;\n}\n.catalog-thread {\n  display: inline-block;\n  box-sizing: border-box;\n  border: 1px solid transparent;\n  word-wrap: break-word;\n  vertical-align: top;\n  position: relative;\n}\n/* overrides 4chan CSS on div.thread */\n.catalog-thread.catalog-thread {\n  margin: 2px;\n}\n.catalog-small > .catalog-thread {\n  width: 165px;\n  height: 320px;\n}\n.catalog-large > .catalog-thread {\n  width: 270px;\n  height: 410px;\n}\n:root.catalog-hover-expand .catalog-thread:hover {\n  z-index: 1;\n}\n.catalog-container {\n  position: absolute;\n  top: -4px;\n  left: 0;\n  right: 0;\n  bottom: 0;\n}\n.catalog-container:not(:hover),\n:root:not(.catalog-hover-expand) .catalog-container {\n  overflow: hidden;\n}\n.catalog-post {\n  position: absolute;\n  top: 4px;\n  left: 0;\n  right: 0;\n  border: 1px solid transparent;\n  padding-top: 20px;\n}\n/* overrides inline CSS from Index.cb.hoverAdjust */\n:root:not(.catalog-hover-expand) .catalog-post {\n  left: 0 !important;\n  right: 0 !important;\n}\n/* overrides 4chan CSS on div.post */\n.catalog-post.catalog-post {\n  margin: -21px -1px -1px;\n  overflow: visible;\n}\n.catalog-thread.noFile > * > .catalog-post {\n  margin-top: -7px;\n  padding-top: 6px;\n}\n:root.catalog-hover-expand .catalog-container:hover > .catalog-post {\n  margin-left: -61px;\n  margin-right: -61px;\n}\n:root.catalog-hover-expand .catalog-container:hover > * > :not(.catalog-replies) {\n  padding-left: 2px;\n  padding-right: 2px;\n}\n.catalog-link {\n  display: block;\n  position: relative;\n}\n.catalog-thumb {\n  border-radius: 2px;\n  box-shadow: 0 0 5px rgba(0, 0, 0, .25);\n  vertical-align: top;\n}\n.catalog-thumb.spoiler-file {\n  width: 100px;\n  height: 100px;\n}\n.catalog-thumb.deleted-file {\n  width: 127px;\n  height: 13px;\n  padding: 20px 11px;\n}\n.catalog-thumb.no-file {\n  width: 77px;\n  height: 13px;\n  padding: 20px 36px;\n}\n.catalog-icons > img,\n.catalog-stats > .menu-button {\n  width: 1em;\n  height: 1em;\n  margin: 0;\n  vertical-align: text-top;\n  padding-left: 2px;\n}\n.catalog-stats > .menu-button > .icon {\n  height: 10px;\n}\n.catalog-stats {\n  font-size: 10px;\n  font-weight: 700;\n  padding-top: 2px;\n}\n.catalog-stats > [title] {\n  cursor: help;\n}\n.catalog-post > .postMessage {\n  margin: 0;\n  padding-bottom: .3em;\n}\n.catalog-container:not(:hover) > * > .file,\n.catalog-container:not(:hover) > * > .postInfo > :not(.subject),\n.catalog-container:not(:hover) > * > .catalog-replies,\n.catalog-container:not(:hover) .extra-linebreak,\n.catalog-container:not(:hover) .abbr,\n:root:not(.catalog-hover-expand) .catalog-container > * > .file,\n:root:not(.catalog-hover-expand) .catalog-container > * > .postInfo > :not(.subject),\n:root:not(.catalog-hover-expand) .catalog-container > * > .catalog-replies,\n:root:not(.catalog-hover-expand) .catalog-container .extra-linebreak,\n:root:not(.catalog-hover-expand) .catalog-container .abbr,\n.catalog-thread > .catalog-container > :not(.catalog-post),\n.preview-summary,\n.catalog-post > .file > :not(.fileText),\n.catalog-post > * > .fileText > :not(:first-child),\n.catalog-post > .postInfo > :not(.subject):not(.nameBlock):not(.dateTime),\n.catalog-post > .postInfo > .nameBlock > .contact-links,\n.catalog-post > * > * > .posteruid,\n.catalog-post > * > * > .postJumper,\n:root.bottom-backlinks .catalog-post > .container,\n.post:not(.catalog-post) > .catalog-link,\n.post:not(.catalog-post) > .catalog-stats,\n.post:not(.catalog-post) > .catalog-replies {\n  display: none;\n}\n.catalog-post > .file {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  min-height: 20px;\n  background-color: inherit;\n}\n.catalog-post > * > .fileText {\n  position: relative;\n  padding: 2px;\n  background-color: inherit;\n}\n.catalog-small .catalog-post > * .fileText {\n  font-size: 10px;\n}\n.catalog-post > * > .fileText:not(:hover) {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.catalog-post > * > .fileText:hover {\n  z-index: 1;\n}\n/* overrides 4chan CSS on div.post div.postInfo */\n.catalog-post > .postInfo.postInfo {\n  width: auto;\n}\n.catalog-post > * > .subject {\n  display: block;\n}\n.catalog-post > * > .dateTime {\n  display: inline-block;\n  font-style: italic;\n}\n:root.catalog-hover-expand .catalog-container:hover > * > * > .nameBlock,\n:root.catalog-hover-expand .catalog-container:hover > * > * > .dateTime,\n:root.catalog-hover-expand .catalog-container:hover > * > .postMessage:not(:empty) {\n  padding-top: .3em;\n}\n.catalog-post .extra-linebreak {\n  content: \'\'; /* makes this work in Blink/WebKit */\n  display: block;\n  margin-top: .3em;\n}\n.catalog-reply {\n  text-align: left;\n  white-space: nowrap;\n  border-top: 1px solid transparent;\n  display: flex;\n  flex-direction: row;\n  align-items: stretch;\n}\n.catalog-reply > * {\n  padding: 3px;\n  overflow: hidden;\n  flex: none;\n}\n.catalog-reply > span {\n  font-style: italic;\n  font-weight: bold;\n}\n.catalog-reply-excerpt {\n  flex: 1 1 auto;\n}\n.catalog-post .prettyprinted {\n  max-width: 100%;\n  box-sizing: border-box;\n}\n.catalog-post .MathJax_Display {\n  text-align: center !important;\n}\n.catalog-container:not(:hover) .exif,\n:root:not(.catalog-hover-expand) .catalog-container .exif {\n  display: none !important;\n}\n.catalog-post > * > .exif {\n  border-collapse: collapse;\n}\n:root.catalog-hover-expand .catalog-container:hover .exif[style*="display: block;"] {\n  display: inline-block !important;\n}\n.catalog-post > * > .exif,\n.catalog-post > * > .exif > tbody {\n  background-color: inherit;\n}\n.catalog-post > * > .exif,\n.catalog-post > * > .exif td {\n  min-width: 0;\n}\n.catalog-post > * > .exif td {\n  padding-top: 1px;\n}\n:root.hats-enabled .catalog-thread::after {\n  content: \'\';\n  pointer-events: none;\n  position: absolute;\n  background-size: contain;\n}\n:root.hats-enabled .catalog-small > .catalog-thread::after {\n  left: -8px;\n  top: -59px;\n  width: 96px;\n  height: 96px;\n}\n:root.hats-enabled:not(.werkTyme) .catalog-small > .catalog-thread:not(.noFile)::after {\n  left: calc(67px - .3px * var(--tn-w));\n}\n:root.hats-enabled .catalog-large > .catalog-thread::after {\n  left: -15px;\n  top: -98px;\n  width: 160px;\n  height: 160px;\n}\n:root.hats-enabled:not(.werkTyme) .catalog-large > .catalog-thread:not(.noFile)::after {\n  left: calc(110px - .5px * var(--tn-w));\n}\n\n/* Copy Text Link\'s textarea element */\ntextarea.copy-text-element {\n  height: 0;\n  width: 0;\n  position: absolute;\n  top: -10000px;\n}\n\n/* Announcement Hiding */\n:root.hide-announcement $site$psa {\n  display: none;\n}\n.hide-announcement-button {\n  opacity: 0.4;\n  float: left;\n}\n\n/* Unread */\n.unread-line {\n  margin: 0;\n}\n.unread-line + br {\n  display: none;\n}\n.unread-mark-read {\n  float: right;\n  clear: both;\n  width: 100%;\n  text-align: right;\n}\n:not(.unread-thread) > .unread-mark-read {\n  display: none;\n}\n\n/* Thread Updater */\n#updater {\n  background: none;\n  border: none;\n  box-shadow: none;\n}\n#updater > .move {\n  position: absolute;\n  top: -5px;\n  bottom: -5px;\n  left: -5px;\n  right: -5px;\n  z-index: -1;\n}\n#updater > div:last-child {\n  text-align: center;\n}\n#updater input[type="number"] {\n  width: 4em;\n}\n:root.float #updater {\n  padding: 0px 3px;\n}\n:root:not(.float).shortcut-icons #updater {\n  display: inline-block;\n  min-width: 12pt;\n  text-align: right;\n}\n.new {\n  color: limegreen;\n}\n#update-status:not(.empty) + #update-timer:not(.empty):not(.loading) {\n  margin-left: 5px;\n}\n#update-timer {\n  cursor: pointer;\n}\n\n/* Thread Watcher */\n#thread-watcher {\n  position: absolute;\n}\n#thread-watcher {\n  padding-bottom: 3px;\n  padding-left: 3px;\n  white-space: nowrap;\n  min-width: 146px;\n}\n#watched-threads {\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n:root.fixed-watcher #thread-watcher {\n  position: fixed;\n}\n:root.fixed-watcher #watched-threads {\n  max-height: calc(100vh - 75px);\n}\n:root:not(.fixed-watcher) #watched-threads:not(:hover) {\n  max-height: 210px;\n  overflow-y: hidden;\n}\n#thread-watcher > .move {\n  padding-top: 3px;\n  display: flex;\n  align-items: center;\n  gap: 3px;\n}\n#watched-threads > div {\n  padding-left: 3px;\n  padding-right: 3px;\n}\n#watched-threads .watcher-link {\n  max-width: 250px;\n  display: inline-flex;\n  flex-direction: row;\n}\n#watched-threads .watcher-page,\n#watched-threads .watcher-unread {\n  flex: 0 0 auto;\n  margin-right: 2px;\n}\n#watched-threads .watcher-title {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  flex: 0 1 auto;\n}\n#watched-threads .watcher-title:not(:first-child) {\n  margin-left: 2px;\n}\n.replies-quoting-you > a, #watcher-link.replies-quoting-you, .last-page > a > .watcher-page {\n  color: #F00;\n}\n#thread-watcher a {\n  text-decoration: none;\n}\n#thread-watcher .move > .close {\n  margin-left: auto;\n}\n.watch-thread-link {\n  width: 18px;\n  height: 18px;\n  background: none;\n  border: none;\n  padding: 2px;\n  opacity: 0.2;\n  filter: none;\n  cursor: pointer;\n  color: var(--xt-watcher, #000);\n}\n.watch-thread-link.watched {\n  opacity: 1;\n}\n:root.oneechan .watch-thread-link > svg {\n  display: none;\n}\n\n\n/* Thread Stats */\n#thread-stats {\n  background: none;\n  border: none;\n  box-shadow: none;\n}\n:root.float #thread-stats > .move > :not(#page-count) {\n  pointer-events: none;\n}\n:root.float #thread-stats {\n  padding: 0px 3px;\n}\n#page-count {\n  cursor: pointer;\n}\n\n/* Quote */\n.hashlink::before {\n  content: \' \';\n  visibility: hidden;\n}\n.inline + .hashlink {\n  display: none !important;\n}\n:root.resurrect-quotes .deadlink {\n  text-decoration: none !important;\n}\n.catalog-post .qmark-ct {\n  display: none;\n}\n.backlink.deadlink:not(.forwardlink),\n.quotelink.deadlink:not(.forwardlink) {\n  text-decoration: underline !important;\n}\n:root:not(.catalog-mode) .inlined {\n  opacity: .5;\n}\n#qp input, .forwarded {\n  display: none;\n}\n.quotelink.forwardlink,\n.backlink.forwardlink {\n  text-decoration: underline dashed;\n}\n.filtered {\n  text-decoration: underline line-through;\n}\n:root.hide-backlinks .backlink.filtered,\n:root.hide-backlinks .backlink.filtered + .hashlink.filtered {\n  display: none;\n}\n.postNum + .container::before {\n  content: " ";\n}\n:root.bottom-backlinks .container {\n  display: block;\n  clear: both;\n  margin: 0 4px;\n}\n:root.bottom-backlinks .backlink {\n  font-size: 90%;\n}\n.inline {\n  border: 1px solid;\n  display: table;\n  margin: 2px 0;\n}\n.container ~ .inline {\n  margin-left: 20px;\n}\n:root.catalog-mode .inline {\n  display: none;\n}\n.inline .post {\n  border: 0 !important;\n  background-color: transparent !important;\n  display: table !important;\n  margin: 0 !important;\n  padding: 1px 2px !important;\n}\n#qp > .opContainer::after {\n  content: \'\';\n  clear: both;\n  display: table;\n}\n#qp .post {\n  border: none;\n  margin: 0;\n  padding: 2px 2px 5px;\n}\n#qp img {\n  max-height: 80vh;\n  max-width: 50vw;\n}\n#qp .preview-summary {\n  display: block;\n}\n\n/* Quote Threading */\n.threadContainer {\n  margin-left: 20px;\n  border-left: 1px solid rgba(128,128,128,.3);\n}\n.threadOP {\n  clear: both;\n}\n\n/* File */\n.expanded-image > .post > .file > .fileThumb {\n  display: flex;\n  flex-direction: column;\n}\n.fileText-original,\n.fnswitch:hover > .fntrunc,\n.fnswitch:not(:hover) > .fnfull,\n.expanded-image > .post > .file > .fileThumb > video[data-md5],\n.expanded-image > .post > .file > .fileThumb > img[data-md5] {\n  display: none;\n}\n.full-image[data-file-i-d] {\n  display: none;\n  cursor: pointer;\n}\n.expanded-image > .post > .file > .fileThumb > .full-image {\n  display: inline;\n}\n.expanded-image > .post > .file > .fileThumb > audio {\n  height: 30px;\n  width: 100%;\n  min-width: 300px;\n}\n.expanded-image {\n  clear: left;\n}\n.expanding {\n  opacity: .5;\n}\n:root.fit-height .full-image {\n  max-height: 100vh;\n}\n:root.fit-height.fixed .full-image {\n  max-height: calc(100vh - 35px);\n}\n:root.fit-width .full-image {\n  max-width: 100%;\n}\n:root.ua-gecko.fit-width .full-image {\n  width: 100%;\n}\n.fileThumb > .warning {\n  clear: both;\n}\n#ihover {\n  pointer-events: none;\n  max-height: calc(100vh - 25px);\n  max-width: 100vw;\n}\n/* WEBM Metadata */\n.webm-title > a::before {\n  content: "title";\n  text-decoration: underline;\n}\n.webm-title.loading > a::after {\n  content: "...";\n}\n.webm-title.error > a:hover::before,\n.webm-title.error > a:focus::before {\n  content: "error";\n  text-decoration: none;\n}\n.webm-title > span {\n  cursor: text;\n}\n.webm-title.not-found > span::before {\n  content: "not found";\n}\n.webm-title:not(:hover):not(:focus) > span,\n.webm-title:hover > span + a,\n.webm-title:focus > span + a {\n  display: none;\n}\n/* Volume control */\ninput[name="Default Volume"] {\n  width: 4em;\n  height: 1ex;\n  vertical-align: middle;\n  margin: 0px;\n}\n/* Fappe and Werk Tyme */\n:root.fappeTyme $site$replyOriginal.noFile,\n:root.fappeTyme $site$replyOriginal.noFile + br {\n  display: none;\n}\n:root.werkTyme $site$thumbLink,\n:root.werkTyme $site$file$thumb,\n:root.werkTyme .catalog-thumb:not(.deleted-file):not(.no-file),\n:root:not(.werkTyme) .werkTyme-filename {\n  display: none;\n}\n.werkTyme-filename {\n  font-weight: bold;\n  font-size: 110%;\n}\n:root.werkTyme .catalog-link {\n  box-shadow: 0 0 5px rgba(0, 0, 0, .25);\n  padding: 8px;\n  text-align: center;\n}\n:root.werkTyme .catalog-thumb {\n  box-shadow: none;\n  padding: 0;\n  vertical-align: middle;\n}\n.indicator {\n  background: rgba(255,0,0,0.8);\n  font-weight: bold;\n  display: inline-block;\n  min-width: 9px;\n  padding: 0px 2px;\n  margin: 0 1px;\n  text-align: center;\n  color: white;\n  border-radius: 2px;\n  cursor: pointer;\n}\n:root:not(.fappeTyme) #shortcut-fappe,\n:root:not(.werkTyme) #shortcut-werk {\n  display: none !important;\n}\n\n/* Index/Reply Navigation */\n#navlinks {\n  top: 25px;\n  right: 10px;\n}\n:root.catalog-mode #navlinks {\n  display: none;\n}\n:root.highlight-own .yourPost$site$highlightable$op::after,\n:root.highlight-you .quotesYou$site$highlightable$op::after,\n.filter-highlight$site$highlightable$op::after {\n  content: "";\n  display: block;\n  clear: both;\n}\n\n/* Spoiler text */\n:root.reveal-spoilers $site$spoiler,\n:root.reveal-spoilers $site$spoiler > a {\n  color: white !important;\n}\n:root.reveal-spoilers .removed-spoiler::before {\n  content: "[spoiler]";\n}\n:root.reveal-spoilers .removed-spoiler::after {\n  content: "[/spoiler]";\n}\n\n/* Thread & Reply Hiding */\n.hide-thread-button,\n.hide-reply-button {\n  float: left;\n  margin-right: 4px;\n  padding: 2px;\n}\n$site$infoRoot a.hide-reply-button {\n  margin-right: 6px;\n  padding: 0;\n}\n.replacedSideArrows {\n  float: left;\n}\n.hide-thread-button:not(:hover),\n.hide-reply-button:not(:hover) {\n  opacity: 0.4;\n}\n.threadContainer .hide-reply-button {\n  margin-left: 2px !important;\n  position: relative;\n  left: 1px;\n}\n.hide-thread-button {\n  margin-top: -1px;\n  width: 11px;\n}\n.stub ~ :not(.threadDivider) {\n  display: none !important;\n}\n.stub input {\n  display: inline-block;\n}\n.stub .stub-icon,\n.stub-subject {\n  margin-right: 1ch;\n}\n.stub-replies {\n  margin-left: 1ch;\n}\n.stub-reasons::before { content: \' (\'; }\n.stub-reasons::after { content: \')\'; }\n.stub-reason:not(:last-of-type)::after { content: \' & \'; }\n$site$thread[hidden] + hr {\n  display: none;\n}\n:root.reply-hide $site$sideArrows {\n  display: none;\n}\n:root.sw-yotsuba.thread-hide .party-hat {\n  left: 19px;\n}\n\n/* Anonymize */\n:root.anonymize $site$info$name,\n:root.sw-yotsuba.anonymize .post-author:not([class*=capcode]) {\n  font-size: 0;\n}\n:root.anonymize $site$info$tripcode,\n:root.sw-yotsuba.anonymize .n-pu {\n  display: none;\n}\n:root.anonymize $site$info$name::before,\n:root.sw-yotsuba.anonymize .post-author:not([class*=capcode])::before {\n  content: "Anonymous";\n  font-size: 10pt;\n}\n:root.sw-yotsuba.anonymize .flashListing .name::before,\n:root.sw-yotsuba.anonymize .post-last > .post-author:not([class*=capcode])::before {\n  font-size: 9pt;\n}\n\n/* QR */\n:root.hide-original-post-form #togglePostFormLink,\n#qr.autohide:not(.focus):not(:hover):not(:active) > form,\n:root.thread-view #qr:not(.show-new-thread-option) select[data-name="thread"],\n#file-n-submit:not(.has-file) #qr-filerm {\n  display: none;\n}\n:root.hide-original-post-form #postForm {\n  display: none !important;\n}\n#qr select,\n#qr-filename-container > a,\n.remove {\n  cursor: pointer;\n}\n#qr {\n  position: fixed;\n  padding: 1px;\n  border: 1px solid transparent;\n  min-width: 300px;\n  border-radius: 3px 3px 0 0;\n}\n#qr > form {\n  max-height: calc(100vh - 75px);\n  overflow: hidden auto;\n}\n.qr-link-container {\n  text-align: center;\n  margin: 16px 0;\n}\n.qr-link-container-bottom {\n  position: absolute;\n  margin-left: 50%;\n  transform: translateX(-50%);\n}\n.qr-link {\n  border-radius: 3px;\n  padding: 6px 10px 5px;\n  font-weight: bold;\n  vertical-align: middle;\n  border-style: solid;\n  border-width: 1px;\n  font-size: 10pt;\n}\n.qr-link-container + #togglePostFormLink {\n  font-size: 10pt;\n  font-weight: normal;\n  margin: -8px 0 3.5px;\n}\n.persona {\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n}\n.persona .field {\n  flex: 1;\n  width: 0;\n}\n#qr.forced-anon :is(input[data-name="name"]:not(.force-show), input[data-name="sub"]:not(.force-show)),\n#qr.reply-to-thread input[data-name="sub"]:not(.force-show),\nbody:not(.board_f) #qr select[name="filetag"],\n#qr.reply-to-thread select[name="filetag"],\n#qr:not(.has-sjis) #sjis-toggle,\n#qr:not(.has-math) #tex-preview-button,\n#qr.tex-preview .textarea > :not(#tex-preview),\n#qr:not(.tex-preview) #tex-preview {\n  display: none;\n}\n#sjis-toggle, #qr.sjis-preview textarea.field {\n  font-family: "IPAMonaPGothic","Mona","MS PGothic",monospace;\n  font-size: 16px;\n  line-height: 17px;\n}\n#tex-preview-button {\n  font-size: 10px;\n}\n#tex-preview {\n  white-space: pre-line;\n}\n.textarea {\n  position: relative;\n  display: flex;\n}\n#qr textarea.field {\n  height: 14.8em;\n  min-height: 9em;\n  min-width: 300px;\n  resize: both;\n}\n#qr.has-captcha textarea.field {\n  height: 9em;\n}\n#char-count {\n  color: #000;\n  background: hsla(0, 0%, 100%, .5);\n  font-size: 8pt;\n  position: absolute;\n  bottom: 1px;\n  right: 1px;\n  pointer-events: none;\n}\n#char-count.warning {\n  color: red;\n}\ninput.field.tripped:not(:hover):not(:focus) {\n  color: transparent !important;\n  text-shadow: none !important;\n}\n\n#qr > .move {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n#qr > .move label {\n  display: inline-flex;\n  align-items: center;\n}\n#qr > .move .close {\n  order: 2;\n}\n\n/* Recaptcha v2 */\n#qr .captcha-root {\n  position: relative;\n}\n#qr .captcha-container > div {\n  margin: auto;\n  width: 304px;\n}\n/* XXX scrollable with scroll bar hidden; prevents scroll on space press */\n:root.ua-blink #qr .captcha-container > div,\n:root.ua-edge #qr .captcha-container > div {\n  overflow: hidden;\n}\n:root.ua-blink #qr .captcha-container > div > div:first-of-type,\n:root.ua-edge #qr .captcha-container > div > div:first-of-type {\n  overflow-y: scroll;\n  overflow-x: hidden;\n  padding-right: 30px;\n  height: 99%;\n  width: 100%;\n}\n#qr .captcha-counter {\n  display: block;\n  width: 100%;\n  text-align: center;\n  pointer-events: none;\n}\n#qr.captcha-open .captcha-counter {\n  position: absolute;\n  bottom: 3px;\n}\n#qr .captcha-counter > a {\n  pointer-events: auto;\n  display: inline-block; /* XXX https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8851747/ */\n}\n#qr:not(.captcha-open) .captcha-counter > a {\n  display: block;\n  width: 100%;\n}\n#qr.captcha-v2 #qr-captcha-iframe {\n  width: 302px;\n  height: 423px;\n  border: 0;\n  display: block;\n  margin: auto;\n}\n.goog-bubble-content {\n  max-width: 100vw;\n  max-height: 100vh;\n  overflow: auto;\n}\n.goog-bubble-content iframe {\n  position: static !important;\n}\n#overlay.media-preview {\n  display: flex;\n  overflow: auto;\n  align-items: center;\n}\n#overlay.media-preview :is(img, video) {\n  margin: auto;\n}\n#overlay.media-preview video {\n  max-height: 100%;\n  max-width: 100%;\n}\n\n/* File Input, Submit Button, Oekaki */\n#file-n-submit, #qr .oekaki {\n  display: flex;\n  align-items: stretch;\n  margin-top: 1px;\n}\n#qr-file-button, #qr-draw-button {\n  width: 15%;\n}\n#file-n-submit input[type="submit"] {\n  width: 25%;\n}\n#qr-filename-container {\n  flex: 1 1 auto;\n  width: 0;\n  display: flex;\n  align-items: center;\n  position: relative;\n  padding: 1px;\n}\ninput#qr-filename {\n  border: none !important;\n  background: none !important;\n  outline: none;\n}\n#qr-filename,\n.has-file #qr-no-file {\n  display: none;\n}\n#qr-no-file,\n.has-file #qr-filename {\n  flex: 1 1 auto;\n  width: 0px; /* XXX Fixes filename not shrinking to allow space for buttons in Edge */\n  display: inline-block;\n  padding: 0;\n  padding-left: 3px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n#qr-no-file {\n  color: #AAA;\n}\n#qr .oekaki.has-file {\n  display: none;\n}\n#qr .oekaki > label {\n  flex: 1 1 auto;\n  width: 0;\n  display: flex;\n  align-items: center;\n}\n#qr .oekaki > label > span {\n  margin: 0 3px;\n}\n#qr .oekaki > label > input {\n  flex: 1 1 auto;\n  width: 0;\n}\n#qr .oekaki-bg {\n  position: relative;\n  display: inline-block;\n  width: 10%;\n  margin-left: 3px;\n}\n#qr .oekaki-bg > * {\n  position: absolute;\n  top: 0;\n  left: 0;\n  margin: 0;\n}\n#qr .oekaki-bg > :not([name="oekaki-bgcolor"]) {\n  z-index: 1;\n}\n#qr [name="oekaki-bgcolor"] {\n  height: 100%;\n  width: 100%;\n  border: none;\n  padding: 0;\n}\n#qr [name="oekaki-bg"]:not(:checked) ~ [name="oekaki-bgcolor"] {\n  visibility: hidden;\n}\n#qr input[type="file"] {\n  visibility: hidden;\n  position: absolute;\n}\n\n/* Spoiler Checkbox, QR Icons */\n#qr-filename-container > label, #qr-filename-container > a {\n  flex: none;\n  margin: 0;\n  margin-right: 3px;\n}\n#qr:not(.has-spoiler) #qr-spoiler-label,\n#file-n-submit:not(.has-file) :is(#qr-spoiler-label, #qr-randomize, #qr-restore-name),\n#file-n-submit:not(.has-image) #qr-jpg,\n#file-n-submit:not(.has-image):not(.has-video) #qr-view,\n#file-n-submit.has-file :is(#paste-area, #url-button),\n#file-n-submit:not(.custom-cooldown) #custom-cooldown-button {\n  display: none;\n}\n#qr-filename-container > label {\n  position: relative;\n}\n#qr-filename-container input[type="checkbox"] {\n  margin: 0;\n}\n.checkbox-letter {\n  font-size: 13px;\n  font-weight: bold;\n}\n#qr-filename-container label:not(:hover) > input[type="checkbox"]:not(:focus):not(:checked),\n#qr-filename-container label:not(:hover) > input[type="checkbox"]:not(:focus):not(:checked) ~ :not(.checkbox-letter),\n#qr-filename-container label:hover > .checkbox-letter,\ninput[type="checkbox"]:focus ~ .checkbox-letter,\ninput[type="checkbox"]:checked ~ .checkbox-letter {\n  /* not displayed but still focusable */\n  position: absolute;\n  opacity: 0;\n  pointer-events: none;\n}\n.checkbox-letter, #paste-area, #url-button, #custom-cooldown-button, #dump-button, #split-post {\n  opacity: 0.6;\n}\n#paste-area {\n  font-size: 0;\n}\n#paste-area:focus {\n  opacity: 1;\n}\n#custom-cooldown-button.disabled {\n  opacity: 0.27;\n}\n\n/* Thread and Flash Tag Select */\n#qr select {\n  background: white;\n  border: 1px solid #CCC;\n}\n#qr select[data-name="thread"] {\n  float: right;\n}\n#qr > form > select {\n  margin-top: 1px;\n}\n\n/* Dumping UI */\n.dump #dump-list-container {\n  display: block;\n}\n#dump-list-container {\n  display: none;\n  position: relative;\n  overflow-y: hidden;\n  margin-top: 1px;\n}\n#dump-list {\n  overflow: auto;\n  white-space: nowrap;\n  width: 248px;\n  max-height: 248px;\n  min-height: 90px;\n  max-width: 100%;\n  min-width: 100%;\n  display: flex;\n  flex-wrap: wrap;\n}\n.qr-preview {\n  box-sizing: border-box;\n  counter-increment: thumbnails;\n  cursor: move;\n  display: inline-block;\n  height: 90px;\n  width: 90px;\n  padding: 2px;\n  opacity: .5;\n  overflow: hidden;\n  position: relative;\n  text-shadow: 0 0 2px #000;\n  transition: opacity .25s ease-in-out, transform .25s ease-in-out;\n  vertical-align: top;\n  background-size: cover;\n  flex: none;\n}\n.qr-preview:hover,\n.qr-preview:focus {\n  opacity: .9;\n}\n.qr-preview::before {\n  content: counter(thumbnails);\n  color: #fff;\n  position: absolute;\n  top: 3px;\n  right: 3px;\n  text-shadow: 0 0 3px #000, 0 0 8px #000;\n}\n.qr-preview#selected {\n  opacity: 1;\n}\n.qr-preview.drag {\n  box-shadow: 0 0 10px rgba(0,0,0,.5);\n  transform: scale(.8);\n}\n.qr-preview.over {\n  border-color: #fff;\n  transform: scale(1.1);\n  opacity: 0.9;\n  z-index: 10;\n}\n.qr-preview > span {\n  color: #fff;\n}\n.remove {\n  background: none;\n  color: #e00;\n  padding: 1px;\n}\n.qr-preview:only-of-type > .remove {\n  display: none;\n}\n.remove:hover::after {\n  content: " Remove";\n}\n.qr-preview:not(.has-file) label,\n#qr:not(.has-spoiler) .qr-preview-spoiler {\n  display: none;\n}\n.qr-preview > label {\n  background: rgba(0,0,0,.5);\n  color: #fff;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  position: absolute;\n  text-align: center;\n}\n.qr-preview > label > input {\n  margin: 0;\n}\n#add-post {\n  cursor: pointer;\n  font-size: 1.5em;\n  position: absolute;\n  bottom: 20px;\n  right: 10px;\n  transform: translateY(calc(-50% - .75em));\n}\n#file-n-submit {\n  display: flex;\n  flex-direction: column;\n}\n#file-n-submit .row {\n  display: flex;\n  flex-direction: row;\n}\n#file-n-submit .row.space {\n  justify-content: space-between;\n}\n#qr-actions {\n  align-items: center;\n  gap: 6px;\n  padding: 0 3px;\n}\n#qr-actions .qr-action-button {\n  display: inline-flex;\n  align-items: center;\n}\n\n/* Menu */\n.menu-button {\n  position: relative;\n  cursor: pointer;\n}\n.postInfo > .menu-button {\n  margin: 0 4px;\n}\n#menu {\n  position: fixed;\n  outline: none;\n  font-weight: normal;\n}\n#menu, .submenu {\n  border-radius: 3px;\n  padding-top: 1px;\n  padding-bottom: 3px;\n}\n.entry {\n  cursor: pointer;\n  display: block;\n  outline: none;\n  padding: 2px 10px;\n  position: relative;\n  text-decoration: none;\n  white-space: nowrap;\n  min-width: 70px;\n  text-align: left;\n  text-shadow: none;\n  font-size: 10pt;\n}\n.entry input[type="checkbox"],\n.entry input[type="radio"] {\n  margin: 0px;\n  position: relative;\n  top: 2px;\n}\n.entry input[type="number"] {\n  width: 4.5em;\n}\n.entry.has-shortcut-text,\n.entry.has-submenu {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.entry .shortcut-text {\n  opacity: 0.5;\n  font-size: 70%;\n  margin-left: 5px;\n}\n.menu-indicator {\n  pointer-events: none;\n  position: relative;\n  right: -7px;\n}\n.left .menu-indicator > .icon {\n  transform: rotate(180deg);\n}\n.submenu {\n  display: none;\n  position: absolute;\n  left: 100%;\n  top: -1px;\n  margin-left: 0px;\n  margin-top: -2px;\n}\n.focused > .submenu {\n  display: block;\n}\n.imp-exp-result {\n  position: absolute;\n  text-align: center;\n  margin: auto;\n  right: 0px;\n  left: 0px;\n  width: 200px;\n}\n\n/* Custom Board Titles */\n.boardTitle, .boardSubtitle {\n  white-space: pre-line;\n}\n.boardTitle[contenteditable="true"],\n.boardSubtitle[contenteditable="true"] {\n  cursor: text !important;\n}\n\n/* Embedding */\n.embedder:not(.embedded) > span {\n  display: none;\n}\n#embedding {\n  padding: 1px 4px;\n  position: fixed;\n}\n#embedding.empty {\n  display: none;\n}\n#embedding > .move {\n  display: flex;\n  justify-content: flex-end;\n  gap: 4px;\n}\n\n/* Gallery */\n#a-gallery {\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  display: flex;\n  flex-direction: row;\n  background: rgba(0,0,0,0.7);\n}\n.gal-viewport {\n  display: flex;\n  align-items: stretch;\n  flex-direction: row;\n  flex: 1 1 auto;\n  overflow: hidden;\n}\n.gal-thumbnails {\n  flex: 0 0 150px;\n  overflow-y: auto;\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n  text-align: center;\n  background: rgba(0,0,0,.5);\n  border-left: 1px solid #222;\n}\n.gal-hide-thumbnails .gal-thumbnails {\n  display: none;\n}\n.gal-thumb img,\n.gal-thumb video {\n  max-width: 125px;\n  max-height: 125px;\n  height: auto;\n  width: auto;\n}\n.gal-thumb {\n  flex: 0 0 auto;\n  padding: 3px;\n  line-height: 0;\n  transition: background .2s linear;\n}\n.gal-highlight {\n  background: rgba(0, 190, 255,.8);\n}\n.gal-prev {\n  border-right: 1px solid #222;\n}\n.gal-next {\n  border-left: 1px solid #222;\n}\n.gal-prev,\n.gal-next {\n  flex: 0 0 20px;\n  position: relative;\n  cursor: pointer;\n  opacity: 0.7;\n  background-color: rgba(0, 0, 0, 0.3);\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n  font-size: 20px;\n  color: #fff;\n}\n.gal-prev:hover,\n.gal-next:hover {\n  opacity: 1;\n}\n.gal-image {\n  flex: 1 0 auto;\n  display: flex;\n  align-items: flex-start;\n  justify-content: space-around;\n  overflow: hidden;\n  /* Flex > Non-Flex child max-width and overflow fix (Firefox only?) */\n  width: 1%;\n}\n:root:not(.gal-fit-height):not(.gal-pdf) .gal-image {\n  overflow-y: scroll !important;\n}\n:root:not(.gal-fit-width):not(.gal-pdf) .gal-image {\n  overflow-x: scroll !important;\n}\n.gal-image a {\n  display: flex;\n  align-items: flex-start;\n  margin: auto;\n  line-height: 0;\n  max-width: 100%;\n}\n:root.gal-pdf .gal-image a {\n  width: 100%;\n  height: 100%;\n}\n.gal-image img,\n.gal-image video {\n  flex: none;\n}\n.gal-fit-width .gal-image img,\n.gal-fit-width .gal-image video {\n  max-width: 100%;\n}\n.gal-fit-height .gal-image img,\n.gal-fit-height .gal-image video {\n  max-height: calc(100vh - 25px);\n}\n.gal-image iframe {\n  width: 100%;\n  height: 100%;\n}\n.gal-buttons {\n  font-size: 1.5em;\n  margin-right: 3px;\n  padding-left: 7px;\n  padding-right: 7px;\n  top: 5px;\n}\n:root.gal-pdf .gal-buttons {\n  top: 40px;\n  background: rgba(0,0,0,0.6) !important;\n  border-radius: 3px;\n}\n.gal-buttons a {\n  color: #ffffff;\n  text-shadow: 0px 0px 1px #000000;\n}\n.gal-buttons.gal-playing > .gal-start,\n.gal-buttons:not(.gal-playing) > .gal-stop {\n  display: none;\n}\n.gal-labels {\n  position: fixed;\n  bottom: 6px;\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n}\n:root:not(.show-sauce) .gal-sauce {\n  display: none;\n}\n.gal-name,\n.gal-count,\n.gal-sauce {\n  background: rgba(0,0,0,0.6) !important;\n  border-radius: 3px;\n  padding: 1px 5px 2px 5px;\n  margin-top: 3px;\n  color: #ffffff !important;\n  text-decoration: none !important;\n}\n.gal-sauce a {\n  color: #ffffff !important;\n}\n.gal-name:hover,\n.gal-buttons a:hover,\n.gal-sauce a:hover {\n  color: rgb(95, 95, 101) !important;\n}\n:root.gal-pdf .gal-buttons a:hover {\n  color: rgb(204, 204, 204) !important;\n}\n.gal-buttons,\n.gal-labels {\n  position: fixed;\n  right: 195px;\n}\n.gal-hide-thumbnails .gal-buttons,\n.gal-hide-thumbnails .gal-labels {\n  right: 44px;\n}\n:root:not(.gal-fit-width):not(.gal-pdf) .gal-labels {\n  bottom: 23px !important;\n}\n:root.gal-fit-height:not(.gal-pdf):not(.gal-hide-thumbnails) .gal-buttons,\n:root.gal-fit-height:not(.gal-pdf):not(.gal-hide-thumbnails) .gal-labels {\n  right: 178px !important;\n}\n:root.gal-hide-thumbnails.gal-fit-height:not(.gal-pdf) .gal-buttons,\n:root.gal-hide-thumbnails.gal-fit-height:not(.gal-pdf) .gal-labels {\n  right: 28px !important;\n}\n:root.gallery-open.fixed #header-bar:not(.autohide) {\n  visibility: hidden;\n}\n\n/* Mod Contact Links */\n.contact-links {\n  margin-left: 2px;\n}\n.move-note > a {\n  text-decoration: underline;\n}\n.invisible {\n  font-size: 0;\n}\n\n/* PSA */\n.fcx-announcement {\n  text-align: center;\n}\n.fcx-announcement a {\n  text-decoration: underline;\n}\n\n.spin > .icon {\n  animation: spin 2s infinite linear;\n}\n\n/* To not scroll posts behind the header */\ndiv.post {\n  overflow: auto;\n  scroll-margin-top: 30px;\n}\n\n/* (you) markers on the scrollbar */\n.post-scroll-marker {\n  border: none;\n  padding: 0;\n  position: fixed;\n  right: -5px;\n  background-color: var(\n    --xt-scroll-maker-you, \n    var(--xt-border-highlight, currentColor)\n  );\n  border-radius: 3px;\n  width: 10px;\n  min-height: 5px;\n  top: calc(var(--top) * 1vh);\n  height: calc(var(--height) * 1vh);\n}\n\n.post-scroll-marker.you-scroll-marker {\n  opacity: 50%;\n}\n\n.scroll-marker-container {\n  display: contents;\n}/* General */\n.dialog {\n  background-color: var(--xt-background);\n  border-color: var(--xt-border);\n}\n.field:focus,\n.field.focus {\n  border-color: var(--xt-border-field-focus);\n}\n\n/* 4chan style fixes */\n:root:not(.oneechan).highlight-you .quotesYou$site$highlightable$reply {\n  border-left: 3px solid var(--xt-border-highlight) !important;\n}\n:root:not(.oneechan).highlight-own .yourPost$site$highlightable$reply {\n  border-left: 3px dashed var(--xt-border-highlight) !important;\n}\n\n/* Header */\n#header-bar.dialog {\n  background-color: var(--xt-header-dialog-bg);\n}\n:root:not(.fixed) #header-bar, #notifications {\n  font-size: var(--xt-notification-size, 9pt);\n}\n#header-bar, #notifications {\n  color: var(--xt-header-dialog-fg);\n}\n#board-list a, #shortcuts a {\n  color: var(--xt-header-link, unset);\n}\n\n/* Settings */\n#fourchanx-settings fieldset, .section-main div::before {\n  border-color: var(--xt-border);\n}\n.suboption-list > div:last-of-type {\n  background-color: var(--xt-background);\n}\n\n/* Catalog */\n:root.catalog-hover-expand .catalog-container:hover > .post {\n  background-color: var(--xt-background);\n}\n:root.werkTyme .catalog-thread:not(:hover),\n:root.werkTyme:not(.catalog-hover-expand) .catalog-thread,\n:root.catalog-hover-expand .catalog-container:hover > .post,\n:root.catalog-hover-expand .catalog-container:hover .catalog-reply {\n  border-color: var(--xt-border);\n}\n\n/* Quote */\n.backlink.deadlink {\n  color: var(--xt-dead-link) !important;\n}\n.inline {\n  border-color: var(--xt-border);\n  background-color: var(--xt-inline, rgba(255, 255, 255, .14));\n}\n\n/* Fappe and Werk Tyme */\n.indicator {\n  color: var(--xt-background);\n}\n\n/* QR */\n#dump-list::-webkit-scrollbar-thumb {\n  background-color: var(--xt-background);\n  border-color: var(--xt-border);\n}\n.qr-preview {\n  background-color: var(--xt-qr-preview-bg, rgba(0, 0, 0, .15));\n}\n.qr-link {\n  border-color: var(--xt-qr-link-border);\n  background: var(--xt-qr-bg);\n}\n.qr-link:hover {\n  background: var(--xt-link-hover-bg, var(--xt-background));\n}\n\n/* Menu */\n#menu {\n  color: var(--xt-menu-fg, var(--xt-header-link));\n}\n.entry {\n  font-size: var(--xt-entry-size, 10pt);\n}\n.focused.entry {\n  background: var(--xt-entry-focus-bg);\n}\n\n/* Unread */\n.unread-mark-read {\n  background-color: var(--xt-unread);\n}\n\n/* Thread Watcher */\n.replies-quoting-you > a, #watcher-link.replies-quoting-you, .last-page > a > .watcher-page {\n  color: var(--xt-watcher-quoting-you, #F00) !important;\n}\n\n/* Moved from style.css */\n\n/* Highlighting */\n.qphl {\n  outline: 2px solid var(--xt-qphl, rgba(216, 94, 49, .8));\n}\n:root.highlight-you .quotesYou$site$highlightable$op,\n:root.highlight-you .quotesYou$site$highlightable$reply {\n  border-left: 3px solid var(--xt-border-highlight);\n}\n:root.highlight-own .yourPost$site$highlightable$op,\n:root.highlight-own .yourPost$site$highlightable$reply {\n  border-left: 3px dashed var(--xt-border-highlight) ;\n}\n.filter-highlight$site$highlightable$op,\n.filter-highlight$site$highlightable$reply {\n  box-shadow: inset 5px 0 var(--xt-filter-highlight, rgba(221, 0, 0, .5));\n}\n:root.highlight-own .yourPost > $site$sideArrows,\n:root.highlight-you .quotesYou > $site$sideArrows,\n.filter-highlight > $site$sideArrows {\n  color: var(--xt-highlight-side-arrow, rgba(221, 0, 0, .8));\n}\n\n:root:not(.werkTyme) .catalog-thread.filter-highlight .catalog-thumb,\n:root.werkTyme .catalog-thread.filter-highlight:not(:hover),\n:root.werkTyme:not(.catalog-hover-expand) .catalog-thread.filter-highlight,\n:root.werkTyme.catalog-hover-expand .catalog-thread.filter-highlight > .catalog-container:hover > .catalog-post,\n:root.catalog $site$catalog$thread.filter-highlight$site$highlightable$catalog {\n  box-shadow: 0 0 3px 3px var(--xt-highlight-shadow, rgba(255, 0, 0, .5));\n}\n:root:not(.werkTyme) .catalog-thread.watched .catalog-thumb,\n:root:root.werkTyme .catalog-thread.watched:not(:hover),\n:root:root.werkTyme:not(.catalog-hover-expand) .catalog-thread.watched,\n:root.werkTyme.catalog-hover-expand .catalog-thread.watched > .catalog-container:hover > .catalog-post {\n  border: 2px solid var(--xt-watched-border, rgba(255, 0, 0, .75));\n}\n\n.unread-line {\n  border-color: var(--xt-unread-line, rgb(255,0,0));\n}\n\n:root.tomorrow,\n:root.spooky {\n  color-scheme: dark;\n}\n\n:root.tomorrow .field,\n:root.spooky .field {\n  background-color: unset;\n  color: unset;\n  border-color: unset;\n}\n\n:root.tomorrow input[type="button"],\n:root.spooky input[type="button"] {\n  filter: brightness(80%);\n}:root.yotsuba {\n  --xt-background: #F0E0D6;\n  --xt-border: #D9BFB7;\n  --xt-border-field-focus: #EA8;\n  --xt-border-highlight: rgba(221, 0, 0, .8);\n  --xt-header-dialog-bg: rgba(240,224,214,0.98);\n  --xt-header-dialog-fg: #B86;\n  --xt-header-link: #800000;\n  --xt-dead-link: #00E;\n  --xt-qr-link-border: rgb(225, 209, 199) rgb(225, 209, 199) rgb(210, 194, 184);\n  --xt-qr-bg: linear-gradient(#FFEFE5, #F0E0D6) repeat scroll 0% 0% transparent;\n  --xt-entry-focus-bg: rgba(255, 255, 255, .33);\n  --xt-unread: rgba(240, 224, 214, 0.5);\n  --xt-watcher: #800000;\n\n  --xt-fxt-fg: #800000;\n}:root.yotsuba-b {\n  --xt-background: #D6DAF0;\n  --xt-link-hover-bg: #D9DDF3;\n  --xt-border: #B7C5D9;\n  --xt-border-field-focus: #98E;\n  --xt-border-highlight: rgba(221, 0, 0, .8);\n  --xt-header-dialog-bg: rgba(214,218,240,0.98);\n  --xt-header-dialog-fg: #89A;\n  --xt-header-link: #34345C;\n  --xt-dead-link: #34345C;\n  --xt-qr-link-border: rgb(199, 203, 225) rgb(199, 203, 225) rgb(184, 188, 210);\n  --xt-qr-bg: linear-gradient(#E5E9FF, #D6DAF0) repeat scroll 0% 0% transparent;\n  --xt-menu-fg: #000;\n  --xt-entry-focus-bg: rgba(255, 255, 255, .33);\n  --xt-unread: rgba(214, 218, 240, 0.5);\n}:root.futaba {\n  --xt-background: #F0E0D6;\n  --xt-border: #D9BFB7;\n  --xt-border-field-focus: #EA8;\n  --xt-border-highlight: rgba(221, 0, 0, .8);\n  --xt-notification-size: 11pt;\n  --xt-header-dialog-fg: #B86;\n  --xt-dead-link: #00E;\n  --xt-header-dialog-bg: rgba(240,224,214,0.98);\n  --xt-header-link: #800000;\n  --xt-qr-link-border: rgb(225, 209, 199) rgb(225, 209, 199) rgb(210, 194, 184);\n  --xt-qr-bg: linear-gradient(#FFEFE5, #F0E0D6) repeat scroll 0% 0% transparent;\n  --xt-entry-size: 12pt;\n  --xt-entry-focus-bg: rgba(255, 255, 255, .33);\n  --xt-unread: rgba(240, 224, 214, 0.5);\n  --xt-watcher: #800000;\n\n  --xt-fxt-fg: #800000;\n}\n\n/* Anonymize */\n:root.futaba.anonymize $site$info$name::before {\n  font-size: 12pt;\n}:root.burichan {\n  --xt-background: #D6DAF0;\n  --xt-border: #B7C5D9;\n  --xt-border-field-focus: #98E;\n  --xt-border-highlight: rgba(221, 0, 0, .8);\n  --xt-header-dialog-bg: rgba(214, 218, 240, 0.98);\n  --xt-notification-size: 11pt;\n  --xt-header-dialog-fg: #89A;\n  --xt-header-link: #34345C;\n  --xt-dead-link: #34345C;\n  --xt-qr-link-border: rgb(199, 203, 225) rgb(199, 203, 225) rgb(184, 188, 210);\n  --xt-qr-bg: linear-gradient(#E5E9FF, #D6DAF0) repeat scroll 0% 0% transparent;\n  --xt-menu-fg: #000;\n  --xt-entry-size: 12pt;\n  --xt-entry-focus-bg: rgba(255, 255, 255, .33);\n  --xt-link-hover-bg: #D9DDF3;\n  --xt-unread: rgba(214, 218, 240, 0.5);\n}\n\n/* Anonymize */\n:root.burichan.anonymize $site$info$name::before {\n  font-size: 12pt;\n}:root.tomorrow {\n  --xt-background: #282A2E;\n  --xt-border: #111;\n  --xt-border-field-focus: rgb(129, 162, 190);\n  --xt-border-highlight: rgba(145, 182, 214, .8);\n  --xt-header-dialog-bg: rgba(40,42,46,0.9);\n  --xt-header-dialog-fg: #C5C8C6;\n  --xt-header-link: #81A2BE;\n  --xt-dead-link: #81A2BE;\n  --xt-inline: rgba(0, 0, 0, .14);\n  --xt-qr-preview-bg: rgba(255, 255, 255, .15);\n  --xt-qr-link-border: rgb(25, 27, 31) rgb(25, 27, 31) rgb(10, 12, 16);\n  --xt-qr-bg: linear-gradient(#37393D, #282A2E) repeat scroll 0% 0% transparent;\n  --xt-menu-fg: #C5C8C6;\n  --xt-entry-focus-bg: rgba(0, 0, 0, .33);\n  --xt-unread: rgba(40, 42, 46, 0.5);\n  --xt-watcher: #c5c8c6;\n\n  --xt-unread-line: rgb(197, 200, 198);\n  --xt-filter-highlight: rgba(145, 182, 214, .5);\n  --xt-highlight-shadow: rgba(64, 192, 255, .7);\n  --xt-watched-border: rgb(64, 192, 255);\n  --xt-qphl: rgba(145, 182, 214, .8);\n  --xt-highlight-side-arrow: rgb(155, 185, 210);\n\n  --xt-fxt-fg: #c5c8c6;\n}\n\n/* 4chan style fixes */\n:root.tomorrow #arc-list span.quote {\n  color: #B5BD68;\n}\n\n:root.tomorrow #header-bar a, :root.tomorrow #notifications a {\n  color: #81A2BE;\n}\n:root.tomorrow.shortcut-icons .native-settings {\n  background-image: url(\'//s.4cdn.org/image/favicon-ws.ico\');\n}\n\n\n:root.tomorrow #qr .field {\n  background-color: rgb(26, 27, 29);\n  color: rgb(197,200,198);\n  border-color: rgb(40, 41, 42);\n}\n:root.tomorrow #qr .field:focus,\n:root.tomorrow #qr .field.focus {\n  border-color: var(--xt-border-field-focus) !important;\n  background-color: rgb(30,32,36);\n}\n:root.tomorrow #qr select {\n  border-color: rgb(40, 41, 42);\n  background: unset;\n}\n:root.tomorrow #qr select > option {\n  background-color: var(--xt-background);\n}\n:root.tomorrow #qr-filename {\n  color: rgb(197,200,198);\n}:root.photon {\n  --xt-background: #DDD;\n  --xt-border: #CCC;\n  --xt-border-field-focus: #EA8;\n  --xt-border-highlight: rgba(221, 0, 0, .8);\n  --xt-header-dialog-bg: rgba(221, 221, 221, 0.98);\n  --xt-header-dialog-fg: #333;\n  --xt-dead-link: #F60;\n  --xt-qr-link-border: rgb(206, 206, 206) rgb(206, 206, 206) rgb(191, 191, 191);\n  --xt-qr-bg: linear-gradient(#ECECEC, #DDD) repeat scroll 0% 0% transparent;\n  --xt-menu-fg: #333;\n  --xt-entry-focus-bg: rgba(255, 255, 255, .33);\n  --xt-unread: rgba(221, 221, 221, 0.5);\n  --xt-watcher-quoting-you: #00F;\n  --xt-watcher: #333;\n\n  --xt-fxt-fg: #333;\n}\n\n/* 4chan style fixes */\n:root.photon #arc-list tr:nth-of-type(odd) span.quote {\n  color: #C0E17A;\n}:root.spooky {\n  --xt-background: #171526;\n  --xt-link-hover-bg: #1A1829;\n  --xt-border: #707070;\n  --xt-border-field-focus: #98E;\n  --xt-border-highlight: rgba(145, 182, 214, .8);\n  --xt-header-dialog-bg: rgba(23, 21, 38, 0.98);\n  --xt-header-dialog-fg: #C49756;\n  --xt-header-link: #FE9600;\n  --xt-dead-link: #FE9600;\n  --xt-qr-link-border: rgb(8, 6, 23) rgb(8, 6, 23) rgb(0, 0, 8);\n  --xt-qr-bg: linear-gradient(#262435, #171526) repeat scroll 0% 0% transparent;\n  --xt-entry-focus-bg: rgba(255, 255, 255, .33);\n  --xt-unread: rgba(23, 21, 38, 0.5);\n  --xt-watcher: #fe9600;\n\n  --xt-unread-line: rgb(197, 200, 198);\n  --xt-filter-highlight: rgba(145, 182, 214, .5);\n  --xt-qphl: rgba(145, 182, 214, .8);\n  --xt-highlight-side-arrow: rgb(155, 185, 210);\n\n  --xt-fxt-fg: #f0f8ffd1;\n}\n\n/* 4chan style fixes */\n:root.spooky #arc-list span.quote {\n  color: #634C2C;\n}\n\n:root.spooky.shortcut-icons .native-settings {\n  background-image: url(\'//s.4cdn.org/image/favicon-ws.ico\');\n}\n\n:root.spooky #qr .field {\n  background-color: rgb(26, 27, 29);\n  color: rgb(197,200,198);\n  border-color: rgb(40, 41, 42);\n}\n:root.spooky #qr .field:focus,\n:root.spooky #qr .field.focus {\n  border-color: rgb(254, 150, 0) !important;\n  background-color: rgb(30,32,36);\n}\n:root.spooky #qr select {\n  border-color: rgb(40, 41, 42);\n  background: unset;\n}\n:root.spooky #qr-filename {\n  color: rgb(197,200,198);\n}\n\n/* Unread */\n:root.spooky .unread-line {\n  visibility: visible;\n  opacity: 1;\n}/* Icons */\nsvg.icon {\n  height: 1em;\n  width: 1em;\n  display: inline-flex;\n  vertical-align: -.125em;\n}\n/* Override catalog.css */\n:root.catalog svg.icon {\n  position: static;\n}\n:root.shortcut-icons #shortcuts .icon--alt-text,\n:root:not(.shortcut-icons) .shortcut .icon {\n  display: none;\n}\n:root.shortcut-icons .shortcut.brackets-wrap::before,\n:root.shortcut-icons .shortcut.brackets-wrap::after {\n  display: none;\n}\n@keyframes spin {\n  100% {transform:rotate(1turn)}\n}:root {\n  --xt-fxt-bg: var(--xt-background);\n  --xt-fxt-border: var(--xt-border);\n}\n\n.fxt-card {\n  color: var(--xt-fxt-fg, #000);\n  background-color: var(--xt-fxt-bg, #D6DAF0);\n  padding: 16px;\n  border: 1px solid var(--xt-fxt-border, #B7C5D9);\n  border-radius: 12px;\n  gap: 8px;\n  width: 550px;\n  display: grid;\n  grid-template-columns: 48px minmax(0, 1fr);\n  grid-template-rows: max-content max-content max-content;\n  grid-template-areas:\n    "meta meta"\n    "content content"\n    "stats stats"\n}\n.fxt-meta {\n  display: flex;\n  flex-direction: row;\n  gap: 8px;\n  grid-area: meta;\n}\n.fxt-meta_profile {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  gap: 8px;\n}\n.fxt-meta_avatar {\n  display: flex;\n  align-items: center;\n}\n.fxt-meta_profile img {\n  height: 48px;\n  width: 48px;\n  aspect-ratio: 1;\n  border-radius: 100%;\n  background-color: var(--xt-fxt-border, #B7C5D9);\n}\n.fxt-meta_author {\n  display: flex;\n  flex-direction: column;\n  flex-wrap: nowrap;\n}\n.fxt-meta_author_username {\n  font-weight: bold;\n}\n.fxt-stats_meta {\n  padding-top: 8px;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-evenly;\n  gap: 8px;\n}\n.fxt-stats_meta span {\n  display: inline-flex;\n  align-items: center;\n  gap: 4px;\n}\n.fxt-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: .5rem;\n  grid-area: content;\n}\n.fxt-text {\n  white-space: pre-wrap;\n  word-break: break-word;\n}\n.fxt-poll {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n.fxt-choice {\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  font-size: 75%;\n  height: 24px;\n}\n.fxt-choice.highlight {\n  font-weight: bold;\n}\n\n.fxt-choice_label {\n  margin-left: 6px;\n  z-index: 1;\n}\n.fxt-choice_percentage {\n  margin-right: 6px;\n  z-index: 1;\n}\n.fxt-choice .fxt-bar {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 24px;\n  border-radius: 4px;\n  background-color: currentColor;\n  opacity: .3;\n  z-index: 0;\n}\n\n.fxt-total-votes {\n  font-size: 75%;\n  opacity: .5;\n}\n.fxt-media {\n  width: 100%;\n  height: 100%;\n  border-radius: 4px;\n  overflow: hidden;\n}\n.fxt-media_container {\n  --maxHeightMedia: 300px;\n}\n.fxt-media_container :is(img, video) {\n  display: block;\n  width: 100%;\n  height: 100%;\n  max-height: var(--maxHeightMedia);\n  max-width: none;\n  object-fit: contain;\n  object-position: center;\n}\n.fxt-media_container {\n  display: grid;\n  gap: 4px;\n  grid-template-columns: repeat(2, 1fr);\n  grid-auto-rows: auto;\n  grid-auto-flow: dense;\n  aspect-ratio: 16 / 9;\n}\n.fxt-media_container .fxt-media:only-child {\n  grid-column: span 2 / auto;\n  grid-row: span 2 / auto;\n}\n.fxt-media_contains_3 .fxt-media:first-child {\n  grid-row: span 2 / auto;\n}\n.fxt-media_contains_3 .fxt-media :is(img, video) {\n  max-height: calc(var(--maxHeightMedia) / 2);\n}\n.fxt-media_contains_3 .fxt-media:first-child :is(img, video) {\n  max-height: calc(var(--maxHeightMedia) + 4px);\n  /* weird spacing even though img/video has block... */\n}\n.fxt-media_video {\n  background-color: #000;\n}\n.fxt-tweet-quote {\n  width: fit-content;\n  padding: 8px;\n}\n.fxt-tweet-quote .fxt-meta_profile img {\n  height: 24px;\n  width: 24px;\n}\n.fxt-tweet-quote .fxt-meta_author {\n  font-size: 80%;\n}\n.fxt-tweet-quote .fxt-meta {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  gap: 8px;\n  padding: 4px;\n}\n.fxt-community_note {\n  display: flex;\n  flex-direction: column;\n  border: 1px solid var(--xt-fxt-border, #B7C5D9);\n  border-radius: .25rem;\n}\n.fxt-community_note-header {\n  display: flex;\n  align-items: center;\n  gap: .5rem;\n  padding: .25rem .5rem;\n  background-color: var(--xt-fxt-border, #B7C5D9);\n}\n.fxt-community_note-text {\n  padding: .5rem;\n  white-space: pre-wrap;\n}\n.fxt-tweet-reply {\n  grid-template-areas:\n    "meta meta"\n    "line content"\n    "line stats"\n}\n.fxt-tweet-reply::before {\n  grid-area: line;\n  content: \'\';\n  display: block;\n  background-color: var(--xt-fxt-border, #B7C5D9);\n  height: calc(100% + 18px);\n  width: 5px;\n  margin: auto;\n  position: relative;\n  top: -5px;\n}\n.fxt-stats {\n  grid-area: stats;\n}\n.fxt-reply_container>.fxt-tweet-reply,\n.fxt-reply_container+.fxt-tweet-original {\n  border: 0;\n  border-radius: 0;\n  padding-top: 8px;\n  padding-bottom: 8px;\n}\n.fxt-reply_container>.fxt-tweet-reply:first-child {\n  border-top-left-radius: 12px;\n  border-top-right-radius: 12px;\n  border: 1px solid var(--xt-fxt-border, #B7C5D9);\n  border-bottom: 0;\n}\n.fxt-reply_container>.fxt-tweet-reply:not(:first-child) {\n  border: 1px solid var(--xt-fxt-border, #B7C5D9);\n  border-top: 0;\n  border-bottom: 0;\n}\n.fxt-reply_container+.fxt-tweet-original {\n  border-bottom-left-radius: 12px;\n  border-bottom-right-radius: 12px;\n  border: 1px solid var(--xt-fxt-border, #B7C5D9);\n  border-top: 0;\n}\n.fxt-text_translated-label,\n.fxt-stats {\n  color: var(--xt-dead-link);\n}\n.fxt-card:is(.warning, .loading) {\n  display: flex;\n}\n.fxt-card_container {\n  max-block-size: 90dvh;\n  overflow: hidden auto;\n  scrollbar-width: thin;\n  width: fit-content;\n}'+(Ie=[{name:"audio",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAAXNSR0IArs4c6QAAAMBQTFRFAAAAAEmSADyHADN6CEOPKmWmADiKNV6lZoO5E2asU3u8B02hXYTAFXK8BEakS3i7MGS0E1mwZYzHSHjCYIrLIGDICFPDHXrIFWnBEGDDdZzWB1G2UYHMH4DPBU60EYrSSX7PGofXfajkeaPgQHzVSoHSDmHLF3vRjLbtea3sa6rsXJ3oSaHrYZXhW5blIKzwPZrqVozbKp7sRonfHpjoJ4vhRHrQLn/eNXnaJ33fNnHMJGvUFG3ZI2THBlPGAU2+9r1cgwAAACh0Uk5TAAcRGSIrO0RQUF9qdnl5hISEiaSoqqqxssnPz9DY2ery+vv7/P39/p/dKS0AAACXSURBVHjaXdDZEoIwDAXQVMuiIFrcd1FQWSqiouD6/38ltVNkel+SnMnkIfAPwrrZBB5Ft3uzlZs9Bnyuewml9HzLnwISP4hSZz4clxujVkNBAETAVeVNpy9BW8BdhpcMbw6oPPphoE027g80u8s21HUQ5gzMvX9gYGXH+EIK8MLotMUAeLpbElTAIo0dC1hqwIth4MoTvt45DOQxQMWhAAAAAElFTkSuQmCC"},{name:"bitchute",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAAXNSR0IArs4c6QAAAMBQTFRFAAAAgICAzDMzzDMz0i0tzjEx0i0t0S4u0C8v1Csr1Ssr1Csr1Csr0ykp1Ckp0yws1Soq1Soq0i0t1Soq1Csr1Csr1Ckp1ikp1Skp1ikp1ikp1ikp1ygo1ygo1ygo1igo1ygo1ygo1ygo2Ccn2Ccn+enp9+Pj9t7e9NHR9MzM8bu78LS076ys65ub65WV6YqK6ImJ54KC5XR05G5u4V9f4FRU3UhI3UVF3UFB3Dw82jU12S8v2Soq2Ccn2CYm2CQklRbHSwAAACV0Uk5TAAIFChEaIicxO0JNWWNqb3R4iZmboaettLzF1t3j6evt8/f7/Ut/7/wAAAC+SURBVHjaTcfRVoJAFIXhPaGZJqQVGIgWDFYWUZnkqOw57/9Wji4Xy++/OGfDUddBGMdh0FM46Yymmo6ejjtwulHBs2LSBbxHXgg9DDOKtZZ0RyT3EZNmv91Z7uttbWyCZzGfdbkWWS/Kt7LJkMvva7VYiZj3748vq5HK3/JnuRJrqk31L3OEbHYuko2LE/RntK6z+QDqLmMrHynAe2r3y9gDcJOSLEg9iwYKQD+hTh+Gvn/bu8LRfRIF7m0dAEgnJl0bT2c0AAAAAElFTkSuQmCC"},{name:"clyp",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAAXNSR0IArs4c6QAAAC1QTFRF////8vn9zOX2v9/0s9jxptLvmsztjcXrgL/pdLjmZ7LkWqviTaXgQZ7dNJjb3UEC1wAAAFpJREFUeNpjeAcFDMiMV+egjKd5EMbzBs06MOOQgpIOiPFGSUFJ9dw7hjfKQIaS6DuGV0IgBhNQ6gaQodIHZLxrUlDSegdiPE5QswMz3l3WewdhvNgHYmDYDgDke1tpAZA/swAAAABJRU5ErkJggg=="},{name:"dailymotion",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAAXNSR0IArs4c6QAAAMxJREFUeNqFkdENhSAMRRu/bUz4dBMGYA1GYQs/+XQFB3AFV3AO+q634SU+TR4NxdjT20IFa7hciFqnc25zm06tIQoj3Q1axbqpzU1NKyOOjLtasuyGsBAZd/EFFuHDNltoOKkDq6x9ZWT8XhkugBd8u0qIyFeKLtQoVuAzUSJV0DPlBFkbcxNObKZNp3iYKsQKEOgAzdT4AgJLpg7QO8AS3uZh61uJ3mQh8NJkiF4gscn1eU3pGtjQeDxUf2oi8vPUt2FxRPdhMfp33B/2Tf349B8MPAAAAABJRU5ErkJggg=="},{name:"gfycat",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAjVBMVEWn3gCo3gSr3w2t4BSu4Bav4Ri35C+45DK45DO55DXA50rA50vB50zC6E/D6FTF6VjG6VvL62vN7G/P7XbQ7XfW74vY8JDa8ZTe8qDe8qLf86Pi9Kzj9K7k9LHp9sDp98Lq98Ps+Mr0++L5/O75/fD6/fH6/fL6/fP7/fT7/fb8/ff8/vj8/vn+/v7///91X4cfAAAAcklEQVR42o3M2xKBUACF4aVQckrIuRJK6H//x2sme4/MuPDfre9i6c/Cc3U5Dj87BuAxsXvGu6JvIIXEHRWwNHCHQNrCzkAFkbSBg4EM8i+Yw7PXBa3zRfuxVyf/Bis7nKwGKAcWxgC8prI5Sc315OlnDfzpDar2S9/oAAAAAElFTkSuQmCC"},{name:"gist",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAAXNSR0IArs4c6QAAACpQTFRFAAAAaWlpubm5zc3PycrL7u7uCxAX/v7/2NnasbK1gYSIWFxhLTI4GR4lkI5WFQAAAAd0Uk5TADicvur2/XGJAcwAAACHSURBVHjaY2BgEPKcosgABEyzz97ZqQBkWOWeOXNtMVBg2Z67d09nKTBI5lRM8Ww/NpFB+054eXn52U0MPrfKgWDtEYa5N0GMuTcRDJ/bIMbeIwzaZ5aXl1fd3cQgefLs9MqzQO1MuyPDK+5kKzAwWO8Kr7i2GWTpmvaKkwoMQCAUXqrIwAAAoI46gu0lGAYAAAAASUVORK5CYII="},{name:"image",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAoJJREFUeNqlk8trU1sYxX/7cc7JSWqb1Da59iEpXr0ovdxcQcSJFnxMxaGOHDv1D1H/AsWhOlJwogPRsVAFJ+KjSqpto/akycnZ57W3AVEQOnPB4oPF+taafB9/CnH55qtOd7hT/yksz9TXrl88vMYuuHLnVef15u9erZS6dmRvc8U5R54Zzi656Gq3u/rbpnOA49maWfGKJo4fUrOWPtEWxzAesh5P4ck6j7p/1R+vixUtobAwVXUcWpS0W7BnARpmg/WtPnZUkAYlMjM5cRzTmp6nNTtPP1NsG8kglwzH9KqKoRLIMaNCICb38c9Sk370lSzP0aIYcubfWcI5zdQE1BR8+OLIckd/JAkCmJ8ALCxOQlHCqJjm5KEa35ISfenA4MaxE8dWXg4sA5OOG0P+bwu2YkFZOhACTwEK6j6cqDEOgKqewFq3quOdnWhj8yO3795DKcPpcxdY3L9MWBVoIZj0ILFgHRRALKARQlpaHPQ1QJYmfN56S1EYHjy8xUx9ieOd4xw+eJRu5LA4NDn7WyGBFGggcRaERPfkTGdhlPL5/UekckS9HltzPd51X6KrAb7vUwmaVMO91EJNZ+lvOu02zgrWBxn6edw6v/ZiA+kfQSiNVIJ0EGCLKmEeoKsV8tRRFB5ah3za3GZnkPBtMI/nBae0RfC1nMFvHEBpHz8MCXyfiYoaTw9PSXxPMr0nZLoWEkpFNhq3R4K5RoF2pcM52LdwEF/lnFluoaVACoGSDhx4WhJ4iszC0zcJoyRnlCbMjgO1SQ0mHpE5iE0J2ZD/FmrgHO7XJZdAxv03ll4sMSYnMUOkDBDbyXbbRKYNAFCpVKJGo7HKLtjN+8fv/B2VaRzENkpWcwAAAABJRU5ErkJggg=="},{name:"installgentoo",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAAXNSR0IArs4c6QAAAMBQTFRFAAAAAAAAAAAAAAAAAAAAAAAAd3KIAAAAEQ4RAwULzs7oAAcM2NbmlIfG5+P4vbPyAAAAAAAAAgkQ7Or4DA8YAAAAERASAwsSubXX3tn07+/3AwwUDCY15OD2XV1nS1BaEzJEZ3iOECs9IFBtaGx7RGmCJVl50Mr48fD4bmuk9vb7xM/jWYGf/f77+fj75+H839v719P2x737uKv2harYe6HSSJfLaoS/RZLDQo28Poe1O4CsLWeKSlpzJ1p+FzxSneqjOwAAAC10Uk5TAAYNEBkbL0tZXmNrcHmJjI2aoqqqrLS6u87m6Onr7e7w8vX5+vr6+/39/v7+2FamfQAAALBJREFUeNpljesaQkAYhHdRLKWSjjqIQrRyKFlK939X2bX1p+/P+80888wAAERJgi1+j2hYFqKPwJ+xW1c2gq32qnojAyAtngU5LEemWxZvTegSEQ7T/FHVNEE79hivVD8/8zJR6k/Dte5n+ZCtUKs3wHGS+SoVbG8X4DBJjwhyfQpwHEQXYnfOxL0l160+bwriyNSYNeT+UihKR2EJz/YcmYN1mMjQIEe3CkX4xf99ABzOEyTh/fKEAAAAAElFTkSuQmCC"},{name:"liveleak",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAAXNSR0IArs4c6QAAALRQTFRFcDk5Wx0doj09mSIi/Pv77/Dw6ezs29ra1tLSwrq6wGVlpF1di1ZWjSkpfhER9fT04ubm68zM19LSw7S02aqqzqamvqurwaGhsJOTunR0s3FxqW5uo2xsmm9vtGJimWNjkVxcuUpKtEZGsDU1pSoqeTk5rBIScCkprQsLlxAQpAEBnQICaxUVlAICiAEBYg8PewQEgAEBdQICbAICWwICtpycyHl5p4eHqAAAYQkJXQoKVgAAewTIdwAAADV0Uk5TmZ+or/39/f39/f39/f39/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v5oWOIfAAAAuElEQVR42kXKwS4DYRhA0fPPfKrtpM0sOpsmiCDdef9H8ABWhE0RDWo61dEIHcTC3Z3kRn5W+q++il83xp46pOo0ygaa7d0A7W4vmvfFMR4Hs+s1VR2pWmdgmUMefzJZUUCYpwTtot8yLyOlLP+SvyDpksiTLu8gI7mP7meRSNMaSWT5ZwIMIZIVJlWt3Nl2h9Eb9TB+83rE7VDo9/HxHM1NqxsJ++BkOcPDtImL88Km2BQFHGwuvwGKmzk9p5YkgwAAAABJRU5ErkJggg=="},{name:"pastebin",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAAXNSR0IArs4c6QAAAF1QTFRFAAAAMzMzLi5GZGx0BQUFXmhxJScqOz1DXWNoa3F3a290k5melJaara+xlpeY8PHx4eLi29zc1dbWz8/Px8fHv7+/t7e4rq+vpqepnZ6ejo6OhISEfX5+d3d3YGBgwIwa3gAAAA90Uk5TAAULITE2YX6anqrW3vD+JUDspAAAAK5JREFUeNpNz0luwzAMBVA5ieMOiQbOouTc/5il2kXzueLDBwimlC77f66xb99WpVrTZpBtT+naSTKxeXHs/hmgnSd1PdvJw78CWitQsFBlEFyAowzM7hadX2i5ZNap2ZvDApCqTao0RaUFNHDwhKEes4BHl+5MJ0/JC2SKo4NVo6xHgJ06OCiOw+MWMPUlL+pdS33et7eGw/O4pHg2I0KtpdjjHntk//jLcdtSSj+AHw++3ZKWJwAAAABJRU5ErkJggg=="},{name:"peertube",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAAXNSR0IArs4c6QAAAMBQTFRFAAAA/wAA/1UA/2YAxlUcdHR0Lhcu62IUKioqcHBwFBQUdnZ2GxIb8WoH82cGc3l5c3NzEhge82gGHBwc9GcFHhkZcXFxJBwZc3Nz8WcFeXNuGxsb8mkFdHR08GkFVi0TlnBZ7mgIHhwecHBwHBoadHR0c3NzGhga8WgFGxkZc3Nz8WcFc3Nz8WgFc3NzGRga8WgFc3N08WkFGxka8WgFdHR0GxkadHR0GxoadHR0GhgZ8WkE8WgE8WgFdHR0GxkaZ7hqxgAAAD10Uk5TAAEDBQkLCw0YGRkcHCQqKiorLC4vMzRbXV5fYGFjZnZ5hYmLkpadnZ+hoqPU1dXV1tjZ2dzi4uPj8/P09Vap/bMAAACRSURBVHjaVc/XEoIwEAXQjYqKGrFXLNg7ILGb5P//ys1IhmQfz869swtQWXUJmFO7h+OiBU/53raJBVIm/YIN4SzomJF9k7KzX9KQYCll/HOsEwXlBTYq4Dzy8wju0tNwHeYQqo944ij47lq4USBeG4+yaIqlKQgRzwNcG3Aa/Q/TkUMDIIPbZeCAMe66Z77/A+q6ElNsGDWuAAAAAElFTkSuQmCC"},{name:"soundcloud",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAAXNSR0IArs4c6QAAAMBQTFRF/2cA/2YA/2YA/2YA/2YA/2YA/2YA/////vby/eXW/N3K/NvJ/NnD/NjI/c+6+8uq/MKr+sKi+r6g+rme/LWY+qZ6+aNv/5Ux/48v/4ss/oos/Yos/4ol/Ikr+IFU/oMp/IIo94Iz9n88+XlK+IAo/n0l/Hwk9X0s93ot+Xok/XUh+nMg9m889HEg92k2+msc+2Qa/2YA/mYA/WUA+WAY91wj+lQU+00O+E0O/0kD/UcK+0cK+UYK/kEH/EAH/jwEfj1KkQAAAAd0Uk5TSFrk5+rt9gISbbcAAACaSURBVHjaTcE5igJRFIbR779v6K4OTaTNxFAQdP+LEMElOOEQiGBJvUHRoDxHClN6605h2NELe813fPv3CCEDoFTwRBAegESVVxSONm5yHDRkPEHky+0n1fY4LiY3ku1PKi5B6awxQ9ssIYDrLmD4h+wVgAKGRYCPxvBoUs+Dw/AO2F9Fi18B4q3Sepzo1WrLpC9pKdyM3io/AdrDMCk60CjnAAAAAElFTkSuQmCC"},{name:"streamable",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAAXNSR0IArs4c6QAAAGBQTFRFAAAAAID/CI/4gsr/BpH5CJH5BpL5arz7BZL6Z7r8BpP7BZH6BpH6JZ76B5L6BpH6BZD6/v//9Pr/5fP+2O7+wOL+veH9rtr9p9f9a7z8Y7j8T7D8O6f7JJ37GJj7BZH6dIRsvAAAABF0Uk5TAAYiKyyAiJCTlK6+0dfy+fzQvCOfAAAAmUlEQVR42l2PbQ+CMAyEC8KciBsbUxl7uf//L21HoobnQ5Neer2WhH6cjZlVTwfdaLGAsapr/YQvkygj/lDstwAKmFyB5SIDOTifKpcduNIMrGHf6muNwRc8yCC7DCQuxe0wTUhAeANVhGZZ49OXWDZf2aKA5Hlpds5H4NZiqySWVFqsjPzQp9PvxzPKorFo6YVBy/t6ICL6AH4DE9XqS58KAAAAAElFTkSuQmCC"},{name:"twitchtv",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAAXNSR0IArs4c6QAAABVQTFRF////Zz6lZEGlY0KlZUKkZEGlZEGltJNrJQAAAAZ0Uk5TASVPXWV9PfYTqwAAAD5JREFUeNpjYEiDAAZmGIMtjQEEUBksCW74GBi6WGGMsEQgIy0BiAXAjLS0RAYQIw0kwABiJjEwQBgKDAwMAD4aF9kc7HdHAAAAAElFTkSuQmCC"},{name:"twitter",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAAXNSR0IArs4c6QAAALNJREFUeNpjQAKMUFpQSIoJwudlB1NzLy47yMXEwMRgdFASrEJmJ0/vTAYWBpXThlCd8QsYTngx8B8IYwBrZWBiWBKqeEZ2SzoDM8x0keOS8a9LwPJQJT5rGXaDNUABC8OWMpGLEowIFfYHLyuHrYApYWTQPKFsdphhSQZMhOekDwNDcwfTKQ2w6xk5d8YzMDOxnbC33szMCNLQ2sPAxMDEYHh5wfMYsCZBqDd5pfl4sXgeAOR+JWx65NE5AAAAAElFTkSuQmCC"},{name:"video",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAAXNSR0IArs4c6QAAACxJREFUeNpj+M+AHzIQVEBYxX98JFEKSHPlf8IK/hNW8J+AAlLdMCgCihAEAJBiCAfi8KAsAAAAAElFTkSuQmCC"},{name:"vidlii",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAAXNSR0IArs4c6QAAAL1QTFRFAAAAAFX/AAAqAFv/ABxVAEr/ACeFAFf/AB1NAFb/ADCbAFD/A1v/AFT/AD68ADqzAEniAln/AD69AEPEBVj6AD7BAkjSD2L/CVHeD2L/GWj8EVvnMXb/GmbzKnH8KHH8U4n/Qn/6GGb9NHf8WIz4Zpf+Zpf2b576//7+//78+/r59Pb97PH/7e/34Or/5On22OP/2eP2ytj6wdL5ssn/tMf4qMH/nbr8mLb4kbP6g639daP/dqL3SIP+KnL+KsPlKgAAACh0Uk5TAAYGDhIfLjU1PkBDVFhfYWl2d36Rk6CmsLjFx9nZ3unu8PL5+/39/kamH9cAAADJSURBVHjaHcjLUoNAEAXQ248hQ0gCxIVW8f8f5d4yVlyICwTm0W0lZ3mItMFWDwNjXgFAh05p/jlf+sP7MzhO3bUNMiyOEAiQyGS2xVM+5lPHOzSny9405H6ffpvCldei1Mfg8vaVYQa23CC1avT5ilAdWtJ3myfMPO3gCjC2rNVuxjC/l0ekorSLM6rkZ1g+UBkfQW4EgUuJ1UsrK9dwbBTYSlg3yK0r516jABRfEvFSi49CHwTgOqpbWlxAtimAPyHPayKAzf4BWmNnf7ZivjUAAAAASUVORK5CYII="},{name:"vimeo",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAYFBMVEUAAAAIdZUKh6sLlLkLmr4LmsAMp88NrdYVW3MZj7Acstkrt9s1e5E7vN5EfI9JvdtKwuBijp5kpbl30eiDt8aG1uqRr7qTyNehxM+k4PCy3enB3OTg6Ovv9PXw+fz////L9U5WAAAAAXRSTlMAQObYZgAAAIFJREFUeNplz90OwiAMBWAQpAoyxclkP3je/y0H2AQXz0WT8100rRD6kNI9/cRroemQL3hXhoujZYj4OHoAmBvYGcBISwbWBvfXCrytnIDUQMkbsBpagMA7zhtQdyTFQAmIG7IkYniiZuh3XGsPqoOZkMOJOpAcLqUzNFGGu/57fwc1hgtp0mVSyQAAAABJRU5ErkJggg=="},{name:"vine",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAAXNSR0IArs4c6QAAAF1QTFRFAAAAAKqqAMaOAL+VALyUALmNAMGTALySAL6RAL2OALyNAMCPAL+PALyPAL2PAL+QALyQAL2QAL6PAL+PAL+QAL6PAL+QAL+PAL6PAL6PAL6QAL6PAL6PAL6PAL6PbycyeQAAAB50Uk5TAAMJDBMdISozNkFJUFttd36ImKqvtL/Iz9zn7/b6+V1hqgAAAKZJREFUeNotyEF2gzAMQMFvyZZJ0sf9zwkpNRhJ3TDLKTzeP8b1PagFEuirwVLmrB/jGPCyOPRly6zyKfdAlHszU0U8UChCZEIiM6hKOCpaMlCsMZzWxQf3EZrWy7wIq5VxRirS1QdBa315cyrZa7mciQlcZ+Uevb2uRCT3P0chu8q8l1XPbSYKLl2Jtd/bCSjgtdXFcv/lifDWNL978gTuWo49APgHoehXKFGk4JYAAAAASUVORK5CYII="},{name:"vocaroo",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAAXNSR0IArs4c6QAAAYBQTFRFAAAAAAAAAFUAJ04UFDsAKFENTnosIU4LO1gUM1URN2ccRm4dOmodaZI2P2seK2ULeZ9MO24VYIgtXIorPXMUI1oIYY0vS40kg65KhaJuZIg+epxVm8ZZYIswNXUPSXIhQ4AaPYQSPYIQpNRlUIAlg6xJTHMyjLpJeKRFmcZbcqA3ksJQPIUNcKA8osCClcRZZ5Mzcp4/m8RjpdRljrtgXp4sRpUSXKcpYqMwk8JVrdtpaKsxga1GjbtVVqcfjbtNocxngrpEt+Zyab02vu53pdFkXqwqotJilcZUzPKTrNV2tb1mq9hnqdlZUKMX7u7uzf6CzP2By/yAzfeOyPd+xfR8wfB6v+52uuhzweJ1tuVvx8fHtOFvsuBrwddyt9iEseJesNtvrdxkpNJhv8JsnNdboNFfotFYpcxposJxm8dco7aFm8BjvatpiMtOkMJOmbFyiMFKlbNlvZ1ghb1Afb5BjqxffJJbe4doUagXxWFTzEVR1zZP4i9QW2hGWmFP8o8FIgAAAE90Uk5TAAIGDQ0TFxcaHiUsNT1FR0pKWmRkZmdpa2trb3V1eH2IjZOVlpqdnp+ipqqtsrO7ws3O2dra2tzd4OHj5ujo7e/x8/P1+Pj6+/z8/P39/a8ykJsAAADdSURBVHjaY4AARg4VXU1tMUYGMGDnFzByjYmISvLlYwADUTWvsAAgiErQYgILSHoGgEFgvp8OWJMeiBdaHh+QVmkGUsJkkliRGZATXR8QXiICUsCTV+RfFxCaXRYQmC4IEmA1DSvICI8NBeqzYQfxuZitgDYkhQQ5aXIC+dK2Fiy8xj7uqaUG8mBncPI4KzFyaBiWFvpkeYCNYBB3UzDPCQ5KiUu2dhMGCTA5OCpK5VbXVkWo61uCncrNxcDtXVNbHGRvJ8cABUxWkcWhLoYesgwwIKEsI8DGpCrEAABv9i67kptWHQAAAABJRU5ErkJggg=="},{name:"youtube",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAAXNSR0IArs4c6QAAADBQTFRFAAAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/////+Dg/8DA/7Cw/1BQ/0BA/xsb/wAABceraAAAAAh0Uk5TABAwQFBgcIDN7a/fAAAAS0lEQVR42mPAAoTNy8uLDRkYWP+DQQCDPoTxicEfwvjKUP///8/7//9/BzF+dL+HMrqgjJ/n////DlL8D6QYrh1hIIOwGcgKLHYDAI8wSVRb1KCAAAAAAElFTkSuQmCC"}],"/* Link Title Favicons */\n"+Ie.map(({name:e,data:t})=>`.linkify.${e}::before {\n  content: "";\n  background: transparent url('data:image/png;base64,${t}') center left no-repeat!important;\n  padding-left: 18px;\n}\n`).join("")),report:"#g-recaptcha,\n:root:not(.js-enabled) #captchaContainerAlt {\n  height: auto;\n}\n#captchaContainerAlt td:nth-child(2) {\n  display: table-cell !important;\n}\n\n/* Archive reports */\n#archive-report {\n  padding: 3px;\n}\n#archive-report-enabled {\n  vertical-align: middle;\n}\n#archive-report > label {\n  display: block;\n}\n#archive-report-reason {\n  display: block;\n  width: 98%;\n}\n.archive-report-success {\n  color: green;\n}\n.archive-report-error {\n  color: red;\n}",www:"#captcha-cnt {\n  height: auto;\n}\n:root:not(.js-enabled) #form {\n  display: block;\n}\n#bd > div[style], #bd > div[style] > * {\n  height: auto !important;\n  margin: 0 !important;\n  font-size: 0;\n}",sub:function(e){var t={site:Ee.SITE.selectors};return e.replace(/\$[\w\$]+/g,function(e){var n,o=e.slice(1).split("$"),a=t;for(n=0;n<o.length;n++){if("object"!=typeof a)return":not(*)";a=Ve.getOwn(a,o[n])}return"string"!=typeof a?":not(*)":a})}},Ke={init(){if(De["Custom CSS"])return this.addStyle()},addStyle(){return this.style=Ve.addStyle(Ye.sub(De.usercss),"custom-css","#fourchanx-css")},rmStyle(){if(this.style)return Ve.rm(this.style),delete this.style},update(){return this.style?this.style.textContent=Ye.sub(De.usercss):this.addStyle()}},Xe=(e,t,n)=>`<svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 ${t} ${n}"><path d="${e}" fill="currentColor" /></svg>`,Ze={image:Xe("M448 80c8.8 0 16 7.2 16 16V415.8l-5-6.5-136-176c-4.5-5.9-11.6-9.3-19-9.3s-14.4 3.4-19 9.3L202 340.7l-30.5-42.7C167 291.7 159.8 288 152 288s-15 3.7-19.5 10.1l-80 112L48 416.3l0-.3V96c0-8.8 7.2-16 16-16H448zM64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zm80 192a48 48 0 1 0 0-96 48 48 0 1 0 0 96z",512,512),eye:Xe("M288 80c-65.2 0-118.8 29.6-159.9 67.7C89.6 183.5 63 226 49.4 256c13.6 30 40.2 72.5 78.6 108.3C169.2 402.4 222.8 432 288 432s118.8-29.6 159.9-67.7C486.4 328.5 513 286 526.6 256c-13.6-30-40.2-72.5-78.6-108.3C406.8 109.6 353.2 80 288 80zM95.4 112.6C142.5 68.8 207.2 32 288 32s145.5 36.8 192.6 80.6c46.8 43.5 78.1 95.4 93 131.1c3.3 7.9 3.3 16.7 0 24.6c-14.9 35.7-46.2 87.7-93 131.1C433.5 443.2 368.8 480 288 480s-145.5-36.8-192.6-80.6C48.6 356 17.3 304 2.5 268.3c-3.3-7.9-3.3-16.7 0-24.6C17.3 208 48.6 156 95.4 112.6zM288 336c44.2 0 80-35.8 80-80s-35.8-80-80-80c-.7 0-1.3 0-2 0c1.3 5.1 2 10.5 2 16c0 35.3-28.7 64-64 64c-5.5 0-10.9-.7-16-2c0 .7 0 1.3 0 2c0 44.2 35.8 80 80 80zm0-208a128 128 0 1 1 0 256 128 128 0 1 1 0-256z",576,512),expand:Xe("M344 0H488c13.3 0 24 10.7 24 24V168c0 9.7-5.8 18.5-14.8 22.2s-19.3 1.7-26.2-5.2l-39-39-87 87c-9.4 9.4-24.6 9.4-33.9 0l-32-32c-9.4-9.4-9.4-24.6 0-33.9l87-87L327 41c-6.9-6.9-8.9-17.2-5.2-26.2S334.3 0 344 0zM168 512H24c-13.3 0-24-10.7-24-24V344c0-9.7 5.8-18.5 14.8-22.2s19.3-1.7 26.2 5.2l39 39 87-87c9.4-9.4 24.6-9.4 33.9 0l32 32c9.4 9.4 9.4 24.6 0 33.9l-87 87 39 39c6.9 6.9 8.9 17.2 5.2 26.2s-12.5 14.8-22.2 14.8z",512,512),comment:Xe("M123.6 391.3c12.9-9.4 29.6-11.8 44.6-6.4c26.5 9.6 56.2 15.1 87.8 15.1c124.7 0 208-80.5 208-160s-83.3-160-208-160S48 160.5 48 240c0 32 12.4 62.8 35.7 89.2c8.6 9.7 12.8 22.5 11.8 35.5c-1.4 18.1-5.7 34.7-11.3 49.4c17-7.9 31.1-16.7 39.4-22.7zM21.2 431.9c1.8-2.7 3.5-5.4 5.1-8.1c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208s-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6c-15.1 6.6-32.3 12.6-50.1 16.1c-.8 .2-1.6 .3-2.4 .5c-4.4 .8-8.7 1.5-13.2 1.9c-.2 0-.5 .1-.7 .1c-5.1 .5-10.2 .8-15.3 .8c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c4.1-4.2 7.8-8.7 11.3-13.5c1.7-2.3 3.3-4.6 4.8-6.9c.1-.2 .2-.3 .3-.5z",512,512),refresh:Xe("M142.9 142.9c62.2-62.2 162.7-62.5 225.3-1L327 183c-6.9 6.9-8.9 17.2-5.2 26.2s12.5 14.8 22.2 14.8H463.5c0 0 0 0 0 0H472c13.3 0 24-10.7 24-24V72c0-9.7-5.8-18.5-14.8-22.2s-19.3-1.7-26.2 5.2L413.4 96.6c-87.6-86.5-228.7-86.2-315.8 1C73.2 122 55.6 150.7 44.8 181.4c-5.9 16.7 2.9 34.9 19.5 40.8s34.9-2.9 40.8-19.5c7.7-21.8 20.2-42.3 37.8-59.8zM16 312v7.6 .7V440c0 9.7 5.8 18.5 14.8 22.2s19.3 1.7 26.2-5.2l41.6-41.6c87.6 86.5 228.7 86.2 315.8-1c24.4-24.4 42.1-53.1 52.9-83.7c5.9-16.7-2.9-34.9-19.5-40.8s-34.9 2.9-40.8 19.5c-7.7 21.8-20.2 42.3-37.8 59.8c-62.2 62.2-162.7 62.5-225.3 1L185 329c6.9-6.9 8.9-17.2 5.2-26.2s-12.5-14.8-22.2-14.8H48.4h-.7H40c-13.3 0-24 10.7-24 24z",512,512),wrench:Xe("M352 320c88.4 0 160-71.6 160-160c0-15.3-2.2-30.1-6.2-44.2c-3.1-10.8-16.4-13.2-24.3-5.3l-76.8 76.8c-3 3-7.1 4.7-11.3 4.7H336c-8.8 0-16-7.2-16-16V118.6c0-4.2 1.7-8.3 4.7-11.3l76.8-76.8c7.9-7.9 5.4-21.2-5.3-24.3C382.1 2.2 367.3 0 352 0C263.6 0 192 71.6 192 160c0 19.1 3.4 37.5 9.5 54.5L19.9 396.1C7.2 408.8 0 426.1 0 444.1C0 481.6 30.4 512 67.9 512c18 0 35.3-7.2 48-19.9L297.5 310.5c17 6.2 35.4 9.5 54.5 9.5zM80 408a24 24 0 1 1 0 48 24 24 0 1 1 0-48z",512,512),bolt:Xe("M349.4 44.6c5.9-13.7 1.5-29.7-10.6-38.5s-28.6-8-39.9 1.8l-256 224c-10 8.8-13.6 22.9-8.9 35.3S50.7 288 64 288H175.5L98.6 467.4c-5.9 13.7-1.5 29.7 10.6 38.5s28.6 8 39.9-1.8l256-224c10-8.8 13.6-22.9 8.9-35.3s-16.6-20.7-30-20.7H272.5L349.4 44.6z",448,512),link:Xe("M579.8 267.7c56.5-56.5 56.5-148 0-204.5c-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6c31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0c-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0L579.8 267.7zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5c50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5L217.7 177.2c31.5-31.5 82.5-31.5 114 0c27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z",640,512),pencil:Xe("M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z",512,512),clipboard:Xe("M192 0c-41.8 0-77.4 26.7-90.5 64H64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64H282.5C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM112 192H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z",384,512),clock:Xe("M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z",512,512),shuffle:Xe("M403.8 34.4c12-5 25.7-2.2 34.9 6.9l64 64c6 6 9.4 14.1 9.4 22.6s-3.4 16.6-9.4 22.6l-64 64c-9.2 9.2-22.9 11.9-34.9 6.9s-19.8-16.6-19.8-29.6V160H352c-10.1 0-19.6 4.7-25.6 12.8L284 229.3 244 176l31.2-41.6C293.3 110.2 321.8 96 352 96h32V64c0-12.9 7.8-24.6 19.8-29.6zM164 282.7L204 336l-31.2 41.6C154.7 401.8 126.2 416 96 416H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H96c10.1 0 19.6-4.7 25.6-12.8L164 282.7zm274.6 188c-9.2 9.2-22.9 11.9-34.9 6.9s-19.8-16.6-19.8-29.6V416H352c-30.2 0-58.7-14.2-76.8-38.4L121.6 172.8c-6-8.1-15.5-12.8-25.6-12.8H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H96c30.2 0 58.7 14.2 76.8 38.4L326.4 339.2c6 8.1 15.5 12.8 25.6 12.8h32V320c0-12.9 7.8-24.6 19.8-29.6s25.7-2.2 34.9 6.9l64 64c6 6 9.4 14.1 9.4 22.6s-3.4 16.6-9.4 22.6l-64 64z",512,512),undo:Xe("M48.5 224H40c-13.3 0-24-10.7-24-24V72c0-9.7 5.8-18.5 14.8-22.2s19.3-1.7 26.2 5.2L98.6 96.6c87.6-86.5 228.7-86.2 315.8 1c87.5 87.5 87.5 229.3 0 316.8s-229.3 87.5-316.8 0c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0c62.5 62.5 163.8 62.5 226.3 0s62.5-163.8 0-226.3c-62.2-62.2-162.7-62.5-225.3-1L185 183c6.9 6.9 8.9 17.2 5.2 26.2s-12.5 14.8-22.2 14.8H48.5z",512,512),download:Xe("M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V274.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V416c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z",512,512),bookOpen:Xe("M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C93.5 32 46.3 45.3 18.1 56.1C6.8 60.5 0 71.7 0 83.8V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V83.8c0-12.1-6.8-23.3-18.1-27.6C529.7 45.3 482.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z",576,512),shrink:Xe("M439 7c9.4-9.4 24.6-9.4 33.9 0l32 32c9.4 9.4 9.4 24.6 0 33.9l-87 87 39 39c6.9 6.9 8.9 17.2 5.2 26.2s-12.5 14.8-22.2 14.8H296c-13.3 0-24-10.7-24-24V72c0-9.7 5.8-18.5 14.8-22.2s19.3-1.7 26.2 5.2l39 39L439 7zM72 272H216c13.3 0 24 10.7 24 24V440c0 9.7-5.8 18.5-14.8 22.2s-19.3 1.7-26.2-5.2l-39-39L73 505c-9.4 9.4-24.6 9.4-33.9 0L7 473c-9.4-9.4-9.4-24.6 0-33.9l87-87L55 313c-6.9-6.9-8.9-17.2-5.2-26.2s12.5-14.8 22.2-14.8z",512,512),heart:Xe("M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z",512,512),caretRight:Xe("M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z",256,512),caretLeft:Xe("M9.4 278.6c-12.5-12.5-12.5-32.8 0-45.3l128-128c9.2-9.2 22.9-11.9 34.9-6.9s19.8 16.6 19.8 29.6l0 256c0 12.9-7.8 24.6-19.8 29.6s-25.7 2.2-34.9-6.9l-128-128z",256,512),caretDown:Xe("M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z",320,512),scissors:Xe("M256 192l-39.5-39.5c4.9-12.6 7.5-26.2 7.5-40.5C224 50.1 173.9 0 112 0S0 50.1 0 112s50.1 112 112 112c14.3 0 27.9-2.7 40.5-7.5L192 256l-39.5 39.5c-12.6-4.9-26.2-7.5-40.5-7.5C50.1 288 0 338.1 0 400s50.1 112 112 112s112-50.1 112-112c0-14.3-2.7-27.9-7.5-40.5L499.2 76.8c7.1-7.1 7.1-18.5 0-25.6c-28.3-28.3-74.1-28.3-102.4 0L256 192zm22.6 150.6L396.8 460.8c28.3 28.3 74.1 28.3 102.4 0c7.1-7.1 7.1-18.5 0-25.6L342.6 278.6l-64 64zM64 112a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm48 240a48 48 0 1 1 0 96 48 48 0 1 1 0-96z",512,512),xmark:Xe("M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z",384,512),arrowRightLong:Xe("M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l370.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128z",512,512),plus:Xe("M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z",448,512),squarePlus:Xe("M64 80c-8.8 0-16 7.2-16 16V416c0 8.8 7.2 16 16 16H384c8.8 0 16-7.2 16-16V96c0-8.8-7.2-16-16-16H64zM0 96C0 60.7 28.7 32 64 32H384c35.3 0 64 28.7 64 64V416c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V96zM200 344V280H136c-13.3 0-24-10.7-24-24s10.7-24 24-24h64V168c0-13.3 10.7-24 24-24s24 10.7 24 24v64h64c13.3 0 24 10.7 24 24s-10.7 24-24 24H248v64c0 13.3-10.7 24-24 24s-24-10.7-24-24z",448,512),squareMinus:Xe("M64 80c-8.8 0-16 7.2-16 16V416c0 8.8 7.2 16 16 16H384c8.8 0 16-7.2 16-16V96c0-8.8-7.2-16-16-16H64zM0 96C0 60.7 28.7 32 64 32H384c35.3 0 64 28.7 64 64V416c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V96zM152 232H296c13.3 0 24 10.7 24 24s-10.7 24-24 24H152c-13.3 0-24-10.7-24-24s10.7-24 24-24z",448,512),play:Xe("M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z",384,512),stop:Xe("M0 128C0 92.7 28.7 64 64 64H320c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128z",384,512),arrowUpLong:Xe("M214.6 9.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 109.3V480c0 17.7 14.3 32 32 32s32-14.3 32-32V109.3l73.4 73.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-128-128z",384,512),arrowDownLong:Xe("M169.4 502.6c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 402.7 224 32c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 370.7L86.6 329.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128z",384,512)};a={set(e,t,n){const o=Ze[t];if(!o)throw new Error(`Icon "${t}" not found.`);e.innerHTML=n?`<span class="icon--alt-text">${Se(n)}</span>${o}`:o},get:e=>Ze[e],raw:e=>({innerHTML:Ze[e],[Qe]:!0})},i={init:()=>Ve.asap(()=>Te.head&&(i.el=Ve('link[rel="shortcut icon"]',Te.head)),i.initAsap),set(e){if(i.status=e,i.el)return i.el.href=i[e],Ve.add(Te.head,i.el)},initAsap(){i.el.type="image/x-icon";const{href:e}=i.el;if(i.isSFW=/ws\.ico$/.test(e),i.default=e,i.switch(),i.status)return i.set(i.status)},switch(){let e={ferongr:["iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAFVBMVEX///9zBQC/AADpDAP/gID/q6voCwJJTwpOAAAAAXRSTlMAQObYZgAAAGJJREFUeF5Fi7ENg0AQBCfa/AFdDh2gdwPIogMK2E2+/xLslwOvdqRJhv+GQQPUCtJM7svankLrq/I+TY5e6Ueh1jyBMX7AFJi9vwfyVO4CbbO6jNYpp9GyVPbdkFhVgAQ2H0NOE5jk9DT8AAAAAElFTkSuQmCC","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAxUlEQVR42q1TOwrCQBB9s0FRtJI0WoqFtSLYegoP4gVSeJsUHsHSI3iFeIqRXXgwrhlXwYHHhLwPTB7B36abBCV+0pA4DUBQUNZYQptGtW3jtoKyxgoe0yrBCoyZfL/5ioQ3URZOXW9I341l3oo+NXEZiW4CEuIzvPECopED4OaZ3RNmeAm4u+a8Jr5f17VyVoL8fr8qcltzwlyyj2iqcgPOQ9ExkHAITgD75bYBe0A5S4H/P9htuWMF3QXoQpwaKeT+lnsC6JE5I6aq6fEAAAAASUVORK5CYII=","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAFVBMVEX///8AcH4AtswA2PJ55fKi6fIA1/FtpPADAAAAAXRSTlMAQObYZgAAAGJJREFUeF5Fi7ENg0AQBCfa/AFdDh2gdwPIogMK2E2+/xLslwOvdqRJhv+GQQPUCtJM7svankLrq/I+TY5e6Ueh1jyBMX7AFJi9vwfyVO4CbbO6jNYpp9GyVPbdkFhVgAQ2H0NOE5jk9DT8AAAAAElFTkSuQmCC","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAxElEQVQ4y2NgoBq4/vE/HJOsBiRQUIfA2AzBqQYqUfn00/9FLz+BaQxDCKqBmX7jExijKEDSDJPHrnnbGQhGV4RmOFwdVkNwhQMheYwQxhaIi7b9Z9A3gWAQm2BUoQOgRhgA8o7j1ozLC4LCyAZcx6kZI5qg4kLKqggDFFWxJySsUQVzlb4pwgAJaTRvokcVNgOqOv8zcHBCsL07DgNg8YsczzA5MxtUL+DMD8g0slxI/H8GQ/P/DJKyeKIRpglXZsIiBwBhP5O+VbI/JgAAAABJRU5ErkJggg==","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAFVBMVEX///8oeQBJ3ABV/wHM/7Lu/+ZU/gAqUP3dAAAAAXRSTlMAQObYZgAAAGJJREFUeF5Fi7ENg0AQBCfa/AFdDh2gdwPIogMK2E2+/xLslwOvdqRJhv+GQQPUCtJM7svankLrq/I+TY5e6Ueh1jyBMX7AFJi9vwfyVO4CbbO6jNYpp9GyVPbdkFhVgAQ2H0NOE5jk9DT8AAAAAElFTkSuQmCC","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAx0lEQVQ4y2NgoBYI+cfwH4ZJVgMS0KhEYGyG4FQDkzjzf9P/d/+fgWl0QwiqgSkI/c8IxsgKkDXD5LFq9rwDweiK0A2HqcNqCK5wICSPEcLYAtH+AMN/IXMIBrEJRie6OEgjDAC5x3FqxuUFNiEUA67j1IweTTBxBQ1puAG86jgSEraogskJWSBcwCGF5k30qMJmgMFEhv/MXBAs5oLDAFj8IsczTE7UEeECbhU8+QGZRpaTi2b4L2zF8J9TGk80wjThykzY5AAW/2O1C2mIbgAAAABJRU5ErkJggg=="],"xat-":["iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAG1BMVEX+AACLkZFub2yfaF3zZGIAAAD/AAD/iYr/zs8IPcF6AAAABXRSTlMAeprJ7xzg6IEAAABZSURBVAjXY2DABKGBSkqioQwMrGmpxsZhaQEMDGFpIa5pqSCRtPDSNJBIaGh5eShQDYOye0V7iREKAyQFYoiCFAcyILQDGcGmEEZYkGoqiMHKysAQEICwGwAAjBmBqhYlagAAAABJRU5ErkJggg==","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAPFBMVEUAAACEgoBva2ilamDxcG7IaWYgFBNOSEf//f0PDQwBAAA7LCwAAAD/AAD+hIX+m5z+zc5HAADPAAAGAADl032uAAAADHRSTlMAzNv0/vz+6v3+7ALrmfyXAAAAaUlEQVQY042PyxKAIAhFAc1eV7T6/3/N8VXOtAgWwBm4ANEPA8AswpySXHvvYZLlpBNrh9pDtcSqAQ1BUTVIjNUQY5icmwfglmXNgE0d6QBF9GigrU0A9LoM53U1kFzk6SBQuWfD/vHqDUCpBmVKTTM4AAAAAElFTkSuQmCC","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAIVBMVEUAAACRjop4dXVpZ2tdcI9dfKdisfMAAAAumMN9xv+s2/+PADT2AAAAB3RSTlMAepGdv83v3HIc4QAAAFxJREFUCNdjYMAE5YXKRuLlDAzsHe2uIRUdBQwMFR1l6R3tIJGOyukdIJHy8lkry4FqGEwzV62aFozMUAFJOQEZ4iDFhQwI7UBGaTiEUVFs3g5isLMzMBQUIOwGAJRlIu9hk08QAAAAAElFTkSuQmCC","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAMFBMVEUAAACAgYVlc4ljsu4AAAAAAAAAAAAumMODyP6b1P6e1f/g8v89msgSIiwNFxwbPU3tQYj5AAAABnRSTlMAxej+9VTmD9ciAAAAZElEQVQI12NgwARpiUKKYmkMDGzlZUpK6eUJDAzp5clm5WUgkfKMtnKQSFpa54o0oBoGJYvZO88+gjJu7wMyhIBS2SCGGFDxaxADpP32NjAjSe0bSFd6epIaWISNjYEhJRVhNwAGlyJpYtcvcAAAAABJRU5ErkJggg==","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAHlBMVEUfJSCRi5Frbm9dn19082KR/30AAABmzDOq/5vZ/9Gt/vt2AAAABnRSTlMAe5rJ7/4vxEp4AAAAWUlEQVQI12NgwARpiUpKYmkMDGzlZcbG6eUJDAzp5Slu5WUgkfLUsHKQSFpaRGsaUA2DsmvnjBAjFAZICsQQAylOZEBoBzKSzSCM9CS1MhCDjY2BISEBYTcAtgAcKSK2vuIAAAAASUVORK5CYII=","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAM1BMVEUAAACBj39tfm1qj2RepFlu2VQAAQAAAAAAAABmyzOX/oSr/pus/pzk/98PGgtatC4CBAI1ENblAAAACHRSTlMA09/p9v77ig0SBcQAAABnSURBVBjTjY9LDsAgCEQRsR2xWu9/2hK/adJFYQG8wABEPwyAYzNnSatjjPAiviWLhPCqI1R7HBrQdCmGBrEETTmnUAq/QMm5dODHyAQOXXR1zLUGsIEI7lonMGfeHQTq9xw4P159AIxSBSC53km7AAAAAElFTkSuQmCC"],Mayhem:["iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABFklEQVR4AZ2R4WqEMBCEFy1yiJQQ14gcIhIuFBFR+qPQ93+v66QMksrlTwMfkZ2ZZbMKTgVqYIDl3YAbeCM31lJP/Zul4MAEPJjBQGNDLGsz8PQ6aqLAP5PTdd1WlmU09mSKtdTDRgrkzspJPKq6RxMahfj9yhOzQEZwZAwfzrk1ox3MXibIN8hO4MAjeV72CemJGWblnRsOYOdoGw0jebB20BPAwKzUQPlrFhrXFw1Wagu9yuzZwINzVAZCURRL+gRr7Wd8Vtqg4Th/lsUmewyk9WQ/A7NiwJz5VV/GmO+MNjMrFvh/NPDMigHTaeJN09a27ZHRJmalBg54CgfvAGYSLpoHjlmpuAwFdzDy7oGS/qIpM9UPFGg1b1kUlssAAAAASUVORK5CYII=","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABR0lEQVR4AYWSQWq0QBCFCw0SRIK0PQ4hiIhEZBhEySLyewUPEMgqR/JIXiDhzz7kKKYePIZajEzDRxfV9dWU3SO6IiVWUsVxT5R75Y4gTmwNnUh4kCulUiuV8sjChDjmKtaUcHgmHsnNrMPh0IVhiMIjKZGzNXDoyhMzF7C89z2KtFGD+FoNXEUKZdgpaPM8P++cDXTtBDca7EyQK8+bXTufYBccuvLAG26UnqN1LCgI4g/lm7zTgSux4vk0J8rnKw3+m1//pBPbBrVyGZVNmiAITviEtm3t+D+2QcJx7GUxlN4594K4ZY75Xzh0JVWqnad6TdP0H+LRNBjHcYNDV5xS32qwaC4my7Lwn6guu5QoomgbdFmWDYhnM8E8zxscuhLzPWtKA/dGqUizrityX9M0YX+DQ1ciXobnP6vgfmTOM7Znnk70B58pPaEvx+epAAAAAElFTkSuQmCC","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA/ElEQVR4AZ3RUWqEMBSF4ftQZAhSREQJIiIXpQwi+tSldkFdWPsLhyEE0ocKH2Fyzg1mNJ4KAQ1arTUeeJMH6qwTUJmCHjMcC6KKtbSIylzdXpl18J/k4fdTpUFmPLOOa9bGe+P4+n5RYYfLXuiMsAlXofBxK2QXpvwN/jqg+AY91vR+pStk+apZe0fEhhMXDhUmWXEoO9WNmrWAzvRPq7jnB2jvUGfWTEgPcJzZFTbZk/0Tnh5QI+af6lVGvq/Do2atwVL4VJ+3QrZo1lr4Pw5wzVqDWaV7SUvHrZDNmrWAHq7g0rphkS3LXDMBVqFGhxGT1gGdDFnWaab6BRmXRvbxDmYiAAAAAElFTkSuQmCC","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABQElEQVR4AY2SQUrEQBBFS9CMNFEkhAQdYmiCIUgcZlYGc4VsBcGVF/AuWXme4F7RtXiVWF9+Y9MYtOHRTdX/NZWaEj2RYpQTJeEdK4fKPuA7DjSGXiQkU0qlUqxySmFMEsYsNSU8zEmK4OwdEbmkKCclYoGmolfWCGyenh1O0EJE2gXNWpFC2S0IGrCQ29EbdPCPAmEHmXIxByf8hDAPD71yzAnXypatbSgoAN8Pyju5h4deMUrqJk1z+0uBN+/XX+gxfoFK2QafUJO2aRq//Q+/QIx2wr+Kwq0rusrP/QKf9MTCtbQLf9U1wNvYnz3qug45S68kSvVXgbPbx3nvYPXNOI7cRPWySukK+DcGCvA+urqZ3RmGAbmSXjFK5rpwW8nhWVJP04TYa9/3uO/goVciDiPlZhW8c8ZAHuRSeqIv32FK/GYGL8YAAAAASUVORK5CYII=","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA/ElEQVR4AZ3RUWqEMBSF4ftQZAihDCKKiAQJShERQx+6o662e2p/4TCEQF468BEm95yLovFr4PBEq9PjgTd5wBcZp6559AiIWDAq6KXV3aJMUMfDOsTf7Mf/XaFBAvYiE9W16b74/vl8UeBAlKOSmWAzUiXwcavMkrrFE9QXVJ+gx5q9XvUVivmqrr1jxIYLCacCs6y6S8psGNU1hw4Bu4JHuUB3pzJBHZcviLiKV9jkyO4vxHyBx1h+qlcY5b2Wj+raE0vlU33dKrNFXWsR/7EgqmtPBIXuIw+dt8osqGsOPaIGSeeGRbZiFtVxsAYeHSbMOgd0MhSzTp3mD4RaQX4aW3NMAAAAAElFTkSuQmCC","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABP0lEQVR4AYWS0UqFQBCGhziImNRBRImDmUgiIaF0kWSP4AMEXXXTE/QiPpL3UdR19Crb/PAvLEtyFj5mmfn/cdxd0RUokbJXEsZYCZUd4D72NBG8wkKmlEqtVMoFhTFJmKuoKelBTVIkjbNE5IainJTIeZqaXjkg8fp+Z7GCjiLQbWgOihTKsCFowUZtoNef4HgDf4JMuTbe8n/Br8NDr5zxhBul52i3FBQE+xflmzzTA69ESmpPmubunwZfztc/6IncBrXSe7/QkK5tW3f8H7dBjHH8q6Kwt033V6Hb4JeeWPgsq42rugfYZ92psWscRwMPvZIo9bEGD2+F2YUnBizLwpeoXnYpbQM34kAB9peP58aueZ4NPPRKxPusaRoYG6UizbquyH1O04T4RA+8EvAwUr6sgjFnDuReLaUn+ANygUa7+9SCWgAAAABJRU5ErkJggg=="],"4chanJS":["iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAD1BMVEUBAAAAAAD/AABnZ2f///8nFk05AAAAAXRSTlMAQObYZgAAAEFJREFUeNqNjgEKACAMAjvX/98cAkkxgmSgO8Bt/Ai4ApJ6KKhzF3OiEMDASrGB/QWgPEHsUpN+Ng9xAETMYhDrWmeHAMcmvycWAAAAAElFTkSuQmCC","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAD1BMVEUAAAAAAAD/AABmZmYA/wBD99DBAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAE9JREFUCNdljcsRACEIQ5MOiNKAdGAJ9N/Uiu7nsMzABHgB4B8ygFoZA2hhVWavhhGeURPJU9q45+17hGbfGxa82Ndex3hEM44SJGD2/b4AzDgGlHbl388AAAAASUVORK5CYII=","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAD1BMVEUBAAAAAAAul8NnZ2f////82iC9AAAAAXRSTlMAQObYZgAAAEFJREFUeNqNjgEKACAMAjvX/98cAkkxgmSgO8Bt/Ai4ApJ6KKhzF3OiEMDASrGB/QWgPEHsUpN+Ng9xAETMYhDrWmeHAMcmvycWAAAAAElFTkSuQmCC","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAD1BMVEUAAAAAAAAul8NnZ2f/AAD7B+mqAAAAAXRSTlMAQObYZgAAAAlwSFlzAAALEgAACxIB0t1+/AAAAE9JREFUCNdljcsRACEIQ5MOiNKAdGAJ9N/Uiu7nsMzABHgB4B8ygFoZA2hhVWavhhGeURPJU9q45+17hGbfGxa82Ndex3hEM44SJGD2/b4AzDgGlHbl388AAAAASUVORK5CYII=","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAElBMVEUBAAAAAABmzDNlyjJnZ2f///+6o7dfAAAAAXRSTlMAQObYZgAAAERJREFUeF6NjkEKADEIA51o///lJZfQxUsHITogWi8AvwZJuxmYa25xDooBLEwOWFTYAsYVhdorLZt9Ng9xCUTCUCQ2H3F4ANrZ2WNiAAAAAElFTkSuQmCC","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAD1BMVEUAAAAAAABmzDNmZmb/AAC8/wCMAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAE9JREFUCNdljcsRACEIQ5MOiNKAdGAJ9N/Uiu7nsMzABHgB4B8ygFoZA2hhVWavhhGeURPJU9q45+17hGbfGxa82Ndex3hEM44SJGD2/b4AzDgGlHbl388AAAAASUVORK5CYII="],Original:["iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAgMAAABinRfyAAAADFBMVEX/////AAD///8AAABBZmS3AAAAAXRSTlMAQObYZgAAAExJREFUeF4tyrENgDAMAMFXKuQswQLBG3mOlBnFS1gwDfIYLpEivvjq2MlqjmYvYg5jWEzCwtDSQlwcXKCVLrpFbvLvvSf9uZJ2HusDtJAY7Tkn1oYAAAAASUVORK5CYII=","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAhElEQVR42q1RwQnAMAjMu5M4guAKXa4j5dUROo5tipSDcrFChUONd0di2m/hEGVOHDyIPufgwAFASDkpoSzmBrkJ2UMyR9LsJ3rvrqo3Rt1YMIMhhNnOxLMnoMFBxHyJAr2IOBFzA8U+6pLBdmEJTA0aMVjpDd6Loks0s5HZNwYx8tfZCZ0kll7ORffZAAAAAElFTkSuQmCC","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAgMAAABinRfyAAAADFBMVEX///8ul8P///8AAACaqgkzAAAAAXRSTlMAQObYZgAAAExJREFUeF4tyrENgDAMAMFXKuQswQLBG3mOlBnFS1gwDfIYLpEivvjq2MlqjmYvYg5jWEzCwtDSQlwcXKCVLrpFbvLvvSf9uZJ2HusDtJAY7Tkn1oYAAAAASUVORK5CYII=","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAALVBMVEUAAAAAAAAAAAAAAAABBQcHFx4KISoNLToaVW4oKCgul8M4ODg7OzvBwcH///8uS/CdAAAAA3RSTlMAx9dmesIgAAAAV0lEQVR42m2NWw6AIBAD1eILZO5/XI0UAgm7H9tOsu0yGWAQSOoFijHOxOANGqm/LczpOaXs4gISrPZ+gc2+hO5w2xdwgOjBFUIF+sEJrhUl9JFr+badFwR+BfqlmGUJAAAAAElFTkSuQmCC","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAgMAAABinRfyAAAADFBMVEX///9mzDP///8AAACT0n1lAAAAAXRSTlMAQObYZgAAAExJREFUeF4tyrENgDAMAMFXKuQswQLBG3mOlBnFS1gwDfIYLpEivvjq2MlqjmYvYg5jWEzCwtDSQlwcXKCVLrpFbvLvvSf9uZJ2HusDtJAY7Tkn1oYAAAAASUVORK5CYII=","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAALVBMVEUAAAAAAAAAAAAAAAAECAIQIAgWLAsePA8oKCg4ODg6dB07OztmzDPBwcH///+rsf3XAAAAA3RSTlMAx9dmesIgAAAAV0lEQVR42m2NWw6AIBAD1eIDhbn/cTVSCCTsfmw7ybbLZIBBIKkXKKU0E4M3aKT+tjCn5xiziwuIsNr7BTb7ErrDZV/AAaIHdwgV6AcnuFaU0Eeu5dt2XiUyBjCQ2bIrAAAAAElFTkSuQmCC"],Metro:["iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAABlBMVEUAAAC/AABrZQDiAAAAAXRSTlMAQObYZgAAABJJREFUCB1jZGBgrMNAQEEc4gCSfAX5bRw/NQAAAABJRU5ErkJggg==","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAAAAAAAAAC/AAD///8dAAApAABsAAAHAAA4AACQAAAsAABMCpCvAAAAA3RSTlMAPse+s4iwAAAAMklEQVQI12NggAFmY2MDECaNAQZCilAzVJyg5oS4GqAxUtygjIp2KGOKJ5SxepcB3BUAcdYRqxAtgFoAAAAASUVORK5CYII=","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAABlBMVEUAAAAA1/GhpCidAAAAAXRSTlMAQObYZgAAABJJREFUCB1jZGBgrMNAQEEc4gCSfAX5bRw/NQAAAABJRU5ErkJggg==","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAAAAAAAAAAA1/H///8AISUALzQAeokACAkAQEcAorYAMTcE9WFNAAAAA3RSTlMAPse+s4iwAAAAMklEQVQI12NggAFmY2MDECaNAQZCilAzVJyg5oS4GqAxUtygjIp2KGOKJ5SxepcB3BUAcdYRqxAtgFoAAAAASUVORK5CYII=","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAABlBMVEUAAABV/wErM5hwAAAAAXRSTlMAQObYZgAAABJJREFUCB1jZGBgrMNAQEEc4gCSfAX5bRw/NQAAAABJRU5ErkJggg==","iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAAAAAAAAABV/wH///8NKAASOAAwkQADCgAZTABAwQATOwC5e3VGAAAAA3RSTlMAPse+s4iwAAAAMklEQVQI12NggAFmY2MDECaNAQZCilAzVJyg5oS4GqAxUtygjIp2KGOKJ5SxepcB3BUAcdYRqxAtgFoAAAAASUVORK5CYII="]};e=Ve.getOwn(e,De.favicon);const t=i;let n=0;for(;e[n];)e[n]="data:image/png;base64,"+e[n++];return[t.unreadDead,t.unreadDeadY,t.unreadSFW,t.unreadSFWY,t.unreadNSFW,t.unreadNSFWY]=e,t.update()},update(){return this.isSFW?(this.unread=this.unreadSFW,this.unreadY=this.unreadSFWY):(this.unread=this.unreadNSFW,this.unreadY=this.unreadNSFWY)},SFW:"//s.4cdn.org/image/favicon-ws.ico",NSFW:"//s.4cdn.org/image/favicon.ico",dead:"data:image/gif;base64,R0lGODlhEAAQAKECAAAAAP8AAP///////yH5BAEKAAIALAAAAAAQABAAAAIvlI+pq+D9DAgUoFkPDlbs7lFZKIJOJJ3MyraoB14jFpOcVMpzrnF3OKlZYsMWowAAOw==",logo:"data:image/png;base64,R0lGODlhEAAQAJEAAAAAAP///9vb2////yH5BAEAAAMALAAAAAAQABAAAAIvnI+pq+D9DBAUoFkPFnbs7lFZKIJOJJ3MyraoB14jFpOcVMpzrnF3OKlZYsMWowAAOw=="};const et={init(){"yotsuba"!==Ee.SITE.software||Te.cookie.indexOf("pass_enabled=1")>=0||(De["Force Noscript Captcha"]&&ke.jsEnabled?Ve.ready(this.noscript):De.captchaLanguage.trim()&&(["boards.4chan.org","boards.4channel.org"].includes(location.hostname)?Ve.onExists(Re,"#captchaFormPart",e=>Ve.onExists(e,'iframe[src^="https://www.google.com/recaptcha/"]',this.iframe)):Ve.onExists(Re,'iframe[src^="https://www.google.com/recaptcha/"]',this.iframe)))},noscript(){let e,t,n;if(!(t=Ve("#g-recaptcha"))||!(e=Ve("noscript",t.parentNode)))return;const o=Ve.el("span",{id:"captcha-forced-noscript"});Ve.replace(e,o),Ve.rm(t);const a=function(){o.innerHTML=e.textContent,this.iframe(Ve('iframe[src^="https://www.google.com/recaptcha/"]',o))};(n=Ve("#togglePostFormLink a, #form-link"))?Ve.on(n,"click",a):a()},iframe(e){let t;if(t=De.captchaLanguage.trim()){const n=/[?&]hl=/.test(e.src)?e.src.replace(/([?&]hl=)[^&]*/,"$1"+encodeURIComponent(t)):e.src+`&hl=${encodeURIComponent(t)}`;e.src!==n&&(e.src=n)}}},tt={init(){if(Te.cookie.indexOf("pass_enabled=1")>=0)return;if(!(this.isEnabled=!!Ve("#t-root")||!Ve.id("postForm")))return;const e=Ve.el("div",{className:"captcha-root"});this.nodes={root:e},Ve.addClass(j.nodes.el,"has-captcha","captcha-t"),Ve.after(j.nodes.com.parentNode,e)},moreNeeded(){},getThread:()=>({boardID:Ee.BOARD.ID,threadID:"new"===j.posts[0].thread?"0":""+j.posts[0].thread}),setup(e){this.isEnabled&&(this.nodes.container||(this.nodes.container=Ve.el("div",{className:"captcha-container"}),Ve.prepend(this.nodes.root,this.nodes.container),tt.currentThread=tt.getThread(),tt.currentThread.autoLoad=De["Auto-load captcha"]?"1":"0",Ve.global("setupTCaptcha",tt.currentThread)),e&&Ve("#t-resp").focus())},destroy(){this.isEnabled&&this.nodes.container&&(Ve.global("destroyTCaptcha"),Ve.rm(this.nodes.container),delete this.nodes.container)},updateThread(){if(!this.isEnabled)return;const{boardID:e,threadID:t}=tt.currentThread||{},n=tt.getThread();n.boardID===e&&n.threadID===t||(tt.destroy(),tt.setup())},getOne(){let e,t={};if(this.nodes.container)for(var n of["t-response","t-challenge"])t[n]=Ve(`[name='${n}']`,this.nodes.container).value;return t["t-response"]||(e=Ve("#t-msg"))&&/Verification not required/i.test(e.textContent)||(t=null),t},setUsed(){this.isEnabled&&this.nodes.container&&Ve.global("TCaptchaClearChallenge")},occupied(){return!!this.nodes.container}};class nt{constructor(e,t,n=!1){if(this.changes=[],this.onSync=this.onSync.bind(this),this.key=e,this.initData(De[this.key]),Ve.sync(this.key,this.onSync),n||this.clean(),t){var o=()=>{Ve.off(Te,"4chanXInitFinished",o),this.sync=t};Ve.on(Te,"4chanXInitFinished",o)}}initData(e){let t;if(this.data=e,this.data.boards){let e;({boards:t,lastChecked:e}=this.data),this.data["4chan.org"]={boards:t,lastChecked:e},delete this.data.boards,delete this.data.lastChecked}return this.data[Ee.SITE.ID]||(this.data[Ee.SITE.ID]={boards:Fe()})}save(e,t){return e(),this.changes.push(e),Ve.get(this.key,{boards:Fe()},n=>{if(!this.changes.length)return;const o=(n[this.key].version||0)>(this.data.version||0);if(o)for(e of(this.initData(n[this.key]),this.changes))e();return this.changes=[],this.data.version=(this.data.version||0)+1,Ve.set(this.key,this.data,()=>(o&&this.sync?.(),t?.()))})}forceSync(e){return Ve.get(this.key,{boards:Fe()},t=>{if((t[this.key].version||0)>(this.data.version||0)){for(var n of(this.initData(t[this.key]),this.changes))n();this.sync?.()}return e?.()})}delete({siteID:e,boardID:t,threadID:n,postID:o},a){e||(e=Ee.SITE.ID),this.data[e]&&this.save(()=>{if(o){if(!this.data[e].boards[t]?.[n])return;delete this.data[e].boards[t][n][o],this.deleteIfEmpty({siteID:e,boardID:t,threadID:n})}else if(n){if(!this.data[e].boards[t])return;delete this.data[e].boards[t][n],this.deleteIfEmpty({siteID:e,boardID:t})}else delete this.data[e].boards[t]},a)}deleteIfEmpty({siteID:e,boardID:t,threadID:n}){this.data[e]&&(n?Object.keys(this.data[e].boards[t][n]).length||(delete this.data[e].boards[t][n],this.deleteIfEmpty({siteID:e,boardID:t})):Object.keys(this.data[e].boards[t]).length||delete this.data[e].boards[t])}set(e,t){this.save(()=>{this.setUnsafe(e)},t)}setUnsafe({siteID:e,boardID:t,threadID:n,postID:o,val:a}){e||(e=Ee.SITE.ID),this.data[e]||(this.data[e]={boards:Fe()});const i=this.data[e].boards;if(void 0!==o){let e;((e=i[t]||(i[t]=Fe()))[n]||(e[n]=Fe()))[o]=a}else void 0!==n?(i[t]||(i[t]=Fe()))[n]=a:i[t]=a}extend({siteID:e,boardID:t,threadID:n,postID:o,val:a},i){this.save(()=>{var i,s;const r=this.get({siteID:e,boardID:t,threadID:n,postID:o,defaultValue:Fe()});for(i in a)void 0===(s=a[i])?delete r[i]:r[i]=s;this.setUnsafe({siteID:e,boardID:t,threadID:n,postID:o,val:r})},i)}setLastChecked(e="lastChecked"){this.save(()=>{this.data[e]=Date.now()})}get({siteID:e,boardID:t,threadID:n,postID:o,defaultValue:a}){let i,s;if(e||(e=Ee.SITE.ID),i=this.data[e]?.boards[t]){let e;if(null==n)if(null!=o){for(e=0;e<i.length;e++)if(o in e){s=e[o];break}}else s=i;else(e=i[n])&&(s=null!=o?e[o]:e)}return s||a}clean(){let e,t;const n=Ee.SITE.ID;for(e in this.data[n].boards)this.deleteIfEmpty({siteID:n,boardID:e});const o=Date.now();if(o-2*qe>=(t=this.data[n].lastChecked||0)||t>o)for(e in this.data[n].lastChecked=o,this.data[n].boards)this.ajaxClean(e)}ajaxClean(e){const t=this,n=Ee.SITE.ID,o=Ee.SITE.urls.threadsListJSON?.({siteID:n,boardID:e});o&&Ve.cache(o,function(){if(200!==this.status)return;const o=Ee.SITE.urls.archiveListJSON?.({siteID:n,boardID:e});if(!o)return t.ajaxCleanParse(e,this.response);const a=this.response;Ve.cache(o,function(){(200===this.status||!Ee.SITE.archivedBoardsKnown&&404===this.status)&&t.ajaxCleanParse(e,a,this.response)})})}ajaxCleanParse(e,t,n){var o,a;let i,s;const r=Ee.SITE.ID;if(!(i=this.data[r].boards[e]))return;const l=Fe();if(t)for(o of t)for(a of o.threads)s=a.no,s in i&&(l[s]=i[s]);if(n)for(s of n)s in i&&(l[s]=i[s]);this.data[r].boards[e]=l,this.deleteIfEmpty({siteID:r,boardID:e}),Ve.set(this.key,this.data)}onSync(e){(e.version||0)<=(this.data.version||0)||(this.initData(e),this.sync?.())}}nt.keys=["hiddenThreads","hiddenPosts","hiddenPosterIds","lastReadPosts","yourPosts","watchedThreads","watcherLastModified","customTitles"];class ot{constructor(){this.keys=[]}push(e,t){this[e=`${e}`]||this.keys.push(e),this[e]=t}insert(e,t,n=(e,t)=>+e<+t){const o=e.toString();if(o in this)return this[o]=t,this.keys.indexOf(o);const a=this.keys.length;if(!a||n(this.lastKey(),e))return this.push(e,t),a;let i=this.keys.findIndex(t=>!n(t,e));return-1===i?this.push(e,t):(this[o]=t,this.keys.splice(i,0,o)),i}insertAt(e,t,n){this[e]=n,this.keys.splice(t,0,e)}rm(e){let t;e=`${e}`,-1!==(t=this.keys.indexOf(e))&&(this.keys.splice(t,1),delete this[e])}forEach(e){for(var t of this.keys)e(this[t])}get(e){return"keys"===e?void 0:Ve.getOwn(this,e)}lastKey(){return this.keys[this.keys.length-1]}last(){return this.keys.length?this[this.keys.length-1]:void 0}}class at{toString(){return this.ID}constructor(e,t){this.board=t,this.ID=+e,this.threadID=this.ID,this.boardID=this.board.ID,this.siteID=Ee.SITE.ID,this.fullID=`${this.board}.${this.ID}`,this.posts=new ot,this.isDead=!1,this.isHidden=!1,this.isSticky=!1,this.isClosed=!1,this.isArchived=!1,this.postLimit=!1,this.fileLimit=!1,this.lastPost=0,this.ipCount=void 0,this.json=null,this.OP=null,this.catalogView=null,this.nodes={root:null},this.board.threads.push(this.ID,this),Ee.threads.push(this.fullID,this)}setPage(e){let t;const{info:n,reply:o}=this.OP.nodes;if((t=Ve(".page-num",n))||(t=Ve.el("span",{className:"page-num"}),Ve.replace(o.parentNode.previousSibling,[Ve.tn(" "),t,Ve.tn(" ")])),t.title=`This thread is on page ${e} in the original index.`,t.textContent=`[${e}]`,this.catalogView)return this.catalogView.nodes.pageCount.textContent=e}setCount(e,t,n){if(!this.catalogView)return;const o=this.catalogView.nodes[`${e}Count`];return o.textContent=t,(n?Ve.addClass:Ve.rmClass)(o,"warning")}setStatus(e,t){const n=`is${e}`;if(this[n]!==t&&(this[n]=t,this.OP))return this.setIcon("Sticky",this.isSticky),this.setIcon("Closed",this.isClosed&&!this.isArchived),this.setIcon("Archived",this.isArchived)}setIcon(e,t){const n=e.toLowerCase();let o=Ve(`.${n}Icon`,this.OP.nodes.info);if(!!o===t)return;if(!t)return Ve.rm(o.previousSibling),Ve.rm(o),void(this.catalogView&&Ve.rm(Ve(`.${n}Icon`,this.catalogView.nodes.icons)));o=Ve.el("img",{src:`${Ee.SITE.Build.staticPath}${n}${Ee.SITE.Build.gifIcon}`,alt:e,title:e,className:`${n}Icon retina`}),"f"===Ee.BOARD.ID&&(o.style.cssText="height: 18px; width: 18px;");const a="Sticky"!==e&&this.isSticky?Ve(".stickyIcon",this.OP.nodes.info):Ve(".page-num",this.OP.nodes.info)||this.OP.nodes.quote;return Ve.after(a,[Ve.tn(" "),o]),this.catalogView?("Sticky"===e&&this.isClosed?Ve.prepend:Ve.add)(this.catalogView.nodes.icons,o.cloneNode()):void 0}kill(){return this.isDead=!0}collect(){let e=0;if(this.posts.forEach(function(t){return t.clones.length?e++:t.collect()}),!e)return Ee.threads.rm(this.fullID),this.board.threads.rm(this)}}class it{toString(){return this.ID}constructor(e,t){this.thread=t,this.ID=this.thread.ID,this.board=this.thread.board;const{post:n}=this.thread.OP.nodes;this.nodes={root:e,thumb:Ve(".catalog-thumb",n),icons:Ve(".catalog-icons",n),postCount:Ve(".post-count",n),fileCount:Ve(".file-count",n),pageCount:Ve(".page-count",n),replies:null},this.thread.catalogView=this}}s=function(){let e,t;return s=class{static initClass(){e=null,t=null}constructor(e){this.setPosition=this.setPosition.bind(this),this.close=this.close.bind(this),this.keybinds=this.keybinds.bind(this),this.onFocus=this.onFocus.bind(this),this.addEntry=this.addEntry.bind(this),this.type=e,Ve.on(Te,"AddMenuEntry",({detail:e})=>{if(e.type===this.type)return delete e.open,this.addEntry(e)}),this.entries=[]}makeMenu(){const e=Ve.el("div",{className:"dialog",id:"menu",tabIndex:0});return e.dataset.type=this.type,Ve.on(e,"click",e=>e.stopPropagation()),Ve.on(e,"keydown",this.keybinds),e}toggle(n,o,a){if(n.preventDefault(),n.stopPropagation(),e){const n=t;if(e.close(),n===o)return}if(this.entries.length)return this.open(o,a)}open(n,o){let a;const i=this.menu=this.makeMenu();for(a of(e=this,t=n,this.entries.sort((e,t)=>e.order-t.order),this.entries))this.insertEntry(a,i,o);return Ve.addClass(t,"active"),Ve.on(Te,"click CloseMenu",this.close),Ve.on(Te,"scroll",this.setPosition),Ve.on(window,"resize",this.setPosition),Ve.after(n,i),this.setPosition(),a=Ve(".entry",i),this.focus(a),i.focus()}setPosition(){const e=this.menu.getBoundingClientRect(),n=t.getBoundingClientRect(),o=Re.clientHeight,a=Re.clientWidth,[i,s]=n.top+n.height+e.height<o?[`${n.bottom}px`,""]:["",o-n.top+"px"],[r,l]=n.left+e.width<a?[`${n.left}px`,""]:["",a-n.right+"px"];return Ve.extend(this.menu.style,{top:i,right:l,bottom:s,left:r}),this.menu.classList.toggle("left",l)}insertEntry(e,t,n){let o;if("function"==typeof e.open)try{if(!e.open(n))return}catch(e){return void ke.handleErrors({message:`Error in building the ${this.type} menu.`,error:e})}if(Ve.add(t,e.el),e.subEntries){for(var a of((o=Ve(".submenu",e.el))&&Ve.rm(o),o=Ve.el("div",{className:"dialog submenu"}),e.subEntries))this.insertEntry(a,o,n);Ve.add(e.el,o)}}close(){return Ve.rm(this.menu),delete this.menu,Ve.rmClass(t,"active"),e=null,t=null,Ve.off(Te,"click scroll CloseMenu",this.close),Ve.off(Te,"scroll",this.setPosition),Ve.off(window,"resize",this.setPosition)}findNextEntry(e,t){const n=[...e.parentNode.children];return n.sort((e,t)=>e.style.order-t.style.order),n[n.indexOf(e)+t]}keybinds(e){let n,o,a,i=Ve(".focused",this.menu);for(;n=Ve(".focused",i);)i=n;switch(e.keyCode){case 27:t.focus(),this.close();break;case 13:case 32:i.click();break;case 38:(o=this.findNextEntry(i,-1))&&this.focus(o);break;case 40:(o=this.findNextEntry(i,1))&&this.focus(o);break;case 39:if((a=Ve(".submenu",i))&&(o=a.firstElementChild)){let e;for(;e=this.findNextEntry(o,-1);)o=e;this.focus(o)}break;case 37:(o=Ve.x('parent::*[contains(@class,"submenu")]/parent::*',i))&&this.focus(o);break;default:return}return e.preventDefault(),e.stopPropagation()}onFocus(e){return e.stopPropagation(),this.focus(e.target)}focus(e){let t,n;for(;t=Ve.x('parent::*/child::*[contains(@class,"focused")]',e);)Ve.rmClass(t,"focused");for(t of Ge(".focused",e))Ve.rmClass(t,"focused");if(Ve.addClass(e,"focused"),!(n=Ve(".submenu",e)))return;const o=n.getBoundingClientRect(),a=e.getBoundingClientRect(),i=Re.clientHeight,s=Re.clientWidth,[r,l]=a.top+o.height<i?["0px","auto"]:["auto","0px"],[d,c]=a.right+o.width<s-150?["100%","auto"]:["auto","100%"],{style:h}=n;return h.top=r,h.bottom=l,h.left=d,h.right=c}addEntry(e){return this.parseEntry(e),this.entries.push(e)}parseEntry(e){const{el:t,subEntries:n}=e;if(Ve.addClass(t,"entry"),Ve.on(t,"focus mouseover",this.onFocus),t.style.order=e.order||100,!n)return;for(var o of(Ve.addClass(t,"has-submenu"),n))this.parseEntry(o);const i=Ve.el("span",{className:"menu-indicator"});a.set(i,"caretRight"),Ve.add(t,i)}},s.initClass(),s}(),r=function(e){let t;if("mousedown"===e.type&&0!==e.button)return;e.preventDefault(),(t="touchstart"===e.type)&&(e=e.changedTouches[e.changedTouches.length-1]);const n=Ve.x('ancestor::div[contains(@class,"dialog")][1]',this),o=n.getBoundingClientRect(),a=Re.clientHeight,i=Re.clientWidth,s={id:n.id,style:n.style,dx:e.clientX-o.left,dy:e.clientY-o.top,height:a-o.height,width:i-o.width,screenHeight:a,screenWidth:i,isTouching:t};return[s.topBorder,s.bottomBorder]=De["Header auto-hide"]||!De["Fixed Header"]?[0,0]:De["Bottom Header"]?[0,Y.bar.getBoundingClientRect().height]:[Y.bar.getBoundingClientRect().height,0],t?(s.identifier=e.identifier,s.move=l.bind(s),s.up=c.bind(s),Ve.on(Te,"touchmove",s.move),Ve.on(Te,"touchend touchcancel",s.up)):(s.move=d.bind(s),s.up=h.bind(s),Ve.on(Te,"mousemove",s.move),Ve.on(Te,"mouseup",s.up))},l=function(e){for(var t of e.changedTouches)if(t.identifier===this.identifier)return void d.call(this,t)},d=function(e){const{clientX:t,clientY:n}=e;let o=t-this.dx;o=o<10?0:this.width-o<10?"":o/this.screenWidth*100+"%";let a=n-this.dy;a=a<10+this.topBorder?this.topBorder+"px":this.height-a<10+this.bottomBorder?"":a/this.screenHeight*100+"%";const i=""===o?0:"",s=""===a?this.bottomBorder+"px":"",{style:r}=this;r.left=o,r.right=i,r.top=a,r.bottom=s},c=function(e){for(var t of e.changedTouches)if(t.identifier===this.identifier)return void h.call(this)},h=function(){if(this.isTouching?(Ve.off(Te,"touchmove",this.move),Ve.off(Te,"touchend touchcancel",this.up)):(Ve.off(Te,"mousemove",this.move),Ve.off(Te,"mouseup",this.up)),2===this.style.length)Ve.set(`${this.id}.position`,this.style.cssText);else{const{left:e,right:t,top:n,bottom:o}=this.style;let a="";e&&(a+=`left:${e};`),t&&(a+=`right:${t};`),n&&(a+=`top:${n};`),o&&(a+=`bottom:${o};`),Ve.set(`${this.id}.position`,a)}};const st=function({root:e,el:t,latestEvent:n,endEvents:o,height:a,width:i,cb:s,noRemove:r}){const l=e.getBoundingClientRect(),d={root:e,el:t,style:t.style,isImage:["IMG","VIDEO"].includes(t.nodeName),cb:s,endEvents:o,latestEvent:n,clientHeight:Re.clientHeight,clientWidth:Re.clientWidth,height:a,width:i,noRemove:r,clientX:(l.left+l.right)/2,clientY:(l.top+l.bottom)/2};return d.hover=u.bind(d),d.hoverend=p.bind(d),d.hover(d.latestEvent),new MutationObserver(function(){if(t.parentNode)return d.hover(d.latestEvent)}).observe(t,{childList:!0}),Ve.on(e,o,d.hoverend),Ve.x('ancestor::div[contains(@class,"inline")][1]',e)&&Ve.on(Te,"keydown",d.hoverend),Ve.on(e,"mousemove",d.hover),d.workaround=function(t){if(!e.contains(t.target))return d.hoverend(t)},Ve.on(Re,"mousemove",d.workaround)};st.padding=25,u=function(e){this.latestEvent=e;const t=(this.height||this.el.offsetHeight)+st.padding,n=this.width||this.el.offsetWidth,{clientX:o,clientY:a}=De["Follow Cursor"]?e:this,i=this.isImage?Math.max(0,a*(this.clientHeight-t)/this.clientHeight):Math.max(0,Math.min(this.clientHeight-t,a-120));let s=this.clientWidth/2;this.isImage||(s=Math.max(s,this.clientWidth-400));let r=(o<=s?o:this.clientWidth-o)+45;this.isImage&&(r=Math.min(r,this.clientWidth-n)),r+="px";const[l,d]=o<=s?[r,""]:["",r],{style:c}=this;return c.top=i+"px",c.left=l,c.right=d},p=function(e){if(("keydown"!==e.type||13===e.keyCode)&&"TEXTAREA"!==e.target.nodeName)return this.noRemove||Ve.rm(this.el),Ve.off(this.root,this.endEvents,this.hoverend),Ve.off(Te,"keydown",this.hoverend),Ve.off(this.root,"mousemove",this.hover),Ve.off(Re,"mousemove",this.workaround),this.cb?this.cb.call(this):void 0};const rt={dialog:function(e,t){const n=Ve.el("div",{className:"dialog",id:e});Ve.extend(n,t),n.style.cssText=De[`${e}.position`];const o=Ve(".move",n);for(var a of(Ve.on(o,"touchstart mousedown",r),o.children))a.tagName&&Ve.on(a,"touchstart mousedown",e=>e.stopPropagation());return n},Menu:s,hover:st,checkbox:function(e,t,n){null==n&&(n=De[e]);const o=Ve.el("label"),a=Ve.el("input",{type:"checkbox",name:e,checked:n});return Ve.add(o,[a,Ve.tn(` ${t}`)]),o}};g={init(){switch(Ee.VIEW){case"index":if(!De["Index Navigation"])return;break;case"thread":if(!De["Reply Navigation"])return;break;default:return}const e=Ve.el("span",{id:"navlinks"}),t=Ve.el("a",{textContent:"â–²",className:"navlinks-navlink navlink-prev",href:"javascript:;"}),n=Ve.el("a",{textContent:"â–¼",className:"navlinks-navlink navlink-next",href:"javascript:;"});a.set(t,"arrowUpLong"),a.set(n,"arrowDownLong"),Ve.on(t,"click",this.prev),Ve.on(n,"click",this.next),Ve.add(e,[t,Ve.tn(" "),n]);var o=function(){return Ve.off(Te,"4chanXInitFinished",o),Ve.add(Te.body,e)};return Ve.on(Te,"4chanXInitFinished",o)},prev:()=>"thread"===Ee.VIEW?window.scrollTo(0,0):g.scroll(-1),next:()=>"thread"===Ee.VIEW?window.scrollTo(0,Te.body.scrollHeight):g.scroll(1),getThread(){var e,t;if("thread"===Ee.VIEW)return Ee.threads.get(`${Ee.BOARD}.${Ee.THREADID}`).nodes.root;if(!Ve.hasClass(Re,"catalog-mode"))for(e of Ge(Ee.SITE.selectors.thread))if((!(t=n.threadFromRoot(e)).isHidden||t.stub)&&Y.getTopOf(e)>=-e.getBoundingClientRect().height)return e},scroll(e){let t;Te.activeElement?.blur();let n=g.getThread();if(!n)return;if(t=Ve.x(`${1===e?"following":"preceding"}-sibling::${Ee.SITE.xpath.thread}[not(@hidden)][1]`,n)){const o=Y.getTopOf(n);(1===e&&o<5||-1===e&&o>-5)&&(n=t)}const o=Y.getTopOf(n)+Re.clientHeight-Te.body.getBoundingClientRect().bottom;return o>0&&(Te.body.style.marginBottom=`${o}px`),Y.scrollTo(n),o>0&&!g.haveExtra?(g.haveExtra=!0,Ve.on(Te,"scroll",g.removeExtra)):void 0},removeExtra(){const e=Re.clientHeight-Te.body.getBoundingClientRect().bottom;return e>0?Te.body.style.marginBottom=`${e}px`:(Te.body.style.marginBottom="",delete g.haveExtra,Ve.off(Te,"scroll",g.removeExtra))}},f={init(){if(!["index","thread"].includes(Ee.VIEW)||!De["Image Expansion"]&&!De["Image Hover"]&&!De["Image Hover in Catalog"]&&!De.Gallery)return;if(Ve.sync("Allow Sound",function(e){De["Allow Sound"]=e,f.inputs&&(f.inputs.unmute.checked=e)}),Ve.sync("Default Volume",function(e){De["Default Volume"]=e,f.inputs&&(f.inputs.volume.value=e)}),De["Mouse Wheel Volume"]&&Ne.Post.push({name:"Mouse Wheel Volume",cb:this.node}),Ee.SITE.noAudio?.(Ee.BOARD))return;De["Mouse Wheel Volume"]&&Ne.CatalogThread.push({name:"Mouse Wheel Volume",cb:this.catalogNode});const e=rt.checkbox("Allow Sound","Allow Sound");e.title=Me.main["Images and Videos"]["Allow Sound"][1];const t=Ve.el("label",{title:"Default volume for videos."});return Ve.extend(t,{innerHTML:'<input name="Default Volume" type="range" min="0" max="1" step="0.01" value="'+Se(De["Default Volume"])+'"> Volume'}),this.inputs={unmute:e.firstElementChild,volume:t.firstElementChild},Ve.on(this.inputs.unmute,"change",Ve.cb.checked),Ve.on(this.inputs.volume,"change",Ve.cb.value),Y.menu.addEntry({el:e,order:200}),Y.menu.addEntry({el:t,order:201})},setup:e=>(e.muted=!De["Allow Sound"],e.volume=De["Default Volume"],Ve.on(e,"volumechange",f.change)),change(){var e,t;const{muted:n,volume:o}=this,a={"Allow Sound":!n,"Default Volume":o};for(e in a)t=a[e],De[e]===t&&delete a[e];if(Ve.set(a),Ve.extend(De,a),f.inputs)return f.inputs.unmute.checked=!n,f.inputs.volume.value=o},node(){if(!Ee.SITE.noAudio?.(this.board))for(var e of this.files)e.isVideo&&(e.thumb&&Ve.on(e.thumb,"wheel",f.wheel.bind(Y.hover)),Ve.on(Ve(".file-info",e.text)||e.link,"wheel",f.wheel.bind(e.thumbLink)))},catalogNode(){const e=this.thread.OP.files[0];if(e?.isVideo)return Ve.on(this.nodes.thumb,"wheel",f.wheel.bind(Y.hover))},wheel(e){let t;if(e.shiftKey||e.altKey||e.ctrlKey||e.metaKey)return;if(!(t=Ve("video:not([data-md5])",this)))return;if(t.muted||!Ve.hasAudio(t))return;let n=t.volume+.1;return e.deltaY<0&&(n*=1.1),e.deltaY>0&&(n/=1.1),t.volume=Ve.minmax(n-.1,0,1),e.preventDefault()}};const lt={setupSync(e,t){t.addEventListener("playing",()=>{e.currentTime=t.currentTime%e.duration,e.play()}),t.addEventListener("play",()=>{e.currentTime=t.currentTime%e.duration,e.play()}),t.addEventListener("pause",()=>{e.pause()}),t.addEventListener("seeked",()=>{e.currentTime=t.currentTime%e.duration}),t.addEventListener("ratechange",()=>{e.currentTime=t.currentTime,e.playbackRate=t.playbackRate}),t.addEventListener("waiting",()=>{e.currentTime=t.currentTime%e.duration,e.pause()}),t.addEventListener("canplay",()=>{t.currentTime<.1&&(e.currentTime=0)},{once:!0})}};m={init(){if(this.enabled=De["Image Expansion"]&&["index","thread"].includes(Ee.VIEW))return this.EAI=Ve.el("a",{className:"expand-all-shortcut",title:"Expand All Images",href:"javascript:;"}),a.set(this.EAI,"expand","Expand All Images"),Ve.on(this.EAI,"click",this.cb.toggleAll),Y.addShortcut("expand-all",this.EAI,520),Ve.on(Te,"scroll visibilitychange",this.cb.playVideos),this.videoControls=Ve.el("span",{className:"video-controls"}),Ve.extend(this.videoControls,{innerHTML:' <a href="javascript:;" title="You can also contract the video by dragging it to the left.">contract</a>'}),Ne.Post.push({name:"Image Expansion",cb:this.node})},node(){if(this.file&&(this.file.isImage||this.file.isVideo))if(Ve.on(this.file.thumbLink,"click",m.cb.toggle),this.isClone){if(this.file.isExpanding)return m.contract(this),m.expand(this);if(this.file.isExpanded&&this.file.isVideo)return f.setup(this.file.fullImage),m.setupVideoCB(this),m.setupVideo(this,!this.origin.file.fullImage?.paused||this.origin.file.wasPlaying,this.file.fullImage.controls)}else if(m.on&&!this.isHidden&&!this.isFetchedQuote&&(De["Expand spoilers"]||!this.file.isSpoiler)&&(De["Expand videos"]||!this.file.isVideo))return m.expand(this)},cb:{toggle(e){if(Ve.modifiedClick(e))return;const t=n.postFromNode(this),{file:o}=t;return o.isExpanded&&V.onControls(e)?void 0:(e.preventDefault(),!De.Autoplay&&o.fullImage?.paused?o.fullImage.play():m.toggle(t))},toggleAll(){let e;Ve.event("CloseMenu");const t=g.getThread(),n=function(n){const{file:o}=n;if(o&&(o.isImage||o.isVideo)&&Re.contains(n.nodes.root)&&(!m.on||!(!De["Expand spoilers"]&&o.isSpoiler||!De["Expand videos"]&&o.isVideo||De["Expand from here"]&&Y.getTopOf(o.thumb)<0||De["Expand thread only"]&&"index"===Ee.VIEW&&!t?.contains(o.thumb))))return Ve.queueTask(e,n)};return(m.on=Ve.hasClass(m.EAI,"expand-all-shortcut"))?(m.EAI.className="contract-all-shortcut",m.EAI.title="Contract All Images",a.set(m.EAI,"shrink","Contract All Images"),e=m.expand):(m.EAI.className="expand-all-shortcut",m.EAI.title="Expand All Images",a.set(m.EAI,"expand","Expand All Images"),e=m.contract),Ee.posts.forEach(function(e){for(e of[e,...e.clones])n(e)})},playVideos:()=>Ee.posts.forEach(function(e){var t,n;for(e of[e,...e.clones]){var{file:o}=e;o&&o.isVideo&&o.isExpanded&&(t=o.fullImage,(n=Ve.hasAudio(t)&&!t.muted||Y.isNodeVisible(t))&&o.wasPlaying?(delete o.wasPlaying,t.play()):n||t.paused||(o.wasPlaying=!0,t.pause()))}}),setFitness(){return Ve[this.checked?"addClass":"rmClass"](Re,this.name.toLowerCase().replace(/\s+/g,"-"))}},toggle(e){if(!e.file.isExpanding&&!e.file.isExpanded)return e.file.scrollIntoView=De["Scroll into view"],void m.expand(e);if(m.contract(e),De["Advance on contract"]){let t=e.nodes.root;for(;(t=Ve.x("following::div[contains(@class,'postContainer')][1]",t))&&(Ve(".stub",t)||0===t.offsetHeight););if(t)return Y.scrollTo(t)}},contract(e){var t,n,o;let a,i,s,r;const{file:l}=e;for(t of((i=l.fullImage)&&(a=Y.getTopOf(i)+i.getBoundingClientRect().height,s=Te.body.clientHeight,({scrollY:r}=window)),Ve.rmClass(e.nodes.root,"expanded-image"),Ve.rmClass(l.thumb,"expanding"),Ve.rm(l.videoControls),l.thumbLink.href=l.url,l.thumbLink.target="_blank",["isExpanding","isExpanded","videoControls","wasPlaying","scrollIntoView"]))delete l[t];if(i){if(Re.contains(i)&&(a<=0?window.scrollBy(0,r-window.scrollY+Te.body.clientHeight-s):Y.scrollToIfNeeded(e.nodes.root),window.scrollX>0&&window.scrollBy(-window.scrollX,0)),Ve.off(i,"error",m.error),V.pushCache(i),l.isVideo)for(n in V.pause(i),m.videoCB)o=m.videoCB[n],Ve.off(i,n,o);De["Restart when Opened"]&&V.rewind(l.thumb),delete l.fullImage,Ve.queueTask(function(){if(!l.isExpanding&&!l.isExpanded&&(Ve.rmClass(i,"full-image"),!i.id))return Ve.rm(i)}),l.audio&&(l.audio.remove(),delete l.audio,l.audioSlider&&(l.audioSlider.remove(),delete l.audioSlider))}},expand(e,t){const{file:n}=e,{thumb:o,thumbLink:a,isVideo:i}=n;if(e.isHidden||n.isExpanding||n.isExpanded)return;let s;if(Ve.addClass(o,"expanding"),n.isExpanding=!0,n.fullImage?s=n.fullImage:V.cache?.dataset.fileID===`${e.fullID}.${n.index}`?(s=n.fullImage=V.popCache(),Ve.on(s,"error",m.error),De["Restart when Opened"]&&"ihover"!==s.id&&V.rewind(s),s.removeAttribute("id")):(s=n.fullImage=Ve.el(i?"video":"img"),s.dataset.fileID=`${e.fullID}.${n.index}`,Ve.on(s,"error",m.error),s.src=t||n.url),s.className="full-image",Ve.after(o,s),i&&(n.videoControls||(n.videoControls=m.videoControls.cloneNode(!0),Ve.add(n.text,n.videoControls)),a.removeAttribute("href"),a.removeAttribute("target"),s.loop=!0,f.setup(s),m.setupVideoCB(e)),i?s.readyState>=s.HAVE_METADATA?m.completeExpand(e):Ve.on(s,"loadedmetadata",()=>m.completeExpand(e)):Ve.asap(()=>s.naturalHeight,()=>m.completeExpand(e)),De["Enable sound posts"]&&De["Allow Sound"]){const e=n.name.match(/\[sound=([^\]]+)]/i);if(e){let t=decodeURIComponent(e[1]);t.startsWith("http")||(t=`https://${t}`);const o=Ve.el("audio",{src:t});f.setup(o),i&&(lt.setupSync(s,o),s.controls=!1),o.loop=!0,o.controls=De["Show Controls"],o.autoplay=De.Autoplay,Ve.after(s,o),n.audio=o}}},completeExpand(e){const{file:t}=e;if(!t.isExpanding)return;const n=Y.getTopOf(t.thumb)+t.thumb.getBoundingClientRect().height,o=Te.body.clientHeight,{scrollY:a}=window;if(Ve.addClass(e.nodes.root,"expanded-image"),Ve.rmClass(t.thumb,"expanding"),t.isExpanded=!0,delete t.isExpanding,Re.contains(e.nodes.root)&&n<=0&&window.scrollBy(0,a-window.scrollY+Te.body.clientHeight-o),t.scrollIntoView){delete t.scrollIntoView;const e=Math.min(Re.clientHeight-t.fullImage.getBoundingClientRect().bottom-25,Y.getBottomOf(t.fullImage));e<0&&window.scrollBy(0,Math.min(-e,Y.getTopOf(t.fullImage)))}return t.isVideo?m.setupVideo(e,De.Autoplay,De["Show Controls"]):void 0},setupVideo(e,t,n){const{audio:o}=e.file,a=e.file.fullImage;t||o?(a.controls=!1,Ve.asap(()=>Re.contains(a),function(){!Te.hidden&&Y.isNodeVisible(a)?a.play():e.file.wasPlaying=!0}),a.controls=n&&!o):a.controls=n},videoCB:function(){let e=!1;return{mouseover:()=>e=!1,mousedown(t){if(0===t.button)return e=!0},mouseup(t){if(0===t.button)return e=!1},mouseout(t){if((1&t.buttons||e)&&t.clientX<=this.getBoundingClientRect().left)return m.toggle(n.postFromNode(this))}}}(),setupVideoCB(e){var t,n;for(t in m.videoCB)n=m.videoCB[t],Ve.on(e.file.fullImage,t,n);if(e.file.videoControls)return Ve.on(e.file.videoControls.firstElementChild,"click",()=>m.toggle(e))},error(){const e=n.postFromNode(this);if(Ve.rm(this),delete e.file.fullImage,e.file.isExpanding||e.file.isExpanded)return V.decodeError(this,e.file)||V.isFromArchive(this)?m.contract(e):V.error(this,e,e.file,1e4,function(t){if((e.file.isExpanding||e.file.isExpanded)&&(m.contract(e),t))return m.expand(e,t)})},menu:{init(){var e,t;if(!m.enabled)return;const n=Ve.el("span",{textContent:"Image Expansion",className:"image-expansion-link"}),{createSubEntry:o}=m.menu,a=[];for(e in Me.imageExpansion)t=Me.imageExpansion[e],a.push(o(e,t[1]));return Y.menu.addEntry({el:n,order:105,subEntries:a})},createSubEntry(e,t){const n=rt.checkbox(e,e);n.title=t;const o=n.firstElementChild;return["Fit width","Fit height"].includes(e)&&Ve.on(o,"change",m.cb.setFitness),Ve.event("change",null,o),Ve.on(o,"change",Ve.cb.checked),{el:n}}}};class dt{toString(){return this.ID}constructor(e,t,n,o={}){var a,i,s;if(void 0===e&&void 0===t&&void 0===n)return;if(this.root=e,this.thread=t,this.board=n,Ve.extend(this,o),this.ID=+e.id.match(/\d*$/)[0],this.postID=this.ID,this.threadID=this.thread.ID,this.boardID=this.board.ID,this.siteID=Ee.SITE.ID,this.fullID=`${this.board}.${this.ID}`,this.context=this,this.isReply=this.ID!==this.threadID,e.dataset.fullID=this.fullID,this.nodes=this.parseNodes(e),!this.isReply){for(a of(this.thread.OP=this,["isSticky","isClosed","isArchived"]))(i=Ee.SITE.selectors.icons[a])&&(this.thread[a]=!!Ve(i,this.nodes.info));this.thread.isArchived&&(this.thread.isClosed=!0,this.thread.kill())}const r=this.nodes.name?.textContent,l=this.nodes.tripcode?.textContent;if(this.info={subject:this.nodes.subject?.textContent||void 0,name:r,email:this.nodes.email?decodeURIComponent(this.nodes.email.href.replace(/^mailto:/,"")):void 0,tripcode:l,uniqueID:this.nodes.uniqueID?.textContent,capcode:this.nodes.capcode?.textContent.replace("## ",""),pass:this.nodes.pass?.title.match(/\d*$/)[0],flagCode:this.nodes.flag?.className.match(/flag-(\w+)/)?.[1].toUpperCase(),flagCodeTroll:this.nodes.flag?.className.match(/bfl-(\w+)/)?.[1].toUpperCase(),flag:this.nodes.flag?.title,date:this.nodes.date?Ee.SITE.parseDate(this.nodes.date):void 0,nameBlock:De.Anonymize?"Anonymous":`${r||""} ${l||""}`.trim()},this.info.capcode&&(this.info.nameBlock+=` ## ${this.info.capcode}`),this.info.uniqueID&&(this.info.nameBlock+=` (ID: ${this.info.uniqueID})`),this.parseComment(),this.parseQuotes(),this.parseFiles(),this.isDead=!1,this.isHidden=!1,this.clones=[],Ee.posts.get(this.fullID))for(s of(this.isRebuilt=!0,this.clones=Ee.posts.get(this.fullID).clones,this.clones))s.origin=this;!this.isFetchedQuote&&this.ID>this.thread.lastPost&&(this.thread.lastPost=this.ID),this.ID<this.thread.lastPost&&"thread"===Ee.VIEW?(this.board.posts.insert(this.ID,this),this.thread.posts.insert(this.ID,this),Ee.posts.insert(this.fullID,this,e=>+e.split(".")[1]<this.ID)):(this.board.posts.push(this.ID,this),this.thread.posts.push(this.ID,this),Ee.posts.push(this.fullID,this))}parseNodes(e){var t,n;const o=Ee.SITE.selectors,a=Ve(o.post,e)||e,i=Ve(o.infoRoot,a),s={root:e,bottom:this.isReply||!Ee.SITE.isOPContainerThread?e:Ve(o.opBottom,e),post:a,info:i,comment:Ve(o.comment,a),quotelinks:[],archivelinks:[],embedlinks:[],backlinks:a.getElementsByClassName("backlink"),uniqueIDRoot:void 0,uniqueID:void 0};for(t in o.info)n=o.info[t],s[t]=Ve(n,i);return Ee.SITE.parseNodes?.(this,s),s.uniqueIDRoot||(s.uniqueIDRoot=s.uniqueID),s}parseComment(){let e;return this.nodes.comment.normalize(),this.nodes.commentClean=e=this.nodes.comment.cloneNode(!0),Ee.SITE.cleanComment?.(e),this.info.comment=this.nodesToText(e)}commentDisplay(){const e=this.nodes.commentClean.cloneNode(!0);return De["Remove Spoilers"]||De["Reveal Spoilers"]||this.cleanSpoilers(e),Ee.SITE.cleanCommentDisplay?.(e),this.nodesToText(e).trim().replace(/\s+$/gm,"")}commentOrig(){const e=this.nodes.commentClean.cloneNode(!0);return Ee.SITE.insertTags?.(e),this.nodesToText(e)}nodesToText(e){let t,n="";const o=Ve.X(".//br|.//text()",e);let a=0;for(;t=o.snapshotItem(a++);)n+=t.data||"\n";return n}cleanSpoilers(e){const t=Ge(Ee.SITE.selectors.spoiler,e);for(var n of t)Ve.replace(n,Ve.tn("[spoiler]"))}parseQuotes(){for(var e of(this.quotes=[],Ge(Ee.SITE.selectors.quotelink,this.nodes.comment)))this.parseQuote(e)}parseQuote(e){const t=e.href.match(Ee.SITE.regexp.quotelink);if(!(t||this.isClone&&e.dataset.postID))return;if(this.nodes.quotelinks.push(e),this.isClone)return;const n=`${t[1]}.${t[3]}`;this.quotes.includes(n)||this.quotes.push(n)}parseFiles(){let e;this.files=[];const t=this.fileRoots();let n=0;for(let a=0;a<t.length;a++){var o=t[a];(e=this.parseFile(o))&&(e.index=n++,e.docIndex=a,this.files.push(e))}if(this.files.length)return this.file=this.files[0]}fileRoots(){if(Ee.SITE.selectors.multifile){const e=Ge(Ee.SITE.selectors.multifile,this.nodes.root);if(e.length)return e}return[this.nodes.root]}parseFile(e){var t,n;const o={isDead:!1};for(t in Ee.SITE.selectors.file)n=Ee.SITE.selectors.file[t],o[t]=Ve(n,e);if(o.thumbLink=o.thumb?.parentNode,!o.text||!o.link)return;if(!Ee.SITE.parseFile(this,o))return;Ve.extend(o,{url:o.link.href,isImage:Ve.isImage(o.link.href),isVideo:Ve.isVideo(o.link.href)});let a=+o.size.match(/[\d.]+/)[0],i=["B","KB","MB","GB"].indexOf(o.size.match(/\w+$/)[0]);for(;i-- >0;)a*=1024;return o.sizeInBytes=a,o}kill(e=!1,t=0){var o,a;let i;if(e){if(this.isDead||this.files[t].isDead)return;this.files[t].isDead=!0,Ve.addClass(this.nodes.root,"deleted-file")}else{if(this.isDead)return;this.isDead=!0,Ve.rmClass(this.nodes.root,"deleted-file"),Ve.addClass(this.nodes.root,"deleted-post")}if((i=Ve("strong.warning",this.nodes.info))||(i=Ve.el("strong",{className:"warning"}),Ve.after(Ve("input",this.nodes.info),i)),i.textContent=e?"[File deleted]":"[Deleted]",!this.isClone){for(o of this.clones)o.kill(e,t);if(!e)for(a of n.allQuotelinksLinkingTo(this))Ve.hasClass(a,"deadlink")||(Ve.add(a,dt.deadMark.cloneNode(!0)),Ve.addClass(a,"deadlink"))}}markAsFromArchive(){var e,t;let o=Ve("strong.warning",this.nodes.info);if(o||(o=Ve.el("strong",{className:"warning"}),Ve.after(Ve("input",this.nodes.info),o)),o.textContent="[Deleted, restored from external archive]",Ve.addClass(this.nodes.root,"from-archive"),!this.isClone){for(e of this.clones)e.markAsFromArchive();for(t of n.allQuotelinksLinkingTo(this))Ve.addClass(t,"from-archive-link")}}resurrect(){var e,t;this.isDead=!1,Ve.rmClass(this.nodes.root,"deleted-post","from-archive");const o=Ve("strong.warning",this.nodes.info);if(this.files.some(e=>e.isDead)?(Ve.addClass(this.nodes.root,"deleted-file"),o.textContent="[File deleted]"):Ve.rm(o),!this.isClone){for(e of this.clones)e.resurrect();for(t of n.allQuotelinksLinkingTo(this))Ve.hasClass(t,"deadlink")&&Ve.rm(Ve(".qmark-dead",t)),Ve.rmClass(t,"deadlink","from-archive-link")}}collect(){Ee.posts.rm(this.fullID),this.thread.posts.rm(this),this.board.posts.rm(this)}addClone(e,t){return Ne.Post.execute(this),new ct(this,e,t)}rmClone(e){for(var t of(this.clones.splice(e,1),this.clones.slice(e)))t.nodes.root.dataset.clone=e++}setCatalogOP(e){this.nodes.root.classList.toggle("catalog-container",e),this.nodes.root.classList.toggle("opContainer",!e),this.nodes.post.classList.toggle("catalog-post",e),this.nodes.post.classList.toggle("op",!e),this.nodes.post.style.left=this.nodes.post.style.right=null}}dt.deadMark=(()=>{const e=document.createElement("span");return e.textContent="Â (Dead)",e.className="qmark-dead",e})();class ct extends dt{constructor(e,t,n){var o,a,i,s,r,l;let d,c,h;for(h of(super(),this.isClone=!0,this.origin=e,this.context=t,["ID","postID","threadID","boardID","siteID","fullID","board","thread","info","quotes","isReply"]))this[h]=this.origin[h];const{nodes:u}=this.origin,p=n?this.cloneWithoutVideo(u.root):u.root.cloneNode(!0);for(o of[p,...Ge("[id]",p)])o.id+=`_${ct.suffix}`;for(a of(ct.suffix++,Ge(".inline",p)))Ve.rm(a);for(i of Ge(".inlined",p))Ve.rmClass(i,"inlined");for(s of(this.nodes=this.parseNodes(p),p.hidden=!1,Ve.rmClass(p,"forwarded"),Ve.rmClass(this.nodes.post,"highlight"),this.isReply||(this.setCatalogOP(!1),Ve.rm(Ve(".catalog-link",this.nodes.post)),Ve.rm(Ve(".catalog-stats",this.nodes.post)),Ve.rm(Ve(".catalog-replies",this.nodes.post))),this.parseQuotes(),this.quotes=[...this.origin.quotes],this.files=[],this.origin.files.length&&(c=this.fileRoots()),this.origin.files)){for(h in d={...s},r=c[d.docIndex],Ee.SITE.selectors.file)l=Ee.SITE.selectors.file[h],d[h]=Ve(l,r);d.thumbLink=d.thumb?.parentNode,d.thumbLink&&(d.fullImage=Ve(".full-image",d.thumbLink)),d.videoControls=Ve(".video-controls",d.text),d.videoThumb&&(d.thumb.muted=!0),this.files.push(d)}return this.files.length&&(this.file=this.files[0],this.file.thumb&&n&&m.contract(this)),this.origin.isDead&&(this.isDead=!0),p.dataset.clone=this.origin.clones.push(this)-1,this}cloneWithoutVideo(e){if("VIDEO"!==e.tagName||e.dataset.md5){if(e.nodeType===Node.ELEMENT_NODE&&Ve("video",e)){const n=e.cloneNode(!1);for(var t of e.childNodes)Ve.add(n,this.cloneWithoutVideo(t));return n}return e.cloneNode(!0)}return[]}}ct.suffix=0,b={cbs:[],init(){let e;if("yotsuba"!==Ee.SITE.software)return;const t=Date.now();if(t-2*qe>=(e=De.boardConfig.lastChecked||0)||e>t)return Ve.ajax(`${location.protocol}//a.4cdn.org/boards.json`,{onloadend:this.load});{const{boards:e}=De.boardConfig;return this.set(e)}},load(){let e;if(200===this.status&&this.response&&this.response.boards){for(var t of(e=Fe(),this.response.boards))e[t.board]=t;Ve.set("boardConfig",{boards:e,lastChecked:Date.now()})}else{({boards:e}=De.boardConfig);const t=(()=>{switch(this.status){case 0:return"Connection Error";case 200:return"Invalid Data";default:return`Error ${this.statusText} (${this.status})`}})();new It("warning",`Failed to load board configuration. ${t}`,20)}return b.set(e)},set(e){var t,n;for(t in this.boards=e,Ee.boards)Ee.boards[t].config=this.boards[t]||{};for(n of this.cbs)Ve.queueTask(n)},ready(e){return this.boards?e():this.cbs.push(e)},sfwBoards(e){return(()=>{var t;const n=[],o=this.boards||De.boardConfig.boards;for(t in o)!!o[t].ws_board===e&&n.push(t);return n})()},isSFW(e){return!!(this.boards||De.boardConfig.boards)[e]?.ws_board},domain:()=>"boards.4chan.org",isArchived(e){const t=(this.boards||De.boardConfig.boards)[e];return!t||t.is_archived},noAudio(e){if("yotsuba"!==Ee.SITE.software)return!1;const t=this.boards||De.boardConfig.boards;return t&&t[e]&&!t[e].webm_audio},title(e){return(this.boards||De.boardConfig.boards)?.[e]?.title||""}},A={init(){if(["index","thread"].includes(Ee.VIEW)&&De.Menu)return this.button=Ve.el("a",{className:"menu-button",href:"javascript:;"}),a.set(this.button,"caretDown"),this.menu=new rt.Menu("post"),Ne.Post.push({name:"Menu",cb:this.node}),Ne.CatalogThread.push({name:"Menu",cb:this.catalogNode})},node(){if(this.isClone){const e=Ve(".menu-button",this.nodes.info);return Ve.rmClass(e,"active"),Ve.rm(Ve(".dialog",this.nodes.info)),void A.makeButton(this,e)}return Ve.add(this.nodes.info,A.makeButton(this))},catalogNode(){return Ve.after(this.nodes.icons,A.makeButton(this.thread.OP))},makeButton:(e,t)=>(t||(t=A.button.cloneNode(!0)),Ve.on(t,"click",function(t){return A.menu.toggle(t,this,e)}),t)},v={recursives:new Map,init(){["index","thread"].includes(Ee.VIEW)&&Ne.Post.push({name:"Recursive",cb:this.node})},node(){var e,t;if(!this.isClone&&!this.isFetchedQuote)for(e of this.quotes){const n=v.recursives.get(e);if(n)for(t=0;t<n.recursives.length;t++)n.recursives[t](this,...n.args[t])}},add(e,t,...n){let o=v.recursives.get(t.fullID);o||(o={recursives:[],args:[]},v.recursives.set(t.fullID,o)),o.recursives.push(e),o.args.push(n)},rm(e,t){const n=v.recursives.get(t.fullID);if(n)for(let t=n.recursives.length-1;t>=0;--t)n.recursives[t]===e&&(n.recursives.splice(t,1),n.args.splice(t,1))},apply(e,t,...n){const{fullID:o}=t;Ee.posts.forEach(function(t){t.quotes.includes(o)&&e(t,...n)})},applyAndAdd(e,t,...n){v.apply(e,t,...n),this.add(e,t,...n)}},x={db:void 0,posterIdDb:void 0,init(){["index","thread"].includes(Ee.VIEW)&&(De["Reply Hiding Buttons"]||De.Menu&&De["Reply Hiding Link"])&&(De["Reply Hiding Buttons"]&&Ve.addClass(Re,"reply-hide"),this.db=new nt("hiddenPosts"),this.posterIdDb=new nt("hiddenPosterIds"),Ne.Post.push({name:"Reply Hiding",cb:this.node}))},isHidden:(e,t,n)=>!(!x.db||!x.db.get({boardID:e,threadID:t,postID:n})),node(){if(!this.isReply||this.isClone||this.isFetchedQuote)return;let e=x.db.get({boardID:this.board.ID,threadID:this.thread.ID,postID:this.ID});if(!e&&this.info.uniqueID){const t=x.posterIdDb.get({boardID:this.board.ID,threadID:this.thread.ID});t&&this.info.uniqueID in t&&(e=t[this.info.uniqueID],e.thisPost=!0)}if(e&&(e.thisPost?x.hide(this,e.makeStub,e.hideRecursively,"Hidden manually"):x.hideRecursive(this,e.makeStub)),!De["Reply Hiding Buttons"])return;const t=x.makeButton(this,"hide"),n=Ee.SITE.selectors.sideArrows;if(n){const e=Ve(n,this.nodes.root);Ve.replace(e.firstChild,t),e.className="replacedSideArrows"}else Ve.prepend(this.nodes.info,t)},menu:{post:void 0,async init(){if(!["index","thread"].includes(Ee.VIEW)||!De.Menu||!De["Reply Hiding Link"])return;await new Promise(e=>b.ready(e));let e=Ve.el("a",{textContent:"Apply",href:"javascript:;"});Ve.on(e,"click",x.menu.hide);const t=[{el:e},{el:rt.checkbox("thisPost","This post",!0)},{el:rt.checkbox("replies","Hide replies",De["Recursive Hiding"])},{el:rt.checkbox("makeStub","Make stub",De.Stubs)}];Ee.BOARD.config.user_ids&&t.push({el:rt.checkbox("byId","By poster id",!1)}),A.menu.addEntry({el:Ve.el("div",{className:"hide-reply-link",textContent:"Hide"}),order:20,open:e=>!(!e.isReply||e.isClone||e.isHidden||(x.menu.post=e,0)),subEntries:t});const n=Ve.el("a",{textContent:"Apply",href:"javascript:;"});Ve.on(n,"click",x.menu.show);const o=rt.checkbox("thisPost","This post",!1),a=rt.checkbox("replies","Show replies",!1),i=Ve.el("a",{textContent:"Hide stub",href:"javascript:;"});Ve.on(i,"click",x.menu.hideStub);const s=[{el:n},{el:o},{el:a}];let r;Ee.BOARD.config.user_ids&&(r=rt.checkbox("byId","By poster id",!1),s.push({el:r})),A.menu.addEntry({el:Ve.el("div",{className:"show-reply-link",textContent:"Show"}),order:20,open(e){if(!e.isReply||e.isClone||!e.isHidden)return!1;const t=x.db.get({boardID:e.board.ID,threadID:e.thread.ID,postID:e.ID});return!!t&&(x.menu.post=e,o.firstChild.checked=e.isHidden,a.firstChild.checked=t.hideRecursively??De["Recursive Hiding"],r&&(r.firstChild.checked=t.byId),!0)},subEntries:s}),A.menu.addEntry({el:i,order:15,open:e=>!(!e.isReply||e.isClone||!e.isHidden)&&!!x.db.get({boardID:e.board.ID,threadID:e.thread.ID,postID:e.ID})&&(x.menu.post=e)})},hide(){const e=this.parentNode,t=Ve("input[name=thisPost]",e).checked,n=Ve("input[name=replies]",e).checked,o=Ve("input[name=makeStub]",e).checked,a=Ve("input[name=byId]",e)?.checked,{post:i}=x.menu;if(t||n||a){if(t?x.hide(i,o,n,"Hidden manually"):n&&x.hideRecursive(i,o),a){const e=`Hidden because of poster ID ${i.info.uniqueID}`;Ee.posts.forEach(s=>{s.info.uniqueID===i.info.uniqueID&&s!==i&&(x.hide(s,o,n,e),x.saveHiddenState(s,!0,t,o,n,a))});const s=x.posterIdDb.get({boardID:i.boardID,threadID:i.threadID,defaultValue:Fe()});i.info.uniqueID in s||(s[i.info.uniqueID]={makeStub:o,hideRecursively:n},x.posterIdDb.set({boardID:i.boardID,threadID:i.threadID,val:s}))}x.saveHiddenState(i,!0,t,o,n,a),Ve.event("CloseMenu")}},show(){const e=this.parentNode,t=Ve("input[name=thisPost]",e).checked,n=Ve("input[name=replies]",e).checked,o=Ve("input[name=byId]",e)?.checked,{post:a}=x.menu,{boardID:i,threadID:s,postID:r}=a;if(!t&&!n&&!o)return;if(t?x.show(a,n):n&&(v.apply(x.show,a,!0),v.rm(x.hide,a)),o){Ee.posts.forEach(e=>{if(e.info.uniqueID===a.info.uniqueID&&e!==a){x.show(e,n);const l=x.db.get({boardID:i,threadID:s,postID:r});l&&x.saveHiddenState(a,!(t&&n),!t,l.makeStub,!n,o)}});const e=x.posterIdDb.get({boardID:i,threadID:s});e&&a.info.uniqueID in e&&(delete e[a.info.uniqueID],x.posterIdDb.set({boardID:i,threadID:s,val:e}))}const l=x.db.get({boardID:i,threadID:s,postID:r});l&&x.saveHiddenState(a,!(t&&n),!t,l.makeStub,!n,o),Ve.event("CloseMenu")},hideStub(){let e;const{post:t}=x.menu;(e=x.db.get({boardID:t.board.ID,threadID:t.thread.ID,postID:t.ID}))&&(x.show(t,e.hideRecursively),x.hide(t,!1,e.hideRecursively),x.saveHiddenState(t,!0,!0,!1,e.hideRecursively,e.byId)),Ve.event("CloseMenu")}},makeButton(e,t){const n=Ve.el("span",{className:"stub-icon"}),o=Ve.el("a",{className:`${t}-post-button ${t}-reply-button`,href:"javascript:;"});return a.set(n,"hide"===t?"squareMinus":"squarePlus"),Ve.add(o,n),Ve.on(o,"click",x.toggle),o},saveHiddenState(e,t,n,o,a,i){const s={boardID:e.board.ID,threadID:e.thread.ID,postID:e.ID};t?(s.val={thisPost:!1!==n,makeStub:o,hideRecursively:a,byId:i},x.db.set(s)):x.db.delete(s)},toggle(){const e=n.postFromNode(this);e.isHidden?x.show(e):x.hide(e,void 0,void 0,"Hidden manually"),x.saveHiddenState(e,e.isHidden)},hide(e,t=De.Stubs,o=De["Recursive Hiding"],a){if(e.isHidden)return;for(var i of(e.isHidden=!0,o&&x.hideRecursive(e,t),n.allQuotelinksLinkingTo(e)))Ve.addClass(i,"filtered");if(!t)return void(e.nodes.root.hidden=!0);e.nodes.stub=Ve.el("div",{className:"stub"});const s=x.makeButton(e,"show");Ve.add(s,Ve.el("span",{className:"stub-name",textContent:e.info.nameBlock}));let r=e.filterResults?.reasons||[];if(a&&(r=[...r,a]),De["Filter Reason"]&&r.length){const e=Ve.el("span",{className:"stub-reasons"});Ve.add(e,r.map(e=>Ve.el("span",{className:"stub-reason",textContent:e}))),s.appendChild(e)}Ve.add(e.nodes.stub,s),!De["Filter Reason"]&&r&&(e.nodes.stub.title=r.join(" & ")),De.Menu&&Ve.add(e.nodes.stub,A.makeButton(e)),Ve.prepend(e.nodes.root,e.nodes.stub)},hideRecursive(e,t){v.applyAndAdd(x.hide,e,t,!0,`Hidden recursively from ${e.ID}`)},show(e,t=De["Recursive Hiding"]){for(var o of(e.nodes.stub?(Ve.rm(e.nodes.stub),delete e.nodes.stub):e.nodes.root.hidden=!1,e.isHidden=!1,t&&(v.apply(x.show,e,!0),v.rm(x.hide,e)),n.allQuotelinksLinkingTo(e)))Ve.rmClass(o,"filtered")}},w={INTERVAL:3e4,init(){if((["index","thread","archive"].includes(Ee.VIEW)&&["Show","Both","BothRelativeFirst"].includes(De.RelativeTime)||B.enabled)&&(this.flush(),Ve.on(Te,"visibilitychange PostsInserted",this.flush)),"No"!==De.RelativeTime)return Ne.Post.push({name:"Relative Post Dates",cb:this.node})},node(){if(!this.info.date)return;const e=this.nodes.date;if("Hover"!==De.RelativeTime){if(!this.isClone)return"Show"===De.RelativeTime&&(e.dataset.fullTime=e.textContent,e.title=e.textContent),w.update(this)}else Ve.on(e,"mouseover",()=>w.hover(this))},relative(e,t,n,o){let a,i;if((a=e/He)>=1){const e=t.getFullYear()-n.getFullYear();let o=t.getMonth()-n.getMonth();const s=t.getDate()-n.getDate();e>1?(a=e-(o<0||0===o&&s<0),i="year"):1===e&&(o>0||0===o&&s>=0)?(a=e,i="year"):(o+=12*e)>1?(a=o-(s<0),i="month"):1===o&&s>=0?(a=o,i="month"):i="day"}else(a=e/qe)>=1?i="hour":(a=e/Oe)>=1?i="minute":(a=Math.max(0,e)/$e,i="second");const s=Math.round(a);return o?i="month"===i?"mo":i[0]:1!==s&&(i+="s"),o?`${s}${i}`:`${s} ${i} ago`},stale:[],timeout:void 0,flush(){if(Te.hidden)return;const e=new Date;for(var t of w.stale)w.update(t,e);w.stale=[],clearTimeout(w.timeout),w.timeout=setTimeout(w.flush,w.INTERVAL)},hover(e){const{date:t}=e.info,n=new Date,o=n-t;e.nodes.date.title=w.relative(o,n,t)},update(e,t=new Date){let n,o;const a=e instanceof dt;a?(({date:o}=e.info),n=!1):(o=new Date(+e.dataset.utc),n=!!e.dataset.abbrev);const i=t-o,s=w.relative(i,t,o,n);if(a)for(var r of[e].concat(e.clones)){const e=r.nodes.date;if("Show"===De.RelativeTime)e.textContent=s;else{let t=e.dataset.fullTime;t||(t=e.textContent,e.dataset.fullTime=t),e.textContent="Both"===De.RelativeTime?`${t}, ${s}`:`${s}, ${t}`}}else e.firstChild.textContent=s;w.setOwnTimeout(i,e)},setOwnTimeout(e,t){const n=e<Oe?$e-(e+500)%$e:e<qe?Oe-(e+3e4)%Oe:e<He?qe-(e+qe/2)%qe:He-(e+He/2)%He;setTimeout(w.markStale,n,t)},markStale(e){w.stale.includes(e)||e instanceof dt&&!Ee.posts.get(e.fullID)||e instanceof Element&&!Re.contains(e)||w.stale.push(e)}};class ht{toString(){return this.ID}constructor(e){this.ID=e,this.boardID=this.ID,this.siteID=Ee.SITE.ID,this.threads=new ot,this.posts=new ot,this.config=b.boards?.[this.ID]||{},Ee.boards[this]=this}cooldowns(){const e=(this.config||{}).cooldowns||{},t={thread:e.threads||0,reply:e.replies||0,image:e.images||0,thread_global:300};if(Te.cookie.indexOf("pass_enabled=1")>=0)for(var n of["reply","image"])t[n]=Math.ceil(t[n]/2);return t}}const ut={init(){return Ve.on(Te,"QRPostSuccessful",e=>{if(e.detail.redirect)return this.event=e,this.delays=0,Ve.queueTask(()=>{if(e===this.event&&0===this.delays)return location.href=e.detail.redirect})})},delays:0,delay(){if(!this.event)return null;const e=this.event;return this.delays++,()=>{if(e===this.event)return this.delays--,0===this.delays?location.href=e.detail.redirect:void 0}}};y={init(){if("index"===Ee.VIEW&&De["Comment Expansion"]&&!De["JSON Index"])return Ne.Post.push({name:"Comment Expansion",cb:this.node})},node(){let e;if(e=Ve(".abbr > a:not([onclick])",this.nodes.comment))return Ve.on(e,"click",y.cb)},callbacks:[],cb(e){return e.preventDefault(),y.expand(n.postFromNode(this))},expand(e){let t;return e.nodes.longComment&&!e.nodes.longComment.parentNode?(Ve.replace(e.nodes.shortComment,e.nodes.longComment),void(e.nodes.comment=e.nodes.longComment)):(t=Ve(".abbr > a",e.nodes.comment))?(t.textContent=`Post No.${e} Loading...`,Ve.cache(Ee.SITE.urls.threadJSON({boardID:e.boardID,threadID:e.threadID}),function(){return y.parse(this,t,e)})):void 0},contract(e){if(e.nodes.shortComment)return Ve(".abbr > a",e.nodes.shortComment).textContent="here",Ve.replace(e.nodes.longComment,e.nodes.shortComment),e.nodes.comment=e.nodes.shortComment},parse(e,t,n){var o,a,i;let s,r;const{status:l}=e;if(![200,304].includes(l))return void(t.textContent=l?`Error ${e.statusText} (${l})`:"Connection Error");const{posts:d}=e.response;for(s of((r=d[0].custom_spoiler)&&(Ee.SITE.Build.spoilerRange[Ee.BOARD]=r),d))if(s.no===n.ID)break;if(s.no!==n.ID)return void(t.textContent=`Post No.${n} not found.`);const{comment:c}=n.nodes,h=c.cloneNode(!1);for(o of(h.innerHTML=s.com,Ge(".quotelink",h)))"/"!==(a=o.getAttribute("href"))[0]&&("#"===a[0]?o.href=`${t.pathname.split(/\/+/).splice(0,4).join("/")}${a}`:o.href=`${t.pathname.split(/\/+/).splice(0,3).join("/")}/${a}`);for(i of(n.nodes.shortComment=c,Ve.replace(c,h),n.nodes.comment=n.nodes.longComment=h,n.parseComment(),n.parseQuotes(),y.callbacks))i.call(n)}};const pt={init(){pt.container=Ve.el("div",{classList:"scroll-marker-container"}),Re.insertAdjacentElement("afterbegin",pt.container),Ve.on(pt.container,"click",e=>{const{postId:t}=e.target.dataset;t&&Y.scrollTo(Ee.posts[t].nodes.root)}),new ResizeObserver(pt.markScroll).observe(Re)},container:void 0,markers:void 0,markScroll:Pe(100,()=>{if(!De["Scroll Markers"])return pt.container.innerText="",void(pt.markers=void 0);const e=new Map;let t;Ee.posts?.forEach(t=>{const n=t.nodes.root;let o=!1;if(Ve.hasClass(n,"quotesYou"))o=!0;else if(!Ve.hasClass(n,"yourPost"))return;const a=n.getBoundingClientRect();e.set(`${t.boardID}.${t.ID}`,{classList:`post-scroll-marker ${o?"reply":"you"}-scroll-marker`,ariaLabel:`Jump to ${o?"reply to ":""} my post`,top:((a.top+window.scrollY)/Re.scrollHeight*100).toFixed(1),height:Math.max(1,a.height/Re.scrollHeight*100).toFixed(1)})});for(const[n,o]of e){const e=pt.markers?.get(n);let a=e?.el;a||(a=Ve.el("button",{type:"button"}),t?t.insertAdjacentElement("afterend",a):Ve.add(pt.container,a)),a.classList=o.classList,a.style.setProperty("--top",o.top),a.style.setProperty("--height",o.height),a.dataset.postId=n,o.el=a,t=a,document.createElement("button")}if(pt.markers)for(const[t,{el:n}]of pt.markers)e.has(t)||n.remove();pt.markers=e},!1)};k={init(){De["Remember Your Posts"]&&(this.db=new nt("yourPosts"),Ve.sync("Remember Your Posts",e=>De["Remember Your Posts"]=e),Ve.on(Te,"QRPostSuccessful",function(e){const t=ut.delay();return Ve.get("Remember Your Posts",De["Remember Your Posts"],function(n){if(!n["Remember Your Posts"])return;const{boardID:o,threadID:a,postID:i}=e.detail;return k.db.set({boardID:o,threadID:a,postID:i,val:!0},t)})}),["index","thread","archive"].includes(Ee.VIEW)&&(De["Highlight Own Posts"]&&Ve.addClass(Re,"highlight-own"),De["Highlight Posts Quoting You"]&&Ve.addClass(Re,"highlight-you"),De["Comment Expansion"]&&y.callbacks.push(this.node),this.mark=Ve.el("span",{textContent:"Â (You)",className:"qmark-you"}),Ne.Post.push({name:"Mark Quotes of You",cb:this.node}),k.menu.init()))},isYou:e=>!!k.db?.get({boardID:e.boardID,threadID:e.threadID,postID:e.ID}),node(){if(!this.isClone&&(k.isYou(this)&&(Ve.addClass(this.nodes.root,"yourPost"),pt.markScroll()),this.quotes.length))for(var e of this.nodes.quotelinks)k.db.get(n.postDataFromLink(e))&&(De["Mark Quotes of You"]&&Ve.add(e,k.mark.cloneNode(!0)),Ve.addClass(e,"you"),Ve.addClass(this.nodes.root,"quotesYou"))},menu:{init(){const e=Ve.el("label",{className:"toggle-you"},{innerHTML:'<input type="checkbox"> You'}),t=Ve("input",e);Ve.on(t,"change",k.menu.toggle),A.menu?.addEntry({el:e,order:80,open:e=>(k.menu.post=e.origin||e,t.checked=k.isYou(e),!0)})},toggle(){var e,t,o;const{post:a}=k.menu,i={boardID:a.board.ID,threadID:a.thread.ID,postID:a.ID,val:!0};for(e of(this.checked?k.db.set(i):k.db.delete(i),[a].concat(a.clones)))e.nodes.root.classList.toggle("yourPost",this.checked);for(t of n.allQuotelinksLinkingTo(a))this.checked?De["Mark Quotes of You"]&&Ve.add(t,k.mark.cloneNode(!0)):Ve.rm(Ve(".qmark-you",t)),t.classList.toggle("you",this.checked),Ve.hasClass(t,"quotelink")&&(o=n.postFromNode(t).nodes.root).classList.toggle("quotesYou",!!Ve(".quotelink.you",o));pt.markScroll()}},cb:{seek(e){let t,n,o;const{highlight:a}=Ee.SITE.classes;if((t=Ve(`.${a}`))&&Ve.rmClass(t,a),k.lastRead&&Re.contains(k.lastRead)&&Ve.hasClass(k.lastRead,"quotesYou"))n=k.lastRead;else{if(!(n=k.lastRead=Ve(".quotesYou")))return void new It("warning","No posts are currently quoting you, loser.",20);if(k.cb.scroll(n))return}const i=`${e}::div[contains(@class,'quotesYou')]`;for(;n=(o=Ve.X(i,n)).snapshotItem("preceding"===e?o.snapshotLength-1:0);)if(k.cb.scroll(n))return;const s=Ge(".quotesYou");return k.cb.scroll(s["following"===e?0:s.length-1])},scroll(e){const t=n.postFromRoot(e);if(t.nodes.post.getBoundingClientRect().height){if(k.lastRead=e,location.href=n.url("post",t),Y.scrollTo(t.nodes.post),t.isReply){const e=`${Ee.SITE.selectors.postContainer}${Ee.SITE.selectors.highlightable.reply}`;let n=t.nodes.root;n.matches(e)||(n=Ve(e,n)),Ve.addClass(n,Ee.SITE.classes.highlight)}return!0}return!1}}};class gt{constructor(e){if(this.length=0,e)for(var t of e)this.push(t)}push(e){let t,{ID:n}=e;if(n||(n=e.id),this[n])return;const{last:o}=this;return this[n]=t={prev:o,next:null,data:e,ID:n},t.prev=o,this.last=o?o.next=t:this.first=t,this.length++}before(e,t){if(t.next===e||t===e)return;this.rmi(t);const{prev:n}=e;return e.prev=t,t.next=e,t.prev=n,n?n.next=t:this.first=t}after(e,t){if(t.prev===e||t===e)return;this.rmi(t);const{next:n}=e;return e.next=t,t.prev=e,t.next=n,n?n.prev=t:this.last=t}prepend(e){const{first:t}=this;if(e!==t&&this[e.ID])return this.rmi(e),e.next=t,t?t.prev=e:this.last=e,this.first=e,delete e.prev}shift(){return this.rm(this.first.ID)}order(){let e;const t=[e=this.first];for(;e=e.next;)t.push(e);return t}rm(e){const t=this[e];if(t)return delete this[e],this.length--,this.rmi(t),delete t.next,delete t.prev}rmi(e){const{prev:t,next:n}=e;return t?t.next=n:this.first=n,n?n.prev=t:this.last=t}}I={init(){if("thread"===Ee.VIEW&&(De["Unread Count"]||De["Unread Favicon"]||De["Unread Line"]||De["Remember Last Read Post"]||De["Desktop Notifications"]||De["Quote Threading"]))return De["Remember Last Read Post"]&&(Ve.sync("Remember Last Read Post",e=>De["Remember Last Read Post"]=e),this.db=new nt("lastReadPosts",this.sync)),this.hr=Ve.el("hr",{id:"unread-line",className:"unread-line"}),this.posts=new Set,this.postsQuotingYou=new Set,this.order=new gt,this.position=null,Ne.Thread.push({name:"Unread",cb:this.node}),Ne.Post.push({name:"Unread",cb:this.addPost})},node(){for(var e of(I.thread=this,I.title=Te.title,I.lastReadPost=I.db?.get({boardID:this.board.ID,threadID:this.ID})||0,I.readCount=0,this.posts.keys))+e<=I.lastReadPost&&I.readCount++;Ve.one(Te,"4chanXInitFinished",I.ready),Ve.on(Te,"PostsInserted",I.onUpdate),Ve.on(Te,"ThreadUpdate",function(e){if(e.detail[404])return I.update()});const t=Ve.el("a",{href:"javascript:;",className:"unread-reset",textContent:"Mark all unread"});return Ve.on(t,"click",I.reset),Y.menu.addEntry({el:t,order:70})},ready(){if(De["Remember Last Read Post"]&&De["Scroll to Last Read Post"]&&I.scroll(),I.setLine(!0),I.read(),I.update(),Ve.on(Te,"scroll visibilitychange",I.read),De["Unread Line"])return Ve.on(Te,"visibilitychange",I.setLine)},positionPrev:()=>I.position?I.position.prev:I.order.last,scroll(){let e;if((e=location.hash.match(/\d+/))&&e[0]in I.thread.posts)return;let t=I.positionPrev();for(;t;){var{bottom:n}=t.data.nodes;if(n.getBoundingClientRect().height){Y.scrollToIfNeeded(n,!0);break}t=t.prev}},reset(){if(null!=I.lastReadPost)return I.posts=new Set,I.postsQuotingYou=new Set,I.order=new gt,I.position=null,I.lastReadPost=0,I.readCount=0,I.thread.posts.forEach(e=>I.addPost.call(e)),Ve.forceSync("Remember Last Read Post"),!De["Remember Last Read Post"]||I.thread.isDead&&!I.thread.isArchived||I.db.set({boardID:I.thread.board.ID,threadID:I.thread.ID,val:0}),I.updatePosition(),I.setLine(),I.update()},sync(){if(null==I.lastReadPost)return;const e=I.db.get({boardID:I.thread.board.ID,threadID:I.thread.ID,defaultValue:0});if(I.lastReadPost>=e)return;I.lastReadPost=e;const t=I.thread.posts.keys;for(let e=I.readCount,o=t.length;e<o;e++){var n=+t[e];if(!I.thread.posts.get(n).isFetchedQuote){if(n>I.lastReadPost)break;I.posts.delete(n),I.postsQuotingYou.delete(n)}I.readCount++}return I.updatePosition(),I.setLine(),I.update()},addPost(){if(!(this.isFetchedQuote||this.isClone||(I.order.push(this),this.ID<=I.lastReadPost||this.isHidden||k.isYou(this))))return I.posts.add(I.posts.last=this.ID),I.addPostQuotingYou(this),null!=I.position?I.position:I.position=I.order[this.ID]},addPostQuotingYou(e){for(var t of e.nodes.quotelinks)if(k.db?.get(n.postDataFromLink(t)))return I.postsQuotingYou.add(I.postsQuotingYou.last=e.ID),void I.openNotification(e)},openNotification(e,t=" replied to you"){if(!Y.areNotificationsEnabled)return;const n=new Notification(`${e.info.nameBlock}${t}`,{body:e.commentDisplay(),icon:i.logo});return n.onclick=function(){return Y.scrollToIfNeeded(e.nodes.bottom,!0),window.focus()},n.onshow=()=>setTimeout(()=>n.close(),7e3)},onUpdate:()=>Ve.queueTask(function(){return I.setLine(),I.read(),I.update()}),readSinglePost(e){const{ID:t}=e;if(I.posts.has(t))return I.posts.delete(t),I.postsQuotingYou.delete(t),I.updatePosition(),I.saveLastReadPost(),I.update()},read:Pe(100,function(e){if(I.posts.size||I.readCount===I.thread.posts.keys.length||I.saveLastReadPost(),Te.hidden||!I.posts.size)return;let t=0;for(;I.position;){var{ID:n,data:o}=I.position,{bottom:a}=o.nodes;if(a.getBoundingClientRect().height&&Y.getBottomOf(a)<=-1)break;t++,I.posts.delete(n),I.postsQuotingYou.delete(n),I.position=I.position.next}return t?(I.updatePosition(),I.saveLastReadPost(),e?I.update():void 0):void 0}),updatePosition(){for(;I.position&&!I.posts.has(I.position.ID);)I.position=I.position.next},saveLastReadPost:Pe(2e3,function(){let e;if(Ve.forceSync("Remember Last Read Post"),!De["Remember Last Read Post"]||!I.db)return;const t=I.thread.posts.keys;for(let n=I.readCount,o=t.length;n<o;n++){if(e=+t[n],!I.thread.posts.get(e).isFetchedQuote){if(I.posts.has(e))break;I.lastReadPost=e}I.readCount++}return!I.thread.isDead||I.thread.isArchived?I.db.set({boardID:I.thread.board.ID,threadID:I.thread.ID,val:I.lastReadPost}):void 0}),setLine(e){if(De["Unread Line"]){if(I.hr.hidden||Te.hidden||!0===e){const e=I.linePosition;if(I.linePosition=I.positionPrev()){if(I.linePosition!==e){let e=I.linePosition.data.nodes.bottom;"BR"===e.nextSibling?.tagName&&(e=e.nextSibling),Ve.after(e,I.hr)}}else Ve.rm(I.hr)}return I.hr.hidden=I.linePosition===I.order.last}},update(){const e=I.posts.size,t=I.postsQuotingYou.size;if(De["Unread Count"]){const n=De["Quoted Title"]&&t?"(!) ":"",o=e||!De["Hide Unread Count at (0)"]?`(${e}) `:"",a=I.thread.isDead?I.title.replace("-",I.thread.isArchived?"- Archived -":"- 404 -"):I.title;Te.title=`${n}${o}${a}`}if(I.saveThreadWatcherCount(),De["Unread Favicon"]&&"yotsuba"===Ee.SITE.software){const{isDead:n}=I.thread;return i.set(t?n?"unreadDeadY":"unreadY":e?n?"unreadDead":"unread":n?"dead":"default")}},saveThreadWatcherCount:Pe(2e3,function(){if(Ve.forceSync("Remember Last Read Post"),De["Remember Last Read Post"]&&(!I.thread.isDead||I.thread.isArchived)){let e;const t=!De["Require OP Quote Link"]&&k.isYou(I.thread.OP)?I.posts:I.postsQuotingYou;if(t.size){if(!t.has(t.last)){t.last=0,e=I.thread.posts.keys;for(let n=e.length-1;n>=0;n--)if(t.has(+e[n])){t.last=e[n];break}}}else t.last=0;return E.update(Ee.SITE.ID,I.thread.board.ID,I.thread.ID,{last:I.thread.lastPost,isDead:I.thread.isDead,isArchived:I.thread.isArchived,unread:I.posts.size,quotingYou:t.last||0})}})},C={statuses:Fe(),init(){"index"===Ee.VIEW&&De["Thread Expansion"]&&(De["JSON Index"]?Ve.on(Te,"IndexRefreshInternal",this.onIndexRefresh):Ne.Thread.push({name:"Expand Thread",cb(){C.setButton(this)}}))},setButton(e){if(!e.nodes.root)return;const t=Ve("a.summary",e.nodes.root);t&&(t.textContent=Ee.SITE.Build.summaryText("+",...t.textContent.match(/\d+/g)),t.style.cursor="pointer",Ve.on(t,"click",C.cbToggle))},disconnect(e){var t,n,o;if("thread"!==Ee.VIEW&&De["Thread Expansion"]){for(t in C.statuses)(n=(o=C.statuses[t]).req)&&(delete o.req,n.abort()),delete C.statuses[t];e||Ve.off(Te,"IndexRefreshInternal",this.onIndexRefresh)}},onIndexRefresh(){C.disconnect(!0),Ee.BOARD.threads.forEach(e=>C.setButton(e))},cbToggle(e){Ve.modifiedClick(e)||(e.preventDefault(),C.toggle(n.threadFromNode(this)))},cbToggleBottom(e){if(Ve.modifiedClick(e))return;e.preventDefault();const t=n.threadFromNode(this);Ve.rm(this);const{bottom:o}=t.nodes.root.getBoundingClientRect();return C.toggle(t),window.scrollBy(0,t.nodes.root.getBoundingClientRect().bottom-o)},toggle(e){if(!e.nodes.root)return;const t=Ve("a.summary",e.nodes.root);t&&(e.ID in C.statuses?C.contract(e,t,e.nodes.root):C.expand(e,t))},expand(e,t){let n;C.statuses[e]=n={},t.textContent=Ee.SITE.Build.summaryText("...",...t.textContent.match(/\d+/g)),n.req=Ve.cache(Ee.SITE.urls.threadJSON({boardID:e.board.ID,threadID:e.ID}),function(){this===n.req&&(delete n.req,C.parse(this,e,t))}),n.numReplies=Ge(Ee.SITE.selectors.replyOriginal,e.nodes.root).length},contract(e,t,o){var a,i;let s;const r=C.statuses[e];if(delete C.statuses[e],s=r.req)return delete r.req,s.abort(),void(t&&(t.textContent=Ee.SITE.Build.summaryText("+",...t.textContent.match(/\d+/g))));let l=Ge(".thread > .replyContainer",o);r.numReplies&&(l=l.slice(0,-r.numReplies));let d=0,c=0;for(a of l){if(De["Quote Inlining"])for(;i=Ve(".inlined",a);)i.click();d++,"file"in n.postFromRoot(a)&&c++,Ve.rm(a)}B.enabled&&Ve.event("PostsRemoved",null,t.parentNode),t.textContent=Ee.SITE.Build.summaryText("+",d,c),Ve.rm(Ve(".summary-bottom",o))},parse(e,t,n){var o,a;let i;if(![200,304].includes(e.status))return void(n.textContent=e.status?`Error ${e.statusText} (${e.status})`:"Connection Error");Ee.SITE.Build.spoilerRange[t.board]=e.response.posts[0].custom_spoiler;const s=[],r=[];let l=0;for(o of e.response.posts)o.no!==t.ID&&(!(a=t.posts.get(o.no))||a.isFetchedQuote?(i=Ee.SITE.Build.postFromObject(o,t.board.ID),"file"in(a=new dt(i,t,t.board))&&l++,s.push(a),r.push(i)):("file"in a&&l++,({root:i}=a.nodes),r.push(i)));ke.callbackNodes("Post",s),Ve.after(n,r),Ve.event("PostsInserted",null,n.parentNode);const d=r.length;if(n.textContent=Ee.SITE.Build.summaryText("-",d,l),i){const e=n.cloneNode(!0);e.classList.add("summary-bottom"),Ve.on(e,"click",C.cbToggleBottom),Ve.after(i,e)}}},D={lastReadPost:Fe(),hr:Fe(),markReadLink:Fe(),init(){if("index"===Ee.VIEW&&De["Remember Last Read Post"]&&De["Unread Line in Index"])return this.enabled=!0,this.db=new nt("lastReadPosts",this.sync),Ne.Thread.push({name:"Unread Line in Index",cb:this.node}),Ve.on(Te,"IndexRefreshInternal",this.onIndexRefresh),Ve.on(Te,"PostsInserted PostsRemoved",this.onPostsInserted)},node(){if(D.lastReadPost[this.fullID]=D.db.get({boardID:this.board.ID,threadID:this.ID})||0,!B.enabled)return D.update(this)},onIndexRefresh(e){if(!e.detail.isCatalog)return(()=>{var t,n;const o=[];for(t of e.detail.threadIDs)n=Ee.threads.get(t),o.push(D.update(n));return o})()},onPostsInserted(e){if(e.target===B.root)return;const t=n.threadFromNode(e.target);if(!t||t.nodes.root!==e.target)return;const o=!!D.hr[t.fullID]?.parentNode;return D.update(t),De["Scroll to Last Read Post"]&&"PostsInserted"===e.type&&!o&&D.hr[t.fullID]?.parentNode?Y.scrollToIfNeeded(D.hr[t.fullID],!0):void 0},sync:()=>Ee.threads.forEach(function(e){const t=D.db.get({boardID:e.board.ID,threadID:e.ID})||0;if(t!==D.lastReadPost[e.fullID]&&(D.lastReadPost[e.fullID]=t,e.nodes.root?.parentNode))return D.update(e)}),update(e){let t;const n=D.lastReadPost[e.fullID];let o=0,a=0,i=null;e.posts.forEach(function(t){if(t.isReply&&e.nodes.root.contains(t.nodes.root)){if(o++,t.ID<=n)return a++;if((!i||t.ID<i.ID)&&!t.isHidden&&!k.isYou(t))return i=t}});let s=D.hr[e.fullID];i&&(a||n===e.OP.ID&&(!Ve(Ee.SITE.selectors.summary,e.nodes.root)||e.ID in C.statuses))?(s||(s=D.hr[e.fullID]=Ve.el("hr",{className:"unread-line"})),Ve.before(i.nodes.root,s)):Ve.rm(s);const r=o?i||!a:B.enabled?e.lastPost>n:e.OP.ID>n;e.nodes.root.classList.toggle("unread-thread",r);let l=D.markReadLink[e.fullID];return l||(l=D.markReadLink[e.fullID]=Ve.el("a",{className:"unread-mark-read brackets-wrap",href:"javascript:;",textContent:"Mark Read"}),Ve.on(l,"click",D.markRead)),(t=Ve(Ee.SITE.selectors.threadDivider,e.nodes.root))?Ve.before(t,l):Ve.add(e.nodes.root,l)},markRead(){const e=n.threadFromNode(this);return D.lastReadPost[e.fullID]=e.lastPost,D.db.set({boardID:e.board.ID,threadID:e.ID,val:e.lastPost}),Ve.rm(D.hr[e.fullID]),e.nodes.root.classList.remove("unread-thread"),E.update(Ee.SITE.ID,e.board.ID,e.ID,{last:e.lastPost,unread:0,quotingYou:0})}},E={init(){let e;if(this.enabled=De["Thread Watcher"]){switch(this.shortcut=e=Ve.el("a",{id:"watcher-link",title:"Thread Watcher",href:"javascript:;"}),a.set(this.shortcut,"eye","Watcher"),this.db=new nt("watchedThreads",this.refresh,!0),this.dbLM=new nt("watcherLastModified",null,!0),this.dialog=rt.dialog("thread-watcher",{innerHTML:'<div class="move">\n  Thread Watcher <a class="refresh" title="Check threads" href="javascript:;" title="refresh"></a>\n  <span id="watcher-status"></span>\n  <a class="menu-button" href="javascript:;"></a>\n  <a class="close" href="javascript:;">Ã—</a>\n</div>\n<div id="watched-threads"></div>'}),this.status=Ve("#watcher-status",this.dialog),this.list=this.dialog.lastElementChild,this.refreshButton=Ve(".refresh",this.dialog),this.menuButton=Ve(".menu-button",this.dialog),this.closeButton=Ve(".move > .close",this.dialog),this.unreaddb=I.db||D.db||new nt("lastReadPosts"),this.unreadEnabled=De["Remember Last Read Post"],a.set(this.refreshButton,"refresh"),a.set(this.menuButton,"caretDown"),a.set(this.closeButton,"xmark"),Ve.on(Te,"QRPostSuccessful",this.cb.post),Ve.on(e,"click",this.toggleWatcher),Ve.on(this.refreshButton,"click",this.buttonFetchAll),Ve.on(this.closeButton,"click",this.toggleWatcher),this.menu.addHeaderMenuEntry(),Ve.onExists(Re,"body",this.addDialog),Ee.VIEW){case"index":Ve.on(Te,"IndexUpdate",this.cb.onIndexUpdate);break;case"thread":Ve.on(Te,"ThreadUpdate",this.cb.onThreadRefresh)}if(De["Fixed Thread Watcher"]&&Ve.addClass(Re,"fixed-watcher"),De["Persistent Thread Watcher"]||(Ve.addClass(E.shortcut,"disabled"),this.dialog.hidden=!0),Y.addShortcut("watcher",e,510),E.initLastModified(),E.fetchAuto(),Ve.on(window,"visibilitychange focus",()=>Ve.queueTask(E.fetchAuto)),De.Menu&&B.enabled&&A.menu.addEntry({el:Ve.el("a",{href:"javascript:;",className:"has-shortcut-text"},{innerHTML:'<span></span><span class="shortcut-text">Alt+click</span>'}),order:6,open({thread:e}){return"catalog"===De["Index Mode"]&&(this.el.firstElementChild.textContent=E.isWatched(e)?"Unwatch":"Watch",this.cb&&Ve.off(this.el,"click",this.cb),this.cb=function(){return Ve.event("CloseMenu"),E.toggle(e,!0)},Ve.on(this.el,"click",this.cb),!0)}}),["index","thread"].includes(Ee.VIEW))return Ne.Post.push({name:"Thread Watcher",cb:this.node}),Ne.CatalogThread.push({name:"Thread Watcher",cb:this.catalogNode})}},isWatched:e=>!!E.db?.get({boardID:e.board.ID,threadID:e.ID}),isWatchedRaw:(e,t)=>!!E.db?.get({boardID:e,threadID:t}),setToggler:(e,t)=>(e.classList.toggle("watched",t),e.title=(t?"Unwatch":"Watch")+" Thread"),node(){let e;if(this.isReply)return;this.isClone?e=Ve(".watch-thread-link",this.nodes.info):(e=Ve.el("button",{type:"button",className:"watch-thread-link"}),a.set(e,"heart"),Ve.before(Ve("input",this.nodes.info),e));const t=Ee.SITE.ID,o=this.board.ID,i=this.thread.ID,s=E.db.get({siteID:t,boardID:o,threadID:i});return E.setToggler(e,!!s),Ve.on(e,"click",E.cb.toggle),s&&null==s.excerpt?Ve.queueTask(()=>E.update(t,o,i,{excerpt:n.threadExcerpt(this.thread)})):void 0},catalogNode(){return E.isWatched(this.thread)&&Ve.addClass(this.nodes.root,"watched"),Ve.on(this.nodes.root,"mousedown click",e=>{if(0===e.button&&e.altKey)return"click"===e.type&&E.toggle(this.thread,!0),e.preventDefault()})},addDialog(){if(ke.isThisPageLegit())return E.build(),Ve.prepend(Te.body,E.dialog)},toggleWatcher:()=>(Ve.toggleClass(E.shortcut,"disabled"),E.dialog.hidden=!E.dialog.hidden),cb:{openAll(){if(!Ve.hasClass(this,"disabled")){for(var e of Ge("a.watcher-link",E.list))Ve.open(e.href);Ve.event("CloseMenu")}},openUnread(){if(!Ve.hasClass(this,"disabled")){for(var e of Ge(".replies-unread > a.watcher-link",E.list))Ve.open(e.href);Ve.event("CloseMenu")}},openDeads(){if(!Ve.hasClass(this,"disabled")){for(var e of Ge(".dead-thread.replies-unread > a.watcher-link",E.list))Ve.open(e.href);Ve.event("CloseMenu")}},clear(){if(!confirm("Delete ALL threads from watcher?"))return;const e=E.getAll();for(let t=0,n=e.length;t<n;t++){const{siteID:n,boardID:o,threadID:a}=e[t];E.db.delete({siteID:n,boardID:o,threadID:a})}E.refresh(!0),Ve.event("CloseMenu")},pruneDeads(){if(!Ve.hasClass(this,"disabled")){for(var{siteID:e,boardID:t,threadID:n,data:o}of E.getAll())o.isDead&&E.db.delete({siteID:e,boardID:t,threadID:n});E.refresh(!0),Ve.event("CloseMenu")}},pruneReadDeads(){if(!Ve.hasClass(this,"disabled")){for(var{siteID:e,boardID:t,threadID:n,data:o}of E.getAll())o.isDead&&!o.unread&&E.db.delete({siteID:e,boardID:t,threadID:n});E.refresh(!0),Ve.event("CloseMenu")}},dismiss(){for(var{siteID:e,boardID:t,threadID:n,data:o}of E.getAll())o.quotingYou&&E.update(e,t,n,{dismiss:o.quotingYou||0});Ve.event("CloseMenu")},toggle(){const{thread:e}=n.postFromNode(this);E.toggle(e,!0)},rm(){const{siteID:e}=this.parentNode.dataset,[t,n]=this.parentNode.dataset.fullID.split(".");E.rm(e,t,+n,void 0,!0)},post(e){const{boardID:t,threadID:n,postID:o}=e.detail,a=ut.delay();o===n?De["Auto Watch"]&&E.addRaw(t,n,{},a,!0):De["Auto Watch Reply"]&&E.add(Ee.threads.get(t+"."+n)||new at(n,Ee.boards[t]||new ht(t)),a,!0)},onIndexUpdate(e){var t,n;const{db:o}=E,a=Ee.SITE.ID,i=Ee.BOARD.ID;let s=0;for(t in o.data[a].boards[i])if(n=o.data[a].boards[i][t],!n?.isDead&&!e.detail.threads.includes(`${i}.${t}`)){if(!e.detail.threads.some(e=>+e.split(".")[1]>t))continue;De["Auto Prune"]||!n||"object"!=typeof n?(o.delete({boardID:i,threadID:t}),s++):E.fetchStatus({siteID:a,boardID:i,threadID:t,data:n})}if(s)return E.refresh()},onThreadRefresh(e){const t=Ee.threads.get(e.detail.threadID);if(e.detail[404]&&E.isWatched(t))return E.add(t)}},requests:[],fetched:0,fetch(e,{siteID:t,force:n},o,a){0===E.requests.length&&(E.status.textContent="...",Ve.addClass(E.refreshButton,"spin"));const i=t===Ee.SITE.ID?Ve.ajax:U.ajax;n&&delete Ve.lastModified.ThreadWatcher?.[e];const s=Ve.whenModified(e,"ThreadWatcher",function(){if(!this.finished)return this.finished=!0,E.fetched++,E.fetched===E.requests.length?E.clearRequests():E.status.textContent=`${Math.round(E.fetched/E.requests.length*100)}%`,a.apply(this,o)},{timeout:Oe,ajax:i});return E.requests.push(s)},clearRequests:()=>(E.requests=[],E.fetched=0,E.status.textContent="",Ve.rmClass(E.refreshButton,"spin")),abort(){for(var e of(delete E.syncing,E.requests))e.finished||(e.finished=!0,e.abort());return E.clearRequests()},initLastModified(){var e,t,n,o,a,i;const s=Ve.lastModified.ThreadWatcher||(Ve.lastModified.ThreadWatcher=Fe());for(e in E.dbLM.data)for(n in(t=E.dbLM.data[e]).boards)if(o=t.boards[n],E.db.get({siteID:e,boardID:n}))for(a in o)i=o[a],s[a]=i;else E.dbLM.delete({siteID:e,boardID:n})},fetchAuto(){let e;if(clearTimeout(E.timeout),!De["Auto Update Thread Watcher"])return;const{db:t}=E,n=De["Show Page"]||E.unreadEnabled&&De["Show Unread Count"]?3e5:2*qe,o=Date.now();return(o-n>=(e=t.data.lastChecked||0)||e>o)&&!Te.hidden&&Te.hasFocus()&&E.fetchAllStatus(n),E.timeout=setTimeout(E.fetchAuto,n)},buttonFetchAll:()=>E.syncing||E.requests.length?E.abort():E.fetchAllStatus(),fetchAllStatus(e=0){E.status.textContent="...",Ve.addClass(E.refreshButton,"spin"),E.syncing=!0;const t=[E.db,E.unreaddb,k.db].filter(e=>e);let n=0;return t.map(o=>o.forceSync(function(){if(++n===t.length){let t;if(!E.syncing)return;if(delete E.syncing,0>(t=Date.now()-(E.db.data.lastChecked||0))||t>=e){let e;const{db:t}=E,n=Date.now(),a=!(n-2*qe<(e=t.data.lastChecked2||0)&&e<=n),i=E.getAll(!0);for(var o of i)E.fetchBoard(o,a);t.setLastChecked(),a&&t.setLastChecked("lastChecked2")}if(E.fetched===E.requests.length)return E.clearRequests()}}))},fetchBoard(e,t){var n;if(!e.some(e=>!e.data.isDead))return;let o=!1;for(n of e){var{data:a}=n;a.isDead||-1===a.last||(De["Show Page"]&&null==a.page&&(o=!0),null==a.modified&&(o=n.force=!0))}const{siteID:i,boardID:s}=e[0],r=Ee.sites[i];if(!r)return;const l=t&&r.threadModTimeIgnoresSage?"catalogJSON":"threadsListJSON",d=r.urls[l]?.({siteID:i,boardID:s});return d?E.fetch(d,{siteID:i,force:o},[e,d],E.parseBoard):void 0},parseBoard(e,t){var n,o,a,i,s;let r,l;if(200!==this.status)return;const{siteID:d,boardID:c}=e[0],h=this.getResponseHeader("Last-Modified");E.dbLM.extend({siteID:d,boardID:c,val:Ve.item(t,h)});const u=Fe();let p=0,g=0,f=null;try{p=this.response[0]?.threads.length||0;for(let e=0;e<this.response.length;e++)for(n of(r=this.response[e],r.threads))u[n.no]={page:e+1,index:g,modified:n.last_modified,replies:n.replies},g++,(null==f||n.no<f)&&(f=n.no)}catch(t){for(l of e)E.fetchStatus(l)}for(l of e){var{threadID:m,data:b}=l;u[m]?(({page:r,index:o,modified:a,replies:i}=u[m]),De["Show Page"]&&(s=Ee.sites[d].isPrunedByAge?.({siteID:d,boardID:c})?m===f:o>=g-p,E.update(d,c,m,{page:r,lastPage:s})),E.unreadEnabled&&De["Show Unread Count"]&&(a!==b.modified||null!=i&&i!==b.replies)&&((l.newData||(l.newData={})).modified=a,E.fetchStatus(l))):E.fetchStatus(l)}},fetchStatus(e){const{siteID:t,boardID:n,threadID:o,data:a,force:i}=e,s=Ee.sites[t]?.urls.threadJSON?.({siteID:t,boardID:n,threadID:o});if(s&&(!a.isDead||i)&&-1!==a.last)return E.fetch(s,{siteID:t,force:i},[e],E.parseStatus)},parseStatus(e,t){var n,o,a,i;let s,r,{siteID:l,boardID:d,threadID:c,data:h,newData:u,force:p}=e;const g=Ee.sites[l];if(200===this.status&&this.response){let e;r=this.response.posts[this.response.posts.length-1].no;const p=this.response.posts.length-1;if(s=e=!(!this.response.posts[0].archived&&!t),s&&De["Auto Prune"])return void E.rm(l,d,c);if(r===h.last&&s===h.isDead&&e===h.isArchived)return;const f=E.unreaddb.get({siteID:l,boardID:d,threadID:c,defaultValue:0});let m=h.unread||0,b=h.quotingYou||0;const A=!!k.db?.get({siteID:l,boardID:d,threadID:c,postID:c});for(n of this.response.posts)if(!(n.no<=(h.last||0)||n.no<=f||k.db?.get({siteID:l,boardID:d,threadID:c,postID:n.no}))){if(o=!1,!De["Require OP Quote Link"]&&A)o=!0;else if(k.db&&n.com)for((i=g.regexp.quotelinkHTML).lastIndex=0;a=i.exec(n.com);)if(k.db.get({siteID:l,boardID:a[1]?encodeURIComponent(a[1]):d,threadID:a[2]||c,postID:a[3]||a[2]||c})){o=!0;break}(!m||!b&&o)&&J.isHidden(g.Build.parseJSON(n,{siteID:l,boardID:d}))||(m++,o&&(b=n.no))}return u||(u={}),Ve.extend(u,{last:r,replies:p,isDead:s,isArchived:e,unread:m,quotingYou:b}),E.update(l,d,c,u)}if(404===this.status){const n=Ee.sites[l]?.urls.archivedThreadJSON?.({siteID:l,boardID:d,threadID:c});return!t&&n?E.fetch(n,{siteID:l,force:p},[e,!0],E.parseStatus):g.mayLackJSON&&null==h.last?E.update(l,d,c,{last:-1}):E.update(l,d,c,{isDead:!0})}},getAll(e){var t,n,o,a,i,s,r;const l=[];for(t in E.db.data)for(o in(n=E.db.data[t]).boards)if(i=n.boards[o],!De["Current Board"]||t===Ee.SITE.ID&&o===Ee.BOARD.ID)for(s in e&&l.push(a=[]),i)(r=i[s])&&"object"==typeof r&&(e?a:l).push({siteID:t,boardID:o,threadID:s,data:r});return l},makeLine(e,t,n,o){let i;const s=Ve.el("a",{textContent:"âœ•",href:"javascript:;"});a.set(s,"xmark"),Ve.on(s,"click",E.cb.rm);let{excerpt:r,isArchived:l}=o;r||(r=`/${t}/ - No.${n}`),De["Show Site Prefix"]&&(r=E.prefixes[e]+r);const d=Ve.el("a",{href:Ee.sites[e]?.urls.thread({siteID:e,boardID:t,threadID:n},l)||"",title:r,className:"watcher-link"});if(De["Show Page"]&&null!=o.page&&(i=Ve.el("span",{textContent:`[${o.page}]`,className:"watcher-page"}),Ve.add(d,i)),E.unreadEnabled&&De["Show Unread Count"]&&null!=o.unread){const e=Ve.el("span",{textContent:`(${o.unread})`,className:"watcher-unread"});Ve.add(d,e)}const c=Ve.el("span",{textContent:r,className:"watcher-title"});Ve.add(d,c);const h=Ve.el("div"),u=`${t}.${n}`;return h.dataset.fullID=u,h.dataset.siteID=e,"thread"===Ee.VIEW&&u===`${Ee.BOARD}.${Ee.THREADID}`&&Ve.addClass(h,"current"),o.isDead&&Ve.addClass(h,"dead-thread"),De["Show Page"]&&(o.lastPage&&Ve.addClass(h,"last-page"),null!=o.page&&(h.dataset.page=o.page)),E.unreadEnabled&&De["Show Unread Count"]&&(0===o.unread&&Ve.addClass(h,"replies-read"),o.unread&&Ve.addClass(h,"replies-unread"),(o.quotingYou||0)>(o.dismiss||0)&&Ve.addClass(h,"replies-quoting-you")),Ve.add(h,[s,Ve.tn(" "),d]),h},setPrefixes(e){var t,n,o,a,i;const s=Fe();for(var{siteID:r}of e)if(!(r in s)){for(t=0,n="",o=Object.keys(s);o.length>0;){for(i of(t++,n=r.slice(0,t),a=[],o))i.slice(0,t)===n?a.push(i):s[i].length<t&&(s[i]=i.slice(0,t));o=a}s[r]=n}return E.prefixes=s},build(){var e;const t=[],o=E.getAll();for(var{siteID:a,boardID:i,threadID:s,data:r}of(E.setPrefixes(o),o))null==r.excerpt&&a===Ee.SITE.ID&&(e=Ee.threads.get(`${i}.${s}`))&&e.OP&&E.db.extend({boardID:i,threadID:s,val:{excerpt:n.threadExcerpt(e)}}),t.push(E.makeLine(a,i,s,r));const{list:l}=E;return Ve.rmAll(l),Ve.add(l,t),E.refreshIcon()},refresh(e){if(E.build(),Ee.threads.forEach(function(e){var t,n;const o=E.isWatched(e);if(e.OP)for(t of[e.OP,...e.OP.clones])(n=Ve(".watch-thread-link",t.nodes.info))&&E.setToggler(n,o);if(e.catalogView)return e.catalogView.nodes.root.classList.toggle("watched",o)}),De["Pin Watched Threads"])return Ve.event("SortIndex",{deferred:!(e&&"catalog"===De["Index Mode"])})},refreshIcon(){for(var e of["replies-unread","replies-quoting-you"])E.shortcut.classList.toggle(e,!!Ve(`.${e}`,E.dialog))},update(e,t,n,o){let a,i,s,r;if(!(a=E.db?.get({siteID:e,boardID:t,threadID:n})))return;if(o.isDead&&De["Auto Prune"])return void E.rm(e,t,n);if(o.isDead||-1===o.last)for(i of["isArchived","page","lastPage","unread","quotingyou"])i in o||(o[i]=void 0);null!=o.last&&o.last<a.last&&(o.modified=void 0);let l=0;for(i in o)r=o[i],a[i]!==r&&l++;if(l){if(E.db.extend({siteID:e,boardID:t,threadID:n,val:o}),s=Ve(`#watched-threads > [data-site-i-d='${e}'][data-full-i-d='${t}.${n}']`,E.dialog)){const o=E.makeLine(e,t,n,a);return Ve.replace(s,o),E.refreshIcon()}return E.refresh()}},set404(e,t,n){let o;return(o=E.db?.get({boardID:e,threadID:t}))?De["Auto Prune"]?(E.db.delete({boardID:e,threadID:t}),n()):o.isDead&&null==o.isArchived&&null==o.page&&null==o.lastPage&&null==o.unread&&null==o.quotingYou?n():E.db.extend({boardID:e,threadID:t,val:{isDead:!0,isArchived:void 0,page:void 0,lastPage:void 0,unread:void 0,quotingYou:void 0}},n):n()},toggle(e,t){const n=Ee.SITE.ID,o=e.board.ID,a=e.ID;return E.db.get({boardID:o,threadID:a})?E.rm(n,o,a,void 0,t):E.add(e,void 0,t)},add(e,t,o){const a={},i=Ee.SITE.ID,s=e.board.ID,r=e.ID;if(e.isDead){if(De["Auto Prune"]&&E.db.get({boardID:s,threadID:r}))return void E.rm(i,s,r,t);a.isDead=!0}return e.OP&&(a.excerpt=n.threadExcerpt(e)),E.addRaw(s,r,a,t,o)},addRaw(e,t,n,o,a){const i=E.db.get({boardID:e,threadID:t,defaultValue:Fe()});delete i.last,delete i.modified,Ve.extend(i,n),E.db.set({boardID:e,threadID:t,val:i},o),E.refresh(a);const s={siteID:Ee.SITE.ID,boardID:e,threadID:t,data:n,force:!0};return De["Show Page"]&&!n.isDead?E.fetchBoard([s]):E.unreadEnabled&&De["Show Unread Count"]?E.fetchStatus(s):void 0},rm:(e,t,n,o,a)=>(E.db.delete({siteID:e,boardID:t,threadID:n},o),E.refresh(a)),menu:{init(){if(!De["Thread Watcher"])return;const e=this.menu=new rt.Menu("thread watcher");return Ve.on(Ve(".menu-button",E.dialog),"click",function(t){return e.toggle(t,this,E)}),this.addMenuEntries()},addHeaderMenuEntry(){if("thread"!==Ee.VIEW)return;const e=Ve.el("a",{href:"javascript:;"});return Y.menu.addEntry({el:e,order:60,open(){const[t,n,o]=E.db.get({boardID:Ee.BOARD.ID,threadID:Ee.THREADID})?["unwatch-thread","watch-thread","Unwatch thread"]:["watch-thread","unwatch-thread","Watch thread"];return Ve.addClass(e,t),Ve.rmClass(e,n),e.textContent=o,!0}}),Ve.on(e,"click",()=>E.toggle(Ee.threads.get(`${Ee.BOARD}.${Ee.THREADID}`),!0))},addMenuEntries(){var e,t,n;const o=function(){return this.el.classList.toggle("disabled",!Ve(".dead-thread",E.list)),!0},a=[{text:"Open all threads",cb:E.cb.openAll,open(){return this.el.classList.toggle("disabled",!E.list.firstElementChild),!0}},{text:"Clear all threads",cb:E.cb.clear,open(){return this.el.classList.toggle("disabled",!E.list.firstElementChild),!0}},{text:"Open unread threads",cb:E.cb.openUnread,open(){return this.el.classList.toggle("disabled",!Ve(".replies-unread",E.list)),!0}},{text:"Open unread dead threads",cb:E.cb.openDeads,open:o},{text:"Prune all dead threads",cb:E.cb.pruneDeads,open:o},{text:"Prune read dead threads",cb:E.cb.pruneReadDeads,open:o},{text:"Dismiss posts quoting you",title:"Unhighlight the thread watcher icon and threads until there are new replies quoting you.",cb:E.cb.dismiss,open(){return this.el.classList.toggle("disabled",!Ve.hasClass(E.shortcut,"replies-quoting-you")),!0}}];for(var{text:i,title:s,cb:r,open:l}of a)e={el:Ve.el("a",{textContent:i,href:"javascript:;"})},s&&(e.el.title=s),Ve.on(e.el,"click",r),e.open=l.bind(e),this.menu.addEntry(e);for(t in Me.threadWatcher)n=Me.threadWatcher[t],this.addCheckbox(t,n[1])},addCheckbox(e,t){const n={type:"thread watcher",el:rt.checkbox(e,e.replace(" Thread Watcher",""))};n.el.title=t;const o=n.el.firstElementChild;return"Show Unread Count"!==e||E.unreadEnabled||(o.disabled=!0,Ve.addClass(n.el,"disabled"),n.el.title+="\n[Remember Last Read Post is disabled.]"),Ve.on(o,"change",Ve.cb.checked),["Current Board","Show Page","Show Unread Count","Show Site Prefix"].includes(e)&&Ve.on(o,"change",()=>E.refresh()),["Show Page","Show Unread Count","Auto Update Thread Watcher"].includes(e)&&Ve.on(o,"change",E.fetchAuto),this.menu.addEntry(n)}}},S={init(){if("thread"!==Ee.VIEW||!De["Reply Pruning"])return;this.container=Ve.frag(),this.summary=Ve.el("span",{hidden:!0,className:"summary"}),this.summary.style.cursor="pointer",Ve.on(this.summary,"click",()=>(this.inputs.enabled.checked=!this.inputs.enabled.checked,Ve.event("change",null,this.inputs.enabled)));const e=rt.checkbox("Prune Replies","Show Last",De["Prune All Threads"]),t=Ve.el("span",{title:"Maximum number of replies to show."},{innerHTML:' <input type="number" name="Max Replies" min="0" step="1" value="'+Se(De["Max Replies"])+'" class="field">'});return Ve.prepend(t,e),this.inputs={enabled:e.firstElementChild,replies:t.lastElementChild},this.setEnabled.call(this.inputs.enabled),Ve.on(this.inputs.enabled,"change",this.setEnabled),Ve.on(this.inputs.replies,"change",Ve.cb.value),Y.menu.addEntry({el:t,order:190}),Ne.Thread.push({name:"Reply Pruning",cb:this.node})},position:0,hidden:0,hiddenFiles:0,total:0,totalFiles:0,setEnabled(){const e=T.input;return this.checked&&e?.checked&&(e.checked=!1,Ve.event("change",null,e)),S.active=this.checked},showIfHidden(e){if(S.container&&Ve(`#${e}`,S.container))return S.inputs.enabled.checked=!1,Ve.event("change",null,S.inputs.enabled)},node(){let e;return S.thread=this,this.isSticky&&(S.active=S.inputs.enabled.checked=!0,T.input&&(De["Thread Quotes"]=T.input.checked=!1)),this.posts.forEach(function(e){if(e.isReply&&(S.total++,e.file))return S.totalFiles++}),S.active&&/^#p\d+$/.test(location.hash)&&1<=(e=this.posts.keys.indexOf(location.hash.slice(2)))&&e<1+Math.max(S.total-+De["Max Replies"],0)&&(S.active=S.inputs.enabled.checked=!1),Ve.after(this.OP.nodes.root,S.summary),Ve.on(S.inputs.enabled,"change",S.update),Ve.on(S.inputs.replies,"change",S.update),Ve.on(Te,"ThreadUpdate",S.updateCount),Ve.on(Te,"ThreadUpdate",S.update),S.update()},updateCount(e){if(!e.detail[404])for(var t of e.detail.newPosts)S.total++,Ee.posts.get(t).file&&S.totalFiles++},update(){let e,t,n;const o=S.hidden,a=S.active?Math.max(S.total-+De["Max Replies"],0):0,i=Te.body.clientHeight-window.scrollY,{posts:s}=S.thread;if(S.hidden<a){for(;S.hidden<a&&S.position<s.keys.length;)if(n=s.get(s.keys[S.position++]),n.isReply&&!n.isFetchedQuote){for(;(t=S.summary.nextSibling)&&t!==n.nodes.root;)Ve.add(S.container,t);Ve.add(S.container,n.nodes.root),S.hidden++,n.file&&S.hiddenFiles++}}else if(S.hidden>a){const e=Ve.frag();for(;S.hidden>a&&S.position>0;)if(n=s.get(s.keys[--S.position]),n.isReply&&!n.isFetchedQuote){for(;(t=S.container.lastChild)&&t!==n.nodes.root;)Ve.prepend(e,t);Ve.prepend(e,n.nodes.root),S.hidden--,n.file&&S.hiddenFiles--}Ve.after(S.summary,e),Ve.event("PostsInserted",null,S.summary.parentNode)}if(S.summary.textContent=S.active?Ee.SITE.Build.summaryText("+",S.hidden,S.hiddenFiles):Ee.SITE.Build.summaryText("-",S.total,S.totalFiles),S.summary.hidden=S.total<=+De["Max Replies"],o!==a&&(e=Y.getTopOf(Ve(".board")))<0)return window.scrollBy(0,Math.max(Te.body.clientHeight-i,window.scrollY+e)-window.scrollY)}},T={init(){De["Quote Threading"]&&"thread"===Ee.VIEW&&(this.controls=Ve.el("label",{innerHTML:'<input id="threadingControl" name="Thread Quotes" type="checkbox"> Threading'}),this.threadNewLink=Ve.el("span",{className:"brackets-wrap threadnewlink",hidden:!0}),Ve.extend(this.threadNewLink,{innerHTML:'<a href="javascript:;">Thread New Posts</a>'}),this.input=Ve("input",this.controls),this.input.checked=De["Thread Quotes"],Ve.on(this.input,"change",this.setEnabled),Ve.on(this.input,"change",this.rethread),Ve.on(this.threadNewLink.firstElementChild,"click",this.rethread),Ve.on(Te,"4chanXInitFinished",()=>{this.ready=!0}),Y.menu.addEntry(this.entry={el:this.controls,order:99}),Ne.Thread.push({name:"Quote Threading",cb:this.setThread}),Ne.Post.push({name:"Quote Threading",cb:this.node}))},parent:Fe(),children:Fe(),inserted:Fe(),toggleThreading(){this.setThreadingState(!De["Thread Quotes"])},setThreadingState(e){this.input.checked=e,this.setEnabled.call(this.input),this.rethread.call(this.input)},setEnabled(){if(this.checked){Ve.set("Prune All Threads",!1);const e=S.inputs?.enabled;e?.checked&&(e.checked=!1,Ve.event("change",null,e))}Ve.cb.checked.call(this)},setThread(){T.thread=this,Ve.asap(()=>!De["Thread Updater"]||Ve(".navLinksBot > .updatelink"),function(){let e;(e=Ve(".navLinksBot"))&&Ve.add(e,[Ve.tn(" "),T.threadNewLink])})},node(){let e;if(this.isFetchedQuote||this.isClone||!this.isReply)return;const t=new Set;let n=null;for(var o of this.quotes)(e=Ee.posts.get(o))&&!e.isFetchedQuote&&e.isReply&&e.ID<this.ID&&(t.add(e.ID),(!n||e.ID>n.ID)&&(n=e));if(!n)return;let a=n;for(;a=T.parent[a.fullID];)t.delete(a.ID);1===t.size&&(T.parent[this.fullID]=n)},descendants(e){let t,n=[e];if(t=T.children[e.fullID])for(var o of t)n=n.concat(T.descendants(o));return n},insert(e){let t,n;if(!De["Thread Quotes"]||!(t=T.parent[e.fullID])||T.inserted[e.fullID])return!1;const o=T.descendants(e);if(!I.posts.has(t.ID)&&function(){for(var e of o)if(I.posts.has(e.ID))return!0}())return T.threadNewLink.hidden=!1,!1;const{order:a}=I,i=T.children[t.fullID]||(T.children[t.fullID]=[]),s=t.nodes.threadContainer||Ve.el("div",{className:"threadContainer"}),r=[e.nodes.root];e.nodes.threadContainer&&r.push(e.nodes.threadContainer);let l=i.length;for(let t=i.length-1;t>=0;t--)i[t].ID>=e.ID&&l--;if(l!==i.length){const t=i[l];for(n of o)a.before(a[t.ID],a[n.ID]);i.splice(l,0,e),Ve.before(t.nodes.root,r)}else{let l,d=t;for(;(l=T.children[d.fullID])&&l.length;)d=l[l.length-1];for(let e=o.length-1;e>=0;e--)n=o[e],a.after(a[d.ID],a[n.ID]);i.push(e),Ve.add(s,r)}return T.inserted[e.fullID]=!0,t.nodes.threadContainer||(t.nodes.threadContainer=s,Ve.addClass(t.nodes.root,"threadOP"),Ve.after(t.nodes.root,s)),!0},rethread(){if(!T.ready)return;const{thread:e}=T,{posts:t}=e;if(T.threadNewLink.hidden=!0,De["Thread Quotes"])t.forEach(T.insert);else{const n=[];I.order=new gt,T.inserted=Fe(),t.forEach(function(e){e.isFetchedQuote||(I.order.push(e),e.isReply&&n.push(e.nodes.root),T.children[e.fullID]&&(delete T.children[e.fullID],Ve.rmClass(e.nodes.root,"threadOP"),Ve.rm(e.nodes.threadContainer),delete e.nodes.threadContainer))}),Ve.add(e.nodes.root,n)}I.position=I.order.first,I.updatePosition(),I.setLine(!0),I.read(),I.update()}};const ft={restore(){const e=K.to("threadJSON",{boardID:Ee.boardID,threadID:Ee.threadID});e?(e.startsWith("https://")||De["Exempt Archives from Encryption"])&&U.ajax(e,{onloadend(){if(this.status<200||this.status>=400){const t=Se(new URL(e).origin);return new It("error",Ve.el("div",{innerHTML:`There was an error while fetching from the archive. See the console for details.<br />Some archive check the browser first before checking content, you might need to open the archive first to get past the browser check: <a href="${t}" target="_blank">${t}</a><br />If that doesn't work, try a different archive under Settings > Advanced > Archives > Thread fetching.`})),void console.error(this)}let t=0;const n=this.response[Ee.threadID.toString()].posts;for(const[e,o]of Object.entries(n))ft.insert(o)[1]&&++t;let o;o=0===t?"No removed posts found":1===t?"1 post restored":`${t} posts restored`,new It("info",o,3)}}):new It("warning","No archive found",3)},init(){if("thread"!==Ee.VIEW)return;const e=Ve.el("a",{href:"javascript:;",textContent:"Restore from archive"});Ve.on(e,"click",()=>{ft.restore(),Y.menu.close()}),Y.menu.addEntry({el:e,order:10})},insert(e){const t=`${e.board.shortname}.${e.num}`;if(Ee.posts.keys.includes(t))return[void 0,!1];let a=!1;const i=(e=>{let t=(e.comment||"").split(/(\n|\[\/?(?:b|spoiler|code|moot|banned|fortune(?: color="#\w+")?|i|red|green|blue)\])/);t=t.map((e,t)=>{var n,o;return t%2==1?"function"==typeof(n=mt.archiveTags[e.replace(/\ .*\]/,"]")])?n(e):n:(o=">"===e[0],e=e.replace(/(\[\/?[a-z]+):lit(\])/g,"$1$2").split(/(>>(?:>\/[a-z\d]+\/)?\d+)/g).map((e,t)=>t%2?`<span class="deadlink">${Se(e)}</span>`:Se(e)).join(""),{innerHTML:o?`<span class="quote">${e}</span>`:e})}),t={innerHTML:Se.cat(t),[Qe]:!0};const n={ID:e.num,threadID:e.thread_num,boardID:e.board.shortname,isReply:e.num!==e.thread_num,fileDeleted:!1,info:{subject:e.title,email:e.email,name:e.name||"",tripcode:e.trip,capcode:(()=>{switch(e.capcode){case"M":return"Mod";case"A":return"Admin";case"D":return"Developer";case"V":return"Verified";case"F":return"Founder";case"G":return"Manager"}})(),uniqueID:e.poster_hash,flagCode:e.poster_country,flagCodeTroll:e.troll_country_code,flag:e.poster_country_name||e.troll_country_name,dateUTC:e.timestamp,dateText:e.fourchan_date,commentHTML:t},file:null,extra:null};if(n.info.capcode&&delete n.info.uniqueID,e.media&&+e.media.banned)n.fileDeleted=!0;else if(e.media?.media_filename){let{thumb_link:t}=e.media;"/"===t?.[0]&&(t=url.split("/",3).join("/")+t),K.securityCheck(t)||(t="");let a=K.to("file",{boardID:n.boardID,filename:e.media.media_orig});K.securityCheck(a)||(a=""),n.file={name:e.media.media_filename,url:a||("f"===n.boardID?`${location.protocol}//${o.flashHost()}/${n.boardID}/${encodeURIComponent(Se(e.media.media_filename))}`:`${location.protocol}//${o.host()}/${n.boardID}/${e.media.media_orig}`),height:e.media.media_h,width:e.media.media_w,MD5:e.media.media_hash,size:Ve.bytesToString(e.media.media_size),thumbURL:t||`${location.protocol}//${o.thumbHost()}/${n.boardID}/${e.media.preview_orig}`,theight:e.media.preview_h,twidth:e.media.preview_w,isSpoiler:"1"===e.media.spoiler},/\.pdf$/.test(n.file.url)||(n.file.dimensions=`${n.file.width}x${n.file.height}`),"f"===n.boardID&&e.media.exif&&(n.file.tag=JSON.parse(e.media.exif).Tag)}n.extra=Fe();const a=Ee.boards[n.boardID]||new ht(n.boardID),i=Ee.threads.get(`${n.boardID}.${n.threadID}`)||new at(n.threadID,a),s=new dt(Ee.SITE.Build.post(n),i,a);return s.resurrect(),s.markAsFromArchive(),s.file&&(s.file.thumbURL=n.file.thumbURL),ke.callbackNodes("Post",[s]),s})(e);if(i.resurrect(),i.markAsFromArchive(),i.threadID===Ee.threadID&&"thread"===Ee.VIEW){const e=Ee.posts.insert(t,i,e=>+e.split(".")[1]<i.ID);De["Thread Quotes"]?i.thread.nodes.root.insertAdjacentElement("beforeend",i.root):Ee.posts.get(Ee.posts.keys[e-1]).root.insertAdjacentElement("afterend",i.root),T.insert(i),a=!0;for(const e of n.allQuotelinksLinkingTo(i))e.href=`#p${i.ID}`}return[i,a]}};class mt{constructor(e,t,n,o,a){let i,s;if(this.boardID=e,this.threadID=t,this.postID=n,this.root=o,this.quoter=a,i=Ee.posts.get(`${this.boardID}.${this.postID}`))this.insert(i);else{if((i=B.replyData?.[`${this.boardID}.${this.postID}`])&&(s=Ee.threads.get(`${this.boardID}.${this.threadID}`))){const e=Ee.boards[this.boardID];return i=new dt(Ee.SITE.Build.postFromObject(i,this.boardID),s,e,{isFetchedQuote:!0}),ke.callbackNodes("Post",[i]),void this.insert(i)}if(this.root.textContent=`Loading post No.${this.postID}...`,this.threadID){const e=this;Ve.cache(Ee.SITE.urls.threadJSON({boardID:this.boardID,threadID:this.threadID}),function({isCached:t}){return e.fetchedPost(this,t)})}else this.archivedPost()}}insert(e){var t;if(!this.root.parentNode)return;this.quoter||(this.quoter=e);const o=e.addClone(this.quoter.context,Ve.hasClass(this.root,"dialog"));ke.callbackNodes("Post",[o]);const{nodes:a}=o;Ve.rmAll(a.root),Ve.add(a.root,a.post);const i=[...o.nodes.quotelinks,...o.nodes.backlinks];for(t of i){var{boardID:s,postID:r}=n.postDataFromLink(t);r===this.quoter.ID&&s===this.quoter.board.ID&&Ve.addClass(t,"forwardlink")}if(o.nodes.flag&&!mt.flagCSS&&!(mt.flagCSS=Ve('link[href^="//s.4cdn.org/css/flags."]'))){const e=Ve('link[href^="//s.4cdn.org/css/"]')?.href.match(/\d+(?=\.css$)|$/)[0]||Date.now();mt.flagCSS=Ve.el("link",{rel:"stylesheet",href:`//s.4cdn.org/css/flags.${e}.css`}),Ve.add(Te.head,mt.flagCSS)}return Ve.rmAll(this.root),Ve.add(this.root,a.root),Ve.event("PostsInserted",null,this.root)}fetchedPost(e,t){let n;if(n=Ee.posts.get(`${this.boardID}.${this.postID}`))return void this.insert(n);const{status:o}=e;if(200!==o){if(o&&this.archivedPost())return;return Ve.addClass(this.root,"warning"),void(this.root.textContent=404===o?`Thread No.${this.threadID} 404'd.`:o?`Error ${e.statusText} (${e.status}).`:"Connection Error")}const{posts:a}=e.response;for(n of(Ee.SITE.Build.spoilerRange[this.boardID]=a[0].custom_spoiler,a))if(n.no===this.postID)break;if(n.no!==this.postID){if(t){const e=Ee.SITE.urls.threadJSON({boardID:this.boardID,threadID:this.threadID});Ve.cleanCache(t=>t===e);const t=this;return void Ve.cache(e,function(){return t.fetchedPost(this,!1)})}if(this.archivedPost())return;return Ve.addClass(this.root,"warning"),void(this.root.textContent=`Post No.${this.postID} was not found.`)}const i=Ee.boards[this.boardID]||new ht(this.boardID),s=Ee.threads.get(`${this.boardID}.${this.threadID}`)||new at(this.threadID,i);return n=new dt(Ee.SITE.Build.postFromObject(n,this.boardID),s,i,{isFetchedQuote:!0}),ke.callbackNodes("Post",[n]),this.insert(n)}archivedPost(){let e;if(!De["Resurrect Quotes"])return!1;if(!(e=K.to("post",{boardID:this.boardID,postID:this.postID})))return!1;const t=K.data.post[this.boardID],n=/^https:\/\//.test(e)||"http:"===location.protocol;if(n||De["Exempt Archives from Encryption"]){const o=this;return U.cache(e,function(){if(!n&&this.response?.media){const{media:e}=this.response;for(var a in e)/_link$/.test(a)&&(Ve.getOwn(e,a)?.match(/^http:\/\//)||delete e[a])}return o.parseArchivedPost(this.response,e,t)}),!0}return!1}parseArchivedPost(e,t,n){let o;if(!(o=Ee.posts.get(`${this.boardID}.${this.postID}`)))return null==e?(Ve.addClass(this.root,"warning"),void(this.root.textContent=`Error fetching Post No.${this.postID} from ${n.name}.`)):e.error?(Ve.addClass(this.root,"warning"),void(this.root.textContent=e.error)):this.insert(ft.insert(e)[0]);this.insert(o)}}mt.archiveTags={"\n":{innerHTML:"<br>"},"[b]":{innerHTML:"<b>"},"[/b]":{innerHTML:"</b>"},"[spoiler]":{innerHTML:"<s>"},"[/spoiler]":{innerHTML:"</s>"},"[code]":{innerHTML:'<pre class="prettyprint">'},"[/code]":{innerHTML:"</pre>"},"[moot]":{innerHTML:'<div style="padding:5px;margin-left:.5em;border-color:#faa;border:2px dashed rgba(255,0,0,.1);border-radius:2px">'},"[/moot]":{innerHTML:"</div>"},"[banned]":{innerHTML:'<strong style="color: red;">'},"[/banned]":{innerHTML:"</strong>"},"[fortune]":e=>({innerHTML:'<span class="fortune" style="color:'+Se(e.match(/#\w+|$/)[0])+'"><b>'}),"[/fortune]":{innerHTML:"</b></span>"},"[i]":{innerHTML:'<span class="mu-i">'},"[/i]":{innerHTML:"</span>"},"[red]":{innerHTML:'<span class="mu-r">'},"[/red]":{innerHTML:"</span>"},"[green]":{innerHTML:'<span class="mu-g">'},"[/green]":{innerHTML:"</span>"},"[blue]":{innerHTML:'<span class="mu-b">'},"[/blue]":{innerHTML:"</span>"}},R={init(){if(De["Quote Previewing"]&&("archive"===Ee.VIEW&&Ve.on(Te,"mouseover",function(e){if("A"===e.target.nodeName&&Ve.hasClass(e.target,"quotelink"))return R.mouseover.call(e.target,e)}),["index","thread"].includes(Ee.VIEW)))return De["Comment Expansion"]&&y.callbacks.push(this.node),Ne.Post.push({name:"Quote Previewing",cb:this.node})},node(){for(var e of this.nodes.quotelinks.concat([...this.nodes.backlinks],this.nodes.archivelinks))Ve.on(e,"mouseover",R.mouseover)},mouseover(e){let t;if(Ve.hasClass(this,"inlined")&&!Ve.hasClass(Re,"catalog-mode")||!Te.contains(this))return;const{boardID:o,threadID:a,postID:i}=n.postDataFromLink(this),s=Ve.el("div",{id:"qp",className:"dialog"});if(Ve.add(Y.hover,s),new mt(o,a,i,s,n.postFromNode(this)),rt.hover({root:this,el:s,latestEvent:e,endEvents:"mouseout click",cb:R.mouseout}),De["Quote Highlighting"]&&(t=Ee.posts.get(`${o}.${i}`))){const e=[t].concat(t.clones);for(var r of(e.pop(),e))Ve.addClass(r.nodes.post,"qphl")}},mouseout(){let e;if(!(e=this.el.firstElementChild))return;Ve.event("PostsRemoved",null,Y.hover);let t=n.postFromRoot(e).origin;if(t.rmClone(e.dataset.clone),De["Quote Highlighting"])for(t of[t].concat(t.clones))Ve.rmClass(t.nodes.post,"qphl")}},B={showHiddenThreads:!1,changed:{},enabledOn:({siteID:e,boardID:t})=>De["JSON Index"]&&"yotsuba"===Ee.sites[e].software&&"f"!==t,init(){var e,t,n,o;let i,s,r;if("index"!==Ee.VIEW)return;if(Ve.one(Te,"4chanXInitFinished",this.cb.initFinished),Ve.on(Te,"PostsInserted",this.cb.postsInserted),!this.enabledOn(Ee.BOARD))return;this.enabled=!0,Ne.Post.push({name:"Index Page Numbers",cb:this.node}),Ne.CatalogThread.push({name:"Catalog Features",cb:this.catalogNode}),this.search=history.state?.searched||"",history.state?.mode&&(De["Index Mode"]=history.state?.mode),this.currentSort=history.state?.sort,this.currentSort||(this.currentSort="object"==typeof De["Index Sort"]?De["Index Sort"][Ee.BOARD.ID]||"bump":De["Index Sort"]),this.currentPage=this.getCurrentPage(),this.processHash(),Ve.addClass(Re,"index-loading",`${De["Index Mode"].replace(/\ /g,"-")}-mode`),Ve.on(window,"popstate",this.cb.popstate),Ve.on(Te,"scroll",this.scroll),Ve.on(Te,"SortIndex",this.cb.resort),this.button=Ve.el("a",{title:"Refresh",href:"javascript:;"}),a.set(this.button,"refresh","Refresh"),Ve.on(this.button,"click",()=>B.update()),Y.addShortcut("index-refresh",this.button,590);const l=[];for(r in this.inputs=s=Fe(),Me.Index)(e=Me.Index[r])instanceof Array&&((t=rt.checkbox(r,`${r[0]}${r.slice(1).toLowerCase()}`)).title=e[1],l.push({el:t}),i=t.firstChild,Ve.on(i,"change",Ve.cb.checked),s[r]=i);Ve.on(s["Show Replies"],"change",this.cb.replies),Ve.on(s["Catalog Hover Expand"],"change",this.cb.hover),Ve.on(s["Pin Watched Threads"],"change",this.cb.resort),Ve.on(s["Anchor Hidden Threads"],"change",this.cb.resort);const d=function(e){if(i=Ve.getOwn(s,e.target.name))return i.checked=e.target.checked,Ve.event("change",null,i)};Ve.on(Te,"OpenSettings",()=>Ve.on(Ve.id("fourchanx-settings"),"change",d));const c=rt.checkbox("Per-Board Sort Type","Per-board sort type","object"==typeof De["Index Sort"]);for(n of(c.title="Set the sorting order of each board independently.",Ve.on(c.firstChild,"change",this.cb.perBoardSort),l.splice(3,0,{el:c}),Y.menu.addEntry({el:Ve.el("span",{textContent:"Index Navigation"}),order:100,subEntries:l}),this.navLinks=Ve.el("div",{className:"navLinks json-index"}),Ve.extend(this.navLinks,{innerHTML:'<span class="brackets-wrap indexlink"><a href="#index">Index</a></span> \n<span class="brackets-wrap cataloglink"><a href="#catalog">Catalog</a></span> \n<span class="brackets-wrap archlistlink"><a href="./archive">Archive</a></span> \n<span class="brackets-wrap bottomlink"><a href="#bottom">Bottom</a></span> \n<span class="brackets-wrap" id="index-last-refresh"><a href="javascript:;"><time title="Last index refresh">...</time></a></span> \n<input type="search" id="index-search" class="field" placeholder="Search">\n<a id="index-search-clear" href="javascript:;" title="Clear search">Ã—</a>\n<span id="hidden-label" hidden> &mdash; <span id="hidden-count"></span> <span id="hidden-toggle">[<a href="javascript:;">Show</a>]</span></span>\n<span id="index-options">\n  <input type="checkbox" id="index-rev" name="Reverse Sort" title="Reverse sort order">\n  <span id="lastlong-options" hidden>\n    <input type="text" title="Minimum letter count (without image)">\n    <input type="text" title="Minimum letter count (with image)">\n  </span>\n  <select id="index-sort" name="Index Sort">\n    <option disabled>Index Sort</option>\n    <option value="bump">Bump order</option>\n    <option value="lastreply">Last reply</option>\n    <option value="lastlong">Last long reply</option>\n    <option value="birth">Creation date</option>\n    <option value="replycount">Reply count</option>\n    <option value="filecount">File count</option>\n    <option value="activity">Posts per minute</option>\n  </select>\n  <select id="index-size" name="Index Size">\n    <option disabled>Image Size</option>\n    <option value="small">Small</option>\n    <option value="large">Large</option>\n  </select>\n  <select id="index-mode" name="Index Mode">\n    <option disabled>Index Mode</option>\n    <option value="paged">Paged</option>\n    <option value="infinite">Infinite scrolling</option>\n    <option value="all pages">All threads</option>\n    <option value="catalog">Catalog</option>\n  </select>\n</span>'}),Ve(".cataloglink a",this.navLinks).href=G.catalog(),b.isArchived(Ee.BOARD.ID)||(Ve(".archlistlink",this.navLinks).hidden=!0),Ve.on(Ve("#index-last-refresh a",this.navLinks),"click",this.cb.refreshFront),this.searchInput=Ve("#index-search",this.navLinks),this.setupSearch(),Ve.on(this.searchInput,"input",this.onSearchInput),Ve.on(Ve("#index-search-clear",this.navLinks),"click",this.clearSearch),a.set(Ve("#index-search-clear",this.navLinks),"xmark"),this.hideLabel=Ve("#hidden-label",this.navLinks),Ve.on(Ve("#hidden-toggle a",this.navLinks),"click",this.cb.toggleHiddenThreads),this.selectRev=Ve("#index-rev",this.navLinks),this.selectMode=Ve("#index-mode",this.navLinks),this.selectSort=Ve("#index-sort",this.navLinks),this.selectSize=Ve("#index-size",this.navLinks),Ve.on(this.selectRev,"change",this.cb.sort),Ve.on(this.selectMode,"change",this.cb.mode),Ve.on(this.selectSort,"change",this.cb.sort),Ve.on(this.selectSize,"change",Ve.cb.value),Ve.on(this.selectSize,"change",this.cb.size),[this.selectMode,this.selectSize]))n.value=De[n.name];this.selectRev.checked=/-rev$/.test(B.currentSort),this.selectSort.value=B.currentSort.replace(/-rev$/,""),this.lastLongOptions=Ve("#lastlong-options",this.navLinks),this.lastLongInputs=Ge("input",this.lastLongOptions),this.lastLongThresholds=[0,0],this.lastLongOptions.hidden="lastlong"!==this.selectSort.value;for(let e=0;e<this.lastLongInputs.length;e++)i=this.lastLongInputs[e],Ve.on(i,"change",this.cb.lastLongThresholds),o=De[`Last Long Reply Thresholds ${e}`],i.value=this.lastLongThresholds[e]="object"==typeof o?o[Ee.BOARD.ID]??100:o;return this.root=Ve.el("div",{className:"board json-index"}),Ve.on(this.root,"click",this.cb.hoverToggle),this.cb.size(),this.cb.hover(),this.pagelist=Ve.el("div",{className:"pagelist json-index"}),Ve.extend(this.pagelist,{innerHTML:'<div class="prev">\n  <a>\n    <button disabled>Previous</button>\n  </a>\n</div>\n<div class="pages"></div>\n<div class="next">\n  <a>\n    <button disabled>Next</button>\n  </a>\n</div>\n<div class="pages cataloglink">\n  <a href="./catalog">Catalog</a>\n</div>'}),Ve(".cataloglink a",this.pagelist).href=G.catalog(),Ve.on(this.pagelist,"click",this.cb.pageNav),this.update(!0),Ve.onExists(Re,"title + *",()=>Te.title=Te.title.replace(/\ -\ Page\ \d+/,"")),Ve.onExists(Re,".board > .thread > .postContainer, .board + *",function(){let e;Ee.SITE.Build.hat=Ve(".board > .thread > img:first-child"),Ee.SITE.Build.hat&&(Ee.BOARD.threads.forEach(function(e){if(e.nodes.root)return Ve.prepend(e.nodes.root,Ee.SITE.Build.hat.cloneNode(!1))}),Ve.addClass(Re,"hats-enabled"),Ve.addStyle(`.catalog-thread::after {background-image: url(${Ee.SITE.Build.hat.src});}`));const t=Ve(".board");Ve.replace(t,B.root),B.loaded&&Ve.event("PostsInserted",null,B.root);try{Te.implementation.createDocument(null,null,null).appendChild(t)}catch(e){}for(e of Ge(".navLinks"))Ve.rm(e);Ve.rm(Ve.id("ctrl-top"));const n=Ve.id("delform").previousElementSibling;Ve.before(n,Ve.el("hr")),Ve.before(n,B.navLinks);const o=Ve("#index-last-refresh time",B.navLinks);if(o.dataset.utc)return w.update(o)}),ke.ready(function(){let e;return(e=Ve(".pagelist"))&&Ve.replace(e,B.pagelist),Ve.rmClass(Re,"index-loading")})},scroll(){if(B.req||!B.liveThreadData||"infinite"!==De["Index Mode"]||window.scrollY<=Re.scrollHeight-(300+window.innerHeight))return;null==B.pageNum&&(B.pageNum=B.currentPage);const e=++B.pageNum;if(e>B.pagesNum)return B.endNotice();const t=B.threadsOnPage(e);return B.buildStructure(t)},endNotice:function(){let e=!1;const t=()=>e=!1;return function(){if(!e)return e=!0,new It("info","Last page reached.",2),setTimeout(t,3e3)}}(),menu:{init(){if("index"===Ee.VIEW&&De.Menu&&De["Thread Hiding Link"]&&B.enabledOn(Ee.BOARD))return A.menu.addEntry({el:Ve.el("a",{href:"javascript:;",className:"has-shortcut-text"},{innerHTML:'<span></span><span class="shortcut-text">Shift+click</span>'}),order:20,open({thread:e}){return"catalog"===De["Index Mode"]&&(this.el.firstElementChild.textContent=e.isHidden?"Unhide":"Hide",this.cb&&Ve.off(this.el,"click",this.cb),this.cb=function(){return Ve.event("CloseMenu"),B.toggleHide(e)},Ve.on(this.el,"click",this.cb),!0)}})}},node(){if(!this.isReply&&!this.isClone&&null!=B.threadPosition[this.ID])return this.thread.setPage(Math.floor(B.threadPosition[this.ID]/B.threadsNumPerPage)+1)},catalogNode(){return Ve.on(this.nodes.root,"click",e=>{0===e.button&&e.shiftKey&&(e.preventDefault(),getSelection().removeAllRanges(),De["MD5 Quick Filter in the Catalog"]&&e.target.classList.contains("catalog-thumb")?J.quickFilterMD5.call(this.thread.OP):B.toggleHide(this.thread))})},toggleHide(e){if(B.showHiddenThreads){if(L.show(e),!L.db.get({boardID:e.board.ID,threadID:e.ID}))return}else L.hide(e);return L.saveHiddenState(e)},cycleSortType(){let e;const t=B.selectSort.options.filter(e=>!e.disabled);for(e=0;e<t.length&&!t[e].selected;e++);return t[(e+1)%t.length].selected=!0,Ve.event("change",null,B.selectSort)},cb:{initFinished:()=>(B.initFinishedFired=!0,Ve.queueTask(()=>B.cb.postsInserted())),postsInserted(){if(!B.initFinishedFired)return;let e=0;return Ee.posts.forEach(function(t){if(!t.isFetchedQuote&&!t.indexRefreshSeen&&Re.contains(t.nodes.root))return t.indexRefreshSeen=!0,e++}),e?Ve.event("IndexRefresh"):void 0},toggleHiddenThreads:()=>(Ve("#hidden-toggle a",B.navLinks).textContent=(B.showHiddenThreads=!B.showHiddenThreads)?"Hide":"Show",B.sort(),B.buildIndex()),mode(){return B.pushState({mode:this.value}),B.pageLoad(!1)},sort(){const e=B.selectRev.checked?B.selectSort.value+"-rev":B.selectSort.value;return B.pushState({sort:e}),B.pageLoad(!1)},resort(e){if(B.changed.order=!0,!e?.detail?.deferred)return B.pageLoad(!1)},perBoardSort(){De["Index Sort"]=this.checked?Fe():"",B.saveSort();for(let e=0;e<2;e++)De[`Last Long Reply Thresholds ${e}`]=this.checked?Fe():"",B.saveLastLongThresholds(e)},lastLongThresholds(){const e=[...this.parentNode.children].indexOf(this),t=+this.value;if(Number.isFinite(t))return B.lastLongThresholds[e]=t,B.saveLastLongThresholds(e),B.changed.order=!0,B.pageLoad(!1);this.value=B.lastLongThresholds[e]},size(e){if("catalog"!==De["Index Mode"]?(Ve.rmClass(B.root,"catalog-small"),Ve.rmClass(B.root,"catalog-large")):"small"===De["Index Size"]?(Ve.addClass(B.root,"catalog-small"),Ve.rmClass(B.root,"catalog-large")):(Ve.addClass(B.root,"catalog-large"),Ve.rmClass(B.root,"catalog-small")),e)return B.buildIndex()},replies:()=>B.buildIndex(),hover:()=>Re.classList.toggle("catalog-hover-expand",De["Catalog Hover Expand"]),hoverToggle(e){if(De["Catalog Hover Toggle"]&&Ve.hasClass(Re,"catalog-mode")&&!Ve.modifiedClick(e)&&!Ve.x("ancestor-or-self::a",e.target)){let t;const o=B.inputs["Catalog Hover Expand"];if(o.checked=!o.checked,Ve.event("change",null,o),t=n.threadFromNode(e.target))return B.cb.catalogReplies.call(t),B.cb.hoverAdjust.call(t.OP.nodes)}},popstate(e){if(e?.state){const{searched:t,mode:n,sort:o}=e.state,a=B.getCurrentPage();return B.setState({search:t,mode:n,sort:o,page:a}),B.pageLoad(!1)}{const e=B.processHash();return De["Refreshed Navigation"]&&e?B.update():B.pageLoad()}},pageNav(e){let t;if(!Ve.modifiedClick(e)){switch(e.target.nodeName){case"BUTTON":e.target.blur(),t=e.target.parentNode;break;case"A":t=e.target;break;default:return}if("Catalog"!==t.textContent)return e.preventDefault(),B.userPageNav(+t.pathname.split(/\/+/)[2]||1)}},refreshFront:()=>(B.pushState({page:1}),B.update()),catalogReplies(){if(De["Show Replies"]&&Ve.hasClass(Re,"catalog-hover-expand")&&!this.catalogView.nodes.replies)return B.buildCatalogReplies(this)},hoverAdjust(){let e;if(!Ve.hasClass(Re,"catalog-hover-expand"))return;const t=this.post.getBoundingClientRect();if(e=Ve.minmax(0,-t.left,Re.clientWidth-t.right)){const{style:t}=this.post;return t.left=`${e}px`,t.right=-e+"px",Ve.one(this.root,"mouseleave",()=>t.left=t.right=null)}}},scrollToIndex:()=>Y.scrollToIfNeeded(B.navLinks.getBoundingClientRect().height?B.navLinks:B.root),getCurrentPage:()=>+window.location.pathname.split(/\/+/)[2]||1,userPageNav:e=>(B.pushState({page:e}),De["Refreshed Navigation"]?B.update():B.pageLoad()),hashCommands:{mode:{paged:"paged","infinite-scrolling":"infinite",infinite:"infinite","all-threads":"all pages","all-pages":"all pages",catalog:"catalog"},sort:{"bump-order":"bump","last-reply":"lastreply","last-long-reply":"lastlong","creation-date":"birth","reply-count":"replycount","file-count":"filecount","posts-per-minute":"activity"}},processHash(){var e,t,n;let o=location.href.match(/#.*/)?.[0]||"";const a={replace:!0},i=o.slice(1).split("/"),s=[];for(e of i)(t=Ve.getOwn(B.hashCommands.mode,e))?a.mode=t:"index"===e?(a.mode=De["Previous Index Mode"],a.page=1):(n=Ve.getOwn(B.hashCommands.sort,e.replace(/-rev$/,"")))?(a.sort=n,/-rev$/.test(e)&&(a.sort+="-rev")):/^s=/.test(e)?a.search=decodeURIComponent(e.slice(2)).replace(/\+/g," ").trim():s.push(e);return o=s.join("/"),o&&(a.hash=`#${o}`),B.pushState(a),i.length-s.length},pushState(e){let{search:t,hash:n,replace:o}=e,a=history.state?.oldpage;null!=t&&t!==B.search&&(e.page=t?1:a||1,t?B.search||(a=B.currentPage):a=void 0),B.setState(e);const i=1===B.currentPage?`/${Ee.BOARD}/`:`/${Ee.BOARD}/${B.currentPage}`;return n||(n=""),history[o?"replaceState":"pushState"]({mode:De["Index Mode"],sort:B.currentSort,searched:B.search,oldpage:a},"",`${location.protocol}//${location.host}${i}${n}`)},setState({search:e,mode:t,sort:n,page:o,hash:a}){if(null!=e&&e!==B.search&&(B.changed.search=!0,B.search=e),null!=t&&t!==De["Index Mode"]&&(B.changed.mode=!0,De["Index Mode"]=t,Ve.set("Index Mode",t),"catalog"!==t&&De["Previous Index Mode"]!==t&&(De["Previous Index Mode"]=t,Ve.set("Previous Index Mode",t))),null!=n&&n!==B.currentSort&&(B.changed.sort=!0,B.currentSort=n,B.saveSort()),["all pages","catalog"].includes(De["Index Mode"])&&(o=1),null!=o&&o!==B.currentPage&&(B.changed.page=!0,B.currentPage=o),null!=a)return B.changed.hash=!0},savePerBoard:(e,t)=>("object"==typeof De[e]?De[e][Ee.BOARD.ID]=t:De[e]=t,Ve.set(e,De[e])),saveSort:()=>B.savePerBoard("Index Sort",B.currentSort),saveLastLongThresholds:e=>B.savePerBoard(`Last Long Reply Thresholds ${e}`,B.lastLongThresholds[e]),pageLoad(e=!0){if(!B.liveThreadData)return;let{threads:t,order:n,search:o,mode:a,sort:i,page:s,hash:r}=B.changed;return t||(t=o),n||(n=i),(t||n)&&B.sort(),t&&B.buildPagelist(),o&&B.setupSearch(),a&&B.setupMode(),i&&B.setupSort(),(t||a||s||n)&&B.buildIndex(),(t||s)&&B.setPage(),e&&!r&&B.scrollToIndex(),B.changed={}},setupMode(){for(var e of["paged","infinite","all pages","catalog"])Ve[e===De["Index Mode"]?"addClass":"rmClass"](Re,`${e.replace(/\ /g,"-")}-mode`);return B.selectMode.value=De["Index Mode"],B.cb.size(),B.showHiddenThreads=!1,Ve("#hidden-toggle a",B.navLinks).textContent="Show"},setupSort:()=>(B.selectRev.checked=/-rev$/.test(B.currentSort),B.selectSort.value=B.currentSort.replace(/-rev$/,""),B.lastLongOptions.hidden="lastlong"!==B.selectSort.value),getPagesNum:()=>B.search?Math.ceil(B.sortedThreadIDs.length/B.threadsNumPerPage):B.pagesNum,getMaxPageNum:()=>Math.max(1,B.getPagesNum()),buildPagelist(){const e=Ve(".pages",B.pagelist),t=B.getMaxPageNum();if(e.childElementCount!==t){const o=[];for(let e=1,a=t;e<=a;e++){var n=Ve.el("a",{textContent:e,href:1===e?"./":e});o.push(Ve.tn("["),n,Ve.tn("] "))}return Ve.rmAll(e),Ve.add(e,o)}},setPage(){let e,t;const n=B.currentPage,o=B.getMaxPageNum(),a=Ve(".pages",B.pagelist),i=a.previousElementSibling.firstElementChild,s=a.nextElementSibling.firstElementChild;let r=Math.max(n-1,1);if(i.href=1===r?"./":r,i.firstElementChild.disabled=r===n,r=Math.min(n+1,o),s.href=1===r?"./":r,s.firstElementChild.disabled=r===n,t=Ve("strong",a)){if(+t.textContent===n)return;Ve.replace(t,t.firstChild)}else t=Ve.el("strong");if(e=a.children[n-1])return Ve.before(e,t),Ve.add(t,e)},updateHideLabel(){if(!B.hideLabel)return;let e=0;for(var t of B.liveThreadIDs)B.isHidden(t)&&e++;return e?(B.hideLabel.hidden=!1,Ve("#hidden-count",B.navLinks).textContent=1===e?"1 hidden thread":`${e} hidden threads`):(B.hideLabel.hidden=!0,void(B.showHiddenThreads&&B.cb.toggleHiddenThreads()))},update(e){let t;if((t=B.req)&&(delete B.req,t.abort()),De["Index Refresh Notifications"]?(B.notice||(B.notice=new It("info","Refreshing index...")),B.nTimeout||(B.nTimeout=setTimeout(()=>{B.notice&&(B.notice.el.lastElementChild.textContent+=" (disable JSON Index if this takes too long)")},3e3))):B.nTimeout||(B.nTimeout=setTimeout(()=>B.notice||(B.notice=new It("info","Refreshing index... (disable JSON Index if this takes too long)")),3e3)),e||"loading"===Te.readyState||Ve(".board + *"))return B.req=Ve.whenModified(Ee.SITE.urls.catalogJSON({boardID:Ee.BOARD.ID}),"Index",B.load),Ve.addClass(B.button,"spin");location.reload()},load(){let e;if(this!==B.req)return;Ve.rmClass(B.button,"spin");const{notice:t,nTimeout:n}=B;if(n&&clearTimeout(n),delete B.nTimeout,delete B.req,delete B.notice,![200,304].includes(this.status))return e="Index refresh failed. "+(this.status?`Error ${this.statusText} (${this.status})`:"Connection Error"),void(t?(t.setType("warning"),t.el.lastElementChild.textContent=e,setTimeout(t.close,$e)):new It("warning",e,1));try{200===this.status?B.parse(this.response):304===this.status&&B.pageLoad()}catch(n){return e=n,Be.error(`Index failure: ${e.message}`,e.stack),void(t?(t.setType("error"),t.el.lastElementChild.textContent="Index refresh failed.",setTimeout(t.close,$e)):new It("error","Index refresh failed.",1))}t&&(De["Index Refresh Notifications"]?(t.setType("success"),t.el.lastElementChild.textContent="Index refreshed!",setTimeout(t.close,$e)):t.close());const o=Ve("#index-last-refresh time",B.navLinks);return o.dataset.utc=Date.parse(this.getResponseHeader("Last-Modified")),w.update(o)},parse:e=>(Ve.cleanCache(e=>/^https?:\/\/a\.4cdn\.org\//.test(e)),B.parseThreadList(e),B.changed.threads=!0,B.pageLoad()),parseThreadList(e){var t,n,o,a;B.pagesNum=e.length,B.threadsNumPerPage=e[0]?.threads.length||1,B.liveThreadData=e.reduce((e,t)=>e.concat(t.threads),[]),B.liveThreadIDs=B.liveThreadData.map(e=>e.no),B.liveThreadDict=Fe(),B.threadPosition=Fe(),B.parsedThreads=Fe(),B.replyData=Fe();for(let e=0;e<B.liveThreadData.length;e++)if(o=B.liveThreadData[e],B.liveThreadDict[o.no]=o,B.threadPosition[o.no]=e,B.parsedThreads[o.no]=t=Ee.SITE.Build.parseJSON(o,Ee.BOARD),n=J.test(t),t.isOnTop=n.top,t.isHidden=n.hide||L.isHidden(t.boardID,t.threadID),o.last_replies)for(a of o.last_replies)B.replyData[`${Ee.BOARD}.${a.no}`]=a;B.liveThreadData[0]&&(Ee.SITE.Build.spoilerRange[Ee.BOARD.ID]=B.liveThreadData[0].custom_spoiler),Ee.BOARD.threads.forEach(function(e){if(!B.liveThreadIDs.includes(e.ID))return e.collect()}),Ve.event("IndexUpdate",{threads:B.liveThreadIDs.map(e=>`${Ee.BOARD}.${e}`)})},isHidden(e){let t;return(t=Ee.BOARD.threads.get(e))&&t.OP&&!t.OP.isFetchedQuote?t.isHidden:B.parsedThreads[e].isHidden},isHiddenReply:(e,t)=>x.isHidden(Ee.BOARD.ID,e,t.no)||J.isHidden(Ee.SITE.Build.parseJSON(t,Ee.BOARD)),buildThreads(e,t,n){var o,a,i,s,r,l,d;let c;const h=[],u=[];let p=[];for(o of e)try{r=B.liveThreadDict[o],(i=Ee.BOARD.threads.get(o))?(i.json!==r&&JSON.stringify(i.json)!==JSON.stringify(r)&&(i.setCount("post",r.replies+1,r.bumplimit),i.setCount("file",r.images+!!r.ext,r.imagelimit),i.setStatus("Sticky",!!r.sticky),i.setStatus("Closed",!!r.closed)),i.catalogView&&(Ve.rm(i.catalogView.nodes.replies),i.catalogView.nodes.replies=null)):(i=new at(o,Ee.BOARD),u.push(i)),(l=r.last_replies&&r.last_replies.length?r.last_replies[r.last_replies.length-1].no:o)>i.lastPost&&(i.lastPost=l),i.json=r,h.push(i),(s=i.OP)&&!s.isFetchedQuote?(s.setCatalogOP(t),i.setPage(Math.floor(B.threadPosition[o]/B.threadsNumPerPage)+1)):(d=B.parsedThreads[o],a=Ee.SITE.Build.post(d),(s=new dt(a,i,Ee.BOARD)).filterResults=d.filterResults,p.push(s)),t&&i.nodes.root||Ee.SITE.Build.thread(i,r,n)}catch(e){c||(c=[]),c.push({message:`Parsing of Thread No.${i} failed. Thread will be skipped.`,error:e,html:a?.outerHTML})}return c&&ke.handleErrors(c),n&&(p=p.concat(B.buildReplies(h))),ke.callbackNodes("Thread",u),ke.callbackNodes("Post",p),B.updateHideLabel(),Ve.event("IndexRefreshInternal",{threadIDs:h.map(e=>e.fullID),isCatalog:t}),h},buildReplies(e){var t,n,o,a,i,s;let r;const l=[];for(t of e)if(n=B.liveThreadDict[t.ID].last_replies){for(a of(o=[],n))if(!(s=t.posts.get(a.no))||s.isFetchedQuote){o.push(i=Ee.SITE.Build.postFromObject(a,t.board.ID));try{l.push(new dt(i,t,t.board))}catch(e){r||(r=[]),r.push({message:`Parsing of Post No.${a.no} failed. Post will be skipped.`,error:e,html:i?.outerHTML})}}else o.push(s.nodes.root);Ve.add(t.nodes.root,o)}return r&&ke.handleErrors(r),l},buildCatalogViews(e){var t,n,o;const a=[];for(t of e)if(!t.catalogView){var{ID:i}=t;n=Math.floor(B.threadPosition[i]/B.threadsNumPerPage)+1,o=Ee.SITE.Build.catalogThread(t,B.liveThreadDict[i],n),a.push(new it(o,t))}ke.callbackNodes("CatalogThread",a)},sizeCatalogViews(e){var t,n;const o="small"===De["Index Size"]?150:250;for(t of e){var{thumb:a}=t.catalogView.nodes,{width:i,height:s}=a.dataset;i&&(n=o/Math.max(i,s),a.style.width=i*n+"px",a.style.height=s*n+"px")}},buildCatalogReplies(e){var t,n;let o;const{nodes:a}=e.catalogView;if(!(o=B.liveThreadDict[e.ID].last_replies))return;const i=[];for(t of o)B.isHiddenReply(e.ID,t)||(n=Ee.SITE.Build.catalogReply(e,t),w.update(Ve("time",n)),Ve.on(Ve(".catalog-reply-preview",n),"mouseover",R.mouseover),i.push(n));a.replies=Ve.el("div",{className:"catalog-replies"}),Ve.add(a.replies,i),Ve.add(e.OP.nodes.post,a.replies)},sort(){let e;const{liveThreadIDs:t,liveThreadData:n}=B;if(!n)return;const o=(new Date).getTime()/1e3,a=B.currentSort.replace(/-rev$/,"");return B.sortedThreadIDs=(()=>{var e,i,s,r;switch(a){case"lastreply":case"lastlong":for(r of(e=n.some(e=>e.last_replies?.length),i=function(t){var n;if(!e)return t.last_modified;const o=t.last_replies||[];for(let e=o.length-1;e>=0;e--)if(n=o[e],!B.isHiddenReply(t.no,n)){if("lastreply"===a)return n;if((n.com?Ee.SITE.Build.parseComment(n.com).replace(/[^a-z]/gi,"").length:0)>=B.lastLongThresholds[+!!n.ext])return n}return t.omitted_posts&&t.last_replies?.length?t.last_replies[0]:t},s=Fe(),n))s[r.no]=i(r).no;return[...n].sort((e,t)=>s[t.no]-s[e.no]).map(e=>e.no);case"bump":default:return t;case"birth":return[...t].sort((e,t)=>t-e);case"replycount":return[...n].sort((e,t)=>t.replies-e.replies).map(e=>e.no);case"filecount":return[...n].sort((e,t)=>t.images-e.images).map(e=>e.no);case"activity":return[...n].sort((e,t)=>(o-e.time)/(e.replies+1)-(o-t.time)/(t.replies+1)).map(e=>e.no)}})(),/-rev$/.test(B.currentSort)&&B.sortedThreadIDs.reverse(),B.search&&(e=B.querySearch(B.search))&&(B.sortedThreadIDs=e),B.sortOnTop(e=>e.isSticky),B.sortOnTop(e=>e.isOnTop||De["Pin Watched Threads"]&&E.isWatchedRaw(e.boardID,e.threadID)),De["Anchor Hidden Threads"]?B.sortOnTop(e=>!B.isHidden(e.threadID)):void 0},sortOnTop(e){const t=[],n=[];for(var o of B.sortedThreadIDs)(e(B.parsedThreads[o])?t:n).push(o);return B.sortedThreadIDs=t.concat(n)},buildIndex(){let e;if(B.liveThreadData){switch(De["Index Mode"]){case"all pages":e=B.sortedThreadIDs;break;case"catalog":e=B.sortedThreadIDs.filter(e=>!B.isHidden(e)!==B.showHiddenThreads);break;default:e=B.threadsOnPage(B.currentPage)}delete B.pageNum,Ve.rmAll(B.root),Ve.rmAll(Y.hover),B.loaded&&B.root.parentNode&&Ve.event("PostsRemoved",null,B.root),"catalog"===De["Index Mode"]?B.buildCatalog(e):B.buildStructure(e)}},threadsOnPage(e){const t=B.threadsNumPerPage,n=t*(e-1);return B.sortedThreadIDs.slice(n,n+t)},buildStructure(e){const t=B.buildThreads(e,!1,De["Show Replies"]),n=[];for(var o of t)n.push(o.nodes.root,Ve.el("hr"));Ve.add(B.root,n),B.root.parentNode&&Ve.event("PostsInserted",null,B.root),B.loaded=!0},buildCatalog(e){let t=0;const n=e.length;let o=null;var a=function(){if(o&&!o.parentNode)return;const i=t>0&&B.root.parentNode?n:t+30;return o=B.buildCatalogPart(e.slice(t,i))[0],t=i,t<n?Ve.queueTask(a):(B.root.parentNode&&Ve.event("PostsInserted",null,B.root),B.loaded=!0)};a()},buildCatalogPart(e){const t=B.buildThreads(e,!0);B.buildCatalogViews(t),B.sizeCatalogViews(t);const n=[];for(var o of t)o.OP.setCatalogOP(!0),Ve.add(o.catalogView.nodes.root,o.OP.nodes.root),n.push(o.catalogView.nodes.root),Ve.on(o.catalogView.nodes.root,"mouseenter",B.cb.catalogReplies.bind(o)),Ve.on(o.OP.nodes.root,"mouseenter",B.cb.hoverAdjust.bind(o.OP.nodes));return Ve.add(B.root,n),n},clearSearch:()=>(B.searchInput.value="",B.onSearchInput(),B.searchInput.focus()),setupSearch:()=>(B.searchInput.value=B.search,B.search?B.searchInput.dataset.searching=1:B.searchInput.removeAttribute("data-searching")),onSearchInput(){const e=B.searchInput.value.trim();if(e!==B.search)return B.pushState({search:e,replace:!!e==!!B.search}),B.pageLoad(!1)},querySearch(e){let t,n;if(n=e.match(/^([\w+]+):\/(.*)\/(\w*)$/)){let e;try{e=RegExp(n[2],n[3])}catch(e){return[]}return B.sortedThreadIDs.filter(t=>e.test(J.values(n[1],B.parsedThreads[t]).join("\n")))}if(t=e.toLowerCase().match(/\S+/g))return B.sortedThreadIDs.filter(e=>B.searchMatch(B.parsedThreads[e],t))},searchMatch(e,t){var n,o;const{info:a,file:i}=e;null==a.comment&&(a.comment=Ee.SITE.Build.parseComment(a.commentHTML.innerHTML));let s=[];for(n of["comment","subject","name","tripcode"])n in a&&s.push(a[n]);for(o of(i&&s.push(i.name),s=s.join(" ").toLowerCase(),t))if(-1===s.indexOf(o))return!1;return!0}},L={init(){if(["index","catalog"].includes(Ee.VIEW)&&(De["Thread Hiding Buttons"]||De.Menu&&De["Thread Hiding Link"]||De["JSON Index"]))return this.db=new nt("hiddenThreads"),"catalog"===Ee.VIEW?this.catalogWatch():(this.catalogSet(Ee.BOARD),Ve.on(Te,"IndexRefreshInternal",this.onIndexRefresh),De["Thread Hiding Buttons"]&&Ve.addClass(Re,"thread-hide"),Ne.Post.push({name:"Thread Hiding",cb:this.node}))},catalogSet(e){if(!Ve.hasStorage||"yotsuba"!==Ee.SITE.software)return;const t=L.db.get({boardID:e.ID,defaultValue:Fe()});for(var n in t)t[n]=!0;return localStorage.setItem(`4chan-hide-t-${e}`,JSON.stringify(t))},catalogWatch(){if(Ve.hasStorage&&"yotsuba"===Ee.SITE.software)return this.hiddenThreads=JSON.parse(localStorage.getItem(`4chan-hide-t-${Ee.BOARD}`))||{},ke.ready(()=>new MutationObserver(L.catalogSave).observe(Ve.id("threads"),{attributes:!0,subtree:!0,attributeFilter:["style"]}))},catalogSave(){let e;const t=JSON.parse(localStorage.getItem(`4chan-hide-t-${Ee.BOARD}`))||{};for(e in t)Ve.hasOwn(L.hiddenThreads,e)||L.db.set({boardID:Ee.BOARD.ID,threadID:e,val:{makeStub:De.Stubs}});for(e in L.hiddenThreads)Ve.hasOwn(t,e)||L.db.delete({boardID:Ee.BOARD.ID,threadID:e});return L.hiddenThreads=t},isHidden:(e,t)=>!(!L.db||!L.db.get({boardID:e,threadID:t})),node(){let e;this.isReply||this.isClone||this.isFetchedQuote||(De["Thread Hiding Buttons"]&&Ve.prepend(this.nodes.root,L.makeButton(this.thread,"hide")),(e=L.db.get({boardID:this.board.ID,threadID:this.ID}))&&L.hide(this.thread,e.makeStub,"Hidden manually"))},onIndexRefresh:()=>Ee.BOARD.threads.forEach(function(e){const{root:t}=e.nodes;e.isHidden&&e.stub&&!t.contains(e.stub)&&L.makeStub(e,t)}),menu:{init(){if("index"!==Ee.VIEW||!De.Menu||!De["Thread Hiding Link"])return;let e=Ve.el("div",{className:"hide-thread-link",textContent:"Hide"});const t=Ve.el("a",{textContent:"Apply",href:"javascript:;"});Ve.on(t,"click",L.menu.hide);const n=rt.checkbox("Stubs","Make stub");A.menu.addEntry({el:e,order:20,open:({thread:e,isReply:t})=>!(t||e.isHidden||De["JSON Index"]&&"catalog"===De["Index Mode"]||(L.menu.thread=e,0)),subEntries:[{el:t},{el:n}]}),e=Ve.el("a",{className:"show-thread-link",textContent:"Show",href:"javascript:;"}),Ve.on(e,"click",L.menu.show),A.menu.addEntry({el:e,order:20,open:({thread:e,isReply:t})=>!(t||!e.isHidden||De["JSON Index"]&&"catalog"===De["Index Mode"]||(L.menu.thread=e,0))});const o=Ve.el("a",{textContent:"Hide stub",href:"javascript:;"});return Ve.on(o,"click",L.menu.hideStub),A.menu.addEntry({el:o,order:15,open:({thread:e,isReply:t})=>!(t||!e.isHidden||De["JSON Index"]&&"catalog"===De["Index Mode"])&&(L.menu.thread=e)})},hide(){const e=Ve("input",this.parentNode).checked,{thread:t}=L.menu;return L.hide(t,e,"Hidden manually"),L.saveHiddenState(t,e),Ve.event("CloseMenu")},show(){const{thread:e}=L.menu;return L.show(e),L.saveHiddenState(e),Ve.event("CloseMenu")},hideStub(){const{thread:e}=L.menu;L.show(e),L.hide(e,!1),L.saveHiddenState(e,!1),Ve.event("CloseMenu")}},makeButton(e,t){const n=Ve.el("span",{className:"stub-icon"}),o=Ve.el("a",{className:`${t}-post-button ${t}-thread-button`,href:"javascript:;"});return a.set(n,"hide"===t?"squareMinus":"squarePlus"),Ve.add(o,n),o.dataset.fullID=e.fullID,Ve.on(o,"click",L.toggle),o},makeStub(e,t,n){let o,a,i=Ge(Ee.SITE.selectors.replyOriginal,t).length;(o=Ve(Ee.SITE.selectors.summary,t))&&(i+=+o.textContent.match(/\d+/));const s=L.makeButton(e,"show"),{nameBlock:r,subject:l}=e.OP.info;l&&Ve.add(s,Ve.el("span",{className:"stub-subject",textContent:l})),Ve.add(s,Ve.el("span",{className:"stub-name",textContent:r})),Ve.add(s,Ve.el("span",{className:"stub-replies",textContent:`(${i} repl${1===i?"y":"ies"})`}));let d=e.OP.filterResults?.reasons||[];if(n&&(d=[...d,n]),De["Filter Reason"]&&d.length){const e=Ve.el("span",{className:"stub-reasons"});Ve.add(e,d.map(e=>Ve.el("span",{className:"stub-reason",textContent:e}))),s.appendChild(e)}if(e.stub=Ve.el("div",{className:"stub"}),De.Menu?Ve.add(e.stub,[s,A.makeButton(e.OP)]):Ve.add(e.stub,s),!De["Filter Reason"]&&d&&(e.stub.title=d.join(" & ")),Ve.prepend(t,e.stub),a=Ve(Ee.SITE.selectors.threadDivider,t))return Ve.addClass(a,"threadDivider")},saveHiddenState:(e,t)=>(e.isHidden?L.db.set({boardID:e.board.ID,threadID:e.ID,val:{makeStub:t}}):L.db.delete({boardID:e.board.ID,threadID:e.ID}),L.catalogSet(e.board)),toggle(e){return e instanceof at||(e=Ee.threads.get(this.dataset.fullID)),e.isHidden?L.show(e):L.hide(e,void 0,"Hidden manually"),L.saveHiddenState(e)},hide(e,t=De.Stubs,n){if(e.isHidden)return;const o=e.nodes.root;if(e.isHidden=!0,B.updateHideLabel(),e.catalogView&&!B.showHiddenThreads&&(Ve.rm(e.catalogView.nodes.root),Ve.event("PostsRemoved",null,B.root)),!t)return o.hidden=!0;L.makeStub(e,o,n)},show(e){if(e.stub&&(Ve.rm(e.stub),delete e.stub),e.nodes.root.hidden=e.isHidden=!1,B.updateHideLabel(),e.catalogView&&"catalog"===De["Index Mode"]){const{root:t}=e.catalogView.nodes;if(B.showHiddenThreads)Ve.rm(t),Ve.event("PostsRemoved",null,B.root);else{let n=B.sortedThreadIDs.indexOf(e.ID)-1;for(;;){if(n<0){Ve(".board").insertAdjacentElement("afterbegin",t);break}const e=Te.getElementById(`t${B.sortedThreadIDs[n]}`);if(e){e.insertAdjacentElement("afterend",t);break}--n}Ve.event("PostsInserted",null,B.root)}}}},N={init(){var e,t,n,o;if((De["Fappe Tyme"]||De["Werk Tyme"])&&["index","thread","archive"].includes(Ee.VIEW)){for(e of(this.nodes={},this.enabled={fappe:!1,werk:De.werk},["Fappe","Werk"]))De[`${e} Tyme`]&&(t=e.toLowerCase(),(n=rt.checkbox(t,`${e} Tyme`,!1)).title=`${e} Tyme`,this.nodes[t]=n.firstElementChild,De[t]&&this.set(t,!0),Ve.on(this.nodes[t],"change",this.toggle.bind(this,t)),Y.menu.addEntry({el:n,order:97}),o=Ve.el("span",{className:"indicator",textContent:e[0],title:`${e} Tyme active`}),Ve.on(o,"click",function(){const e=Ve.getOwn(N.nodes,this.parentNode.id.replace("shortcut-",""));return e.checked=!e.checked,Ve.event("change",null,e)}),Y.addShortcut(t,o,410));return De["Werk Tyme"]&&Ve.sync("werk",this.set.bind(this,"werk")),Ne.Post.push({name:"Fappe Tyme",cb:this.node}),Ne.CatalogThread.push({name:"Werk Tyme",cb:this.catalogNode})}},node(){return this.nodes.root.classList.toggle("noFile",!this.files.length)},catalogNode(){const e=this.thread.OP.files[0];if(!e)return;const t=Ve.el("div",{textContent:e.name,className:"werkTyme-filename"});return Ve.add(this.nodes.thumb.parentNode,t)},set(e,t){return this.enabled[e]=this.nodes[e].checked=t,Ve[(t?"add":"rm")+"Class"](Re,`${e}Tyme`)},toggle(e){if(this.set(e,!this.enabled[e]),"werk"===e)return Ve.cb.checked.call(this.nodes[e])}},M={init(){let e;if(!["index","thread"].includes(Ee.VIEW)||!De.Sauce)return;Ve.addClass(Re,"show-sauce");const t=[];for(e of De.sauces.split("\n")){var n;"#"!==e[0]&&(n=this.parseLink(e))&&t.push(n)}return t.length?(this.links=t,this.link=Ve.el("a",{target:"_blank",className:"sauce"}),Ne.Post.push({name:"Sauce",cb:this.node})):void 0},parseLink(e){var t,n;if(!(e=e.trim()))return null;const o=Fe(),a=e.split(/;(?=(?:text|boards|types|regexp|sandbox):?)/);for(let e=0;e<a.length;e++)t=a[e],0===e?o.url=t:o[(n=t.match(/^(\w*):?(.*)$/))[1]]=n[2];if(o.text||(o.text=o.url.match(/(\w+)\.\w+\//)?.[1]||"?"),"boards"in o&&(o.boards=J.parseBoards(o.boards)),"regexp"in o)try{let e;(e=o.regexp.match(/^\/(.*)\/(\w*)$/))?o.regexp=RegExp(e[1],e[2]):o.regexp=RegExp(o.regexp)}catch(t){return new It("warning",[Ve.tn("Invalid regexp for Sauce link:"),Ve.el("br"),Ve.tn(e),Ve.el("br"),Ve.tn(t.message)],60),null}return o},createSauceLink(e,t,n){let o,a,i;const s=n.url.match(/[^.]*$/)[0],r=Fe();if(Ve.extend(r,e),r.boards&&!r.boards[`${t.siteID}/${t.boardID}`]&&!r.boards[`${t.siteID}/*`])return null;if(r.types&&(i=s,!r.types.split(",").includes(i)))return null;if(r.regexp&&!(a=n.name.match(r.regexp)))return null;const l=[];for(var d of["url","text"])r[d]=r[d].replace(/%(T?URL|IMG|[sh]?MD5|board|name|%|semi|\$\d+)/g,function(e,o){let i;if("$"===o[0]){if(!a)return e;i=a[o.slice(1)]||""}else if(i=M.formatters[o](t,n,s),null==i)return l.push(o),"";return"url"!==d||["%","semi"].includes(o)||(/^javascript:/i.test(r.url)&&(i=JSON.stringify(i)),i=encodeURIComponent(i)),i});return Ee.SITE.areMD5sDeferred?.(t.board)&&l.length&&!l.filter(e=>!/^.?MD5$/.test(e)).length?(o=M.link.cloneNode(!1),o.dataset.skip="1",o):l.length?null:(o=M.link.cloneNode(!1),o.href=r.url,o.textContent=r.text,/^javascript:/i.test(r.url)&&o.removeAttribute("target"),o)},node(){if(!this.isClone)for(var e of this.files)M.file(this,e)},file(e,t){let n,o;const a=[],i=[];for(n of M.links)(o=M.createSauceLink(n,e,t))&&(a.push(Ve.tn(" "),o),o.dataset.skip&&i.push([n,o]));if(Ve.add(t.text,a),i.length){var s=new MutationObserver(function(){if(t.text.dataset.md5){for([n,o]of i){var a;(a=M.createSauceLink(n,e,t))&&Ve.replace(o,a)}return s.disconnect()}});return s.observe(t.text,{attributes:!0})}},formatters:{TURL:(e,t)=>t.thumbURL,URL:(e,t)=>t.url,IMG:(e,t,n)=>["gif","jpg","jpeg","png"].includes(n)?t.url:t.thumbURL,MD5:(e,t)=>t.MD5,sMD5:(e,t)=>t.MD5?.replace(/[+/=]/g,e=>({"+":"-","/":"_","=":""}[e])),hMD5(e,t){if(t.MD5)return Array.from(atob(t.MD5),e=>e.charCodeAt(0).toString(16).padStart(2,"0")).join("")},board:e=>e.board.ID,name:(e,t)=>t.name,"%":()=>"%",semi:()=>";"}},P={init(){if(!(this.enabled=De.Gallery&&["index","thread"].includes(Ee.VIEW)))return;this.delay=De["Slide Delay"];const e=Ve.el("a",{href:"javascript:;",title:"Gallery"});return a.set(e,"image","Gallery"),Ve.on(e,"click",this.cb.toggle),Y.addShortcut("gallery",e,530),Ne.Post.push({name:"Gallery",cb:this.node})},node(){return(()=>{const e=[];for(var t of this.files)t.thumb&&(P.nodes&&(P.generateThumb(this,t),P.nodes.total.textContent=P.images.length),De["Image Expansion"]||"tinyboard"===Ee.SITE.software&&ke.jsEnabled?e.push(void 0):e.push(Ve.on(t.thumbLink,"click",P.cb.image)));return e})()},build(e){var t,o,i,s,r,l,d;let c,h;const{cb:u}=P;De["Fullscreen Gallery"]&&(Ve.one(Te,"fullscreenchange mozfullscreenchange webkitfullscreenchange",()=>Ve.on(Te,"fullscreenchange mozfullscreenchange webkitfullscreenchange",u.close)),Re.mozRequestFullScreen?.(),Re.webkitRequestFullScreen?.(Element.ALLOW_KEYBOARD_INPUT)),P.images=[];const p=P.nodes={};P.fileIDs=Fe(),P.slideshow=!1,p.el=c=Ve.el("div",{id:"a-gallery"}),Ve.extend(c,{innerHTML:'<div class="gal-viewport">\n  <span class="gal-buttons">\n    <a href="javascript:;" class="gal-start" title="Start slideshow"><i></i></a>\n    <a href="javascript:;" class="gal-stop" title="Stop slideshow"><i></i></a>\n    <a href="javascript:;" class="menu-button"><i></i></a>\n    <a href="javascript:;" class="gal-close">Ã—</a>\n  </span>\n  <div class="gal-labels">\n    <span class="gal-count">\n      <span class="count"></span> / <span class="total"></span>\n    </span>\n    <a class="gal-name" target="_blank"></a>\n    <span class="gal-sauce"></span>\n  </div>\n  <div class="gal-prev"></div>\n  <div class="gal-image">\n    <a href="javascript:;"><img></a>\n  </div>\n  <div class="gal-next"></div>\n</div>\n<div class="gal-thumbnails"></div>'});const g={buttons:".gal-buttons",frame:".gal-image",name:".gal-name",count:".count",total:".total",sauce:".gal-sauce",thumbs:".gal-thumbnails",next:".gal-image a",current:".gal-image img"};for(t in g)o=g[t],p[t]=Ve(o,c);const m=Ve(".menu-button",c);p.menu=new rt.Menu("gallery"),Ve.on(p.frame,"click",u.blank),De["Mouse Wheel Volume"]&&Ve.on(p.frame,"wheel",f.wheel),Ve.on(p.next,"click",u.click),Ve.on(p.name,"click",V.download);const b=Ve(".gal-prev",c),A=Ve(".gal-next",c),v=Ve(".gal-start",c),x=Ve(".gal-stop",c),w=Ve(".gal-close",c);for(i of(Ve.on(b,"click",u.prev),Ve.on(A,"click",u.next),Ve.on(v,"click",u.start),Ve.on(x,"click",u.stop),Ve.on(w,"click",u.close),Ve.on(m,"click",function(e){return p.menu.toggle(e,this,Ee)}),a.set(m,"caretDown"),a.set(v,"play"),a.set(x,"stop"),a.set(w,"xmark"),a.set(b,"caretLeft"),a.set(A,"caretRight"),P.menu.createSubEntries()))i.order=0,p.menu.addEntry(i);for(s of(Ve.on(Te,"keydown",u.keybinds),De.Keybinds&&Ve.off(Te,"keydown",H.keydown),Ve.on(window,"resize",P.cb.setHeight),Ge(Ee.SITE.selectors.file.thumb)))if(r=n.postFromNode(s))for(l of r.files)l.thumb&&(P.generateThumb(r,l),!e&&P.fileIDs[`${r.fullID}.${l.index}`]&&(d=l.thumbLink,Y.getTopOf(d)+d.getBoundingClientRect().height>=0&&(e=d)));return Ve.addClass(Re,"gallery-open"),Ve.add(Te.body,c),p.thumbs.scrollTop=0,p.current.parentElement.scrollTop=0,e&&(h=Ve(`[href='${e.href}']`,p.thumbs)),h||(h=P.images[P.images.length-1]),h&&P.open(h),Re.style.overflow="hidden",p.total.textContent=P.images.length},generateThumb(e,t){if(e.isClone||e.isHidden)return;if(!t||!t.thumb||!t.isImage&&!t.isVideo&&!De["PDF in Gallery"])return;if(P.fileIDs[`${e.fullID}.${t.index}`])return;P.fileIDs[`${e.fullID}.${t.index}`]=!0;const n=Ve.el("a",{className:"gal-thumb",href:t.url,target:"_blank",title:t.name});n.dataset.id=P.images.length,n.dataset.post=e.fullID,n.dataset.file=t.index;const o=t.thumb.cloneNode(!1);return o.style.cssText="",Ve.add(n,o),Ve.on(n,"click",P.cb.open),P.images.push(n),Ve.add(P.nodes.thumbs,n)},load(e,t){const n=e.href.match(/\w*$/),o=Ve.getOwn({webm:"video",mp4:"video",ogv:"video",pdf:"iframe"},n)||"img",a=Ve.el(o);return Ve.extend(a.dataset,e.dataset),Ve.on(a,"error",t),a.src=e.href,a},open(e){var t,n;let o,a,i;const{nodes:s}=P,r=+s.current.dataset.id,l=+e.dataset.id;if((o=P.images[r])&&Ve.rmClass(o,"gal-highlight"),Ve.addClass(e,"gal-highlight"),s.thumbs.scrollTop=e.offsetTop+e.offsetHeight/2-s.thumbs.clientHeight/2,P.cache?.dataset.id===""+l?(a=P.cache,Ve.off(a,"error",P.cacheError),Ve.on(a,"error",P.error)):a=P.load(e,P.error),Ve.off(s.current,"error",P.error),V.pause(s.current),Ve.replace(s.current,a),s.current=a,"VIDEO"===a.nodeName&&(a.loop=!0,f.setup(a),De.Autoplay&&a.play(),De["Show Controls"]&&(a.controls=!0)),Re.classList.toggle("gal-pdf","IFRAME"===a.nodeName),P.cb.setHeight(),s.count.textContent=+e.dataset.id+1,s.name.download=s.name.textContent=e.title,s.name.href=e.href,s.frame.scrollTop=0,s.next.focus(),Ve.rmAll(s.sauce),De.Sauce&&M.links&&(i=Ee.posts.get(a.dataset.post))){const e=[];for(t of M.links)(n=M.createSauceLink(t,i,i.files[+a.dataset.file]))&&e.push(Ve.tn(" "),n);Ve.add(s.sauce,e)}if(P.slideshow&&(l>r||r===P.images.length-1&&0===l)?P.setupTimer():P.cb.stop(),De["Scroll to Post"]&&(i=Ee.posts.get(a.dataset.post))&&Y.scrollTo(i.nodes.root),isNaN(r)||l===(r+1)%P.images.length)return P.cache=P.load(P.images[(l+1)%P.images.length],P.cacheError)},error(){if(this.error?.code===MediaError.MEDIA_ERR_DECODE)return new It("error","Corrupt or unplayable video",30);if(V.isFromArchive(this))return;const e=Ee.posts.get(this.dataset.post),t=e.files[+this.dataset.file];return V.error(this,e,t,null,e=>{if(e)return P.images[+this.dataset.id].href=e,P.nodes.current===this?this.src=e:void 0})},cacheError:()=>delete P.cache,cleanupTimer(){clearTimeout(P.timeoutID);const{current:e}=P.nodes;return Ve.off(e,"canplaythrough load",P.startTimer),Ve.off(e,"ended",P.cb.next)},startTimer:()=>P.timeoutID=setTimeout(P.checkTimer,P.delay*$e),setupTimer(){P.cleanupTimer();const{current:e}=P.nodes,t="VIDEO"===e.nodeName;return t&&e.play(),(t?e.readyState>=4:e.complete)||"IFRAME"===e.nodeName?P.startTimer():Ve.on(e,t?"canplaythrough":"load",P.startTimer)},checkTimer(){const{current:e}=P.nodes;return"VIDEO"!==e.nodeName||e.paused?P.cb.next():(Ve.on(e,"ended",P.cb.next),e.loop=!1)},cb:{keybinds(e){let t;if(!(t=H.keyCode(e)))return;const n=(()=>{switch(t){case De.Close:case De["Open Gallery"]:return P.cb.close;case De["Next Gallery Image"]:return P.cb.next;case De["Advance Gallery"]:return P.cb.advance;case De["Previous Gallery Image"]:return P.cb.prev;case De.Pause:return P.cb.pause;case De.Slideshow:return P.cb.toggleSlideshow;case De["Rotate image anticlockwise"]:return P.cb.rotateLeft;case De["Rotate image clockwise"]:return P.cb.rotateRight;case De["Download Gallery Image"]:return P.cb.download}})();return n?(e.stopPropagation(),e.preventDefault(),n()):void 0},open(e){if(e&&e.preventDefault(),this)return P.open(this)},image(e){return e.preventDefault(),e.stopPropagation(),P.build(this)},prev:()=>P.cb.open.call(P.images[+P.nodes.current.dataset.id-1]||P.images[P.images.length-1]),next:()=>P.cb.open.call(P.images[+P.nodes.current.dataset.id+1]||P.images[0]),click(e){if(!V.onControls(e))return e.preventDefault(),P.cb.advance()},advance:()=>!De.Autoplay&&P.nodes.current.paused?P.nodes.current.play():P.cb.next(),toggle:()=>(P.nodes?P.cb.close:P.build)(),blank(e){if(e.target===this)return P.cb.close()},toggleSlideshow:()=>P.cb[P.slideshow?"stop":"start"](),download:()=>Ve(".gal-name").click(),pause(){P.cb.stop();const{current:e}=P.nodes;if("VIDEO"===e.nodeName)return e[e.paused?"play":"pause"]()},start:()=>(Ve.addClass(P.nodes.buttons,"gal-playing"),P.slideshow=!0,P.setupTimer()),stop(){if(!P.slideshow)return;P.cleanupTimer();const{current:e}=P.nodes;return"VIDEO"===e.nodeName&&(e.loop=!0),Ve.rmClass(P.nodes.buttons,"gal-playing"),P.slideshow=!1},rotateLeft:()=>P.cb.rotate(270),rotateRight:()=>P.cb.rotate(90),rotate:Pe(100,function(e){const{current:t}=P.nodes;if("IFRAME"!==t.nodeName)return t.dataRotate=((t.dataRotate||0)+e)%360,t.style.transform=`rotate(${t.dataRotate}deg)`,P.cb.setHeight()}),close:()=>(Ve.off(P.nodes.current,"error",P.error),V.pause(P.nodes.current),Ve.rm(P.nodes.el),Ve.rmClass(Re,"gallery-open"),De["Fullscreen Gallery"]&&(Ve.off(Te,"fullscreenchange mozfullscreenchange webkitfullscreenchange",P.cb.close),Te.mozCancelFullScreen?.(),Te.webkitExitFullscreen?.()),delete P.nodes,delete P.fileIDs,Re.style.overflow="",Ve.off(Te,"keydown",P.cb.keybinds),De.Keybinds&&Ve.on(Te,"keydown",H.keydown),Ve.off(window,"resize",P.cb.setHeight),clearTimeout(P.timeoutID)),setFitness(){return(this.checked?Ve.addClass:Ve.rmClass)(Re,`gal-${this.name.toLowerCase().replace(/\s+/g,"-")}`)},setHeight:Pe(100,function(){let e,t,n;const{current:o,frame:a}=P.nodes,{style:i}=o;if(De["Stretch to Fit"]&&(e=Ee.posts.get(o.dataset.post)?.files[+o.dataset.file].dimensions)){const[t,s]=e.split("x");let r=a.clientWidth,l=Re.clientHeight-25;(o.dataRotate||0)%180==90&&([r,l]=[l,r]),n=Math.min(l,s/t*r),i.minHeight=n+"px",i.minWidth=t/s*n+"px"}else i.minHeight=i.minWidth="";return(o.dataRotate||0)%180==90?(i.maxWidth=De["Fit Height"]?Re.clientHeight-25+"px":"none",i.maxHeight=De["Fit Width"]?`${a.clientWidth}px`:"none",t=(o.clientWidth-o.clientHeight)/2,i.margin=`${t}px ${-t}px`):i.maxWidth=i.maxHeight=i.margin=""}),setDelay(){return P.delay=+this.value}},menu:{init(){if(!P.enabled)return;const e=Ve.el("span",{textContent:"Gallery",className:"gallery-link"});return Y.menu.addEntry({el:e,order:105,subEntries:P.menu.createSubEntries()})},createSubEntry(e){const t=rt.checkbox(e,e),n=t.firstElementChild;return["Hide Thumbnails","Fit Width","Fit Height"].includes(e)&&Ve.on(n,"change",P.cb.setFitness),Ve.event("change",null,n),Ve.on(n,"change",Ve.cb.checked),["Hide Thumbnails","Fit Width","Fit Height","Stretch to Fit"].includes(e)&&Ve.on(n,"change",P.cb.setHeight),{el:t}},createSubEntries(){const e=["Hide Thumbnails","Fit Width","Fit Height","Stretch to Fit","Scroll to Post"].map(e=>P.menu.createSubEntry(e)),t=Ve.el("label",{innerHTML:'Slide Delay: <input type="number" name="Slide Delay" min="0" step="any" class="field">'}),n=t.firstElementChild;return n.value=P.delay,Ve.on(n,"change",P.cb.setDelay),Ve.on(n,"change",Ve.cb.value),e.push({el:t}),e}}},F={init(){if(["index","thread","archive"].includes(Ee.VIEW)&&De.Linkify)return De["Comment Expansion"]&&y.callbacks.push(this.node),Ne.Post.push({name:"Linkify",cb:this.node}),O.init()},node(){let e;if(this.isClone)return O.events(this);if(!F.regString.test(this.info.comment))return;for(e of Ge("a",this.nodes.comment))Ee.SITE.isLinkified?.(e)&&(Ve.addClass(e,"linkify"),o.useFaster&&o.fixLinks([e]),O.process(e,this));const t=F.process(this.nodes.comment);for(e of(o.useFaster&&o.fixLinks(t),t))O.process(e,this)},process(e){var t,n,o,a,i,s,r;let l;const d=/[^\s"]+/g,c=/[\s"]/,h=Ve.X(".//br|.//text()",e);let u=0;const p=[];for(;e=h.snapshotItem(u++);){var{data:g}=e;if(g&&"A"!==e.parentElement.nodeName)for(;t=d.exec(g);){var{index:f}=t;if(n=e,(l=f+(o=t[0]).length)===g.length)for(d.lastIndex=0;a=h.snapshotItem(u++);){if("BR"===a.nodeName||"P"===a.parentElement.nodeName&&!a.previousSibling){if((s=o.match(/(https?:\/\/)?([a-z\d-]+\.)*[a-z\d-]+$/i))&&(r=h.snapshotItem(u)?.data?.match(/^(\.[a-z\d-]+)*\//i))&&0===(s[0]+r[0]).search(F.regString))continue;break}if("A"===a.parentElement.nodeName&&!F.regString.test(o))break;if(n=a,({data:g}=a),i=c.exec(g)){o+=g.slice(0,i.index),d.lastIndex=l=i.index,u--;break}({length:l}=g),o+=g}if(F.regString.test(o)&&p.push(F.makeRange(e,n,f,l)),!d.lastIndex||e!==n)break}}for(u=p.length;u--;)p[u]=F.makeLink(p[u]);return p},regString:new RegExp('((https?|mailto|git|magnet|ftp|irc):([a-z\\d%/?])|([-a-z\\d]+[.])+(aero|asia|biz|cat|com|coop|dance|info|int|jobs|mobi|moe|museum|name|net|org|post|pro|tel|travel|xxx|xyz|edu|gov|mil|[a-z]{2})([:/]|(?![^\\s"]))|[\\d]{1,3}\\.[\\d]{1,3}\\.[\\d]{1,3}\\.[\\d]{1,3}|[-\\w\\d.@]+@[a-z\\d.-]+\\.[a-z\\d])',"i"),makeRange(e,t,n,o){const a=document.createRange();return a.setStart(e,n),a.setEnd(t,o),a},makeLink(e){let t,n,o=e.toString(),a=o.search(F.regString);if(a>0){for(o=o.slice(a);e.startOffset+a>=e.startContainer.data.length;)a--;a&&e.setStart(e.startContainer,e.startOffset+a)}for(a=0;/[)\]}>.,]/.test(t=o.charAt(o.length-(1+a)))&&(/[.,]/.test(t)||o.match(/[()\[\]{}<>]/g).length%2);)a++;if(a){for(o=o.slice(0,-a);e.endOffset-a<0;)a--;a&&e.setEnd(e.endContainer,e.endOffset-a)}/((mailto|magnet):|.+:\/\/)/.test(o)||(o=(/@/.test(o)?"mailto:":"http://")+o),(n=o.match(/^(https?:\/\/[^/]*%[0-9a-f]{2})(.*)$/i))&&(o=n[1].replace(/%([0-9a-f]{2})/gi,function(e,t){return"25"===t?e:String.fromCharCode(parseInt(t,16))})+n[2]);const i=Ve.el("a",{className:"linkify",rel:"noreferrer noopener",target:"_blank",href:o});return Ve.add(i,e.extractContents()),e.insertNode(i),i}},$={init(){["index","thread","archive"].includes(Ee.VIEW)&&De["Time Formatting"]&&Ne.Post.push({name:"Time Formatting",cb:this.node})},node(){if(!this.info.date||this.isClone)return;const{textContent:e}=this.nodes.date;this.nodes.date.textContent=e.match(/^\s*/)[0]+$.format(this.info.date)+e.match(/\s*$/)[0]},format:(e,t=De.time)=>t.replace(/%(.)/g,function(t,n){return Ve.hasOwn($.formatters,n)?$.formatters[n].call(e):t}),zeroPad:e=>e<10?`0${e}`:e,formatterCache:new Map,formatters:{a(){let e=$.formatterCache.get("a");return e||(e=Intl.DateTimeFormat(De.timeLocale||void 0,{weekday:"short"}),$.formatterCache.set("a",e)),e.format(this)},A(){let e=$.formatterCache.get("A");return e||(e=Intl.DateTimeFormat(De.timeLocale||void 0,{weekday:"long"}),$.formatterCache.set("A",e)),e.format(this)},b(){let e=$.formatterCache.get("b");return e||(e=Intl.DateTimeFormat(De.timeLocale||void 0,{month:"short"}),$.formatterCache.set("b",e)),e.format(this)},B(){let e=$.formatterCache.get("B");return e||(e=Intl.DateTimeFormat(De.timeLocale||void 0,{month:"long"}),$.formatterCache.set("B",e)),e.format(this)},d(){return $.zeroPad(this.getDate())},e(){return this.getDate()},H(){return $.zeroPad(this.getHours())},I(){return $.zeroPad(this.getHours()%12||12)},k(){return this.getHours()},l(){return this.getHours()%12||12},m(){return $.zeroPad(this.getMonth()+1)},n(){return this.getMonth()+1},M(){return $.zeroPad(this.getMinutes())},p(){let e=$.formatterCache.get("p");return e||(e=Intl.DateTimeFormat(De.timeLocale||void 0,{hour:"numeric",hour12:!0}),$.formatterCache.set("p",e)),e.formatToParts(this).find(e=>"dayPeriod"===e.type).value},P(){return $.formatters.p.call(this).toLowerCase()},S(){return $.zeroPad(this.getSeconds())},y(){return this.getFullYear().toString().slice(2)},Y(){return this.getFullYear()},"%":()=>"%"}},O={init(){if(["index","thread","archive"].includes(Ee.VIEW)&&De.Linkify&&(De.Embedding||De["Link Title"]||De["Cover Preview"])){for(var e of(this.types=Fe(),this.ordered_types))this.types[e.key]=e;De.Embedding&&"archive"!==Ee.VIEW&&(this.dialog=rt.dialog("embedding",{innerHTML:'<div class="move">\n  <a href="javascript:;" class="jump" title="Jump to post">â†’</a>\n  <a href="javascript:;" class="close" title="Close">Ã—</a>\n</div>\n<div id="media-embed"><div></div></div>'}),this.media=Ve("#media-embed",this.dialog),Ve.one(Te,"4chanXInitFinished",this.ready),Ve.on(Te,"IndexRefreshInternal",()=>Ee.posts.forEach(function(e){for(e of[e,...e.clones])for(var t of e.nodes.embedlinks)O.cb.catalogRemove.call(t)}))),O.shouldFetchTitles()&&Ve.on(Te,"4chanXInitFinished PostsInserted",function(){for(const e of Object.values(O.types))e.title?.batchSize&&O.flushTitles(e.title)})}},events(e){let t,n,o;if("archive"!==Ee.VIEW){if(De.Embedding)for(n=0,o=e.nodes.embedlinks=Ge(".embedder",e.nodes.comment);t=o[n++];)Ve.on(t,"click",O.cb.click),Ve.hasClass(t,"embedded")&&O.cb.toggle.call(t);if(De["Cover Preview"])for(n=0,o=Ge(".linkify",e.nodes.comment);t=o[n++];){var a;(a=O.services(t))&&O.preview(a)}}},process(e,t){let n;if((De.Embedding||De["Link Title"]||De["Cover Preview"])&&!Ve.x("ancestor::pre",e))return(n=O.services(e))&&(n.post=t,De.Embedding&&"archive"!==Ee.VIEW&&O.embed(n),O.shouldFetchTitles()&&O.title(n),De["Cover Preview"]&&"archive"!==Ee.VIEW)?O.preview(n):void 0},services(e){var t,n;const{href:o}=e;for(t of O.ordered_types)if(n=t.regExp.exec(o))return{key:t.key,uid:n[1],options:n[2],link:e}},embed(e){var t,n;const{key:o,uid:a,options:i,link:s,post:r}=e,{href:l}=s;Ve.addClass(s,o.toLowerCase());const d=Ve.el("a",{className:"embedder",href:"javascript:;"},{innerHTML:"(<span>un</span>embed)"}),c={key:o,uid:a,options:i,href:l};for(t in c)n=c[t],d.dataset[t]=n;if(Ve.on(d,"click",O.cb.click),Ve.after(s,[Ve.tn(" "),d]),r.nodes.embedlinks.push(d),De["Auto-embed"]&&!De["Floating Embeds"]&&!r.isFetchedQuote)return Ve.hasClass(Re,"catalog-mode")?Ve.addClass(d,"embed-removed"):O.cb.toggle.call(d)},ready(){if(!ke.isThisPageLegit())return;Ve.addClass(O.dialog,"empty");const e=Ve(".close",O.dialog),t=Ve(".jump",O.dialog);return Ve.on(e,"click",O.closeFloat),Ve.on(Ve(".move",O.dialog),"mousedown",O.dragEmbed),Ve.on(t,"click",function(){if(Re.contains(O.lastEmbed))return Y.scrollTo(O.lastEmbed)}),a.set(t,"arrowRightLong"),a.set(e,"xmark"),Ve.add(Te.body,O.dialog)},closeFloat:()=>(delete O.lastEmbed,Ve.addClass(O.dialog,"empty"),Ve.replace(O.media.firstChild,Ve.el("div"))),dragEmbed(){const{style:e}=O.media;return O.dragEmbed.mouseup?(Ve.off(Te,"mouseup",O.dragEmbed),O.dragEmbed.mouseup=!1,void(e.pointerEvents="")):(Ve.on(Te,"mouseup",O.dragEmbed),O.dragEmbed.mouseup=!0,e.pointerEvents="none")},title(e){let t;const{key:n,uid:o,options:a,link:i,post:s}=e;if(t=O.types[n].title)return Ve.addClass(i,n.toLowerCase()),t.batchSize?((t.queue||(t.queue=[])).push(e),t.queue.length>=t.batchSize?O.flushTitles(t):void 0):U.cache(t.api(o),function(){return O.cb.title(this,e)})},flushTitles(e){let t;const{queue:n}=e;if(n?.length)return e.queue=[],U.cache(e.api(n.map(e=>e.uid)),function(){for(t of n)O.cb.title(this,t)})},preview(e){let t;const{key:n,uid:o,link:a}=e;if(t=O.types[n].preview)return Ve.on(a,"mouseover",function(e){const n=t.url(o),{height:i}=t,s=Ve.el("img",{src:n,id:"ihover"});return s.setAttribute("referrerpolicy","no-referrer"),Ve.add(Y.hover,s),rt.hover({root:a,el:s,latestEvent:e,endEvents:"mouseout click",height:i})})},cb:{click(e){if(e.preventDefault(),Ve.hasClass(this,"embedded")||!De["Floating Embeds"]&&!Ve.hasClass(Re,"catalog-mode"))return O.cb.toggle.call(this);{let e;if(!(e=O.media.firstChild))return;return Ve.replace(e,O.cb.embed(this)),O.lastEmbed=n.postFromNode(this).nodes.root,Ve.rmClass(O.dialog,"empty")}},toggle(){return Ve.hasClass(this,"embedded")?Ve.rm(this.nextElementSibling):Ve.after(this,O.cb.embed(this)),Ve.toggleClass(this,"embedded")},embed(e){let t,n;const o=Ve.el("div",{className:"media-embed"});return Ve.add(o,t=(n=O.types[e.dataset.key]).el(e)),t.style.cssText=null!=n.style?n.style:"border: none; width: 640px; height: 360px;",o},catalogRemove(){const e=Ve.hasClass(Re,"catalog-mode");if(e&&Ve.hasClass(this,"embedded")||!e&&Ve.hasClass(this,"embed-removed"))return O.cb.toggle.call(this),Ve.toggleClass(this,"embed-removed")},title(e,t){var n,o;let a;const{key:i,uid:s,options:r,link:l,post:d}=t,c=O.types[i].title;let{status:h}=e;if([200,304].includes(h)&&c.status&&(h=c.status(e.response)[0]),h)for(n of(a=`[${i}] ${(()=>{switch(h){case 200:case 304:return a=c.text(e.response,s),"string"==typeof a?a:a=l.textContent;case 404:return"Not Found";case 403:case 401:return"Forbidden or Private";default:return`${h}'d`}})()}`,l.dataset.original=l.textContent,l.textContent=a,d.clones))for(o of Ge("a.linkify",n.nodes.comment))o.href===l.href&&(null==o.dataset.original&&(o.dataset.original=o.textContent),o.textContent=a)}},ordered_types:[{key:"audio",regExp:/^[^?#]+\.(?:mp3|m4a|oga|wav|flac)(?:[?#]|$)/i,style:"",el:e=>Ve.el("audio",{controls:!0,preload:"auto",src:e.dataset.href})},{key:"image",regExp:/^[^?#]+\.(?:gif|png|jpg|jpeg|bmp|webp)(?::\w+)?(?:[?#]|$)/i,style:"",el(e){const t=Se(e.dataset.href);return Ve.el("div",{innerHTML:`<a target="_blank" href="${t}"><img src="${t}" style="max-width: 80vw; max-height: 80vh;"></a>`})}},{key:"video",regExp:/^[^?#]+\.(?:og[gv]|webm|mp4)(?:[?#]|$)/i,style:"max-width: 80vw; max-height: 80vh;",el(e){const t=Ve.el("video",{hidden:!0,controls:!0,preload:"auto",src:e.dataset.href,loop:o.test(e.dataset.href.split("/")[2])});return Ve.on(t,"loadedmetadata",function(){return 0===t.videoHeight&&t.parentNode?Ve.replace(t,O.types.audio.el(e)):t.hidden=!1}),t}},{key:"PeerTube",regExp:/^(\w+:\/\/[^\/]+\/videos\/watch\/\w{8}-\w{4}-\w{4}-\w{4}-\w{12})(.*)/,el(e){let t;const n=(t=e.dataset.options.match(/[?&](start=\w+)/))?`?${t[1]}`:"",o=Ve.el("iframe",{src:e.dataset.uid.replace("/videos/watch/","/videos/embed/")+n});return o.setAttribute("allowfullscreen","true"),o}},{key:"BitChute",regExp:/^\w+:\/\/(?:www\.)?bitchute\.com\/video\/([\w\-]+)/,el(e){const t=Ve.el("iframe",{src:`https://www.bitchute.com/embed/${e.dataset.uid}/`});return t.setAttribute("allowfullscreen","true"),t}},{key:"Clyp",regExp:/^\w+:\/\/(?:www\.)?clyp\.it\/(\w{8})/,style:"border: 0; width: 640px; height: 160px;",el:e=>Ve.el("iframe",{src:`https://clyp.it/${e.dataset.uid}/widget`}),title:{api:e=>`https://api.clyp.it/oembed?url=https://clyp.it/${e}`,text:e=>e.title}},{key:"Dailymotion",regExp:/^\w+:\/\/(?:(?:www\.)?dailymotion\.com\/(?:embed\/)?video|dai\.ly)\/([A-Za-z0-9]+)[^?]*(.*)/,el(e){let t;const n=(t=e.dataset.options.match(/[?&](start=\d+)/))?`?${t[1]}`:"",o=Ve.el("iframe",{src:`//www.dailymotion.com/embed/video/${e.dataset.uid}${n}`});return o.setAttribute("allowfullscreen","true"),o},title:{api:e=>`https://api.dailymotion.com/video/${e}`,text:e=>e.title},preview:{url:e=>`https://www.dailymotion.com/thumbnail/video/${e}`,height:240}},{key:"Gfycat",regExp:/^\w+:\/\/(?:www\.)?gfycat\.com\/(?:iframe\/)?(\w+)/,el(e){const t=Ve.el("iframe",{src:`//gfycat.com/ifr/${e.dataset.uid}`});return t.setAttribute("allowfullscreen","true"),t}},{key:"Gist",regExp:/^\w+:\/\/gist\.github\.com\/[\w\-]+\/(\w+)/,style:"",el:function(){let e=0;return function(t){const n=Ve.el("pre",{hidden:!0,id:"gist-embed-"+e++});return U.cache(`https://api.github.com/gists/${t.dataset.uid}`,function(){return n.textContent=Object.values(this.response.files)[0].content,n.className="prettyprint",Ve.global("prettyPrint",{id:n.id}),n.hidden=!1}),n}}(),title:{api:e=>`https://api.github.com/gists/${e}`,text({files:e}){for(var t in e)if(e.hasOwnProperty(t))return t}}},{key:"InstallGentoo",regExp:/^\w+:\/\/paste\.installgentoo\.com\/view\/(?:raw\/|download\/|embed\/)?(\w+)/,el:e=>Ve.el("iframe",{src:`https://paste.installgentoo.com/view/embed/${e.dataset.uid}`})},{key:"LiveLeak",regExp:/^\w+:\/\/(?:\w+\.)?liveleak\.com\/.*\?.*[tif]=(\w+)/,el(e){const t=Ve.el("iframe",{src:`https://www.liveleak.com/e/${e.dataset.uid}`});return t.setAttribute("allowfullscreen","true"),t}},{key:"Loopvid",regExp:/^\w+:\/\/(?:www\.)?loopvid.appspot.com\/#?((?:pf|kd|lv|gd|gh|db|dx|nn|cp|wu|ig|ky|mf|m2|pc|1c|pi|ni|wl|ko|mm|ic|gc)\/[\w\-\/]+(?:,[\w\-\/]+)*|fc\/\w+\/\d+|https?:\/\/.+)/,style:"max-width: 80vw; max-height: 80vh;",el(e){var t,n,a,i;const s=Ve.el("video",{controls:!0,preload:"auto",loop:!0});if(/^http/.test(e.dataset.uid))return Ve.add(s,Ve.el("source",{src:e.dataset.uid})),s;const[r,l,d]=e.dataset.uid.match(/(\w+)\/(.*)/),c=(()=>{switch(l){case"gd":case"wu":case"fc":return[""];case"gc":return["giant","fat","zippy"];default:return[".webm",".mp4"]}})();for(t of d.split(","))for(n of c)for(i of(a=`${t}${n}`,(()=>{switch(l){case"pf":return[`https://kastden.org/_loopvid_media/pf/${a}`,`https://web.archive.org/web/2/http://a.pomf.se/${a}`];case"kd":return[`https://kastden.org/loopvid/${a}`];case"lv":return[`https://lv.kastden.org/${a}`];case"gd":return[`https://docs.google.com/uc?export=download&id=${a}`];case"gh":return[`https://googledrive.com/host/${a}`];case"db":return[`https://dl.dropboxusercontent.com/u/${a}`];case"dx":return[`https://dl.dropboxusercontent.com/${a}`];case"nn":return[`https://kastden.org/_loopvid_media/nn/${a}`];case"cp":return[`https://copy.com/${a}`];case"wu":return[`http://webmup.com/${a}/vid.webm`];case"ig":return[`https://i.imgur.com/${a}`];case"ky":return[`https://kastden.org/_loopvid_media/ky/${a}`];case"mf":return[`https://kastden.org/_loopvid_media/mf/${a}`,`https://web.archive.org/web/2/https://d.maxfile.ro/${a}`];case"m2":return[`https://kastden.org/_loopvid_media/m2/${a}`];case"pc":return[`https://kastden.org/_loopvid_media/pc/${a}`,`https://web.archive.org/web/2/http://a.pomf.cat/${a}`];case"1c":return[`http://b.1339.cf/${a}`];case"pi":return[`https://kastden.org/_loopvid_media/pi/${a}`,`https://web.archive.org/web/2/https://u.pomf.is/${a}`];case"ni":return[`https://kastden.org/_loopvid_media/ni/${a}`,`https://web.archive.org/web/2/https://u.nya.is/${a}`];case"wl":return[`http://webm.land/media/${a}`];case"ko":return[`https://kordy.kastden.org/loopvid/${a}`];case"mm":return[`https://kastden.org/_loopvid_media/mm/${a}`,`https://web.archive.org/web/2/https://my.mixtape.moe/${a}`];case"ic":return[`https://media.8ch.net/file_store/${a}`];case"fc":return[`//${o.host()}/${a}.webm`];case"gc":return[`https://${n}.gfycat.com/${t}.webm`]}})()))Ve.add(s,Ve.el("source",{src:i}));return s}},{key:"Openings.moe",regExp:/^\w+:\/\/openings.moe\/\?video=([^.&=]+)/,style:"width: 1280px; height: 720px; max-width: 80vw; max-height: 80vh;",el(e){const t=Ve.el("iframe",{src:`https://openings.moe/?video=${e.dataset.uid}`});return t.setAttribute("allowfullscreen","true"),t}},{key:"Pastebin",regExp:/^\w+:\/\/(?:\w+\.)?pastebin\.com\/(?!u\/)(?:[\w.]+(?:\/|\?i\=))?(\w+)/,el:e=>Ve.el("iframe",{src:`//pastebin.com/embed_iframe/${e.dataset.uid}`})},{key:"SoundCloud",regExp:/^\w+:\/\/(?:www\.)?(?:soundcloud\.com\/|snd\.sc\/)([\w\-\/]+)/,style:"border: 0; width: 500px; height: 400px;",el:e=>Ve.el("iframe",{src:`https://w.soundcloud.com/player/?visual=true&show_comments=false&url=https%3A%2F%2Fsoundcloud.com%2F${encodeURIComponent(e.dataset.uid)}`}),title:{api:e=>`${location.protocol}//soundcloud.com/oembed?format=json&url=https%3A%2F%2Fsoundcloud.com%2F${encodeURIComponent(e)}`,text:e=>e.title}},{key:"StrawPoll",regExp:/^\w+:\/\/(?:www\.)?strawpoll\.me\/(?:embed_\d+\/)?(\d+(?:\/r)?)/,style:"border: 0; width: 600px; height: 406px;",el:e=>Ve.el("iframe",{src:`https://www.strawpoll.me/embed_1/${e.dataset.uid}`})},{key:"Streamable",regExp:/^\w+:\/\/(?:www\.)?streamable\.com\/(\w+)/,el(e){const t=Ve.el("iframe",{src:`https://streamable.com/o/${e.dataset.uid}`});return t.setAttribute("allowfullscreen","true"),t},title:{api:e=>`https://api.streamable.com/oembed?url=https://streamable.com/${e}`,text:e=>e.title}},{key:"TwitchTV",regExp:/^\w+:\/\/(?:www\.|secure\.|clips\.|m\.)?twitch\.tv\/(\w[^#\&\?]*)/,el(e){let t,n=e.dataset.href.match(/^\w+:\/\/(?:(clips\.)|\w+\.)?twitch\.tv\/(?:\w+\/)?(clip\/)?(\w[^#\&\?]*)/);if(n[1]||n[2])t=`//clips.twitch.tv/embed?clip=${n[3]}&parent=${location.hostname}`;else{let o;n=e.dataset.uid.match(/(\w+)(?:\/(?:v\/)?(\d+))?/),t=`//player.twitch.tv/?${n[2]?`video=v${n[2]}`:`channel=${n[1]}`}&autoplay=false&parent=${location.hostname}`,(o=e.dataset.href.match(/\bt=(\w+)/))&&(t+=`&time=${o[1]}`)}const o=Ve.el("iframe",{src:t});return o.setAttribute("allowfullscreen","true"),o}},{key:"Twitter",regExp:/^\w+:\/\/(?:www\.|mobile\.)?(?:(?:(?:fx|vx)?twitter|(?:fixup|fixv)?x|twittpr|xcancel)\.com|nitter\.\w+.\w+)\/(\w+\/status\/\d+)/,style:"border: none; width: 550px; height: 250px; overflow: hidden; resize: both;",el(t){var n,o;if("tf"===De.XEmbedder){const e=Ve.el("iframe");return Ve.on(e,"load",function(){return this.contentWindow.postMessage({element:"t",query:"height"},"https://twitframe.com")}),n=function(t){if(t.source===e.contentWindow&&"https://twitframe.com"===t.origin)return Ve.off(window,"message",n),(o||e).style.height=+Ve.minmax(t.data.height,250,.8*Re.clientHeight)+"px"},Ve.on(window,"message",n),e.src=`https://twitframe.com/show?url=https://twitter.com/${t.dataset.uid}`,"gecko"===Ve.engine?(e.style.cssText="border: none; width: 100%; height: 100%;",o=Ve.el("div"),Ve.add(o,e),o):e}return function(t){const n=Ve.el("div",{innerHTML:'<blockquote class="twitter-tweet">Loading&hellip;</blockquote>'}),o=De.fxtLang?`/${De.fxtLang}`:"",i=+De.fxtMaxReplies;return U.cachePromise(`${De.fxtUrl}/${t.dataset.uid}${o}`).then(async t=>{function s(t){const n=[];let o=0;for(const a of t.matchAll(/(?:@|\#)\w+/g))n.push(t.slice(o,a.index),e("a",{href:`https://x.com/${a[0].startsWith("#")?"hashtag/":""}${a[0].slice(1)}`,target:"_blank",referrerpolicy:"no-referrer"},a[0])),o=a.index+a[0].length;return n.push(t.slice(o)),n}async function r(t,n){const i=function(t){return t.media?.all?.map(t=>{switch(t.type){case"photo":return e("div",{class:"fxt-media"},e("a",{href:t.url,target:"_blank",referrerpolicy:"no-referrer"},e("img",{src:t.url,alt:t.altText,width:t.width,height:t.height,referrerpolicy:"no-referrer"})));case"video":case"gif":return e("div",{class:"fxt-media"},e("video",{controls:!0,width:t.width,height:t.height,poster:t.thumbnail_url,preload:"meta"},e("source",{src:t.url,type:t.format})));default:console.warn(`FxTwitter media type ${t.type} not recognized`)}})||[]}(t),l=t?.quote?await async function(t){return e("div",{class:"fxt-quote_container"},await r(t,"quote"))}(t.quote):"",d=t?.poll?function(t){let n=0,o=-1;return t.poll.choices.forEach((e,t)=>{e.percentage>n&&(n=e.percentage,o=t)}),e("div",{class:"fxt-poll"},...t.poll.choices.map((t,n)=>e("div",{class:"fxt-choice "+(n===o?"highlight":"")},e("span",{class:"fxt-choice_label"},t.label),e("span",{class:"fxt-choice_percentage"},t.percentage,"%"),e("div",{class:"fxt-bar",style:`width: ${t.percentage}%`}))),e("div",{class:"total-votes"},t.poll.total_votes.toLocaleString()," votes"))}(t):"",c=function(e){return $.format(new Date(e.created_at))}(t),h=o?function(t){return t?.translation?.target_lang&&t?.translation?.source_lang!==t?.translation?.target_lang?e(We,null,e("hr",null),e("p",null,"Translated from ",t.translation.source_lang_en),e("p",{lang:t.translation.target_lang},...s(t.translation.text))):""}(t):"",u=t.community_note?function(t){const n=[];let o=0;if(t.entities)for(const a of t.entities)a.ref.url&&(o<a.fromIndex&&n.push(...s(t.text.slice(o,a.fromIndex))),n.push(e("a",{href:a.ref.url,target:"_blank",referrerpolicy:"no-referrer"},t.text.slice(a.fromIndex,a.toIndex))),o=a.toIndex);return o<t.text.length-1&&n.push(...s(t.text.slice(o))),e("div",{class:"fxt-community_note"},e("div",{class:"fxt-community_note-header"},"Community Note"),e("div",{class:"fxt-community_note-text"},...n))}(t.community_note):"";return e("article",{class:`fxt-card fxt-tweet-${n}`},function(t){return e("div",{class:"fxt-meta"},e("a",{class:"fxt-meta_profile",href:t.author.url,title:t.author.description,target:"_blank",referrerpolicy:"no-referrer"},e("div",{class:"fxt-meta_avatar"},e("img",{src:t.author.avatar_url,referrerpolicy:"no-referrer"})),e("div",{class:"fxt-meta_author"},e("span",{class:"fxt-meta_author_username"},t.author.name),e("span",{class:"fxt-meta_author_account"},"@",t.author.screen_name))),e("a",{href:t.url,title:"Open tweet in a new tab",target:"_blank",referrerpolicy:"no-referrer"},a.raw("link")))}(t),e("div",{class:"fxt-content"},e("div",{class:"fxt-text",lang:t.lang},...s(t.text),h),(i.length||d)&&e("div",{class:"fxt-media_container "+(t.media?.all?.length>1?"fxt-media-multiple":"")},d,...i),u,l),e("div",{class:"fxt-stats"},e("div",{class:"fxt-stats_time"},c),e("div",{class:"fxt-stats_meta"},e("span",{class:"fxt-likes"},a.raw("comment"),t.replies.toLocaleString()),e("span",{class:"fxt-reposts"},a.raw("shuffle"),t.retweets.toLocaleString()),e("span",{class:"fxt-replies"},a.raw("heart"),t.likes.toLocaleString()))))}if(404===t.status)return void(n.textContent="404: tweet not found");const{tweet:l}=t.response,d=await async function(t){const n=await r(t,"original"),o=t.replying_to?await async function(t){const n=[];let o=0;for(;t.replying_to&&t.replying_to_status&&o<i;){const a=`${De.fxtUrl}/${t.replying_to}/status/${t.replying_to_status}`;try{t=(await U.cachePromise(a)).response.tweet;const e=await r(t,"reply");n.unshift(e),o++}catch(n){console.error(`Error fetching/rendering reply tweet: ${n.message}`),console.log(t);const o=`${De.fxtUrl}/${t.replying_to}/status/${t.replying_to_status}`;return e("div",{class:"fxt-reply_container"},e("article",{class:"fxt-card fxt-tweet-reply"},e("div",{class:"fxt-content warning"},"Failed trying to load ",e("a",{href:o,target:"_blank",referrerpolicy:"no-referrer"},o),e("br",null),"This tweet has probably been deleted or removed.",e("br",null),"This also breaks the reply chain, so you may want to view the original tweet.")))}}return e("div",{class:"fxt-reply_container"},...n)}(t):"";return e(We,null,o,n)}(l);n.innerHTML=d.innerHTML;for(const e of n.getElementsByClassName("fxt-text"))F.process(e);n.style.resize=null,n.classList.add("fxt-card_container"),n.style.height=null,n.style.width=null,n.style.overflow=null}),n}(t)}},{key:"VidLii",regExp:/^\w+:\/\/(?:www\.)?vidlii\.com\/watch\?v=(\w{11})/,style:"border: none; width: 640px; height: 392px;",el(e){const t=Ve.el("iframe",{src:`https://www.vidlii.com/embed?v=${e.dataset.uid}&a=0`});return t.setAttribute("allowfullscreen","true"),t}},{key:"Vimeo",regExp:/^\w+:\/\/(?:www\.)?vimeo\.com\/(\d+)/,el(e){const t=Ve.el("iframe",{src:`//player.vimeo.com/video/${e.dataset.uid}?wmode=opaque`});return t.setAttribute("allowfullscreen","true"),t},title:{api:e=>`https://vimeo.com/api/oembed.json?url=https://vimeo.com/${e}`,text:e=>e.title}},{key:"Vine",regExp:/^\w+:\/\/(?:www\.)?vine\.co\/v\/(\w+)/,style:"border: none; width: 500px; height: 500px;",el:e=>Ve.el("iframe",{src:`https://vine.co/v/${e.dataset.uid}/card`})},{key:"Vocaroo",regExp:/^\w+:\/\/(?:(?:www\.|old\.)?vocaroo\.com|voca\.ro)\/((?:i\/)?\w+)/,style:"",el(e){const t=Ve.el("iframe");return t.width=300,t.height=60,t.setAttribute("frameborder",0),t.src=`https://vocaroo.com/embed/${e.dataset.uid.replace(/^i\//,"")}?autoplay=0`,t}},{key:"YouTube",regExp:/^\w+:\/\/(?:youtu.be\/|[\w.]*youtube[\w.]*\/.*(?:v=|\bembed\/|\bv\/|shorts\/|live\/|watch\/))([\w\-]{11})(.*)/,el(e){let t=e.dataset.options.match(/\b(?:star)?t\=(\w+)/);t&&(t=t[1]),t&&!/^\d+$/.test(t)&&(t+=" 0h0m0s",t=3600*t.match(/(\d+)h/)[1]+60*t.match(/(\d+)m/)[1]+1*t.match(/(\d+)s/)[1]);const n=Ve.el("iframe",{src:`//www.youtube.com/embed/${e.dataset.uid}?rel=0&wmode=opaque${t?"&start="+t:""}`});return n.setAttribute("allowfullscreen","true"),n},title:{api:e=>`https://www.youtube.com/oembed?url=https%3A//www.youtube.com/watch%3Fv%3D${e}&format=json`,text:e=>e.title,status(e){if(e.error){const t=e.error.match(/^(\d*)\s*(.*)/);return[+t[1],t[2]]}return[200,"OK"]}},preview:{url:e=>`https://img.youtube.com/vi/${e}/0.jpg`,height:360}}],shouldFetchTitles:()=>!(!De["Link Title"]||!De["Link Title in the catalog"]&&("catalog"===Ee.VIEW||"index"===Ee.VIEW&&"catalog"===De["Index Mode"]))},q={init(){var e,t;let n;if(this.audio=Ve.el("audio"),"gecko"!==Ve.engine&&(this.audio.src=this.beep),Ve.on(this.audio,"error",()=>{new It("error",this.audio.error.message||"Error when trying to play thread updater beep.",15)}),"thread"!==Ee.VIEW||!De["Thread Updater"])return;this.enabled=!0,De["Updater and Stats in Header"]?(this.dialog=n=Ve.el("span",{id:"updater"}),Ve.extend(n,{innerHTML:'<span id="update-status" class="empty"></span><span id="update-timer" class="empty" title="Update now"></span>'}),Y.addShortcut("updater",n,100)):(this.dialog=n=rt.dialog("updater",{innerHTML:'<div class="move"></div><span id="update-status" class="empty"></span><span id="update-timer" class="empty" title="Update now"></span>'}),Ve.addClass(Re,"float"),Ve.ready(()=>Ve.add(Te.body,n))),this.checkPostCount=0,this.timer=Ve("#update-timer",n),this.status=Ve("#update-status",n),Ve.on(this.timer,"click",this.update),Ve.on(this.status,"click",this.update);const o=Ve.el("span",{className:"brackets-wrap updatelink"});Ve.extend(o,{innerHTML:'<a href="javascript:;">Update</a>'}),ke.ready(function(){let e;if(e=Ve(".navLinksBot"))return Ve.add(e,[Ve.tn(" "),o])}),Ve.on(o.firstElementChild,"click",this.update);const a=[];for(const n in Me.updater.checkbox){e=Me.updater.checkbox[n];const o=rt.checkbox(n,n);o.title=e[1],t=o.firstElementChild,Ve.on(t,"change",Ve.cb.checked),"Scroll BG"===t.name?(Ve.on(t,"change",this.cb.scrollBG),this.cb.scrollBG()):"Auto Update"===t.name&&Ve.on(t,"change",this.setInterval),a.push({el:o})}return this.settings=Ve.el("span",{innerHTML:'<a href="javascript:;">Interval</a>'}),Ve.on(this.settings,"click",this.intervalShortcut),a.push({el:this.settings}),Y.menu.addEntry(this.entry={el:Ve.el("span",{textContent:"Updater"}),order:110,subEntries:a}),Ne.Thread.push({name:"Thread Updater",cb:this.node})},node(){return q.thread=this,q.root=this.nodes.root,q.outdateCount=0,q.postIDs=[],q.fileIDs=[],this.posts.forEach(function(e){if(q.postIDs.push(e.ID),e.file)return q.fileIDs.push(e.ID)}),q.cb.interval.call(Ve.el("input",{value:De.Interval})),Ve.on(Te,"QRPostSuccessful",q.cb.checkpost),Ve.on(Te,"visibilitychange",q.cb.visibility),q.setInterval()},beep:"data:audio/wav;base64,UklGRjQDAABXQVZFZm10IBAAAAABAAEAgD4AAIA+AAABAAgAc21wbDwAAABBAAADAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABkYXRhzAIAAGMms8em0tleMV4zIpLVo8nhfSlcPR102Ki+5JspVEkdVtKzs+K1NEhUIT7DwKrcy0g6WygsrM2k1NpiLl0zIY/WpMrjgCdbPhxw2Kq+5Z4qUkkdU9K1s+K5NkVTITzBwqnczko3WikrqM+l1NxlLF0zIIvXpsnjgydZPhxs2ay95aIrUEkdUdC3suK8N0NUIjq+xKrcz002WioppdGm091pK1w0IIjYp8jkhydXPxxq2K295aUrTkoeTs65suK+OUFUIzi7xqrb0VA0WSoootKm0t5tKlo1H4TYqMfkiydWQBxm16+85actTEseS8y7seHAPD9TIza5yKra01QyWSson9On0d5wKVk2H4DYqcfkjidUQB1j1rG75KsvSkseScu8seDCPz1TJDW2yara1FYxWSwnm9Sn0N9zKVg2H33ZqsXkkihSQR1g1bK65K0wSEsfR8i+seDEQTxUJTOzy6rY1VowWC0mmNWoz993KVc3H3rYq8TklSlRQh1d1LS647AyR0wgRMbAsN/GRDpTJTKwzKrX1l4vVy4lldWpzt97KVY4IXbUr8LZljVPRCxhw7W3z6ZISkw1VK+4sMWvXEhSPk6buay9sm5JVkZNiLWqtrJ+TldNTnquqbCwilZXU1BwpKirrpNgWFhTaZmnpquZbFlbVmWOpaOonHZcXlljhaGhpZ1+YWBdYn2cn6GdhmdhYGN3lp2enIttY2Jjco+bnJuOdGZlZXCImJqakHpoZ2Zug5WYmZJ/bGlobX6RlpeSg3BqaW16jZSVkoZ0bGtteImSk5KIeG5tbnaFkJKRinxxbm91gY2QkIt/c3BwdH6Kj4+LgnZxcXR8iI2OjIR5c3J0e4WLjYuFe3VzdHmCioyLhn52dHR5gIiKioeAeHV1eH+GiYqHgXp2dnh9hIiJh4J8eHd4fIKHiIeDfXl4eHyBhoeHhH96eHmA",playBeep(e=!0){const{audio:t}=q,n=De.beepSource||q.beep;t.src!==n&&(t.src=n),t.volume=Math.max(.01,Math.min(+De.beepVolume,1)),t.paused?t.play():e&&Ve.one(t,"ended",q.playBeep)},cb:{checkpost(e){if(e.detail.threadID===q.thread.ID)return q.postID=e.detail.postID,q.checkPostCount=0,q.outdateCount=0,q.setInterval()},visibility(){if(!Te.hidden)return q.outdateCount=0,q.seconds>q.interval?q.setInterval():void 0},scrollBG:()=>q.scrollBG=De["Scroll BG"]?()=>!0:()=>!Te.hidden,interval(e){let t=parseInt(this.value,10);if(t<1&&(t=1),q.interval=this.value=t,e)return Ve.cb.value.call(this)},load(){if(this===q.req)switch(this.status){case 200:return q.parse(this),q.thread.isArchived?q.kill():q.setInterval();case 404:return Ve.ajax(Ee.SITE.urls.catalogJSON({boardID:q.thread.board.ID}),{onloadend(){var e,t;let n;if(200===this.status){for(e of(n=!0,this.response))for(t of e.threads)if(t.no===q.thread.ID){n=!1;break}}else n=!1;n?q.kill():q.error(this)}});default:return q.error(this)}}},kill:()=>(q.thread.kill(),q.setInterval(),Ve.event("ThreadUpdate",{404:!0,threadID:q.thread.fullID})),error:e=>(304===e.status&&q.set("status",""),q.setInterval(),e.status?304!==e.status?q.set("status",`${e.statusText} (${e.status})`,"warning"):void 0:q.set("status","Connection Error","warning")),setInterval(){if(clearTimeout(q.timeoutID),q.thread.isDead)return q.set("status",q.thread.isArchived?"Archived":"404","warning"),void q.set("timer","");if(q.postID&&q.checkPostCount<5)return q.set("timer","...","loading"),void(q.timeoutID=setTimeout(q.update,++q.checkPostCount*$e));if(!De["Auto Update"])return void q.set("timer","Update");const{interval:e}=q;if(De["Optional Increase"]){const t=Te.hidden?10:5,n=Math.min(q.outdateCount,t),o=(Math.floor(.1*e)||1)*n*n;q.seconds=Ve.minmax(o,e,300)}else q.seconds=e;return q.timeout()},intervalShortcut(){W.open("Advanced");const e=Ve.id("fourchanx-settings");return Ve("input[name=Interval]",e).focus()},set(e,t,n){let o;const a=q[e];return(o=a.firstChild)?o.data=t:a.textContent=t,a.className=n??(""===t?"empty":"")},timeout:()=>(q.seconds?(q.set("timer",q.seconds),q.timeoutID=setTimeout(q.timeout,1e3)):(q.outdateCount++,q.update()),q.seconds--),update(){let e;return clearTimeout(q.timeoutID),q.set("timer","...","loading"),(e=q.req)&&(delete q.req,e.abort()),q.req=Ve.whenModified(Ee.SITE.urls.threadJSON({boardID:q.thread.board.ID,threadID:q.thread.ID}),"ThreadUpdater",q.cb.load,{timeout:Oe})},updateThreadStatus(e,t){if(q.thread[`is${e}`]!==t&&(q.thread.setStatus(e,t),"Closed"!==e||!q.thread.isArchived))return new It("info",`The thread is ${"Sticky"===e?t?"now a sticky":"not a sticky anymore":t?"now closed":"not closed anymore"}.`,30)},parse(e){var t,n;let o,a,i;const s=e.response.posts,r=s[0],l=q.thread,{board:d}=l,c=q.postIDs[q.postIDs.length-1];if(s[s.length-1].no<c&&new Date(e.getResponseHeader("Last-Modified"))-l.posts.get(c).info.date<3e4)return;Ee.SITE.Build.spoilerRange[d]=r.custom_spoiler,l.setStatus("Archived",!!r.archived),q.updateThreadStatus("Sticky",!!r.sticky),q.updateThreadStatus("Closed",!!r.closed),l.postLimit=!!r.bumplimit,l.fileLimit=!!r.imagelimit,r.unique_ips&&(l.ipCount=r.unique_ips);const h=[],u=[],p=[],g=[];for(t of s)o=t.no,u.push(o),t.fsize&&p.push(o),o<=c||(!(i=l.posts.get(o))||i.isFetchedQuote?(g.push(`${d}.${o}`),n=Ee.SITE.Build.postFromObject(t,d.ID),h.push(new dt(n,l,d)),q.postID===o&&delete q.postID):i.resurrect());const f=[];for(o of q.postIDs)u.includes(o)||(l.posts.get(o).kill(),f.push(`${d}.${o}`));q.postIDs=u;const m=[];for(o of q.fileIDs)p.includes(o)||f.includes(`${d}.${o}`)||(l.posts.get(o).kill(!0),m.push(`${d}.${o}`));if(q.fileIDs=p,h.length){q.set("status",`+${h.length}`,"new"),q.outdateCount=0;const e=I.posts?.size,t=I.postsQuotingYou?.size;ke.callbackNodes("Post",h),!Te.hidden&&Te.hasFocus()||(De["Beep Quoting You"]&&I.postsQuotingYou?.size>t?(q.playBeep(),De.Beep&&q.playBeep()):De.Beep&&I.posts?.size>0&&0===e&&q.playBeep());const n=De["Auto Scroll"]&&q.scrollBG()&&q.root.getBoundingClientRect().bottom-Re.clientHeight<25;let o=null;for(i of h)T.insert(i)||(o||(o=i.nodes.root),Ve.add(q.root,i.nodes.root));Ve.event("PostsInserted",null,q.root),n&&(De["Bottom Scroll"]?window.scrollTo(0,Te.body.clientHeight):o&&Y.scrollTo(o))}else q.set("status","");return r.unique_ips&&(a=Ve.id("unique-ips"))&&(a.textContent=r.unique_ips,a.previousSibling.textContent=a.previousSibling.textContent.replace(/\b(?:is|are)\b/,1===r.unique_ips?"is":"are"),a.nextSibling.textContent=a.nextSibling.textContent.replace(/\bposters?\b/,1===r.unique_ips?"poster":"posters")),Ve.event("ThreadUpdate",{404:!1,threadID:l.fullID,newPosts:g,deletedPosts:f,deletedFiles:m,postCount:r.replies+1,fileCount:r.images+!!r.fsize,ipCount:r.unique_ips})}},H={init(){var e,t;if(De.Keybinds){for(e in Me.hotkeys)Ve.sync(e,H.sync);return t=function(){for(var e of(Ve.off(Te,"4chanXInitFinished",t),Ve.on(Te,"keydown",H.keydown),Ge("[accesskey]")))e.removeAttribute("accesskey")},Ve.on(Te,"4chanXInitFinished",t)}},sync:(e,t)=>De[t]=e,keydown(e){var t,o,a;let i,s,r,l,d;if(!(i=H.keyCode(e)))return;const{target:c}=e;if(["INPUT","TEXTAREA"].includes(c.nodeName)&&(!/(Esc|Alt|Ctrl|Meta|Shift\+\w{2,})/.test(i)||/^Alt\+(\d|Up|Down|Left|Right)$/.test(i)))return;["index","thread"].includes(Ee.VIEW)&&(r=g.getThread(),s=n.threadFromRoot(r));let h=!1;if(i===De["Toggle board list"]&&De["Custom Board Navigation"]&&(Y.toggleBoardList(),h=!0),i===De["Toggle header"]&&(Y.toggleBarVisibility(),h=!0),i===De["Open empty QR"]&&j.postingIsEnabled&&(H.qr(),h=!0),i===De["Open QR"]&&j.postingIsEnabled&&r&&(H.qr(r),h=!0),i===De["Open settings"]&&(W.open(),h=!0),i===De.Close){if(W.dialog)W.close();else if((d=Ge(".notification")).length)for(t of d)Ve(".close",t).click();else j.nodes?.preview?j.closePreview():j.nodes&&!j.nodes.el.hidden&&"none"!==window.getComputedStyle(j.nodes.form).display?De["Persistent QR"]?j.hide():j.close():O.lastEmbed&&O.closeFloat();h=!0}if(i===De["Spoiler tags"]&&"TEXTAREA"===c.nodeName&&(H.tags("spoiler",c),h=!0),i===De["Code tags"]&&"TEXTAREA"===c.nodeName&&(H.tags("code",c),h=!0),i===De["Eqn tags"]&&"TEXTAREA"===c.nodeName&&(H.tags("eqn",c),h=!0),i===De["Math tags"]&&"TEXTAREA"===c.nodeName&&(H.tags("math",c),h=!0),i===De["SJIS tags"]&&"TEXTAREA"===c.nodeName&&(H.tags("sjis",c),h=!0),i===De["Toggle sage"]&&j.nodes&&!j.nodes.el.hidden&&(H.sage(),h=!0),i===De["Toggle Cooldown"]&&j.nodes&&!j.nodes.el.hidden&&Ve.hasClass(j.nodes.fileSubmit,"custom-cooldown")&&(j.toggleCustomCooldown(),h=!0),i===De["Post from URL"]&&j.postingIsEnabled&&(j.handleUrl(""),h=!0),i===De["Add new post"]&&j.postingIsEnabled&&(j.addPost(),h=!0),i!==De["Submit QR"]||!j.nodes||j.nodes.el.hidden||j.status()||(j.submit(),h=!0),i===De.Update)switch(Ee.VIEW){case"thread":q.enabled&&q.update(),h=!0;break;case"index":B.enabled&&B.update(),h=!0}if(i===De.Watch&&E.enabled&&s&&(E.toggle(s),h=!0),i===De["Update thread watcher"]&&E.enabled&&(E.buttonFetchAll(),h=!0),i===De["Toggle thread watcher"]&&E.enabled&&(E.toggleWatcher(),h=!0),i===De["Toggle threading"]&&T.ready&&(T.toggleThreading(),h=!0),i===De["Mark thread read"]&&"index"===Ee.VIEW&&s&&D.enabled&&(D.markRead.call(r),h=!0),i===De["Expand image"]&&m.enabled&&r&&(o=n.postFromNode(H.post(r))).file&&(m.toggle(o),h=!0),i===De["Expand images"]&&m.enabled&&(m.cb.toggleAll(),h=!0),i===De["Open Gallery"]&&P.enabled&&(P.cb.toggle(),h=!0),i===De.fappeTyme&&N.nodes?.fappe&&(N.toggle("fappe"),h=!0),i===De.werkTyme&&N.nodes?.werk&&(N.toggle("werk"),h=!0),i===De["Front page"]&&(B.enabled?B.userPageNav(1):location.href=`/${Ee.BOARD}/`,h=!0),i===De["Open front page"]&&(Ve.open(`${location.origin}/${Ee.BOARD}/`),h=!0),i===De["Next page"]&&"index"===Ee.VIEW&&!Ee.SITE.isOnePage?.(Ee.BOARD)){if(B.enabled){if(!["paged","infinite"].includes(De["Index Mode"]))return;Ve(".next button",B.pagelist).click()}else Ve(Ee.SITE.selectors.nav.next)?.click();h=!0}if(i===De["Previous page"]&&"index"===Ee.VIEW&&!Ee.SITE.isOnePage?.(Ee.BOARD)){if(B.enabled){if(!["paged","infinite"].includes(De["Index Mode"]))return;Ve(".prev button",B.pagelist).click()}else Ve(Ee.SITE.selectors.nav.prev)?.click();h=!0}i===De["Search form"]&&"index"===Ee.VIEW&&(a=B.enabled?B.searchInput:Ee.SITE.selectors.searchBox?Ve(Ee.SITE.selectors.searchBox):void 0)&&(Y.scrollToIfNeeded(a),a.focus(),h=!0),i===De["Paged mode"]&&B.enabledOn(Ee.BOARD)&&(location.href="index"===Ee.VIEW?"#paged":`/${Ee.BOARD}/#paged`),i===De["Infinite scrolling mode"]&&B.enabledOn(Ee.BOARD)&&(location.href="index"===Ee.VIEW?"#infinite":`/${Ee.BOARD}/#infinite`),i===De["All pages mode"]&&B.enabledOn(Ee.BOARD)&&(location.href="index"===Ee.VIEW?"#all-pages":`/${Ee.BOARD}/#all-pages`),i===De["Open catalog"]&&(l=G.catalog())&&(location.href=l),i===De["Cycle sort type"]&&B.enabled&&(B.cycleSortType(),h=!0),i===De["Next thread"]&&"index"===Ee.VIEW&&r&&(g.scroll(1),h=!0),i===De["Previous thread"]&&"index"===Ee.VIEW&&r&&(g.scroll(-1),h=!0),i===De["Expand thread"]&&"index"===Ee.VIEW&&r&&(C.toggle(s),Y.scrollTo(r),h=!0),i===De["Open thread"]&&"index"===Ee.VIEW&&r&&(H.open(s),h=!0),i===De["Open thread tab"]&&"index"===Ee.VIEW&&r&&(H.open(s,!0),h=!0),i===De["Next reply"]&&r&&(H.hl(1,r),h=!0),i===De["Previous reply"]&&r&&(H.hl(-1,r),h=!0),i===De["Deselect reply"]&&r&&(H.hl(0,r),h=!0),i===De.Hide&&s&&L.db&&(Y.scrollTo(r),L.toggle(s),h=!0),i===De["Quick Filter MD5"]&&r&&(o=H.post(r),H.hl(1,r),J.quickFilterMD5.call(o,e),h=!0),i===De["Previous Post Quoting You"]&&r&&k.db&&(k.cb.seek("preceding"),h=!0),i===De["Next Post Quoting You"]&&r&&k.db&&(k.cb.seek("following"),h=!0),h&&(e.preventDefault(),e.stopPropagation())},keyCode(e){let t=(()=>{let t;switch(t=e.keyCode){case 8:return"";case 13:return"Enter";case 27:return"Esc";case 32:return"Space";case 37:return"Left";case 38:return"Up";case 39:return"Right";case 40:return"Down";case 188:return"Comma";case 190:return"Period";case 191:return"Slash";case 59:case 186:return"Semicolon";default:return 48<=t&&t<=57||65<=t&&t<=90?String.fromCharCode(t).toLowerCase():96<=t&&t<=105?String.fromCharCode(t-48):null}})();return t&&(e.altKey&&(t="Alt+"+t),e.ctrlKey&&(t="Ctrl+"+t),e.metaKey&&(t="Meta+"+t),e.shiftKey&&(t="Shift+"+t)),t},post(e){const t=Ee.SITE.selectors;return Ve(`${t.postContainer}${t.highlightable.reply}.${Ee.SITE.classes.highlight}`,e)||Ve(`${Ee.SITE.isOPContainerThread?t.thread:t.postContainer}${t.highlightable.op}`,e)},qr:e=>(j.open(),null!=e&&j.quote.call(H.post(e)),j.nodes.com.focus()),tags(e,t){b.ready(function(){const{config:t}=Ee.BOARD;if(!(()=>{switch(e){case"spoiler":return!!t.spoilers;case"code":return!!t.code_tags;case"math":case"eqn":return!!t.math_tags;case"sjis":return!!t.sjis_tags}})())return new It("warning",`[${e}] tags are not supported on /${Ee.BOARD}/.`,20)});const{value:n}=t,o=t.selectionStart,a=t.selectionEnd;t.value=n.slice(0,o)+`[${e}]`+n.slice(o,a)+`[/${e}]`+n.slice(a);const i=`[${e}]`.length+a;return t.setSelectionRange(i,i),Ve.event("input",null,t)},sage(){const e=/sage/i.test(j.nodes.email.value);return j.nodes.email.value=e?"":"sage"},open(e,t){if("index"!==Ee.VIEW)return;const o=n.url("thread",e);return t?Ve.open(o):location.href=o},hl(e,t){const o=`${Ee.SITE.selectors.postContainer}${Ee.SITE.selectors.highlightable.reply}`,{highlight:a}=Ee.SITE.classes,i=Ve(`${o}.${a}`,t);if(!e)return void(i&&Ve.rmClass(i,a));if(i){const{height:t}=i.getBoundingClientRect();if(Y.getTopOf(i)>=-t&&Y.getBottomOf(i)>=-t){let t;const{root:s}=n.postFromNode(i).nodes;if(!(t=Ve.x(`${1===e?"following":"preceding"}-sibling::${Ee.SITE.xpath.replyContainer}[not(@hidden) and not(child::div[@class='stub'])][1]`,s)))return;return t.matches(o)||(t=Ve(o,t)),Y.scrollToIfNeeded(t,1===e),Ve.addClass(t,a),void Ve.rmClass(i,a)}Ve.rmClass(i,a)}const s=Ge(o,t);for(var r of(-1===e&&s.reverse(),s))if(1===e&&Y.getTopOf(r)>0||-1===e&&Y.getBottomOf(r)>0)return void Ve.addClass(r,a)}};const bt={cache:{init(){return Ve.on(Te,"SaveCaptcha",e=>this.saveAPI(e.detail)),Ve.on(Te,"NoCaptcha",e=>this.noCaptcha(e.detail))},captchas:[],getCount(){return this.captchas.length},neededRaw(){return!(this.haveCookie()||this.captchas.length||j.req||this.submitCB)&&(j.posts.length>1||De["Auto-load captcha"]||!j.posts[0].isOnlyQuotes()||j.posts[0].file)},needed(){return this.neededRaw()&&Ve.event("LoadCaptcha")},haveCookie:()=>/\b_ct=/.test(Te.cookie)&&"new"!==j.posts[0].thread,getOne(){let e;return delete this.prerequested,this.clear(),(e=this.captchas.shift())?(this.count(),e):null},request(e){if(this.submitCB||!Ve.event("RequestCaptcha",{isReply:e}))return e=>(this.submitCB=e,this.updateCount())},abort(){if(this.submitCB)return delete this.submitCB,Ve.event("AbortCaptcha"),this.updateCount()},saveAPI(e){let t;return(t=this.submitCB)?(delete this.submitCB,t(e),this.updateCount()):this.save(e)},noCaptcha(e){let t;if(t=this.submitCB)return this.haveCookie()&&!e?.error||(j.error(e?.error||"Failed to retrieve captcha."),j.captcha.setup(Te.activeElement===j.nodes.status)),delete this.submitCB,t(),this.updateCount()},save(e){let t;return(t=this.submitCB)?(this.abort(),void t(e)):(this.captchas.push(e),this.captchas.sort((e,t)=>e.timeout-t.timeout),this.count())},clear(){if(this.captchas.length){let e;const t=Date.now();for(e=0;e<this.captchas.length&&!(this.captchas[e].timeout>t);e++);if(e)return this.captchas=this.captchas.slice(e),this.count()}},count(){return clearTimeout(this.timer),this.captchas.length&&(this.timer=setTimeout(this.clear.bind(this),this.captchas[0].timeout-Date.now())),this.updateCount()},updateCount(){return Ve.event("CaptchaCount",this.captchas.length)}},replace:et,t:tt,v2:{lifetime:12e4,init(){if(Te.cookie.indexOf("pass_enabled=1")>=0)return;if(!(this.isEnabled=!!Ve("#g-recaptcha, #captcha-forced-noscript")||!Ve.id("postForm")))return;(this.noscript=De["Force Noscript Captcha"]||!ke.jsEnabled)&&Ve.addClass(j.nodes.el,"noscript-captcha"),bt.cache.init(),Ve.on(Te,"CaptchaCount",this.count.bind(this));const e=Ve.el("div",{className:"captcha-root"});Ve.extend(e,{innerHTML:'<div class="captcha-counter"><a href="javascript:;"></a></div>'});const t=Ve(".captcha-counter > a",e);return this.nodes={root:e,counter:t},this.count(),Ve.addClass(j.nodes.el,"has-captcha","captcha-v2"),Ve.after(j.nodes.com.parentNode,e),Ve.on(t,"click",this.toggle.bind(this)),Ve.on(t,"keydown",e=>{if("Space"===H.keyCode(e))return this.toggle(),e.preventDefault(),e.stopPropagation()}),Ve.on(window,"captcha:success",()=>Ve.queueTask(()=>this.save(!1)))},timeouts:{},prevNeeded:0,noscriptURL(){let e,t=`https://www.google.com/recaptcha/api/fallback?k=${Ce.recaptchaKey}`;return(e=De.captchaLanguage.trim())&&(t+=`&hl=${encodeURIComponent(e)}`),t},moreNeeded(){return Ve.queueTask(()=>{const e=bt.cache.needed();return e&&!this.prevNeeded&&this.setup(j.cooldown.auto&&Te.activeElement===j.nodes.status),this.prevNeeded=e})},toggle(){return this.nodes.container&&!this.timeouts.destroy?this.destroy():this.setup(!0,!0)},setup(e,t){if(this.isEnabled&&(bt.cache.needed()||t)){if(e&&(Ve.addClass(j.nodes.el,"focus"),this.nodes.counter.focus()),this.timeouts.destroy)return clearTimeout(this.timeouts.destroy),delete this.timeouts.destroy,this.reload();if(!this.nodes.container)return this.nodes.container=Ve.el("div",{className:"captcha-container"}),Ve.prepend(this.nodes.root,this.nodes.container),new MutationObserver(this.afterSetup.bind(this)).observe(this.nodes.container,{childList:!0,subtree:!0}),this.noscript?this.setupNoscript():this.setupJS();Ve.queueTask(()=>{let e;if(this.nodes.container&&Te.activeElement===this.nodes.counter&&(e=Ve('iframe[src^="https://www.google.com/recaptcha/"]',this.nodes.container)))return e.focus(),j.focus()})}},setupNoscript(){const e=Ve.el("iframe",{id:"qr-captcha-iframe",scrolling:"no",src:this.noscriptURL()}),t=Ve.el("div"),n=Ve.el("textarea");return Ve.add(t,n),Ve.add(this.nodes.container,[e,t])},setupJS(){Ve.global("setupCaptcha",{recaptchaKey:Ce.recaptchaKey})},afterSetup(e){var t,n,o,a;for(t of e)for(n of t.addedNodes)(o=Ve.x('./descendant-or-self::iframe[starts-with(@src, "https://www.google.com/recaptcha/")]',n))&&this.setupIFrame(o),(a=Ve.x("./descendant-or-self::textarea",n))&&this.setupTextArea(a)},setupIFrame(e){let t;if(Re.contains(e))return bt.replace.iframe(e),Ve.addClass(j.nodes.el,"captcha-open"),this.fixQRPosition(),Ve.on(e,"load",this.fixQRPosition),Te.activeElement===this.nodes.counter&&e.focus(),["blink","edge"].includes(Ve.engine)&&(t=e.parentNode,Ge("#qr .captcha-container > div > div:first-of-type").includes(t))?Ve.on(e.parentNode,"scroll",function(){return this.scrollTop=0}):void 0},fixQRPosition(){if(j.nodes.el.getBoundingClientRect().bottom>Re.clientHeight)return j.nodes.el.style.top="",j.nodes.el.style.bottom="0px"},setupTextArea(e){return Ve.one(e,"input",()=>this.save(!0))},destroy(){if(this.isEnabled)return delete this.timeouts.destroy,Ve.rmClass(j.nodes.el,"captcha-open"),this.nodes.container?(Ve.global("resetCaptcha"),Ve.rm(this.nodes.container),delete this.nodes.container):void 0},getOne:e=>bt.cache.getOne(e),save(e,t){bt.cache.save({response:t||Ve("textarea",this.nodes.container).value,timeout:Date.now()+this.lifetime});const n="IFRAME"===Te.activeElement?.nodeName&&/https?:\/\/www\.google\.com\/recaptcha\//.test(Te.activeElement.src);if(bt.cache.needed()?(n&&(j.cooldown.auto||De["Post on Captcha Completion"]?this.nodes.counter.focus():j.nodes.status.focus()),this.reload()):(e?this.destroy():null==this.timeouts.destroy&&(this.timeouts.destroy=setTimeout(this.destroy.bind(this),3e3)),n&&j.nodes.status.focus()),De["Post on Captcha Completion"]&&!j.cooldown.auto)return j.submit()},count(){const e=bt.cache.getCount(),t=bt.cache.submitCB?"...":"";return this.nodes.counter.textContent=`Captchas: ${e}${t}`,this.moreNeeded()},reload(){if(Ve('iframe[src^="https://www.google.com/recaptcha/api/fallback?"]',this.nodes.container))return this.destroy(),this.setup(!1,!0);Ve.global("resetCaptcha")},occupied(){return!!this.nodes.container&&!this.timeouts.destroy}}};j={postingIsEnabled:!1,captcha:void 0,min_width:0,min_height:0,max_width:0,max_height:0,max_size:0,max_size_video:0,max_comment:0,max_width_video:0,max_height_video:0,max_duration_video:0,forcedAnon:!1,spoiler:!1,link:void 0,post:void 0,posts:void 0,nodes:void 0,shortcut:void 0,hasFocus:!1,req:void 0,selected:void 0,mimeTypes:["image/jpeg","image/png","image/gif","application/pdf","application/vnd.adobe.flash.movie","application/x-shockwave-flash","video/webm","video/mp4"],validExtension:/\.(jpe?g|png|gif|pdf|swf|webm|mp4)$/i,typeFromExtension:{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",pdf:"application/pdf",swf:"application/vnd.adobe.flash.movie",webm:"video/webm",mp4:"video/mp4"},extensionFromType:{"image/jpeg":"jpg","image/png":"png","image/gif":"gif","application/pdf":"pdf","application/vnd.adobe.flash.movie":"swf","application/x-shockwave-flash":"swf","video/webm":"webm","video/mp4":"mp4"},init(){let e;De["Quick Reply"]&&(this.posts=[],Ve.on(Te,"4chanXInitFinished",()=>b.ready(j.initReady)),Ne.Post.push({name:"Quick Reply",cb:this.node}),this.shortcut=e=Ve.el("a",{className:"disabled",title:"Quick Reply",href:"javascript:;"}),a.set(this.shortcut,"comment","Quick Reply"),Ve.on(e,"click",function(){j.postingIsEnabled&&(De["Persistent QR"]||!j.nodes||j.nodes.el.hidden?(j.open(),j.nodes.com.focus()):j.close())}),Y.addShortcut("qr",e,540),window.addEventListener("message",e=>{e.data?.twister?.error&&j.error(Ve.el("div",{innerHTML:e.data.twister.error}))}))},initReady(){let e;const t=Ve("#g-recaptcha, #captcha-forced-noscript")?"v2":"t";j.captcha=bt[t],j.postingIsEnabled=!0;const{config:n}=Ee.BOARD,o=(e,t)=>+(n[e]??t);if(j.min_width=o("min_image_width",1),j.min_height=o("min_image_height",1),j.max_width=j.max_height=1e4,j.max_size=o("max_filesize",4194304),j.max_size_video=o("max_webm_filesize",j.max_size),j.max_comment=o("max_comment_chars",2e3),j.max_width_video=j.max_height_video=2048,j.max_duration_video=o("max_webm_duration",120),j.forcedAnon=!!n.forced_anon,j.spoiler=!!n.spoilers,e=Ve.id("togglePostFormLink")){const t=Ve.el("h1",{className:"qr-link-container"});Ve.extend(t,{innerHTML:`<a href="javascript:;" class="qr-link">${"thread"===Ee.VIEW?"Reply to Thread":"Start a Thread"}</a>`}),j.link=t.firstElementChild,Ve.on(t.firstChild,"click",function(){return j.open(),j.nodes.com.focus()}),Ve.before(e,t),e.firstElementChild.textContent="Original Form"}if("thread"===Ee.VIEW){let e;const t=Ve.el("div",{className:"brackets-wrap qr-link-container-bottom"});Ve.extend(t,{innerHTML:'<a href="javascript:;" class="qr-link-bottom">Reply to Thread</a>'}),Ve.on(t.firstElementChild,"click",function(){return j.open(),j.nodes.com.focus()}),(e=Ve(".navLinksBot"))&&Ve.prepend(e,t)}if(Ve.on(Te,"QRGetFile",j.getFile),Ve.on(Te,"QRDrawFile",j.drawFile),Ve.on(Te,"QRSetFile",j.setFile),Ve.on(Te,"paste",j.paste),Ve.on(Te,"dragover",j.dragOver),Ve.on(Te,"drop",j.dropFile),Ve.on(Te,"dragstart dragend",j.drag),Ve.on(Te,"IndexRefreshInternal",j.generatePostableThreadsList),Ve.on(Te,"ThreadUpdate",j.statusCheck),De["Persistent QR"])return j.open(),De["Auto Hide QR"]?j.hide():void 0},statusCheck(){if(!j.nodes)return;const{thread:e}=j.posts[0];return"new"!==e&&Ee.threads.get(`${Ee.BOARD}.${e}`).isDead?j.abort():j.status()},node(){if(Ve.on(this.nodes.quote,"click",j.quote),this.isFetchedQuote)return j.generatePostableThreadsList()},open(){if(j.nodes)j.nodes.el.hidden&&j.captcha.setup(),j.nodes.el.hidden=!1,j.unhide();else try{j.dialog()}catch(e){return delete j.nodes,void ke.handleErrors({message:"Quick Reply dialog creation crashed.",error:e})}return Ve.rmClass(j.shortcut,"disabled")},close(){if(!j.req){for(var e of(j.nodes.el.hidden=!0,j.cleanNotifications(),j.blur(),Ve.rmClass(j.nodes.el,"dump"),Ve.addClass(j.shortcut,"disabled"),new j.post(!0),j.posts.splice(0,j.posts.length-1)))e.delete();return j.cooldown.auto=!1,j.status(),j.captcha.destroy()}j.abort()},focus:()=>Ve.queueTask(function(){if(!j.inBubble())return j.hasFocus=Te.activeElement&&j.nodes.el.contains(Te.activeElement),j.nodes.el.classList.toggle("focus",j.hasFocus)}),inBubble(){const e=Ge('iframe[src^="https://www.google.com/recaptcha/api2/frame"]');return e.includes(Te.activeElement)||e.some(e=>"hidden"!==getComputedStyle(e).visibility&&e.getBoundingClientRect().bottom>0)},hide:()=>(j.blur(),Ve.addClass(j.nodes.el,"autohide"),j.nodes.autohide.checked=!0),unhide:()=>(Ve.rmClass(j.nodes.el,"autohide"),j.nodes.autohide.checked=!1),toggleHide(){return this.checked?j.hide():j.unhide()},blur(){if(j.nodes.el.contains(Te.activeElement))return Te.activeElement.blur()},toggleSJIS:e=>(e.preventDefault(),De.sjisPreview=!De.sjisPreview,Ve.set("sjisPreview",De.sjisPreview),j.nodes.el.classList.toggle("sjis-preview",De.sjisPreview)),texPreviewShow:()=>Ve.hasClass(j.nodes.el,"tex-preview")?j.texPreviewHide():(Ve.addClass(j.nodes.el,"tex-preview"),j.nodes.texPreview.textContent=j.nodes.com.value,Ve.event("mathjax",null,j.nodes.texPreview)),texPreviewHide:()=>Ve.rmClass(j.nodes.el,"tex-preview"),addPost(){const e=j.nodes&&!j.nodes.el.hidden;return j.open(),e&&(Ve.addClass(j.nodes.el,"dump"),new j.post(!0)),j.nodes.com.focus()},setCustomCooldown:e=>(De.customCooldownEnabled=e,j.cooldown.customCooldown=e,j.nodes.customCooldown.classList.toggle("disabled",!e)),toggleCustomCooldown(){const e=Ve.hasClass(j.nodes.customCooldown,"disabled");return j.setCustomCooldown(e),Ve.set("customCooldownEnabled",e)},error(e,t){let n;j.open(),"string"==typeof e?n=Ve.tn(e):(n=e,n.removeAttribute("style"));const o=new It("warning",n);if(j.notifications.push(o),Y.areNotificationsEnabled){if(Te.hidden||!t&&!Te.hasFocus()){const e=new Notification(n.textContent,{body:n.textContent,icon:i.logo});if(e.onclick=()=>window.focus(),"gecko"!==Ve.engine)return e.onclose=()=>o.close(),e.onshow=()=>setTimeout(function(){return e.onclose=null,e.close()},7e3)}}else if(Te.hidden&&!j.cooldown.auto)return alert(n.textContent)},connectionError:()=>Ve.el("span",{innerHTML:'Connection error while posting. [<a href="'+Se(Ce.upstreamFaq)+'#connection-errors" target="_blank">More info</a>]'}),notifications:[],cleanNotifications(){for(var e of j.notifications)e.close();return j.notifications=[]},status(){let e,t;if(!j.nodes)return;const{thread:n}=j.posts[0];"new"!==n&&Ee.threads.get(`${Ee.BOARD}.${n}`).isDead&&(t="Dead",e=!0,j.cooldown.auto=!1),t=j.req?j.req.progress:j.cooldown.seconds||t;const{status:o}=j.nodes;return o.value=t?j.cooldown.auto?`Auto ${t}`:t:"Submit",o.disabled=e||!1,o.disabled},openPost(){if(j.open(),j.selected.isLocked){const e=j.posts.indexOf(j.selected);return(j.posts[e+1]||new j.post).select(),Ve.addClass(j.nodes.el,"dump"),j.cooldown.auto=!0}},quote(e){var t,o,a,i;let s;if(e?.preventDefault(),!j.postingIsEnabled)return;const r=Te.getSelection(),l=n.postFromNode(this),{root:d}=l.nodes,c=new Range;c.selectNode(d);let h=l.board.ID===Ee.BOARD.ID?`>>${l}\n`:`>>>/${l.board}/${l}\n`;for(let e=0;e<r.rangeCount;e++)try{if(s=r.getRangeAt(e),s.compareBoundaryPoints(Range.START_TO_START,c)<0&&s.setStartBefore(d),s.compareBoundaryPoints(Range.END_TO_END,c)>0&&s.setEndAfter(d),!s.toString().trim())continue;for(o of(a=s.cloneContents(),i=s.commonAncestorContainer,Ve.x('ancestor-or-self::*[self::s or contains(@class,"removed-spoiler")]',i)&&(Ve.prepend(a,Ve.tn("[spoiler]")),Ve.add(a,Ve.tn("[/spoiler]"))),(t=Ve.x('ancestor-or-self::pre[contains(@class,"prettyprint")]',i))&&(Ve.prepend(a,Ve.tn("[code]")),Ve.add(a,Ve.tn("[/code]"))),Ge(t?"br":".prettyprint br",a)))Ve.replace(o,Ve.tn("\n"));for(o of Ge("br",a))o!==a.lastChild&&Ve.replace(o,Ve.tn("\n>"));for(o of(Ee.SITE.insertTags?.(a),Ge(".linkify[data-original]",a)))Ve.replace(o,Ve.tn(o.dataset.original));for(o of Ge(".embedder",a))" "===o.previousSibling?.nodeValue&&Ve.rm(o.previousSibling),Ve.rm(o);h+=`>${a.textContent.trim()}\n`}catch(e){}j.openPost();const{com:u,thread:p}=j.nodes;u.value||(p.value=n.threadFromNode(this));const g=j.selected.isOnlyQuotes(),f=u.selectionStart;return u.value=u.value.slice(0,f)+h+u.value.slice(u.selectionEnd),s=f+h.length,u.setSelectionRange(s,s),u.focus(),g&&(j.selected.quotedText=u.value),j.selected.save(u),j.selected.save(p)},characterCount(){const e=j.nodes.charCount,t=j.nodes.com.value.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length;return e.textContent=t.toString(),e.hidden=t<j.max_comment/2,j.nodes.splitPost.hidden=t<j.max_comment,(t>j.max_comment?Ve.addClass:Ve.rmClass)(e,"warning")},splitPost(){if(j.selected.isLocked)return;if(j.nodes.com.value.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length<j.max_comment)return;const e=j.nodes.com.value;let t=0,n=0;const o=j.posts.indexOf(j.selected);j.selected.setComment("");for(const o of e.split("\n")){const e=o.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length+1;if(e+t>j.max_comment)new j.post(!0).setComment(o),t=e,n++;else{const n=[j.selected.com,o].filter(e=>null!==e).join("\n");j.selected.setComment(n),t+=e}}const a=j.posts.length-n,i=j.posts.splice(a,n);j.posts.splice(o+1,0,...i);const s=[...j.nodes.dumpList.children],r=s.splice(a,n);s.splice(o+1,0,...r);for(const e of s)j.nodes.dumpList.appendChild(e);j.nodes.el.classList.add("dump")},getFile:()=>Ve.event("QRFile",j.selected?.file),drawFile(e){const t=j.selected?.file;if(!t||!/^(image|video)\//.test(t.type))return;const n=/^video\//.test(t),o=Ve.el(n?"video":"img");return Ve.on(o,"error",()=>j.openError()),Ve.on(o,n?"loadeddata":"load",function(){return e.target.getContext("2d").drawImage(o,0,0),URL.revokeObjectURL(o.src),Ve.event("QRImageDrawn",null,e.target)}),o.src=URL.createObjectURL(t)},openError(){const e=Ve.el("div");return Ve.extend(e,{innerHTML:'Could not open file. [<a href="'+Se(Ce.upstreamFaq)+'#error-reading-metadata" target="_blank">More info</a>]'}),j.error(e)},setFile(e){const{file:t,name:n,source:o}=e.detail;return null!=n&&(t.name=n),null!=o&&(t.source=o),j.open(),j.handleFiles([t])},drag(e){const t="dragstart"===e.type?Ve.off:Ve.on;return t(Te,"dragover",j.dragOver),t(Te,"drop",j.dropFile)},dragOver:e=>(e.preventDefault(),e.dataTransfer.dropEffect="copy"),dropFile(e){if(e.dataTransfer.files.length)return e.preventDefault(),j.open(),j.handleFiles(e.dataTransfer.files)},paste(e){var t,n,o;if(!e.clipboardData.items)return;let a=null,i=-1;for(t of e.clipboardData.items)"file"===t.kind&&(n=t.getAsFile())&&(o=2*+(n.size<=j.max_size)+ +("image/png"===n.type))>i&&(a=n,i=o);if(a){const{type:e}=a,t=new Blob([a],{type:e});t.name=`${De.pastedname}.${Ve.getOwn(j.extensionFromType,e)||"jpg"}`,j.open(),j.handleFiles([t])}},pasteFF(){var e,t,n,o,a;const{pasteArea:i}=j.nodes;if(!i.childNodes.length)return;const s=Ge("img",i);for(e of(Ve.rmAll(i),s)){var{src:r}=e;if(t=r.match(/data:(image\/(\w+));base64,(.+)/)){n=atob(t[3]),o=new Uint8Array(n.length);for(let e=0;e<n.length;e++)o[e]=n.charCodeAt(e);(a=new Blob([o],{type:t[1]})).name=`${De.pastedname}.${t[2]}`,j.handleFiles([a])}else/^https?:\/\//.test(r)&&j.handleUrl(r)}},handleUrl(e){j.open();const{selected:t}=j;t.preventAutoPost(),U.permission(function(){const n=prompt("Enter a URL:",e);n&&(j.nodes.fileButton.focus(),U.file(n,function(e){e&&!/^text\//.test(e.type)?(t.setFile(e),Ve.addClass(j.nodes.el,"dump")):j.error("Can't load file.")}))})},handleFiles(e){if(this!==j&&(e=[...this.files],this.value=null),e.length){for(var t of(j.cleanNotifications(),e))j.handleFile(t,e.length);return Ve.addClass(j.nodes.el,"dump"),Te.activeElement===j.nodes.fileButton&&Ve.hasClass(j.nodes.fileSubmit,"has-file")?j.nodes.filename.focus():void 0}},handleFile(e,t){let n;const o=/^text\//.test(e.type);return 1===t?n=j.selected:(n=j.posts[j.posts.length-1],(o?n.com||n.pasting:n.file)&&(n=new j.post)),n[o?"pasteText":"setFile"](e)},openFileInput(){if(!j.nodes.fileButton.disabled)return j.nodes.fileInput.click(),j.nodes.fileButton.focus()},generatePostableThreadsList(){if(!j.nodes)return;const e=j.nodes.thread,t=[e.firstElementChild];for(var n of Ee.BOARD.threads.keys)t.push(Ve.el("option",{value:n,textContent:`Thread ${n}`}));const o=e.value;return Ve.rmAll(e),Ve.add(e,t),e.value=o,e.value!==o?(e.value="thread"===Ee.VIEW?Ee.THREADID:"new",("thread"===Ee.VIEW?Ve.addClass:Ve.rmClass)(j.nodes.el,"reply-to-thread")):void 0},dialog(){let e,t,n,o;j.nodes=n={el:e=rt.dialog("qr",{innerHTML:'<div class="move">\n  <label>\n    <input type="checkbox" id="autohide" title="Auto-hide">\n    Quick Reply\n  </label>\n  <a href="javascript:;" class="close" title="Close">âœ•</a>\n  <select data-name="thread" title="Create a new thread / Reply">\n    <option value="new">New thread</option>\n  </select>\n</div>\n<form>\n  <div class="persona">\n    <button type="button" id="sjis-toggle" class="qr-button" title="Toggle Mona font">âˆ€</button>\n    <button type="button" id="tex-preview-button" class="qr-button" title="Preview TeX">T<sub>E</sub>X</button>\n    <input name="name" data-name="name" list="list-name" placeholder="Name" class="field" size="1">\n    <input name="email" data-name="email" list="list-email" placeholder="Options" class="field" size="1">\n    <input name="sub" data-name="sub" list="list-sub" placeholder="Subject" class="field" size="1" maxlength="100">\n  </div>\n  <div class="textarea">\n    <textarea data-name="com" placeholder="Comment" class="field"></textarea>\n    <span id="char-count"></span>\n    <div id="tex-preview"></div>\n  </div>\n  <div id="dump-list-container">\n    <div id="dump-list"></div>\n    <a id="add-post" href="javascript:;" title="Add a post">+</a>\n  </div>\n  <div class="oekaki" hidden>\n    <input type="button" id="qr-draw-button" class="qr-button" value="Draw">\n    <label><span>Width:</span><input name="oekaki-width" value="400" type="number" class="field" size="1"></label>\n    <label><span>Height:</span><input name="oekaki-height" value="400" type="number" class="field" size="1"></label>\n    <span class="oekaki-bg" title="Background Color"><input name="oekaki-bg" type="checkbox" checked><input name="oekaki-bgcolor" type="color" value="#ffffff"></span>\n  </div>\n  <div id="file-n-submit">\n    <span id="qr-file" class="row">\n      <input type="button" id="qr-file-button" class="qr-button" value="Files">\n      <span id="qr-filename-container" class="field">\n        <span id="qr-no-file">No selected file</span>\n        <input id="qr-filename" data-name="filename" spellcheck="false">\n        <label id="qr-spoiler-label">\n          <input type="checkbox" id="qr-file-spoiler" title="Spoiler image">\n          <a class="checkbox-letter">S</a>\n        </label>\n      </span>\n    </span>\n    <span id="qr-actions-container" class="row space">\n      <span id="qr-actions" class="row">\n        <a href="javascript:;" id="qr-oekaki-button" class="qr-action-button" title="Edit in Tegaki">âœŽï¸Ž</a>\n        <a href="javascript:;" id="qr-jpg" class="qr-action-button" title="Compress to jpg">C</a>\n        <a href="javascript:;" id="qr-view" class="qr-action-button" title="Preview">V</a>\n        <a href="javascript:;" id="qr-randomize" class="qr-action-button" title="Randomize filename">R</a>\n        <a href="javascript:;" id="qr-restore-name" class="qr-action-button" title="Reset filename">U</a>\n        <a href="javascript:;" id="qr-filerm" class="qr-action-button" title="Remove file">âœ•</a>\n        <a href="javascript:;" id="url-button" class="qr-action-button" title="Post from URL">ðŸ”—ï¸Ž</a>\n        <a href="javascript:;" hidden id="paste-area" class="qr-action-button" title="Select to paste images" tabindex="-1" contentEditable="true">ðŸ“‹ï¸Ž</a>\n        <a href="javascript:;" id="custom-cooldown-button" class="qr-action-button" title="Toggle custom cooldown" class="disabled">ðŸ•’ï¸Ž</a>\n        <a href="javascript:;" id="split-post" class="qr-action-button" title="Split into multiple posts" hidden>âœ‚ï¸</a>\n        <a href="javascript:;" id="dump-button" class="qr-action-button" title="Dump list">âž•ï¸Ž</a>\n      </span>\n      <input class="qr-button" type="submit">\n    </span>\n  </div>\n  <select data-default="4" name="filetag">\n    <option value="0">Hentai</option>\n    <option value="6">Porn</option>\n    <option value="1">Japanese</option>\n    <option value="2">Anime</option>\n    <option value="3">Game</option>\n    <option value="5">Loop</option>\n    <option value="4" selected>Other</option>\n  </select>\n  <input type="file" multiple>\n</form>\n<datalist id="list-name"></datalist>\n<datalist id="list-email"></datalist>\n<datalist id="list-sub"></datalist>'})};const i=(t,o)=>n[t]=Ve(o,e);i("move",".move"),i("autohide","#autohide"),i("close",".close"),i("thread","select"),i("form","form"),i("sjisToggle","#sjis-toggle"),i("texButton","#tex-preview-button"),i("name","[data-name=name]"),i("email","[data-name=email]"),i("sub","[data-name=sub]"),i("com","[data-name=com]"),i("charCount","#char-count"),i("texPreview","#tex-preview"),i("dumpList","#dump-list"),i("addPost","#add-post"),i("oekaki",".oekaki"),i("drawButton","#qr-draw-button"),i("randomizeButton","#qr-randomize"),i("compress","#qr-jpg"),i("view","#qr-view"),i("restoreNameButton","#qr-restore-name"),i("fileSubmit","#file-n-submit"),i("fileButton","#qr-file-button"),i("noFile","#qr-no-file"),i("filename","#qr-filename"),i("spoiler","#qr-file-spoiler"),i("oekakiButton","#qr-oekaki-button"),i("fileRM","#qr-filerm"),i("urlButton","#url-button"),i("pasteArea","#paste-area"),i("customCooldown","#custom-cooldown-button"),i("dumpButton","#dump-button"),i("status","[type=submit]"),i("flashTag","[name=filetag]"),i("fileInput","[type=file]"),i("splitPost","#split-post");const{config:s}=Ee.BOARD,{classList:r}=j.nodes.el;r.toggle("forced-anon",j.forcedAnon),r.toggle("has-spoiler",j.spoiler),r.toggle("has-sjis",!!s.sjis_tags),r.toggle("has-math",!!s.math_tags),r.toggle("sjis-preview",!!s.sjis_tags&&De.sjisPreview),r.toggle("show-new-thread-option",De["Show New Thread Option in Threads"]),parseInt(De.customCooldown,10)>0&&(Ve.addClass(j.nodes.fileSubmit,"custom-cooldown"),Ve.get("customCooldownEnabled",De.customCooldownEnabled,function({customCooldownEnabled:e}){return j.setCustomCooldown(e),Ve.sync("customCooldownEnabled",j.setCustomCooldown)})),j.flagsInput(),Ve.on(n.autohide,"change",j.toggleHide),Ve.on(n.close,"click",j.close),Ve.on(n.status,"click",j.submit),Ve.on(n.form,"submit",j.submit),Ve.on(n.sjisToggle,"click",j.toggleSJIS),Ve.on(n.texButton,"mousedown",j.texPreviewShow),Ve.on(n.texButton,"mouseup",j.texPreviewHide),Ve.on(n.addPost,"click",()=>new j.post(!0)),Ve.on(n.drawButton,"click",j.oekaki.draw),Ve.on(n.fileButton,"click",j.openFileInput),Ve.on(n.noFile,"click",j.openFileInput),Ve.on(n.randomizeButton,"click",()=>{j.selected.randomizeName()}),Ve.on(n.compress,"click",async()=>{j.handleFiles([await j.convert(j.selected.file)])}),Ve.on(n.view,"click",j.preview),Ve.on(n.restoreNameButton,"click",()=>{j.selected.restoreName()}),Ve.on(n.filename,"focus",function(){return Ve.addClass(this.parentNode,"focus")}),Ve.on(n.filename,"blur",function(){return Ve.rmClass(this.parentNode,"focus")}),Ve.on(n.spoiler,"change",()=>j.selected.nodes.spoiler.click()),Ve.on(n.oekakiButton,"click",j.oekaki.button),Ve.on(n.fileRM,"click",()=>j.selected.rmFile()),Ve.on(n.urlButton,"click",()=>j.handleUrl("")),Ve.on(n.customCooldown,"click",j.toggleCustomCooldown),Ve.on(n.dumpButton,"click",()=>n.el.classList.toggle("dump")),Ve.on(n.fileInput,"change",j.handleFiles),Ve.on(n.splitPost,"click",j.splitPost),window.addEventListener("focus",j.focus,!0),window.addEventListener("blur",j.focus,!0),Ve.on(Te,"click",j.focus),"gecko"!==Ve.engine||window.DataTransferItemList||(n.pasteArea.hidden=!1),new MutationObserver(j.pasteFF).observe(n.pasteArea,{childList:!0});const l=["thread","name","email","sub","com","filename","flag"];let d=0;const c=function(){j.selected.save(this)};for(;o=l[d++];){var h;(h=n[o])&&(t="SELECT"===h.nodeName?"change":"input",Ve.on(n[o],t,c))}De["Remember QR Size"]&&(Ve.get("QR Size","",e=>n.com.style.cssText=e["QR Size"]),Ve.on(n.com,"mouseup",function(e){0===e.button&&Ve.set("QR Size",this.style.cssText)})),j.generatePostableThreadsList(),j.persona.load(),new j.post(!0),j.status(),j.cooldown.setup(),j.captcha.init(),Ve.add(Te.body,e),j.captcha.setup(),j.oekaki.setup(),Ve.event("QRDialogCreation",null,e),a.set(n.oekakiButton,"pencil"),a.set(n.urlButton,"link"),a.set(n.pasteArea,"clipboard"),a.set(n.customCooldown,"clock"),a.set(n.randomizeButton,"shuffle"),a.set(n.compress,"shrink"),a.set(n.view,"eye"),a.set(n.restoreNameButton,"undo"),a.set(n.splitPost,"scissors"),a.set(n.fileRM,"xmark"),a.set(n.close,"xmark"),a.set(n.dumpButton,"squarePlus"),a.set(n.addPost,"plus")},flags(){var e;const t=Ve.el("select",{name:"flag",className:"flagSelector"}),n=(e,n)=>Ve.add(t,Ve.el("option",{value:e,textContent:n}));for(e in n("0",Ee.BOARD.config.country_flags?"Geographic Location":"None"),Ee.BOARD.config.board_flags)n(e,Ee.BOARD.config.board_flags[e]);return t},flagsInput(){const{nodes:e}=j;if(e&&(e.flag&&(Ve.rm(e.flag),delete e.flag),Ee.BOARD.config.board_flags)){const t=j.flags();return t.dataset.name="flag",t.dataset.default="0",e.flag=t,Ve.add(e.form,t)}},submit(e){let t,n,o;e?.preventDefault();const a=e?.shiftKey;if(j.req)return void j.abort();if(Ve.forceSync("cooldowns"),j.cooldown.seconds){if(!a)return j.cooldown.auto=!j.cooldown.auto,void j.status();j.cooldown.clear()}const i=j.posts[0];delete i.quotedText,i.forceSave();let s=i.thread;const r=Ee.BOARD.threads.get(s);if("f"===Ee.BOARD.ID&&"new"===s&&(o=j.nodes.flashTag.value),"new"===s?(s=null,Ee.BOARD.config.require_subject&&!i.sub?n="New threads require a subject.":Ee.BOARD.config.text_only||i.file||(n="No file selected.")):Ee.BOARD.threads.get(s).isClosed?n="You can't reply to this thread anymore.":i.com||i.file?i.file&&r.fileLimit&&(n="Max limit of image replies has been reached."):n="No comment or file.","r9k"!==Ee.BOARD.ID||i.com?.match(/[a-z-]/i)||n||(n="Original comment required."),!j.captcha.isEnabled||j.captcha===bt.v2&&/\b_ct=/.test(Te.cookie)&&s||n&&!a||(t=j.captcha.getOne(!!s),j.captcha===bt.v2&&(t||(t=bt.cache.request(!!s))),t||(n="No valid captcha.",j.captcha.setup(!j.cooldown.auto||Te.activeElement===j.nodes.status))),j.cleanNotifications(),n&&!a)return j.cooldown.auto=!1,j.status(),void j.error(n);j.cooldown.auto=j.posts.length>1,i.lock();const l={MAX_FILE_SIZE:j.max_size,mode:"regist",pwd:j.persona.getPassword(),resto:s,name:j.forcedAnon?void 0:i.name,email:i.email,sub:j.forcedAnon||s?void 0:i.sub,com:i.com,upfile:i.file,filetag:o,spoiler:i.spoiler,flag:i.flag},d={responseType:"document",withCredentials:!0,onloadend:j.response,form:Ve.formData(l)};De["Show Upload Progress"]&&(d.onprogress=function(e){if(this===j.req?.upload)return e.loaded<e.total?j.req.progress=`${Math.round(e.loaded/e.total*100)}%`:(j.req.isUploadFinished=!0,j.req.progress="..."),j.status()});let c=function(e){var t,n;if(null!=e)if(j.currentCaptcha=e,j.captcha===bt.v2)null!=e.challenge?(d.form.append("recaptcha_challenge_field",e.challenge),d.form.append("recaptcha_response_field",e.response)):d.form.append("g-recaptcha-response",e.response);else for(t in e)n=e[t],d.form.append(t,n);j.req=Ve.ajax(`https://sys.${location.hostname.split(".")[1]}.org/${Ee.BOARD}/post`,d),j.req.progress="..."};"function"==typeof t?(j.req={progress:"...",abort(){j.captcha===bt.v2&&bt.cache.abort(),c=null}},t(function(e){if(j.captcha===bt.v2&&bt.cache.haveCookie()){if(c?.(),e)return bt.cache.save(e)}else e?c?.(e):(delete j.req,i.unlock(),j.cooldown.auto=!!bt.cache.getCount(),j.status())})):c(t),j.status()},response(){let e,t;if(this!==j.req)return;delete j.req;const n=j.posts[0];if(n.unlock(),t=this.response?.getElementById("errmsg")){const e=Ve("a",t);e&&(e.target="_blank")}else(e=!this.response||"Post successful!"!==this.response.title)?(t=j.connectionError(),j.captcha===bt.v2&&j.currentCaptcha&&bt.cache.save(j.currentCaptcha)):200!==this.status&&(t=`Error ${this.statusText} (${this.status})`);if(e||j.captcha.setUsed?.(),delete j.currentCaptcha,t){let a;if(j.errorCount=(j.errorCount||0)+1,/captcha|verification/i.test(t.textContent))/mistyped/i.test(t.textContent)?t="You mistyped the CAPTCHA, or the CAPTCHA malfunctioned.":/expired/i.test(t.textContent)&&(t="This CAPTCHA is no longer valid because it has expired."),j.cooldown.auto=!1;else if(e)j.errorCount>=5?j.cooldown.auto=!1:(j.cooldown.auto=j.captcha.isEnabled||e,j.cooldown.addDelay(n,2));else if(t.textContent&&(a=t.textContent.match(/\d+\s+(?:minute|second)/gi))&&!/duplicate|hour/i.test(t.textContent)){j.cooldown.auto=!/have\s+been\s+muted/i.test(t.textContent);let e=0;for(var o of a)e+=(/minute/i.test(o)?60:1)*+o.match(/\d+/)[0];/muted/i.test(t.textContent)?j.cooldown.addMute(e):j.cooldown.addDelay(n,e)}else j.cooldown.auto=!1;return j.captcha.setup(j.cooldown.auto&&[j.nodes.status,Te.body].includes(Te.activeElement)),j.status(),void j.error(t)}delete j.errorCount;const a=Ve("h1",this.response);let[i,s,r]=a.nextSibling.textContent.match(/thread:(\d+),no:(\d+)/);r=+r,s=+s||r;const l=s!==r;Ve.event("QRPostSuccessful",{boardID:Ee.BOARD.ID,threadID:s,postID:r}),Ve.event("QRPostSuccessful_",{boardID:Ee.BOARD.ID,threadID:s,postID:r});const d=j.posts.length-1;j.cooldown.auto=d&&l;const c=!function(){for(var e of j.posts.slice(1))if(e.thread===n.thread)return!0}();d?(n.rm(),j.captcha.setup(Te.activeElement===j.nodes.status)):De["Persistent QR"]?(n.rm(),De["Auto Hide QR"]?j.hide():j.blur()):j.close(),j.cleanNotifications(),De["Posting Success Notifications"]&&j.notifications.push(new It("success",a.textContent,5)),j.cooldown.add(s,r);const h=s===r?`${window.location.origin}/${Ee.BOARD}/thread/${s}`:s!==Ee.THREADID&&c&&De["Open Post in New Tab"]?`${window.location.origin}/${Ee.BOARD}/thread/${s}#p${r}`:void 0;if(h){const e=De["Open Post in New Tab"]||d?()=>Ve.open(h):()=>location.href=h;s===r?j.waitForThread(h,e):e()}j.status()},waitForThread(e,t){let n=0;var o=function(){Ve.ajax(e,{onloadend(){return n++,n>=6||200===this.status?t():setTimeout(o,n*$e)},responseType:"text",type:"HEAD"})};o()},abort(){let e;(e=j.req)&&!j.req.isUploadFinished&&(delete j.req,e.abort(),j.captcha===bt.v2&&j.currentCaptcha&&bt.cache.save(j.currentCaptcha),delete j.currentCaptcha,j.posts[0].unlock(),j.cooldown.auto=!1,j.notifications.push(new It("info","QR upload aborted.",5))),j.status()},getMaxSize(e){let t=j.max_size;return e.type.startsWith("video/")&&(t=Math.min(t,j.max_size_video)),t},async convert(e,t="jpeg",n){const o=n?.maxSize||this.getMaxSize(e),a=n?.img||await createImageBitmap(e),i=n?.width||a.width,s=n?.height||a.height,r=e.name.replace(/\.[a-z]+$/i,"."+t),l="image/"+t;let d,c,h;window.OffscreenCanvas&&!De["Avoid OffscreenCanvas"]?(d=new OffscreenCanvas(i,s),c=(e,t)=>d.convertToBlob({type:e,quality:t})):(d=Ve.el("canvas",{width:i,height:s}),c=(e,t)=>new Promise(n=>{d.toBlob(n,e,t)}));let u=.9;d.getContext("2d").drawImage(a,0,0,i,s);do{h=new File([await c(l,u)],r,{type:l}),u-=.1}while("jpeg"===t&&h.size>o&&u>=.1);return h.size>=e.size&&h.type===e.type?(new It("warning","New jpeg file isn't smaller than the old one, so it won't be used.",3),e):h},previewUrl:void 0,preview(){if(j.selected.file){if(j.nodes.preview=Ve.el("div",{id:"overlay",className:"media-preview"}),Ve.add(Te.body,j.nodes.preview),j.previewUrl=URL.createObjectURL(j.selected.file),j.selected.file.type.startsWith("video/")){const e=Ve.el("video",{controls:!0,src:j.previewUrl,autoplay:!0});Ve.add(j.nodes.preview,e),e.focus()}else Ve.add(j.nodes.preview,Ve.el("img",{src:j.previewUrl}));j.nodes.preview.addEventListener("click",e=>{"VIDEO"!==e.target.tagName&&j.closePreview()})}},closePreview(){j.nodes.preview.remove(),URL.revokeObjectURL(j.previewUrl)},cooldown:{seconds:0,delays:{deletion:60},maxDelay:0,isSetup:!1,auto:!1,data:{},init(){De["Quick Reply"]&&(this.data=De.cooldowns,this.changes=Fe(),Ve.sync("cooldowns",this.sync))},setup(){var e,t;for(e in Ve.extend(j.cooldown.delays,Ee.BOARD.cooldowns()),j.cooldown.maxDelay=0,j.cooldown.delays)t=j.cooldown.delays[e],["thread","thread_global"].includes(e)||(j.cooldown.maxDelay=Math.max(j.cooldown.maxDelay,t));j.cooldown.isSetup=!0,j.cooldown.start()},start(){const{data:e}=j.cooldown;!De.Cooldown||!j.cooldown.isSetup||j.cooldown.isCounting||Object.keys(e[Ee.BOARD.ID]||{}).length+Object.keys(e.global||{}).length<=0||(j.cooldown.isCounting=!0,j.cooldown.count())},sync(e){j.cooldown.data=e||Fe(),j.cooldown.start()},add(e,t){if(!De.Cooldown)return;const n=Date.now(),o=Ee.BOARD.ID;j.cooldown.set(o,n,{threadID:e,postID:t}),e===t&&j.cooldown.set("global",n,{boardID:o,threadID:e,postID:t}),j.cooldown.save(),j.cooldown.start()},addDelay(e,t){if(!De.Cooldown)return;const n=j.cooldown.categorize(e);n.delay=t,j.cooldown.set(Ee.BOARD.ID,Date.now(),n),j.cooldown.save(),j.cooldown.start()},addMute(e){De.Cooldown&&(j.cooldown.set(Ee.BOARD.ID,Date.now(),{type:"mute",delay:e}),j.cooldown.save(),j.cooldown.start())},delete(e){let t;if(!j.cooldown.data)return;const n=j.cooldown.data[e.board.ID]||(j.cooldown.data[e.board.ID]=Fe());for(var o in n)t=n[o],null==t.delay&&t.threadID===e.thread.ID&&t.postID===e.ID&&j.cooldown.set(e.board.ID,o,null);j.cooldown.save()},secondsDeletion(e){var t,n,o;if(!j.cooldown.data||!De.Cooldown)return 0;const a=j.cooldown.data[e.board.ID]||Fe();for(t in a)if(null==(n=a[t]).delay&&n.threadID===e.thread.ID&&n.postID===e.ID)return o=j.cooldown.delays.deletion-Math.floor((Date.now()-t)/$e),Math.max(o,0);return 0},categorize:e=>"new"===e.thread?{type:"thread"}:{type:e.file?"image":"reply",threadID:+e.thread},mergeChange(e,t,n,o){o?(e[t]||(e[t]=Fe()))[n]=o:t in e&&(delete e[t][n],0===Object.keys(e[t]).length&&delete e[t])},set(e,t,n){j.cooldown.mergeChange(j.cooldown.data,e,t,n),(j.cooldown.changes[e]||(j.cooldown.changes[e]=Fe()))[t]=n},save(){const{changes:e}=j.cooldown;Object.keys(e).length&&Ve.get("cooldowns",Fe(),function({cooldowns:e}){var t,n,o;for(t in j.cooldown.changes){for(n in j.cooldown.changes[t])o=j.cooldown.changes[t][n],j.cooldown.mergeChange(e,t,n,o);j.cooldown.data=e}Ve.set("cooldowns",e,()=>j.cooldown.changes=Fe())})},clear(){j.cooldown.data=Fe(),j.cooldown.changes=Fe(),j.cooldown.auto=!1,j.cooldown.update(),Ve.queueTask(Ve.delete,"cooldowns")},update(){var e,t,n,o,a,i;let s;if(!j.cooldown.isCounting)return;let r=!1,l=0;const d=Date.now(),{type:c,threadID:h}=j.cooldown.categorize(j.posts[0]);let u=0;if(De.Cooldown)for(e of[Ee.BOARD.ID,"global"]){for(n in t=j.cooldown.data[e]||(j.cooldown.data[e]=Fe()))s=t[n],n=+n,(o=Math.floor((d-n)/$e))<0?(j.cooldown.set(e,n,null),r=!0):null==s.delay?(a=s.threadID!==s.postID?j.cooldown.maxDelay:j.cooldown.delays["global"===e?"thread_global":"thread"],j.cooldown.customCooldown&&(a=Math.max(a,parseInt(De.customCooldown,10))),a<=o?(j.cooldown.set(e,n,null),r=!0):"thread"===c==(s.threadID===s.postID)&&s.boardID!==Ee.BOARD.ID&&(i="global"===e?"_global":"",u=Math.max(u,j.cooldown.delays[c+i]-o),j.cooldown.customCooldown&&(u=Math.max(u,parseInt(De.customCooldown,10)-o)))):s.delay<=o?(j.cooldown.set(e,n,null),r=!0):(s.type===c&&s.threadID===h||"mute"===s.type)&&(u=Math.max(u,s.delay-o));l+=Object.keys(t).length}r&&j.cooldown.save,l?(clearTimeout(j.cooldown.timeout),j.cooldown.timeout=setTimeout(j.cooldown.count,$e)):delete j.cooldown.isCounting;const p=u!==j.cooldown.seconds;j.cooldown.seconds=u,p&&j.status()},count(){j.cooldown.update(),0===j.cooldown.seconds&&j.cooldown.auto&&!j.req&&j.submit()}},oekaki:{menu:{init(){if(!(["index","thread"].includes(Ee.VIEW)&&De.Menu&&De["Edit Link"]&&De["Quick Reply"]))return;const e=Ve.el("a",{className:"edit-link",href:"javascript:;",textContent:"Edit image"});Ve.on(e,"click",this.editFile),A.menu.addEntry({el:e,order:90,open(e){j.oekaki.menu.post=e;const{file:t}=e;return j.postingIsEnabled&&!!t&&(t.isImage||t.isVideo)}})},editFile(){const{post:e}=j.oekaki.menu;j.quote.call(e.nodes.post);const{isVideo:t}=e.file,n=e.file.fullImage?.currentTime||0;return U.file(e.file.url,function(o){if(o)if(t){const t=Ve.el("video");Ve.on(t,"loadedmetadata",function(){Ve.on(t,"seeked",function(){const n=Ve.el("canvas",{width:t.videoWidth,height:t.videoHeight});n.getContext("2d").drawImage(t,0,0),n.toBlob(function(t){t.name=e.file.name.replace(/\.\w+$/,"")+".png",j.handleFiles([t]),j.oekaki.edit()})}),t.currentTime=n}),Ve.on(t,"error",()=>j.openError()),t.src=URL.createObjectURL(o)}else o.name=e.file.name,j.handleFiles([o]),j.oekaki.edit();else j.error("Can't load file.")})}},setup(){Ve.global("setupQR")},load(e){if(Ve('script[src^="//s.4cdn.org/js/tegaki"]',Te.head))e();else{const t=Ve.el("link",{rel:"stylesheet",href:`//s.4cdn.org/css/tegaki.${Date.now()}.css`}),n=Ve.el("script",{src:`//s.4cdn.org/js/tegaki.min.${Date.now()}.js`});let o=0;const a=function(){2===++o&&e()};Ve.on(t,"load",a),Ve.on(n,"load",a),Ve.add(Te.head,[t,n])}},draw:()=>Ve.global("qrTegakiDraw"),button(){j.selected.file?j.oekaki.edit():j.oekaki.toggle()},edit(){j.oekaki.load(()=>Ve.global("qrTegakiLoad"))},toggle(){j.oekaki.load(()=>j.nodes.oekaki.hidden=!j.nodes.oekaki.hidden)}},persona:{always:{},types:{name:[],email:[],sub:[]},init(){if(De["Quick Reply"]||De.Menu&&De["Delete Link"])for(var e of De["QR.personas"].split("\n"))j.persona.parseItem(e.trim())},parseItem(e){if("#"===e[0])return;const t=e.match(/(name|options|email|subject|password):"(.*)"/i);if(!t)return;let n,[o,a,i]=t;e=e.replace(o,"");const s=e.match(/boards:([^;]+)/i)?.[1].toLowerCase()||"global";("global"===s||(n=Ee.BOARD.ID,s.split(",").includes(n)))&&("password"!==a?("options"===a&&(a="email"),"subject"===a&&(a="sub"),/always/i.test(e)&&(j.persona.always[a]=i),j.persona.types[a].includes(i)||j.persona.types[a].push(i)):j.persona.pwd=i)},load(){var e,t,n,o;for(e in j.persona.types)for(o of(t=j.persona.types[e],n=Ve(`#list-${e}`,j.nodes.el),t))o&&Ve.add(n,Ve.el("option",{textContent:o}))},getPassword(){let e;return null!=j.persona.pwd?j.persona.pwd:(e=Te.cookie.match(/4chan_pass=([^;]+)/))?decodeURIComponent(e[1]):""},get(e){Ve.get("QR.persona",{},({"QR.persona":t})=>e(t))},set(e){Ve.get("QR.persona",{},function({"QR.persona":t}){t={name:e.name,flag:e.flag},Ve.set("QR.persona",t)})}}},j.post=class{constructor(e){var t,n;this.select=this.select.bind(this);const o=Ve.el("a",{className:"qr-preview",draggable:!0,href:"javascript:;"});Ve.extend(o,{innerHTML:`<a href="javascript:;" class="remove" title="Remove">${a.get("xmark")}</a><label class="qr-preview-spoiler"><input type="checkbox"> Spoiler</label><span id="qr-preview-comment"></span><br /><span id="qr-preview-name"></span>`});const[i,s,r,,l]=o.childNodes;for(t of(this.nodes={el:o,rm:i,spoiler:s.firstChild,span:r,spanFileName:l},Ve.on(o,"click",this.select),Ve.on(this.nodes.rm,"click",e=>{e.stopPropagation(),this.rm()}),Ve.on(this.nodes.spoiler,"change",e=>(this.spoiler=e.target.checked,this===j.selected&&(j.nodes.spoiler.checked=this.spoiler),this.preventAutoPost())),Ge("label",o)))Ve.on(t,"click",e=>e.stopPropagation());for(n of(Ve.add(j.nodes.dumpList,o),["dragStart","dragEnter","dragLeave","dragOver","dragEnd","drop"]))Ve.on(o,n.toLowerCase(),this[n]);this.thread="thread"===Ee.VIEW?Ee.THREADID:"new";const d=j.posts[j.posts.length-1];j.posts.push(this),this.nodes.spoiler.checked=this.spoiler=!(!d||!De["Remember Spoiler"])&&d.spoiler,j.persona.get(e=>{this.name="name"in j.persona.always?j.persona.always.name:d?d.name:e.name,this.email="email"in j.persona.always?j.persona.always.email:"",this.sub="sub"in j.persona.always?j.persona.always.sub:"",j.nodes.flag&&(this.flag=d?d.flag:e.flag&&e.flag in Ee.BOARD.config.board_flags?e.flag:void 0),j.selected===this&&this.load()}),e&&this.select(),this.unlock(),j.captcha.moreNeeded()}rm(){this.delete();const e=j.posts.indexOf(this);1===j.posts.length?(new j.post(!0),Ve.rmClass(j.nodes.el,"dump")):this===j.selected&&(j.posts[e-1]||j.posts[e+1]).select(),j.posts.splice(e,1),j.status(),j.captcha.updateThread?.()}delete(){Ve.rm(this.nodes.el),URL.revokeObjectURL(this.URL),this.dismissErrors()}lock(e=!0){var t,n;if(this.isLocked=e,this===j.selected){for(t of["thread","name","email","sub","com","fileButton","filename","spoiler","flag"])(n=j.nodes[t])&&(n.disabled=e);this.nodes.rm.style.visibility=e?"hidden":"",this.nodes.spoiler.disabled=e,this.nodes.el.draggable=!e}}unlock(){this.lock(!1)}select(){j.selected&&(j.selected.nodes.el.removeAttribute("id"),j.selected.forceSave()),j.selected=this,this.lock(this.isLocked),this.nodes.el.id="selected";const e=this.nodes.el.getBoundingClientRect(),t=this.nodes.el.parentNode.getBoundingClientRect();this.nodes.el.parentNode.scrollLeft+=e.left+e.width/2-t.left-t.width/2,this.load()}load(){var e,t;for(e of["thread","name","email","sub","com","filename","flag"])(t=j.nodes[e])&&(t.value=this[e]||t.dataset.default||"");("new"!==this.thread?Ve.addClass:Ve.rmClass)(j.nodes.el,"reply-to-thread"),this.showFileData(),j.characterCount()}save(e,t){if("checkbox"===e.type)return void(this.spoiler=e.checked);const{name:n}=e.dataset;if(!["thread","name","email","sub","com","filename","flag"].includes(n))return;const o=this[n]||e.dataset.default||null;switch(this[n]=e.value||e.dataset.default||null,n){case"thread":("new"!==this.thread?Ve.addClass:Ve.rmClass)(j.nodes.el,"reply-to-thread"),j.status(),j.captcha.updateThread?.();break;case"com":this.updateComment();break;case"filename":if(!this.file)return;this.saveFilename(),this.updateFilename();break;case"name":case"flag":this[n]!==o&&j.persona.set(this)}t||this.preventAutoPost()}forceSave(){var e,t;if(this===j.selected)for(e of["thread","name","email","sub","com","filename","spoiler","flag"])(t=j.nodes[e])&&this.save(t,!0)}preventAutoPost(){j.cooldown.auto&&this===j.posts[0]&&(j.cooldown.update(),j.cooldown.seconds<=5&&(j.cooldown.auto=!1))}setComment(e){return this.com=e||null,this===j.selected&&(j.nodes.com.value=this.com),this.updateComment()}updateComment(){this===j.selected&&j.characterCount(),this.nodes.span.textContent=this.com,j.captcha.moreNeeded()}isOnlyQuotes(){return(this.com||"").trim()===(this.quotedText||"").trim()}static rmErrored(e){var t,n,o;e.stopPropagation();for(let e=j.posts.length-1;e>=0;e--)if(t=(n=j.posts[e]).errors)for(o of t)if(Re.contains(o)){n.rm();break}}error(e,t,n){const o=Ve.el("div",{className:e});Ve.extend(o,{innerHTML:t+(n?` [<a href="${Se(n)}" target="_blank">More info</a>]`:"")+'<br>[<a href="javascript:;">delete post</a>] [<a href="javascript:;">delete all</a>]'}),(this.errors||(this.errors=[])).push(o);const[a,i]=Ge("a",o);Ve.on(o,"click",()=>{j.posts.includes(this)&&this.select()}),Ve.on(a,"click",e=>{e.stopPropagation(),j.posts.includes(this)&&this.rm()}),Ve.on(i,"click",j.post.rmErrored),j.error(o,!0)}fileError(e,t){this.error("file-error",`${this.filename}: ${e}`,t)}dismissErrors(e=()=>!0){if(this.errors)for(var t of this.errors)Re.contains(t)&&e(t)&&t.parentNode.previousElementSibling.click()}async validateFile(e){if(location.hostname.endsWith("4chan.org")&&!j.mimeTypes.includes(e.type)){if(!e.type.startsWith("image/"))throw new Error("Unsupported file type.");{const t=`The ${e.type.slice(6)} image was converted to png.`;e=await j.convert(e,"png"),new It("info",t,3)}}const t=j.getMaxSize(e);if(e.type.startsWith("image/")){let n=await createImageBitmap(e);const{width:o,height:a}=n;let i=o,s=a;if(i>j.max_width&&(s=Math.round(s*(j.max_width/i)),i=j.max_width),s>j.max_height&&(i=Math.round(i*(j.max_height/s)),s=j.max_height),i===o&&s===a||(e=await j.convert(e,"image/jpeg"===e.type?"jpeg":"png",{width:i,height:s,img:n}),n=void 0,new It("warning",`Image was too large got shrunk from ${o} * ${a} to ${i} * ${s}.It might have lost animation.`)),e.size>t){const o=e.size;e=await j.convert(e,"jpeg",{maxSize:t,img:n}),new It("warning",`Image was too large (${Ve.bytesToString(o)}) and got converted to jpg (${Ve.bytesToString(e.size)}). It might have lost transparency or animation.`)}}else if(e.size>t)throw new Error(`File too large (file: ${Ve.bytesToString(e.size)}, max: ${Ve.bytesToString(t)}).`);return e}async setFile(e){try{this.file=e,this.filename=e.name,this.originalName=e.name,this.file=await this.validateFile(e),this.originalName=e.name,De["Randomize Filename"]&&"f"!==Ee.BOARD.ID&&!this.file.name.toLowerCase().includes("[sound=")?this.randomizeName(!1):this.filename=this.file.name,this.filesize=Ve.bytesToString(this.file.size),Ve.addClass(this.nodes.el,"has-file","has-"+this.file.type.split("/")[0]),j.captcha.moreNeeded(),URL.revokeObjectURL(this.URL),this.saveFilename(),this===j.selected?this.showFileData():this.updateFilename(),this.rmMetadata(),this.nodes.el.dataset.type=this.file.type,this.nodes.el.style.backgroundImage="",/^(image|video)\//.test(this.file.type)?(this.nodes.spanFileName.textContent="",this.readFile()):this.nodes.spanFileName.textContent=this.file.name.match(/\.([^\.]+)$/)[1]}catch(e){console.error(e),this.fileError(e?.message||e||"unknown error when setting a file")}this.preventAutoPost()}randomizeName(e=!0){this.filename=""+(1e3*Date.now()-Math.floor(365*Math.random()*He*1e3));const t=this.file.name.match(j.validExtension);t&&(this.filename+=t[0]),e&&(j.nodes.filename.value=this.filename)}restoreName(){j.nodes.filename.value=this.filename=this.originalName}readFile(){var e,t;const n=/^video\//.test(this.file.type),o=Ve.el(n?"video":"img");if(n&&!o.canPlayType(this.file.type))return;const a=n?"loadeddata":"load";e=()=>{Ve.off(o,a,e),Ve.off(o,"error",t),this.checkDimensions(o),this.setThumbnail(o),Ve.event("QRMetadata",null,this.nodes.el)},t=()=>{Ve.off(o,a,e),Ve.off(o,"error",t),this.fileError(`Corrupt ${n?"video":"image"} or error reading metadata.`,Ce.upstreamFaq+"#error-reading-metadata"),URL.revokeObjectURL(o.src),this.nodes.el.removeAttribute("data-height"),Ve.event("QRMetadata",null,this.nodes.el)},this.nodes.el.dataset.height="loading",Ve.on(o,a,e),Ve.on(o,"error",t),o.src=URL.createObjectURL(this.file)}checkDimensions(e){let t,n;if("IMG"===e.tagName)({height:t,width:n}=e),this.nodes.el.dataset.height=t,this.nodes.el.dataset.width=n,(t>j.max_height||n>j.max_width)&&this.fileError(`Image too large (image: ${t}x${n}px, max: ${j.max_height}x${j.max_width}px)`),(t<j.min_height||n<j.min_width)&&this.fileError(`Image too small (image: ${t}x${n}px, min: ${j.min_height}x${j.min_width}px)`);else{const{videoHeight:t,videoWidth:n,duration:o}=e;this.nodes.el.dataset.height=t,this.nodes.el.dataset.width=n,this.nodes.el.dataset.duration=o;const a=Math.min(j.max_height,j.max_height_video),i=Math.min(j.max_width,j.max_width_video);(t>a||n>i)&&this.fileError(`Video too large (video: ${t}x${n}px, max: ${a}x${i}px)`),(t<j.min_height||n<j.min_width)&&this.fileError(`Video too small (video: ${t}x${n}px, min: ${j.min_height}x${j.min_width}px)`),isFinite(o)?o>j.max_duration_video&&this.fileError(`Video too long (video: ${o}s, max: ${j.max_duration_video}s)`):this.fileError("Video lacks duration metadata (try remuxing)"),b.noAudio(Ee.BOARD.ID)&&Ve.hasAudio(e)&&this.fileError("Audio not allowed")}}setThumbnail(e){let t,n;const o="VIDEO"===e.tagName;let a=180*window.devicePixelRatio;if("image/gif"===this.file.type&&(a*=3),o)t=e.videoHeight,n=e.videoWidth;else if(({height:t,width:n}=e),t<a||n<a)return this.URL=e.src,void(this.nodes.el.style.backgroundImage=`url(${this.URL})`);t<=n?(n*=a/t,t=a):(t*=a/n,n=a);const i=Ve.el("canvas");i.height=t,i.width=n;const s=()=>{i.getContext("2d").drawImage(e,0,0,n,t),URL.revokeObjectURL(e.src),i.toBlob(e=>{this.URL=URL.createObjectURL(e),this.nodes.el.style.backgroundImage=`url(${this.URL})`})};o?(e.currentTime=0,e.addEventListener("seeked",s)):s()}rmFile(){this.isLocked||(delete this.file,delete this.filename,delete this.filesize,this.nodes.el.removeAttribute("title"),j.nodes.filename.removeAttribute("title"),this.rmMetadata(),this.nodes.el.style.backgroundImage="",Ve.rmClass(this.nodes.el,"has-file","has-image","has-video"),this.showFileData(),URL.revokeObjectURL(this.URL),this.dismissErrors(e=>Ve.hasClass(e,"file-error")),this.preventAutoPost())}rmMetadata(){for(var e of["type","height","width","duration"])this.nodes.el.removeAttribute(`data-${e}`)}saveFilename(){this.file.newName=(this.filename||"").replace(/[/\\]/g,"-"),j.validExtension.test(this.filename)||(this.file.newName+=`.${Ve.getOwn(j.extensionFromType,this.file.type)||"jpg"}`)}updateFilename(){const e=`${this.filename} (${this.filesize})`;this.nodes.el.title=e,this===j.selected&&(j.nodes.filename.title=e)}showFileData(){this.file?(this.updateFilename(),j.nodes.filename.value=this.filename,Ve.addClass(j.nodes.oekaki,"has-file"),Ve.addClass(j.nodes.fileSubmit,"has-file","has-"+this.file.type.split("/")[0])):(Ve.rmClass(j.nodes.oekaki,"has-file"),Ve.rmClass(j.nodes.fileSubmit,"has-file","has-image","has-video")),null!=this.file?.source?j.nodes.fileSubmit.dataset.source=this.file.source:j.nodes.fileSubmit.removeAttribute("data-source"),j.nodes.spoiler.checked=this.spoiler}pasteText(e){this.pasting=!0,this.preventAutoPost();const t=new FileReader;t.onload=e=>{const{result:t}=e.target;this.setComment(this.com?`${this.com}\n${t}`:t),delete this.pasting},t.readAsText(e)}dragStart(e){const{left:t,top:n}=this.getBoundingClientRect();e.dataTransfer.setDragImage(this,e.clientX-t,e.clientY-n),Ve.addClass(this,"drag")}dragEnd(){Ve.rmClass(this,"drag")}dragEnter(){Ve.addClass(this,"over")}dragLeave(){Ve.rmClass(this,"over")}dragOver(e){e.preventDefault(),e.dataTransfer.dropEffect="move"}drop(){if(Ve.rmClass(this,"over"),!this.draggable)return;const e=Ve(".drag",this.parentNode),t=e=>{for(let t=0;t<e.parentNode.children.length;t++)if(e.parentNode.children[t]===e)return t;return-1},n=t(e),o=t(this);if(j.posts[n].isLocked||j.posts[o].isLocked)return;(n<o?Ve.after:Ve.before)(this,e);const a=j.posts.splice(n,1)[0];j.posts.splice(o,0,a),j.status(),j.captcha.updateThread?.()}},U={binary(e,t,n=Fe()){e=e.replace(/^((?:https?:)?\/\/(?:\w+\.)?(?:4chan|4channel|4cdn)\.org)\/adv\//,"$1//adv/");const o=function(){return Ve.ajax(e,{headers:n,responseType:"arraybuffer",onloadend(){return this.status&&this.response?t(new Uint8Array(this.response),this.getAllResponseHeaders()):t(null)}})};if(void 0===window.GM_xmlhttpRequest||null===window.GM_xmlhttpRequest)return void o();const a={method:"GET",anonymous:!0,url:e,headers:n,responseType:"arraybuffer",overrideMimeType:"text/plain; charset=x-user-defined",onload(e){let n;if(e.response instanceof ArrayBuffer)n=new Uint8Array(e.response);else{const t=e.responseText;n=new Uint8Array(t.length);let o=0;for(;o<t.length;)n[o]=t.charCodeAt(o),o++}return t(n,e.responseHeaders)},onerror:()=>t(null),onabort:()=>t(null)};try{return(GM?.xmlHttpRequest||GM_xmlhttpRequest)(a)}catch(e){return o()}},file:(e,t)=>U.binary(e,function(n,o){if(null==n)return t(null);let a=e.match(/([^\/?#]+)\/*(?:$|[?#])/)?.[1];const i=o.match(/Content-Type:\s*(.*)/i)?.[1],s=o.match(/Content-Disposition:\s*(.*)/i)?.[1];let r=i?.match(/[^;]*/)[0]||"application/octet-stream";const l=s?.match(/\bfilename\s*=\s*"((\\"|[^"])+)"/i)?.[1]||i?.match(/\bname\s*=\s*"((\\"|[^"])+)"/i)?.[1];l&&(a=l.replace(/\\"/g,'"')),/^text\/plain;\s*charset=x-user-defined$/i.test(r)&&(r=Ve.getOwn(j.typeFromExtension,a.match(/[^.]*$/)[0].toLowerCase())||"application/octet-stream"),t(new File([n],a,{type:r}))}),Request:function(){const e=class{static initClass(){this.prototype.status=0,this.prototype.statusText="",this.prototype.response=null,this.prototype.responseHeaderString=null}getResponseHeader(e){var t,n,o,a;if(null==this.responseHeaders&&null!=this.responseHeaderString)for(t of(this.responseHeaders=Fe(),this.responseHeaderString.split("\r\n")))(n=t.indexOf(":"))>=0&&(o=t.slice(0,n).trim().toLowerCase(),a=t.slice(n+1).trim(),this.responseHeaders[o]=a);return this.responseHeaders?.[e.toLowerCase()]??null}abort(){}onloadend(){}};return e.initClass(),e}(),ajax(e,t={}){let n,{onloadend:o,timeout:a,responseType:i,headers:s}=t;null==i&&(i="json");const r=new U.Request;if(r.onloadend=o,null==window.GM?.xmlHttpRequest&&null==window.GM_xmlhttpRequest)return Ve.ajax(e,t);const l={method:"GET",anonymous:!0,url:e,headers:s,timeout:a,onload(t){try{let n=t.responseText;if("json"===i)try{n=JSON.parse(t.responseText)}catch(e){console.error(e),console.error(t)}Ve.extend(r,{url:e,headers:s,response:n,status:t.status,statusText:t.statusText,responseHeaderString:t.responseHeaders})}catch(e){}return r.onloadend()},onerror:()=>r.onloadend(),onabort:()=>r.onloadend(),ontimeout:()=>r.onloadend()};try{n=(GM?.xmlHttpRequest||GM_xmlhttpRequest)(l)}catch(n){return Ve.ajax(e,t)}return n&&"function"==typeof n.abort&&(r.abort=function(){try{return n.abort()}catch(e){}}),r},ajaxPromise:(e,t={})=>new Promise(n=>U.ajax(e,{...t,onloadend(){n(this)}})),cache:(e,t)=>Ve.cache(e,t,{ajax:U.ajax}),cachePromise:e=>new Promise(t=>{U.cache(e,function(){t(this)})}),permission:e=>e()},V={pause(e){if("VIDEO"===e.nodeName)return e.pause(),Ve.off(e,"volumechange",f.change),e.muted=!0},rewind(e){if("VIDEO"===e.nodeName){if(e.readyState>=e.HAVE_METADATA)return e.currentTime=0}else if(/\.gif$/.test(e.src))return Ve.queueTask(()=>e.src=e.src)},pushCache:e=>(V.cache=e,Ve.on(e,"error",V.cacheError)),popCache(){const e=V.cache;return Ve.off(e,"error",V.cacheError),delete V.cache,e},cacheError(){if(V.cache===this)return delete V.cache},decodeError(e,t){let n;return e.error?.code===MediaError.MEDIA_ERR_DECODE&&((n=Ve(".warning",t.thumb.parentNode))||(n=Ve.el("div",{className:"warning"}),Ve.after(t.thumb,n)),n.textContent="Error: Corrupt or unplayable video",!0)},isFromArchive:e=>"yotsuba"===Ee.SITE.software&&!o.test(e.src.split("/")[2]),error(e,t,n,o,a){let i;const s=n.url.split("/");let r=null;if("yotsuba"===Ee.SITE.software&&De["404 Redirect"]&&(r=K.to("file",{boardID:t.board.ID,filename:s[s.length-1]})),r&&K.securityCheck(r)||(r=null),(t.isDead||n.isDead)&&!V.isFromArchive(e))return a(r);if(null!=o&&(i=setTimeout(()=>a(r),o)),t.isDead||n.isDead)return;const l=function(){if(!V.isFromArchive(e))return null!=o&&clearTimeout(i),a(r)},d=Ee.SITE.urls.threadJSON?.(t);if(d){var c=function(e){let o,a;if(404===this.status){let o;!e&&(o=Ee.SITE.urls.archivedThreadJSON?.(t))?Ve.ajax(o,{onloadend(){return c.call(this,!0)}}):t.kill(!t.isClone,n.index)}if(200!==this.status)return l();for(a of this.response.posts)if(a.no===t.ID)break;return a.no!==t.ID?(t.kill(),l()):(o=n.docIndex,Ee.SITE.Build.parseJSON(a,t.board).filesDeleted.includes(o)?(t.kill(!0),l()):r=n.url)};return Ve.ajax(d,{onloadend(){return c.call(this)}})}},onControls:e=>De["Show Controls"]&&De["Click Passthrough"]&&"VIDEO"===e.target.nodeName||e.target.controls&&e.target.getBoundingClientRect().bottom-e.clientY<35,download(e){if("blob:"===this.protocol)return!0;e.preventDefault();const{href:t,download:n}=this;return U.file(t,function(e){if(e){const t=Ve.el("a",{href:URL.createObjectURL(e),download:n,hidden:!0});return Ve.add(Te.body,t),t.click(),Ve.rm(t)}return new It("warning",`Could not download ${t}`,20)})}};const At=e("div",{class:"box-inner"},e("div",{class:"boxbar"},e("h2",null,"Trouble buying a 4chan Pass? (a message from 4chan X)",e("a",{href:"javascript:;",style:"text-decoration: none; float: right; margin-right: 4px;",title:"Close"},"Ã—"))),e("div",{class:"boxcontent"},"Check the 4chan X wiki for ",e("a",{href:`${Ce.captchaFAQ}#alternatives`,target:"_blank",rel:"noopener"},"alternative solutions"),".")),vt={init(){if(De.passMessageClosed)return;const e=Ve.el("div",{className:"box-outer top-box"},At);e.style.cssText="padding-bottom: 0;";const t=Ve("a",e);return Ve.on(t,"click",function(){return Ve.rm(e),Ve.set("passMessageClosed",!0)}),Ve.ready(function(){let t;return(t=Ve.id("hd"))?Ve.after(t,e):Ve.prepend(Te.body,e)})}};Q={init(){let e;if(e=location.search.match(/\bno=(\d+)/))return bt.replace.init(),this.postID=+e[1],Ve.ready(this.ready)},ready:()=>(Ve.addStyle(Ye.report),De["Archive Report"]&&Q.archive(),new MutationObserver(function(){return Q.fit('iframe[src^="https://www.google.com/recaptcha/api2/frame"]'),Q.fit("body")}).observe(Te.body,{childList:!0,attributes:!0,subtree:!0}),Q.fit("body")),fit(e){let t;if(!(t=Ve(e,Re))||"hidden"===getComputedStyle(t).visibility)return;const n=t.getBoundingClientRect().bottom-Re.clientHeight+8;return n>0?window.resizeBy(0,n):void 0},archive(){let e,t;if(!(t=K.report(Ee.BOARD.ID)).length)return;const n=Ve("form"),o=Ve.id("reportTypes"),a=Ve("h3"),i=Ve.el("fieldset",{id:"archive-report",hidden:!0},{innerHTML:'<legend><label><input id="archive-report-enabled" type="checkbox">Report illegal content to archives</label></legend>\n<label for="archive-report-reason">Details</label>\n<textarea id="archive-report-reason" disabled>Illegal content</textarea>\n<button id="archive-report-submit" hidden>Submit</button>'}),s=Ve("#archive-report-enabled",i),r=Ve("#archive-report-reason",i),l=Ve("#archive-report-submit",i);if(Ve.on(s,"change",function(){return r.disabled=!this.checked}),n&&o?(i.hidden=!Ve('[value="31"]',o).checked,Ve.on(o,"change",function(e){return i.hidden="31"!==e.target.value,Q.fit("body")}),Ve.after(o,i),Q.fit("body"),Ve.one(n,"submit",function(e){if(!i.hidden&&s.checked)return e.preventDefault(),Q.archiveSubmit(t,r.value,e=>(this.action="#archiveresults="+encodeURIComponent(JSON.stringify(e)),this.submit()))})):a&&(i.hidden=/Report submitted!/.test(a.textContent),Ve.on(s,"change",function(){return l.hidden=!this.checked}),Ve.after(a,i),Ve.on(l,"click",()=>Q.archiveSubmit(t,r.value,Q.archiveResults))),e=location.hash.match(/^#archiveresults=(.*)$/))try{return Q.archiveResults(JSON.parse(decodeURIComponent(e[1])))}catch(e){}},archiveSubmit(e,t,n){const o=Ve.formData({board:Ee.BOARD.ID,num:Q.postID,reason:t}),a=[];for(var[i,s]of e)(function(t,i){Ve.ajax(i,{onloadend(){if(a.push([t,this.response||{error:""}]),a.length===e.length)return n(a)},form:o})})(i,s)},archiveResults(e){var t;const n=Ve.id("archive-report");for(var[o,a]of e)t=Ve.el("h3",{className:"archive-report-response"}),"success"in a?(Ve.addClass(t,"archive-report-success"),t.textContent=`${o}: ${a.success}`):(Ve.addClass(t,"archive-report-error"),t.textContent=`${o}: ${a.error||"Error reporting post."}`),n?Ve.before(n,t):Ve.add(Te.body,t)}};const xt={init(){if(De["Remember Your Posts"])return Ve.ready(this.ready)},ready(){if("Post successful!"!==Te.title)return;let[e,t,n]=Ve("h1").nextSibling.textContent.match(/thread:(\d+),no:(\d+)/);return n=+n,t=+t||n,new nt("yourPosts").set({boardID:Ee.BOARD.ID,threadID:t,postID:n,val:!0})}},wt={isOPContainerThread:!1,hasIPCount:!0,archivedBoardsKnown:!0,urls:{thread:({boardID:e,threadID:t})=>`${location.protocol}//${b.domain(e)}/${e}/thread/${t}`,post:({postID:e})=>`#p${e}`,index:({boardID:e})=>`${location.protocol}//${b.domain(e)}/${e}/`,catalog:({boardID:e})=>"f"===e?void 0:`${location.protocol}//${b.domain(e)}/${e}/catalog`,archive:({boardID:e})=>b.isArchived(e)?`${location.protocol}//${b.domain(e)}/${e}/archive`:void 0,threadJSON:({boardID:e,threadID:t})=>`${location.protocol}//a.4cdn.org/${e}/thread/${t}.json`,threadsListJSON:({boardID:e})=>`${location.protocol}//a.4cdn.org/${e}/threads.json`,archiveListJSON:({boardID:e})=>b.isArchived(e)?`${location.protocol}//a.4cdn.org/${e}/archive.json`:"",catalogJSON:({boardID:e})=>`${location.protocol}//a.4cdn.org/${e}/catalog.json`,file({boardID:e},t){const n="f"===e?o.flashHost():o.host();return`${location.protocol}//${n}/${e}/${t}`},thumb:({boardID:e},t)=>`${location.protocol}//${o.thumbHost()}/${e}/${t}`},isPrunedByAge:({boardID:e})=>"f"===e,areMD5sDeferred:({boardID:e})=>"f"===e,isOnePage:({boardID:e})=>"f"===e,noAudio:({boardID:e})=>b.noAudio(e),selectors:{board:".board",thread:".thread",threadDivider:".board > hr",summary:"a.summary",postContainer:".postContainer",replyOriginal:".replyContainer:not([data-clone])",sideArrows:"div.sideArrows",post:".post",infoRoot:".postInfo",info:{subject:".subject",name:".name",email:".useremail",tripcode:".postertrip",uniqueIDRoot:".posteruid",uniqueID:".posteruid > .hand",capcode:".capcode.hand",pass:".n-pu",flag:".flag, .bfl",date:".dateTime",nameBlock:".nameBlock",quote:".postNum > a:nth-of-type(2)",reply:".replylink"},icons:{isSticky:".stickyIcon",isClosed:".closedIcon",isArchived:".archivedIcon"},file:{text:".file > :first-child",link:".fileText > a",thumb:"a.fileThumb > [data-md5]"},thumbLink:"a.fileThumb",highlightable:{op:".opContainer",reply:" > .reply",catalog:""},comment:".postMessage",spoiler:"s",quotelink:":not(pre) > .quotelink",catalog:{board:"#threads",thread:".thread",thumb:".thumb"},boardList:"#boardNavDesktop > .boardList",boardListBottom:"#boardNavDesktopFoot > .boardList",styleSheet:"link[title=switch]",psa:"#globalMessage",psaTop:"#globalToggle",searchBox:"#search-box",nav:{prev:".prev > form > [type=submit]",next:".next > form > [type=submit]"}},classes:{highlight:"highlight"},xpath:{thread:'div[contains(concat(" ",@class," ")," thread ")]',postContainer:'div[contains(@class,"postContainer")]',replyContainer:'div[contains(@class,"replyContainer")]'},regexp:{quotelink:new RegExp("^https?://boards\\.4chan(?:nel)?\\.org/+([^/]+)/+thread/+(\\d+)(?:[/?][^#]*)?(?:#p(\\d+))?$"),quotelinkHTML:/<a [^>]*\bhref="(?:(?:\/\/boards\.4chan(?:nel)?\.org)?\/([^\/]+)\/thread\/)?(\d+)?(?:#p(\d+))?"/g,pass:/^https?:\/\/www\.4chan(?:nel)?\.org\/+pass(?:$|[?#])/,captcha:/^https?:\/\/sys\.4chan(?:nel)?\.org\/+captcha(?:$|[?#])/},bgColoredEl:()=>Ve.el("div",{className:"reply"}),isThisPageLegit:()=>["boards.4chan.org","boards.4channel.org"].includes(location.hostname)&&Te.doctype&&!Ve('link[href*="favicon-status.ico"]',Te.head)&&!["4chan - Temporarily Offline","4chan - Error","504 Gateway Time-out","MathJax Equation Source"].includes(Te.title),is404:()=>["4chan - Temporarily Offline","4chan - 404 Not Found"].includes(Te.title)||"thread"===Ee.VIEW&&Ve(".board")&&!Ve(".opContainer"),isIncomplete:()=>["index","thread"].includes(Ee.VIEW)&&!Ve(".board + *"),isBoardlessPage:e=>["www.4chan.org","www.4channel.org"].includes(e.hostname),isAuxiliaryPage:e=>!["boards.4chan.org","boards.4channel.org"].includes(e.hostname),isFileURL:e=>o.test(e.hostname),initAuxiliary(){switch(location.hostname){case"www.4chan.org":case"www.4channel.org":return void(wt.regexp.pass.test(location.href)?vt.init():(Ve.onExists(Re,"body",()=>Ve.addStyle(Ye.www)),bt.replace.init()));case"sys.4chan.org":case"sys.4channel.org":var e=location.pathname.split(/\/+/);if("imgboard.php"===e[2]){let e;/\bmode=report\b/.test(location.search)?Q.init():(e=location.search.match(/\bres=(\d+)/))&&Ve.ready(function(){if(De["404 Redirect"]&&"Error: Specified thread does not exist."===Ve.id("errmsg")?.textContent)return K.navigate("thread",{boardID:Ee.BOARD.ID,postID:+e[1]})})}else"post"===e[2]&&xt.init();return}},scriptData(){for(var e of Ge("script:not([src])",Te.head))if(/\bcooldowns *=/.test(e.textContent))return e.textContent;return""},parseThreadMetadata(e){let t;const n=this.scriptData();if(e.postLimit=/\bbumplimit *= *1\b/.test(n),e.fileLimit=/\bimagelimit *= *1\b/.test(n),e.ipCount=(t=n.match(/\bunique_ips *= *(\d+)\b/))?+t[1]:void 0,"f"===Ee.BOARD.ID&&e.OP.file){const{file:t}=e.OP;return Ve.ajax(this.urls.threadJSON({boardID:"f",threadID:e.ID}),{timeout:Oe,onloadend(){if(this.response)return t.text.dataset.md5=t.MD5=this.response.posts[0].md5}})}},parseNodes(e,t){if("f"===e.boardID)return(()=>{var e,n;const o=[];for(e of["Sticky","Closed"])(n=Ve(`img[alt=${e}]`,t.info))&&o.push(Ve.addClass(n,`${e.toLowerCase()}Icon`,"retina"));return o})()},parseDate:e=>new Date(1e3*e.dataset.utc),parseFile(e,t){let n;const{text:a,link:i,thumb:s}=t;if(!(n=i.nextSibling?.textContent.match(/\(([\d.]+ [KMG]?B).*\)/)))return!1;if(Ve.extend(t,{name:a.title||i.title||i.textContent,size:n[1],dimensions:n[0].match(/\d+x\d+/)?.[0],tag:n[0].match(/,[^,]*, ([a-z]+)\)/i)?.[1],MD5:a.dataset.md5}),s&&(Ve.extend(t,{thumbURL:s.src,MD5:s.dataset.md5,isSpoiler:Ve.hasClass(s.parentNode,"imgspoiler")}),t.isSpoiler)){let n;t.thumbURL=(n=i.href.match(/\d+(?=\.\w+$)/))?`${location.protocol}//${o.thumbHost()}/${e.board}/${n[0]}s.jpg`:void 0}return!0},cleanComment(e){var t,n;let o;if(o=Ve(".abbr",e)){for(t of Ge(".abbr + br, .exif",e))Ve.rm(t);for(let e=0;e<2;e++)(n=o.previousSibling)&&"BR"===n.nodeName&&Ve.rm(n);return Ve.rm(o)}},cleanCommentDisplay(e){let t;return(t=Ve("b",e))&&/^Rolled /.test(t.textContent)&&Ve.rm(t),Ve.rm(Ve(".fortune",e))},insertTags(e){let t;for(t of Ge("s, .removed-spoiler",e))Ve.replace(t,[Ve.tn("[spoiler]"),...t.childNodes,Ve.tn("[/spoiler]")]);for(t of Ge(".prettyprint",e))Ve.replace(t,[Ve.tn("[code]"),...t.childNodes,Ve.tn("[/code]")])},hasCORS:e=>e.split("/").slice(0,3).join("/")===location.protocol+"//a.4cdn.org",sfwBoards:e=>b.sfwBoards(e),uidColor(e){let t=0,n=0;for(;n<8;)t=(t<<5)-t+e.charCodeAt(n++);return t>>8&16777215},isLinkified:e=>o.test(e.hostname),testNativeExtension:()=>Ve.global("testNativeExtension",{}),transformBoardList(){var e,t,n;let o;const a=[],i=()=>Ve.el("span",{className:"spacer"}),s=Ve.X(".//a|.//text()[not(ancestor::a)]",Ve(wt.selectors.boardList));let r=0;for(;o=s.snapshotItem(r++);)switch(o.nodeName){case"#text":for(e of o.nodeValue)t=Ve.el("span",{textContent:e})," "===e&&(t.className="space"),"]"===e&&a.push(i()),a.push(t),"["===e&&a.push(i());break;case"A":n=o.cloneNode(!0),a.push(n)}return a},Build:{staticPath:"//s.4cdn.org/image/",gifIcon:window.devicePixelRatio>=2?"@2x.gif":".gif",spoilerRange:Object.create(null),shortFilename(e){const t=e.match(/\.?[^\.]*$/)[0];return e.length-t.length>30?`${e.match(/(?:[\uD800-\uDBFF][\uDC00-\uDFFF]|[^]){0,25}/)[0]}(...)${t}`:e},spoilerThumb(e){let t;return(t=this.spoilerRange[e])?`${this.staticPath}spoiler-${e}${Math.floor(1+t*Math.random())}.png`:`${this.staticPath}spoiler.png`},sameThread:(e,t)=>"thread"===Ee.VIEW&&Ee.BOARD.ID===e&&Ee.THREADID===+t,threadURL:(e,t)=>e!==Ee.BOARD.ID?`//${b.domain(e)}/${e}/thread/${t}`:"thread"!==Ee.VIEW||+t!==Ee.THREADID?`/${e}/thread/${t}`:"",postURL(e,t,n){return`${this.threadURL(e,t)}#p${n}`},parseJSON(e,{siteID:t,boardID:n}){const o={ID:e.no,postID:e.no,threadID:e.resto||e.no,boardID:n,siteID:t,isReply:!!e.resto,isSticky:!!e.sticky,isClosed:!!e.closed,isArchived:!!e.archived,threadReplies:e.replies,threadImages:e.images,fileDeleted:!!e.filedeleted,filesDeleted:e.filedeleted?[0]:[]};for(var a in o.info={subject:Ve.unescape(e.sub),email:Ve.unescape(e.email),name:Ve.unescape(e.name)||"",tripcode:e.trip,pass:null!=e.since4pass?`${e.since4pass}`:void 0,uniqueID:e.id,flagCode:e.country,flagCodeTroll:e.board_flag,flag:Ve.unescape(e.country_name||e.flag_name),dateUTC:e.time,dateText:e.now,commentHTML:{innerHTML:e.com||"",[Qe]:!0}},e.capcode&&(o.info.capcode=e.capcode.replace(/_highlight$/,"").replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),o.capcodeHighlight=/_highlight$/.test(e.capcode),delete o.info.uniqueID),o.files=[],e.ext&&(o.file=this.parseJSONFile(e,{siteID:t,boardID:n}),o.files.push(o.file)),o.extra=Fe(),e)"x"===a[0]&&(o.extra[a]=e[a]);return o},parseJSONFile(e,{siteID:t,boardID:n}){const o=Ee.sites[t],a="yotsuba"===o.software&&"f"===n?`${encodeURIComponent(e.filename)}${e.ext}`:`${e.tim}${e.ext}`,i={name:Ve.unescape(e.filename)+e.ext,url:o.urls.file({siteID:t,boardID:n},a),height:e.h,width:e.w,MD5:e.md5,size:Ve.bytesToString(e.fsize),thumbURL:o.urls.thumb({siteID:t,boardID:n},`${e.tim}s.jpg`),theight:e.tn_h,twidth:e.tn_w,isSpoiler:!!e.spoiler,tag:e.tag,hasDownscale:!!e.m_img};return null==e.h||/\.pdf$/.test(i.url)||(i.dimensions=`${i.width}x${i.height}`),i},parseComment:e=>(e=e.replace(/<br\b[^<]*>/gi,"\n").replace(/\n\n<span\b[^<]* class="abbr"[^]*$/i,"").replace(/<[^>]*>/g,""),Ve.unescape(e)),parseCommentDisplay(e){if(!De["Remove Spoilers"]&&!De["Reveal Spoilers"]){let t;for(;(t=e.replace(/<s>(?:(?!<\/?s>).)*<\/s>/g,"[spoiler]"))!==e;)e=t}return e=e.replace(/^<b\b[^<]*>Rolled [^<]*<\/b>/i,"").replace(/<span\b[^<]* class="fortune"[^]*$/i,""),this.parseComment(e).trim().replace(/\s+$/gm,"")},postFromObject(e,t){const n=this.parseJSON(e,{boardID:t,siteID:Ee.SITE.ID});return this.post(n)},post(t){var n,o,a;const{ID:i,threadID:s,boardID:r,file:l}=t,{subject:d,email:c,name:h,tripcode:u,capcode:p,pass:g,uniqueID:f,flagCode:m,flagCodeTroll:b,flag:A,dateUTC:v,dateText:x,commentHTML:w}=t.info,{staticPath:y,gifIcon:k}=this;let I,C,D;if(p)if(D=p.toLowerCase(),"Founder"===p)C="the Founder",I="4chan's Founder";else if("Verified"===p)C="Verified Users",I="";else{const e=Ve.getOwn({Admin:"Administrator",Mod:"Moderator"},p)||p;C=`${e}s`,I=`a 4chan ${e}`}const E=this.threadURL(r,s),S=function(t,n,o,a,i,s,r,l,d,c,h,u,p,g,f,m,b,A,v,x,w,y,k){const I=[e("span",{class:"name"+(a?" capcode":"")},s)];r&&I.push(" ",e("span",{class:"postertrip"},r)),l&&I.push(" ",e("span",{title:`Pass user since ${l}`,class:"n-pu"})),a&&I.push(" ",e("strong",{class:`capcode hand id_${d}`,title:`Highlight posts by ${c}`},"## ",a));const C=i?[" ",e("a",{href:`mailto:${i}`,class:"useremail"},...I)]:I;"f"===y&&!n.isReply||p||C.push(" "),p&&C.push(e("img",{src:`${h}${d}icon${u}`,alt:`${a} Icon`,title:`This user is ${p}.`,class:"identityIcon retina"})),g&&!a&&C.push(e("span",{class:`posteruid id_${g}`},"(ID: ",e("span",{class:"hand",title:"Highlight posts by this ID"},g),")")),m&&C.push(" ",e("span",{title:f,class:`flag flag-${m.toLowerCase()}`})),b&&C.push(" ",e("span",{title:f,class:`bfl bfl-${b.toLowerCase()}`}));const D=[e("a",{href:x,title:"Link to this post"},"No."),e("a",{href:w,title:"Reply to this post"},t)];if(n.isSticky){const t=`${h}sticky${u}`;D.push(" "),"f"===y?D.push(e("img",{src:t,alt:"Sticky",title:"Sticky",style:"height: 18px; width: 18px;"})):D.push(e("img",{src:t,alt:"Sticky",title:"Sticky",class:"stickyIcon retina"}))}if(n.isClosed&&!n.isArchived){D.push(" ");const t=`${h}closed${u}`;"f"===y?D.push(e("img",{src:t,alt:"Closed",title:"Closed",style:"height: 18px; width: 18px;"})):D.push(e("img",{src:t,alt:"Closed",title:"Closed",class:"closedIcon retina"}))}return n.isArchived&&D.push(" ",e("img",{src:`${h}archived${u}`,alt:"Archived",title:"Archived",class:"archivedIcon retina"})),n.isReply||"index"!==Ee.VIEW||D.push(" Â  ",e("span",null,"[",e("a",{href:`/${y}/thread/${k}`,class:"replylink"},"Reply"),"]")),e("div",{class:"postInfo desktop",id:`pi${t}`},e("input",{type:"checkbox",name:t,value:"delete"})," ",...!n.isReply||"f"===y||o?[e("span",{class:"subject"},o)," "]:[],e("span",{class:"nameBlock"+(a?` capcode${a}`:"")},...C)," ",e("span",{class:"dateTime","data-utc":A},v)," ",e("span",{class:"postNum"+(" f"!==y||n.isReply?" desktop":"")},...D))}(i,t,d,p,c,h,u,g,D,C,y,k,I,f,A,m,b,v,x,`${E}#p${i}`,this.sameThread(r,s)?`javascript:quote('${+i}');`:`${E}#q${i}`,r,s);let T,R,B,L;l&&(T=/^https?:(?=\/\/i\.4cdn\.org\/)/,R=l.url.replace(T,""),B=this.shortFilename(l.name),L=l.isSpoiler?this.spoilerThumb(r):l.thumbURL.replace(T,""));const N=function(t,n,o,a,i,s,r,l,d){if(t){const r=[];return"f"===o?r.push(e("div",{class:"fileInfo","data-md5":t.MD5},e("span",{class:"fileText",id:`fT${n}`},"File: ",e("a",{"data-width":t.width,"data-height":t.height,href:a,target:"_blank"},t.name),"-(",t.size,", ",t.dimensions,t.tag?", "+t.tag:"",")"))):r.push(e("div",{class:"fileText",id:`fT${n}`,title:t.isSpoiler?t.name:null},"File: ",e("a",{title:t.name===i||t.isSpoiler?null:t.name,href:a,target:"_blank"},t.isSpoiler?"Spoiler Image":i),` (${t.size}, ${t.dimensions||"PDF"})`),e("a",{class:"fileThumb"+(t.isSpoiler?" imgspoiler":""),href:a,target:"_blank","data-m":t.hasDownscale?"":null},e("img",{src:s,alt:t.size,"data-md5":t.MD5,style:`height: ${t.isSpoiler?"100":t.theight}px; width: ${t.isSpoiler?"100":t.twidth}px;`,loading:"lazy"}))),e("div",{class:"file",id:`f${n}`},...r)}return r.fileDeleted?e("div",{class:"file",id:`f${n}`},e("span",{class:"fileThumb"},e("img",{src:`${l}filedeleted-res${d}`,alt:"File deleted.",class:"fileDeletedRes retina"}))):{innerHTML:"",[Qe]:!0}}(l,i,r,R,B,L,t,y,k),M=t.isReply?"reply":"op",P=t.isReply?[S,N]:[N,S];P.push(e("blockquote",{class:"postMessage",id:`m${i}`},w)),t.isReply||null==t.threadReplies||P.push(e("span",{class:"summary preview-summary"},this.summaryText("",t.threadReplies,t.threadImages,!0)));const F=e(We,null,t.isReply?e("div",{class:"sideArrows",id:`sa${i}`},">>"):"",e("div",{id:`p${i}`,class:`post ${M}${t.capcodeHighlight?" highlightPost":""}`},...P)),$=Ve.el("div",{className:`postContainer ${M}Container`,id:`pc${i}`});for(n of(Ve.extend($,F),Ge(".quotelink",$)))"#"===(o=n.getAttribute("href"))[0]?this.sameThread(r,s)||(n.href=this.threadURL(r,s)+o):(a=n.href.match(wt.regexp.quotelink))&&this.sameThread(a[1],a[2])&&(n.href=o.match(/(#[^#]*)?$/)[0]||"#");return $},summaryText(e,t,n,o=!1){let a="";return e&&(a+=`${e} `),a+=`${t} post${1==t?"":"s"}`,+n&&(a+=` and ${n} image repl${n>1?"ies":"y"}`),o?a:`${a} ${"-"===e?"shown":"omitted"}.`},summary(e,t,n,o){return Ve.el("a",{className:"summary",textContent:this.summaryText("",n,o),href:`/${e}/thread/${t}`})},thread(e,t,n){let o;if((o=e.nodes.root)?Ve.rmAll(o):e.nodes.root=o=Ve.el("div",{className:"thread",id:`t${t.no}`}),this.hat&&Ve.add(o,this.hat.cloneNode(!1)),Ve.add(o,e.OP.nodes.root),t.omitted_posts||!n&&t.replies){const[a,i]=n?[t.omitted_posts,t.images-t.last_replies.filter(e=>!!e.ext).length]:[t.replies,t.images],s=this.summary(e.board.ID,t.no,a,i);Ve.add(o,s)}return o},catalogThread(t,n,o){let a,i,s;const{staticPath:r,gifIcon:l}=this,{tn_w:d,tn_h:c}=n;if(n.spoiler&&!De["Reveal Spoiler Thumbnails"]){let e;s=`${r}spoiler`,(e=this.spoilerRange[t.board])&&(s+=`-${t.board}`+Math.floor(1+e*Math.random())),s+=".png",i="spoiler-file",a="--tn-w: 100; --tn-h: 100;"}else if(n.filedeleted)s=`${r}filedeleted-res${l}`,i="deleted-file";else if(t.OP.file){s=t.OP.file.thumbURL;const e=250/Math.max(d,c);a=`--tn-w: ${d*e}; --tn-h: ${c*e};`}else s=`${r}nofile.png`,i="no-file";const h=n.replies+1,u=n.images+!!n.ext,p=Ve.el("div",function(t,n,o,a,i,s,r,l,d){return e(We,null,e("a",{class:"catalog-link",href:`/${t.board}/thread/${t.ID}`},e("img",o?{src:n,class:`catalog-thumb ${o}`}:{src:n,class:"catalog-thumb","data-width":a.tn_w,"data-height":a.tn_h})),e("div",{class:"catalog-stats"},e("span",{title:"Posts / Files / Page"},e("span",{class:"post-count"+(a.bumplimit?" warning":"")},i)," / ",e("span",{class:"file-count"+(a.imagelimit?" warning":"")},s)," / ",e("span",{class:"page-count"},r)),e("span",{class:"catalog-icons"},t.isSticky?e("img",{src:`${l}sticky${d}`,class:"stickyIcon",title:"Sticky"}):"",t.isClosed?e("img",{src:`${l}closed${d}`,class:"closedIcon",title:"Closed"}):"")))}(t,s,i,n,h,u,o,r,l));for(var g of(Ve.before(t.OP.nodes.info,[...p.childNodes]),Ge("br",t.OP.nodes.comment)))g.previousSibling&&"BR"===g.previousSibling.nodeName&&Ve.addClass(g,"extra-linebreak");const f=Ve.el("div",{className:"thread catalog-thread",id:`t${t}`});return t.OP.highlights&&Ve.addClass(f,...t.OP.highlights),t.OP.file||Ve.addClass(f,"noFile"),f.style.cssText=a||"",f},catalogReply(t,n){let o="";n.com&&(o=this.parseCommentDisplay(n.com).replace(/>>\d+/g,"").trim().replace(/\n+/g," // ")),n.ext&&(o||(o=`${Ve.unescape(n.filename)}${n.ext}`)),n.com&&(o||(o=Ve.unescape(n.com.replace(/<br\b[^<]*>/gi," // ")))),o||(o="Â "),o.length>73&&(o=`${o.slice(0,70)}...`);const a=this.postURL(t.board.ID,t.ID,n.no);return Ve.el("div",{className:"catalog-reply"},e(We,null,e("span",null,e("time",{"data-utc":1e3*n.time,"data-abbrev":"1"},"..."),": "),e("a",{class:"catalog-reply-excerpt",href:a},o),e("a",{class:"catalog-reply-preview",href:a},"...")))}}},yt={isOPContainerThread:!0,mayLackJSON:!0,threadModTimeIgnoresSage:!0,disabledFeatures:["Resurrect Quotes","Quick Reply Personas","Quick Reply","Cooldown","Report Link","Delete Link","Edit Link","Quote Inlining","Quote Previewing","Quote Backlinks","File Info Formatting","Image Expansion","Image Expansion (Menu)","Comment Expansion","Thread Expansion","Favicon","Quote Threading","Thread Updater","Banner","Flash Features","Reply Pruning"],detect(){var e,t,n,o;for(e of Ge("script:not([src])",Te.head))if(t=e.textContent.match(/\bvar configRoot=(".*?")/)){n=Fe();try{"/"===(o=JSON.parse(t[1]))[0]?n.root=location.origin+o:/^https?:/.test(o)&&(n.root=o)}catch(e){}return n}return!1},awaitBoard(e){if(Ve.id("react-ui")){const t=this.selectors=Object.create(this.selectors);return t.boardFor={index:".page-container"},t.thread='div[id^="thread_"]',ke.mounted(e)}return e()},urls:{thread:({siteID:e,boardID:t,threadID:n},o)=>`${De.siteProperties[e]?.root||`http://${e}/`}${t}/${o?"archive/":""}res/${n}.html`,post:({postID:e})=>`#${e}`,index:({siteID:e,boardID:t})=>`${De.siteProperties[e]?.root||`http://${e}/`}${t}/`,catalog:({siteID:e,boardID:t})=>`${De.siteProperties[e]?.root||`http://${e}/`}${t}/catalog.html`,threadJSON({siteID:e,boardID:t,threadID:n},o){const a=De.siteProperties[e]?.root;return a?`${a}${t}/${o?"archive/":""}res/${n}.json`:""},archivedThreadJSON:e=>yt.urls.threadJSON(e,!0),threadsListJSON({siteID:e,boardID:t}){const n=De.siteProperties[e]?.root;return n?`${n}${t}/threads.json`:""},archiveListJSON({siteID:e,boardID:t}){const n=De.siteProperties[e]?.root;return n?`${n}${t}/archive/archive.json`:""},catalogJSON({siteID:e,boardID:t}){const n=De.siteProperties[e]?.root;return n?`${n}${t}/catalog.json`:""},file:({siteID:e,boardID:t},n)=>`${De.siteProperties[e]?.root||`http://${e}/`}${t}/${n}`,thumb:(e,t)=>yt.urls.file(e,t)},selectors:{board:'form[name="postcontrols"]',thread:'input[name="board"] ~ div[id^="thread_"]',threadDivider:'div[id^="thread_"] > hr:last-child',summary:".omitted",postContainer:'div[id^="reply_"]:not(.hidden)',opBottom:".op",replyOriginal:'div[id^="reply_"]:not(.hidden)',infoRoot:".intro",info:{subject:".subject",name:".name",email:".email",tripcode:".trip",uniqueID:".poster_id",capcode:".capcode",flag:".flag",date:"time",nameBlock:"label",quote:'a[href*="#q"]',reply:'a[href*="/res/"]:not([href*="#"])'},icons:{isSticky:".fa-thumb-tack",isClosed:".fa-lock"},file:{text:".fileinfo",link:".fileinfo > a",thumb:"a > .post-image"},thumbLink:".file > a",multifile:".files > .file",highlightable:{op:" > .op",reply:".reply",catalog:" > .thread"},comment:".body",spoiler:".spoiler",quotelink:'a[onclick*="highlightReply("]',catalog:{board:"#Grid",thread:".mix",thumb:".thread-image"},boardList:".boardlist",boardListBottom:".boardlist.bottom",styleSheet:"#stylesheet",psa:".blotter",nav:{prev:".pages > form > [value=Previous]",next:".pages > form > [value=Next]"}},classes:{highlight:"highlighted"},xpath:{thread:'div[starts-with(@id,"thread_")]',postContainer:'div[starts-with(@id,"reply_") or starts-with(@id,"thread_")]',replyContainer:'div[starts-with(@id,"reply_")]'},regexp:{quotelink:new RegExp("/([^/]+)/res/(\\d+)(?:\\.\\w+)?#(\\d+)$"),quotelinkHTML:/<a [^>]*\bhref="[^"]*\/([^\/]+)\/res\/(\d+)(?:\.\w+)?#(\d+)"/g},Build:{parseJSON(e,t){const n=wt.Build.parseJSON(e,t);if("deleted"===e.ext&&(delete n.file,Ve.extend(n,{files:[],fileDeleted:!0,filesDeleted:[0]})),e.extra_files){let o;for(let a=0;a<e.extra_files.length;a++)"deleted"===e.extra_files[a].ext?n.filesDeleted.push(a):(o=wt.Build.parseJSONFile(e,t),n.files.push(o));n.files.length&&(n.file=n.files[0])}return n},parseComment:e=>(e=e.replace(/<br\b[^<]*>/gi,"\n").replace(/<[^>]*>/g,""),Ve.unescape(e))},bgColoredEl:()=>Ve.el("div",{className:"post reply"}),isFileURL:e=>/\/src\/[^\/]+/.test(e.pathname),preParsingFixes(e){let t;if(t=Ve('a > input[name="board"]',e))return Ve.before(t.parentNode,t)},parseNodes(e,t){let n;if(t.uniqueID)return;let o="",a=t.nameBlock.nextSibling;for(;a&&3===a.nodeType;)o+=a.textContent,a=a.nextSibling;if(n=o.match(/(\s*ID:\s*)(\S+)/)){let e;t.info.normalize();let{nextSibling:o}=t.nameBlock;return o=o.splitText(n[1].length),o.splitText(n[2].length),t.uniqueID=e=Ve.el("span",{className:"poster_id"}),Ve.replace(o,e),Ve.add(e,o)}},parseDate(e){let t=Date.parse(e.getAttribute("datetime")?.trim());return isNaN(t)?(t=Date.parse(e.textContent.trim()+" UTC"),isNaN(t)?void 0:new Date(t)):new Date(t)},parseFile(e,t){let n,o;const{text:a,link:i,thumb:s}=t;if(Ve.x(`ancestor::${this.xpath.postContainer}[1]`,a)!==e.nodes.root)return!1;if(!(o=i.nextSibling?.textContent.includes("(")?i.nextSibling:i.nextElementSibling))return!1;if(!(n=o.textContent.match(/\((.*,\s*)?([\d.]+ ?[KMG]?B).*\)/)))return!1;const r=Ve(".postfilename",a);return Ve.extend(t,{name:r?r.title||r.textContent:i.pathname.match(/[^/]*$/)[0],size:n[2],dimensions:n[0].match(/\d+x\d+/)?.[0]}),s&&Ve.extend(t,{thumbURL:/\/static\//.test(s.src)&&Ve.isImage(i.href)?i.href:s.src,isSpoiler:/^Spoiler/i.test(n[1]||"")||"Spoiler Image"===i.textContent}),!0},isThumbExpanded:e=>Ve.hasClass(e.thumb.parentNode,"expanded")||"true"===e.thumb.parentNode.dataset.expanded,isLinkified:e=>/\bnofollow\b/.test(e.rel),catalogPin:e=>e.dataset.sticky="true"},kt={tinyboard:yt,yotsuba:wt};z={init(){if(["index","thread","archive"].includes(Ee.VIEW)&&De["File Info Formatting"])return Ne.Post.push({name:"File Info Formatting",cb:this.node})},node(){if(!this.file)return;if(this.isClone){let e;for(e of Ge(".file-info .download-button",this.file.text))Ve.on(e,"click",V.download);for(e of Ge(".file-info .quick-filter-md5",this.file.text))Ve.on(e,"click",J.quickFilterMD5);return}const e=Ve.el("span",{className:"fileText-original"});Ve.prepend(this.file.link.parentNode,e),Ve.add(e,[this.file.link.previousSibling,this.file.link,this.file.link.nextSibling]);const t=Ve.el("span",{className:"file-info"});return z.format(De.fileInfo,this,t),Ve.prepend(this.file.text,t)},format(e,t,n){let o;const a=[];for(o of(e.replace(/%(.)|[^%]+/g,function(e,n){return a.push(Ve.hasOwn(z.formatters,n)?z.formatters[n].call(t):{innerHTML:Se(e)}),""}),Ve.extend(n,{innerHTML:Se.cat(a)}),Ge(".download-button",n)))Ve.on(o,"click",V.download);for(o of Ge(".quick-filter-md5",n))Ve.on(o,"click",J.quickFilterMD5)},formatters:{t(){return{innerHTML:Se(this.file.url.match(/[^/]*$/)[0]),[Qe]:!0}},T(){return e("a",{href:this.file.url,target:"_blank"},z.formatters.t.call(this))},l(){return e("a",{href:this.file.url,target:"_blank"},z.formatters.n.call(this))},L(){return e("a",{href:this.file.url,target:"_blank"},z.formatters.N.call(this))},n(){const t=this.file.name,n=kt.yotsuba.Build.shortFilename(this.file.name,this.isReply);return t===n?{innerHTML:Se(t),[Qe]:!0}:e("span",{class:"fnswitch"},e("span",{class:"fntrunc"},n),e("span",{class:"fnfull"},t))},N(){return{innerHTML:Se(this.file.name),[Qe]:!0}},d(){return e("a",{href:this.file.url,download:this.file.name,class:"download-button"},a.raw("download"))},f:()=>({innerHTML:`<a href="javascript:;" class="quick-filter-md5">${a.get("xmark")}</a>`,[Qe]:!0}),p(){return{innerHTML:this.file.isSpoiler?"Spoiler, ":"",[Qe]:!0}},s(){return{innerHTML:Se(this.file.size),[Qe]:!0}},B(){return{innerHTML:Math.round(this.file.sizeInBytes)+" Bytes",[Qe]:!0}},K(){return{innerHTML:Math.round(this.file.sizeInBytes/1024)+" KB",[Qe]:!0}},M(){return{innerHTML:Math.round(this.file.sizeInBytes/1048576*100)/100+" MB",[Qe]:!0}},r(){return{innerHTML:Se(this.file.dimensions||"PDF"),[Qe]:!0}},g(){return{innerHTML:this.file.tag?", "+Se(this.file.tag):"",[Qe]:!0}},"%":()=>({innerHTML:"%",[Qe]:!0})}},W={dialog:void 0,init(){const e=Ve.el("a",{className:"settings-link",title:`${Ce.name} Settings`,href:"javascript:;"});a.set(e,"wrench","Settings"),Ve.on(e,"click",W.open),Y.addShortcut("settings",e,820);const t=this.addSection;t("Main",this.main),t("Filter",this.filter),t("Sauce",this.sauce),t("Advanced",this.advanced),t("Keybinds",this.keybinds),Ve.on(Te,"AddSettingsSection",W.addSection),Ve.on(Te,"OpenSettings",e=>W.open(e.detail)),"yotsuba"===Ee.SITE.software&&De["Disable Native Extension"]&&Ve.global(Ve.hasStorage?"disableNativeExtension":"disableNativeExtensionNoStorage")},open(e){var t,n;let o,i;if(W.dialog)return;Ve.event("CloseMenu"),W.dialog=o=Ve.el("div",{id:"overlay"},_e),Ve.on(Ve(".export",o),"click",W.export),Ve.on(Ve(".import",o),"click",W.import),Ve.on(Ve(".reset",o),"click",W.reset),Ve.on(Ve("input",o),"change",W.onImport);const s=[];for(t of W.sections)n=Ve.el("a",{className:`tab-${t.hyphenatedTitle}`,textContent:t.title,href:"javascript:;"}),Ve.on(n,"click",W.openSection.bind(t)),s.push(n,Ve.tn(" | ")),t.title===e&&(i=n);s.pop(),Ve.add(Ve(".sections-list",o),s),"none"!==e&&(i||s[0]).click(),a.set(Ve(".close",o),"xmark"),Ve.on(Ve(".close",o),"click",W.close),Ve.on(window,"beforeunload",W.close),Ve.on(o,"click",()=>{"INPUT"!==Te.activeElement?.tagName&&"TEXTAREA"!==Te.activeElement?.tagName&&W.close()}),Ve.on(o.firstElementChild,"click",e=>e.stopPropagation()),Ve.add(Te.body,o),s[0].focus(),Ve.event("OpenSettings",null,o)},close(){W.dialog&&(Te.activeElement?.blur(),Ve.rm(W.dialog),delete W.dialog)},sections:[],addSection(e,t){"string"!=typeof e&&({title:e,open:t}=e.detail);const n=e.toLowerCase().replace(/\s+/g,"-");W.sections.push({title:e,hyphenatedTitle:n,open:t})},openSection(){let e;(e=Ve(".tab-selected",W.dialog))&&Ve.rmClass(e,"tab-selected"),Ve.addClass(Ve(`.tab-${this.hyphenatedTitle}`,W.dialog),"tab-selected");const t=Ve("section",W.dialog);Ve.rmAll(t),t.className=`section-${this.hyphenatedTitle}`,this.open(t,Ee),t.scrollTop=0,Ve.event("OpenSettings",null,t)},warnings:{localStorage(e){if(Ve.cantSync){const t=Ve.cantSet?"save your settings":"synchronize settings between tabs";e(Ve.el("li",{textContent:`${Ce.name} needs local storage to ${t}.\nEnable it on boards.${location.hostname.split(".")[1]}.org in your browser's privacy settings (may be listed as part of "local data" or "cookies").`}))}},ads(t){Ve.onExists(Re,".adg-rects > .desktop",n=>Ve.onExists(n,"iframe",function(){const n=K.to("thread",{boardID:"qa",threadID:362590});t(Ve.el("li",e(We,null,"To protect yourself from ",e("a",{href:n,target:"_blank"},"malicious ads"),", you should ",e("a",{href:"https://github.com/gorhill/uBlock#ublock-origin",target:"_blank"},"block ads")," on 4chan.")))}))}},main(e){var t,n,o;let a;const i=Ve.el("fieldset",{hidden:!0},{innerHTML:"<legend>Warnings</legend><ul></ul>"}),s=function(e){Ve.add(Ve("ul",i),e),i.hidden=!1};for(a in W.warnings)(0,W.warnings[a])(s);Ve.add(e,i);const r=Fe(),l=Fe(),d=function(e,t){var n,o,i,s,d,c;const h=[e],u=[];for(a in t)(n=t[a])instanceof Array&&(o=n[1],(i=Ve.el("div",{innerHTML:`<label><input type="checkbox" name="${a}">${a}</label><span class="description">: ${o}</span>`})).dataset.name=a,s=Ve("input",i),Ve.on(s,"change",Ve.cb.checked),Ve.on(s,"change",function(){this.parentNode.parentNode.dataset.checked=this.checked}),r[a]=De[a],l[a]=s,d=n[2]||0,h.length<=d?(c=Ve.el("div",{className:"suboption-list"}),Ve.add(h[h.length-1].lastElementChild,c),h[d]=c):h.length>d+1&&h.splice(d+1,h.length-(d+1)),u.push(Ve.add(h[d],i)));return u};for(t in Me.main)n=Me.main[t],d(o=Ve.el("fieldset",{innerHTML:`<legend>${t}</legend>`}),n),"Posting and Captchas"===t&&Ve.add(o,Ve.el("p",{innerHTML:'For more info on captcha options and issues, see the <a href="'+Ce.captchaFAQ+'" target="_blank">captcha FAQ</a>.'})),Ve.add(e,o);d(Ve('div[data-name="JSON Index"] > .suboption-list',e),Me.Index),Ve.get(r,function(e){for(a in e){var t=e[a];l[a].checked=t,l[a].parentNode.parentNode.dataset.checked=t}});const c=Ve.el("div",{innerHTML:'<button></button><span class="description">: Clear manually-hidden threads and posts on all boards. Reload the page to apply.'}),h=Ve("button",c);Ve.get({hiddenThreads:Fe(),hiddenPosts:Fe()},function({hiddenThreads:e,hiddenPosts:t}){let n,o,a,i,s=0;for(o in e)if(a=e[o],"boards"!==o)for(o in a.boards)n=a.boards[o],s+=Object.keys(n).length;for(o in e.boards)n=e.boards[o],s+=Object.keys(n).length;for(o in t)if(a=t[o],"boards"!==o)for(o in a.boards)for(o in n=a.boards[o],n)i=n[o],s+=Object.keys(i).length;for(o in t.boards)for(o in n=t.boards[o],n)i=n[o],s+=Object.keys(i).length;h.textContent=`Hidden: ${s}`}),Ve.on(h,"click",function(){this.textContent="Hidden: 0",Ve.get("hiddenThreads",Fe(),function({hiddenThreads:e}){if(Ve.hasStorage&&"yotsuba"===Ee.SITE.software){let t;for(t in e["4chan.org"]?.boards)localStorage.removeItem(`4chan-hide-t-${t}`);for(t in e.boards)localStorage.removeItem(`4chan-hide-t-${t}`)}Ve.delete(["hiddenThreads","hiddenPosts"])})}),Ve('input[name="Stubs"]',e).closest("fieldset").insertAdjacentElement("beforeend",c)},isExportModalOpen:!1,async export(){let e=De["Export History"],t=!1;if(De["Ask to Export History"]){if(W.isExportModalOpen)return;const n=rt.dialog("export-dialog",{innerHTML:'<form id="export-form">\n  <div class="move">Export settings</div>\n  <label><input name="history" type="checkbox" />Export history (last read, your posts, etc)</label><br />\n  <label><input name="ask" type="checkbox" checked />Ask every time.</label><br />\n  <button type="submit">Export</button>\n  <button type="button" id="cancel-export">Cancel</button>\n</form>'}),o=Ve("form",n),{history:a,ask:i}=o.elements;a.checked=De["Export History"],Ve.add(Te.body,n);const s=Ve(".export",W.dialog).getBoundingClientRect();if(n.style.top=`${s.y+s.height}px`,n.style.left=`${s.x}px`,W.isExportModalOpen=!0,await new Promise(s=>{const r=()=>{n.remove(),s(),W.isExportModalOpen=!1};Ve.on(o,"submit",t=>{t.preventDefault(),e=a.checked,Ve.set("Export History",e),Ve.set("Ask to Export History",i.checked),r()}),Ve.on(Ve("#cancel-export",n),"click",()=>{t=!0,r()})}),t)return}const n=Fe();Ve.extend(n,De),e||(delete n.hiddenThreads,delete n.hiddenPosts,delete n.hiddenPosterIds,delete n.lastReadPosts,delete n.yourPosts,delete n.watchedThreads,delete n.cooldowns,delete n["Index Sort"]),Ve.get(n,function(e){delete e.boardConfig,W.downloadExport({version:Ee.VERSION,date:Date.now(),Conf:e})})},downloadExport(e){const t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),n=URL.createObjectURL(t),o=Ve.el("a",{download:`${Ce.name} v${Ee.VERSION}-${e.date}.json`,href:n}),a=Ve(".imp-exp-result",W.dialog);Ve.rmAll(a),Ve.add(a,o),o.click()},import(){Ve("input[type=file]",this.parentNode).click()},onImport(){let e;if(!(e=this.files[0]))return;this.value=null;const t=Ve(".imp-exp-result");if(!confirm("Your current settings will be entirely overwritten, are you sure?"))return void(t.textContent="Import aborted.");const n=new FileReader;n.onload=function(e){try{W.loadSettings(Fe.json(e.target.result),function(e){e?t.textContent="Import failed due to an error.":confirm("Import successful. Reload now?")&&window.location.reload()})}catch(e){const n=e;t.textContent="Import failed due to an error.",Be.error(n.stack)}},n.readAsText(e)},upgrade(e,t){let n,o,a;const i=Fe(),s=(t,n)=>e[t]=i[t]=n;if(n='"'===t[0])try{t=JSON.parse(t)}catch(e){}const r=t.replace(/^XT /i,"").replace(/\d+/g,e=>e.padStart(5,"0"));if(n)for(o in e)if(a=e[o],"string"==typeof a)try{s(o,JSON.parse(a))}catch(e){}return r<"00001.00014.00016.00001"&&null!=e.archiveLists&&s("archiveLists",e.archiveLists.replace("https://mayhemydg.github.io/archives.json/archives.json","https://nstepien.github.io/archives.json/archives.json")),r<"00001.00014.00016.00007"&&null!=e.sauces&&s("sauces",e.sauces.replace(/https:\/\/www\.deviantart\.com\/gallery\/#\/d%\$1%\$2;regexp:\/\^\\w\+_by_\\w\+\[_-\]d\(\[\\da-z\]\{6\}\)\\b\|\^d\(\[\\da-z\]\{6\}\)-\[\\da-z\]\{8\}-\//g,'javascript:void(open("https://www.deviantart.com/"+%$1.replace(/_/g,"-")+"/art/"+parseInt(%$2,36)));regexp:/^\\w+_by_(\\w+)[_-]d([\\da-z]{6})\\b/').replace(/\/\/imgops\.com\/%URL/g,"//imgops.com/start?url=%URL")),r<"00001.00014.00017.00002"&&null!=e.jsWhitelist&&s("jsWhitelist",e.jsWhitelist+"\n\nhttps://hcaptcha.com\nhttps://*.hcaptcha.com"),r<"00001.00014.00020.00004"&&null!=e.archiveLists&&s("archiveLists",e.archiveLists.replace("https://nstepien.github.io/archives.json/archives.json","https://4chenz.github.io/archives.json/archives.json")),r<"00001.00014.00022.00003"&&e.sauces&&(s("sauces",e.sauces.replace(/^#?\s*https:\/\/www\.google\.com\/searchbyimage\?image_url=%(IMG|T?URL)&safe=off(?=$|;)/gm,"https://www.google.com/searchbyimage?sbisrc=4chanx&image_url=%$1&safe=off")),"00001.00014.00022.00002"!==r||/\bsbisrc=/.test(e.sauces)||s("sauces",e.sauces.replace(/^#?\s*https:\/\/lens\.google\.com\/uploadbyurl\?url=%(IMG|T?URL)(?=$|;)/m,"https://www.google.com/searchbyimage?sbisrc=4chanx&image_url=%$1&safe=off"))),r<"00002.00003.00001.00000"&&e.boardnav&&s("boardnav",e.boardnav.replace('[external-text:"FAQ","4chan XT"]',`[external-text:"FAQ","${Ce.faq}"]`)),r<"00002.00003.00006.00000"&&s("RelativeTime",e["Relative Post Dates"]?e["Relative Date Title"]?"Hover":"Show":"No"),"00002.00009.00000.00000"===r&&(s("XEmbedder",e["Embed Tweets inline with fxTwitter"]?"fxt":"tf"),s("fxtMaxReplies",e["Resolve Tweet Replies"]?e["Resolve all Tweet Replies"]?100:1:0),s("fxtLang",e["Translate non-English Tweets to English"]?"en":"")),i},loadSettings(e,t){e.version!==Ee.VERSION&&W.upgrade(e.Conf,e.version),Ve.clear(function(n){if(n)return t(n);Ve.set(e.Conf,t)})},reset(){confirm("Your current settings will be entirely wiped, are you sure?")&&Ve.clear(function(e){e?Ve(".imp-exp-result").textContent="Import failed due to an error.":confirm("Reset successful. Reload now?")&&window.location.reload()})},filter(e){Ve.extend(e,{innerHTML:'<select name="filter">\n  <option value="guide">Guide</option>\n  <option value="general">General</option>\n  <option value="postID">Post number</option>\n  <option value="name">Name</option>\n  <option value="uniqueID">Unique ID</option>\n  <option value="tripcode">Tripcode</option>\n  <option value="capcode">Capcode</option>\n  <option value="pass">Pass Date</option>\n  <option value="email">Email</option>\n  <option value="subject">Subject</option>\n  <option value="comment">Comment</option>\n  <option value="flag">Flag</option>\n  <option value="filename">Filename</option>\n  <option value="dimensions">Image dimensions</option>\n  <option value="filesize">Filesize</option>\n  <option value="MD5">Image MD5</option>\n  </select>\n<div></div>'});const t=Ve("select",e);Ve.on(t,"change",W.selectFilter),W.selectFilter.call(t)},selectFilter(){let e;const t=this.nextElementSibling;if("guide"!==(e=this.value)){if(!Ve.hasOwn(Me.filter,e))return;Ve.rmAll(t);const n=Ve.el("textarea",{name:e,className:"field",spellcheck:!1});return Ve.on(n,"change",Ve.cb.value),void Ve.get(e,De[e],function(o){n.value=o[e],Ve.add(t,n)})}const n=Object.keys(Me.filter).filter(e=>"general"!==e).join(",â€‹");Ve.extend(t,{innerHTML:'<div class="warning"><code>Filter</code> is disabled.</div>\n<p>\n  Use <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions" target="_blank">regular expressions</a>, one per line.<br>\n  Lines starting with a <code>#</code> will be ignored.<br>\n  For example, <code>/weeaboo/i</code> will filter posts containing the string `<code>weeaboo</code>`, case-insensitive.<br>\n  MD5 and Unique ID filtering use exact string matching, not regular expressions.\n</p>\n<ul>You can use these settings with each regular expression, separate them with semicolons:\n  <li>\n    Per boards, separate them with commas. It is global if not specified. Use <code>sfw</code> and <code>nsfw</code> to reference all worksafe or not-worksafe boards.<br>\n    For example: <code>boards:a,jp;</code>.<br>\n    To specify boards on a particular site, put the beginning of the domain and a slash character before the list.<br>\n    Any initial <code>www.</code> should not be included, and all 4chan domains are considered <code>4chan.org</code>.<br>\n    For example: <code>boards:4:a,jp,sama:a,z;</code>.<br>\n    An asterisk can be used to specify all boards on a site.<br>\n    For example: <code>boards:4:*;</code>.<br>\n  </li>\n  <li>\n    Show a custom reason in the stub. If not given, the type and regex will be shown.<br>\n    For example: <code>reason:This is bait;</code>\n  </li>\n  <li>\n    Select boards to be excluded from the filter. The syntax is the same as for the <code>boards:</code> option above.<br>\n    For example: <code>exclude:vg,v;</code>.\n  </li>\n  <li>\n    Filter OPs only along with their threads (`only`) or replies only (`no`).<br>\n    For example: <code>op:only;</code> or <code>op:no;</code>.\n  </li>\n  <li>\n    Filter only posts with files (`only`) or only posts without files (`no`).<br>\n    For example: <code>file:only;</code> or <code>file:no;</code>.\n  </li>\n  <li>\n    Overrule the `Show Stubs` setting if specified: create a stub (`yes`) or not (`no`).<br>\n    For example: <code>stub:yes;</code> or <code>stub:no;</code>.\n  </li>\n  <li>\n    Highlight instead of hiding. You can specify a class name to use with a userstyle.<br>\n    For example: <code>highlight;</code> or <code>highlight:wallpaper;</code>.\n  </li>\n  <li>\n    Highlighted OPs will have their threads put on top of the board index by default.<br>\n    For example: <code>top:yes;</code> or <code>top:no;</code>.\n  </li>\n  <li>Show a desktop notification instead of hiding: <code>notify;</code>.</li>\n  <li>Hide all posts from this poster: <code>poster;</code>.</li>\n  <li>Recursively hide replies: <code>replies;</code>.</li>\n  <li>Hide anyway even if highlighting. The highlight class will be applied to the stub: <code>hide;</code>.</li>\n  <li>\n    Filters in the "General" section apply to multiple fields, by default <code>subject,name,filename,comment</code>.<br>\n    The fields can be specified with the <code>type</code> option, separated by commas.<br>\n    For example: <code id="filterTypes"></code>.<br>\n    Types can also be combined with a <code>+</code> sign; this indicates the filter applies to the given fields joined by newlines.<br>\n    For example: <code>type:filename+filesize+dimensions;</code>.<br>\n  </li>\n</ul>'}),Ve("#filterTypes",t).textContent=`type:â€‹${n};`,Ve(".warning",t).hidden=De.Filter},sauce(e){Ve.extend(e,{innerHTML:'<div class="warning"><code>Sauce</code> is disabled.</div>\n<input id="sauce-doc-expand" type="checkbox" hidden>\n<div id="sauce-doc">\n  <label for="sauce-doc-expand">[expand]</label>\n  <div>These parameters will be replaced by their corresponding values in the URL and displayed text:</div>\n  <ul>\n    <li><code>%IMG</code>: Full image URL for GIF, JPG, and PNG; thumbnail URL for other types.</li>\n    <li><code>%URL</code>: Full image URL.</li>\n    <li><code>%TURL</code>: Thumbnail URL.</li>\n    <li><code>%name</code>: Original file name.</li>\n    <li><code>%board</code>: Current board.</li>\n    <li><code>%MD5</code>: MD5 hash in base64.</li>\n    <li><code>%sMD5</code>: MD5 hash in base64 using <code>-</code> and <code>_</code>.</li>\n    <li><code>%hMD5</code>: MD5 hash in hexadecimal.</li>\n    <li><code>%$0</code>: Matched regular expression within the filename.</li>\n    <li><code>%$1</code>, <code>%$2</code>, <code>%$3</code>, ... : Subexpressions within the matched regular expression.</li>\n    <li><code>%%</code>, <code>%semi</code>: Literal <code>%</code> and <code>;</code>.</li>\n  </ul>\n  <div>Lines starting with a <code>#</code> will be ignored.</div>\n  <div>You can specify a display text by appending <code>;text:[text]</code> to the URL.</div>\n  <div>You can specify the applicable boards/sites by appending <code>;boards:[board1],[board2]</code>. See the Filter guide for details.</div>\n  <div>You can specify the applicable file types by appending <code>;types:[extension1],[extension2]</code>.</div>\n  <div>You can specify a regular expression the filename must match by appending <code>;regexp:[regular expression]</code>.</div>\n</div>\n<textarea hidden name="sauces" class="field" spellcheck="false"></textarea>'}),Ve(".warning",e).hidden=De.Sauce;const t=Ve("textarea",e);Ve.get("sauces",De.sauces,function(e){t.value=e.sauces,t.hidden=!1}),Ve.on(t,"change",Ve.cb.value)},advanced(e){var t,n,a;let i,s;for(t of(Ve.extend(e,{innerHTML:'<fieldset>\n  <legend>Archives</legend>\n  <div class="warning" data-feature="404 Redirect"><code>404 Redirect</code> is disabled.</div>\n  <select id="archive-board-select"></select>\n  <table id="archive-table">\n    <thead>\n      <th>Thread redirection</th>\n      <th>Thread fetching</th>\n      <th>Post fetching</th>\n      <th>File redirection</th>\n    </thead>\n    <tbody></tbody>\n  </table>\n  <br>\n  <div>\n    <b>Archive Lists</b>: Each line below should be an archive list in <a href="https://github.com/4chenz/archives.json/blob/gh-pages/CONTRIBUTING.md" target="_blank">this format</a> or a URL to load an archive list from.<br>\n    Archive properties can be overriden by another item with the same <code>uid</code> (or if absent, its <code>name</code>).\n  </div>\n  <textarea hidden name="archiveLists" class="field" spellcheck="false"></textarea>\n  <button id="update-archives">Update now</button> Last updated: <time id="lastarchivecheck"></time> <label><input type="checkbox" name="archiveAutoUpdate"> Auto-update</label>\n</fieldset>\n\n<fieldset>\n  <legend>External Catalog</legend>\n  <div class="warning" data-feature="External Catalog"><code>External Catalog</code> is disabled. This will be used only as a fallback.</div>\n  <div>\n    URLs of external catalog sites, where <code>%board</code> is to be replaced by the board name.<br>\n    Each URL should be followed by <code>;boards:</code> and optionally <code>;exclude:</code> and a list of supported/excluded boards in the format explained in the Filter guide.\n  </div>\n  <textarea hidden name="externalCatalogURLs" class="field" spellcheck="false"></textarea>\n</fieldset>\n\n<fieldset>\n  <legend>Override 4chan Image Host</legend>\n  <div>Change 4chan image links to this domain. Leave blank for no change.</div>\n  <div><input name="fourchanImageHost" class="field" spellcheck="false" list="list-fourchanImageHost"></div>\n  <datalist id="list-fourchanImageHost"></datalist>\n</fieldset>\n\n<fieldset>\n  <legend>Captcha Language</legend>\n  <div>Choose from <a href="https://developers.google.com/recaptcha/docs/language" target="_blank">list of language codes</a>. Leave blank to autoselect.</div>\n  <div><input name="captchaLanguage" class="field" spellcheck="false"></div>\n</fieldset>\n\n<fieldset>\n  <legend>Custom Board Navigation</legend>\n  <div><textarea hidden name="boardnav" class="field" spellcheck="false"></textarea></div>\n  <span class="note">New lines will be converted into spaces.</span><br><br>\n  <div class="note">In the following examples for /g/, <code>g</code> can be changed to a different board ID (<code>a</code>, <code>b</code>, etc...), the current board (<code>current</code>), or the Twitter link (<code>@</code>).</div>\n  <div>Board link: <code>g</code></div>\n  <div>Archive link: <code>g-archive</code></div>\n  <div>Internal archive link: <code>g-expired</code></div>\n  <div>Title link: <code>g-title</code></div>\n  <div>Board link (Replace with title when on that board): <code>g-replace</code></div>\n  <div>Full text link: <code>g-full</code></div>\n  <div>Custom text link: <code>g-text:&quot;Install Gentoo&quot;</code></div>\n  <div>Index-only link: <code>g-index</code></div>\n  <div>Catalog-only link: <code>g-catalog</code></div>\n  <div>Index mode: <code>g-mode:&quot;infinite scrolling&quot;</code></div>\n  <div>Index sort: <code>g-sort:&quot;creation date rev&quot;</code></div>\n  <div>External link: <code>external-text:&quot;Google&quot;,&quot;http://www.google.com&quot;</code></div>\n  <div>Open in new tab: <code>g-nt</code></div>\n  <div>Combinations are possible: <code>g-index-text:&quot;Technology Index&quot;</code></div>\n  <div>Full board list toggle: <code>toggle-all</code></div>\n  <br>\n  <div class="note">\n    <code>[ toggle-all ] [current-title] [g-title / a-title / jp-title] [x / wsg / h] [t-text:&quot;Piracy&quot;]</code><br>\n    will give you<br>\n    <code>[ + ] [Technology] [Technology / Anime & Manga / Otaku Culture] [x / wsg / h] [Piracy]</code><br>\n    if you are on /g/.\n  </div>\n  <div class="note">\n    For custom styling, you can wrap groups or individual links in <code>{{</code> and <code>}}</code>, to wrap them in\n    a span. You can also add classes in double quotes right after the {{. For example: <br />\n    <code>[g-title] {{"favorites"[a-title / jp-title]}}</code><br />\n    Results in:<br />\n    <code>[&lt;a [...] &gt;Technology&lt;/a&gt;] &lt;span class="favorites"&gt;[&lt;a [...] &gt;Anime &amp;amp;\n      Manga&lt;/a&gt; / &lt;a [...] &gt;Otaku Culture&lt;/a&gt;]&lt;/span&gt;</code>\n  </div>\n</fieldset>\n\n<fieldset>\n  <legend>\n    Time Formatting\n    <span class="warning" data-feature="Time Formatting">is disabled, relative time setting still applies.</span>\n  </legend>\n  <div><input name="time" class="field" spellcheck="false">: <span class="time-preview"></span></div>\n  <div>Supported <a href="http://man7.org/linux/man-pages/man1/date.1.html" target="_blank">format specifiers</a>:</div>\n  <div>Day: <code>%a</code>, <code>%A</code>, <code>%d</code>, <code>%e</code></div>\n  <div>Month: <code>%m</code>, <code>%b</code>, <code>%B</code>, <code>%n</code> (Not zero padded)</div>\n  <div>Year: <code>%y</code>, <code>%Y</code></div>\n  <div>Hour: <code>%k</code>, <code>%H</code>, <code>%l</code>, <code>%I</code>, <code>%p</code>, <code>%P</code></div>\n  <div>Minute: <code>%M</code></div>\n  <div>Second: <code>%S</code></div>\n  <div>Literal <code>%</code>: <code>%%</code></div>\n  <div><a href="https://www.w3.org/International/articles/language-tags/" target="_blank">Language tag</a>: <input name="timeLocale" class="field" spellcheck="false"></div>\n  <div>Relative time, like "3 minutes ago":\n    <select name="RelativeTime">\n      <option value="No">Disabled</option>\n      <option value="Hover">Show when hovering on the date</option>\n      <option value="Show">Show relative time, and time and date on hover</option>\n      <option value="Both">Show both timestamp and relative date</option>\n      <option value="BothRelativeFirst">Show both relative date and timestamp</option>\n    </select>\n  </div>\n</fieldset>\n\n<fieldset>\n  <legend>Quote Backlinks formatting <span class="warning" data-feature="Quote Backlinks">is disabled.</span></legend>\n  <div><input name="backlink" class="field" spellcheck="false">: <span class="backlink-preview"></span></div>\n</fieldset>\n\n<fieldset>\n  <legend>Default pasted content filename</legend>\n  <div><input name="pastedname" class="field" spellcheck="false">.png</div>\n</fieldset>\n\n<fieldset>\n  <legend>File Info Formatting <span class="warning" data-feature="File Info Formatting">is disabled.</span></legend>\n  <div><input name="fileInfo" class="field" spellcheck="false">: <span class="file-info file-info-preview"></span></div>\n  <div>Link: <code>%l</code> (truncated), <code>%L</code> (untruncated), <code>%T</code> (4chan filename)</div>\n  <div>Filename: <code>%n</code> (truncated), <code>%N</code> (untruncated), <code>%t</code> (4chan filename)</div>\n  <div>Download button: <code>%d</code></div>\n  <div>Quick filter MD5: <code>%f</code></div>\n  <div>Spoiler indicator: <code>%p</code></div>\n  <div>Size: <code>%B</code> (Bytes), <code>%K</code> (KB), <code>%M</code> (MB), <code>%s</code> (4chan default)</div>\n  <div>Resolution: <code>%r</code> (Displays &#039;PDF&#039; for PDF files)</div>\n  <div>Tag: <code>%g</code>\n  <div>Literal <code>%</code>: <code>%%</code></div>\n</fieldset>\n\n<fieldset>\n  <legend>Quick Reply Personas</legend>\n  <textarea hidden class="personafield field" name="QR.personas" spellcheck="false"></textarea>\n  <p>\n    One item per line.<br>\n    Items will be added in the relevant input&#039;s auto-completion list.<br>\n    Password items will always be used, since there is no password input.<br>\n    Lines starting with a <code>#</code> will be ignored.\n  </p>\n  <ul>You can use these settings with each item, separate them with semicolons:\n    <li>Possible items are: <code>name</code>, <code>options</code> (or equivalently <code>email</code>), <code>subject</code> and <code>password</code>.</li>\n    <li>Wrap values of items with quotes, like this: <code>options:&quot;sage&quot;</code>.</li>\n    <li>Force values as defaults with the <code>always</code> keyword, for example: <code>options:&quot;sage&quot;;always</code>.</li>\n    <li>Select specific boards for an item, separated with commas, for example: <code>options:&quot;sage&quot;;boards:jp;always</code>.</li>\n  </ul>\n</fieldset>\n\n<fieldset>\n  <legend>Unread Favicon <span class="warning" data-feature="Unread Favicon">is disabled.</span></legend>\n  <select name="favicon">\n    <option value="ferongr">ferongr</option>\n    <option value="xat-">xat-</option>\n    <option value="4chanJS">4chanJS</option>\n    <option value="Mayhem">Mayhem</option>\n    <option value="Original">Original</option>\n    <option value="Metro">Metro</option>\n  </select>\n  <span class="favicon-preview"></span>\n</fieldset>\n\n<fieldset>\n  <legend>Thread Updater <span class="warning" data-feature="Thread Updater">is disabled.</span></legend>\n  <div>\n    Interval: <input type="number" name="Interval" class="field" min="1"> seconds\n  </div>\n</fieldset>\n\n<fieldset>\n    <legend>Custom Cooldown Time</legend>\n    <div>\n        Seconds: <input type="number" name="customCooldown" class="field" min="0">\n    </div>\n</fieldset>\n\n<fieldset>\n  <legend>\n    <label><input type="checkbox" name="Custom CSS"> Custom CSS</label>\n  </legend>\n  <div>For more information about customizing 4chan X&#039;s CSS, see the <a href="https://github.com/ccd0/4chan-x/wiki/Styling-Guide" target="_blank">styling guide</a>.</div>\n  <button id="apply-css">Apply CSS</button>\n  <textarea hidden name="usercss" class="field" spellcheck="false"></textarea>\n</fieldset>\n\n<fieldset>\n  <legend>Javascript Whitelist</legend>\n  <div>\n    Sources from which Javascript is allowed to be loaded by <a href="http://content-security-policy.com/#source_list" target="_blank">Content Security Policy</a>.<br>\n    Lines starting with a <code>#</code> will be ignored. Remove or comment out all lines to allow everything.\n  </div>\n  <textarea hidden name="jsWhitelist" class="field" spellcheck="false"></textarea>\n</fieldset>\n\n<fieldset>\n  <legend>Known Banners</legend>\n  <div>List of known banners, used for click-to-change feature.</div>\n  <textarea hidden name="knownBanners" class="field" spellcheck="false"></textarea>\n</fieldset>\n\n<fieldset>\n  <legend>X (formerly Twitter) embeds</legend>\n  <div>Only applies if embeds are enabled in the main settings</div>\n  <label>Service to use for embeds\n    <select name="XEmbedder">\n      <option value="fxt">FxTwitter</option>\n      <option value="tf">Twitframe</option>\n    </select>\n  </label><br />\n  <label>\n    Language to translate FxTwitter embeds to, as a two character ISO code, like <code>en</code>.\n    Leave empty for no translation.\n    <input name="fxtLang" maxlength="2" class="field" />\n  </label><br />\n  <label>FxTwitter endpoint <input name="fxtUrl" type="url" class="field" /></label><br />\n  <label>FxTwitter maximum amount of replies include\n    <input name="fxtMaxReplies" type="number" min="0" step="1" max="100" class="field" />\n  </label>\n</fieldset>\n\n<fieldset>\n  <legend>Thread updater sound</legend>\n  <label>\n    Sound volume, between 0 and 1:\n    <input name="beepVolume" type="number" min=".01" max="1" step=".01" class="field" />\n  </label><br />\n  <label>\n    Sound url. Can be a base64 one starting with <code>data:</code>. Leave empty for the default beep.\n    <input type="string" name="beepSource" class="field wide" />\n  </label>\n</fieldset>'}),Ge(".warning",e)))t.hidden=De[t.dataset.feature];const r=Fe();for(i of Ge("[name]",e))r[i.name]=i;Ve.on(r.archiveLists,"change",function(){Ve.set("lastarchivecheck",0),De.lastarchivecheck=0,Ve.id("lastarchivecheck").textContent="never"});const l=Fe();for(s in r)i=r[s],["Interval","Custom CSS","timeLocale"].includes(s)||(l[s]=De[s],n="SELECT"===i.nodeName||["checkbox","radio"].includes(i.type)||"TEXTAREA"===i.nodeName&&!(s in W)?"change":"input",Ve.on(i,n,Ve.cb["checkbox"===i.type?"checked":"value"]),s in W&&Ve.on(i,n,W[s]));Ve.get(l,function(e){var t,n;for(t in e)n=e[t],i=r[t],i["checkbox"===i.type?"checked":"value"]=n,i.hidden=!1,t in W&&W[t].call(i)});const d=Ve.id("list-fourchanImageHost");for(a of o.suggestions)Ve.add(d,Ve.el("option",{textContent:a}));const c=r.Interval,h=r["Custom CSS"],u=Ve("#apply-css",e),p=r.timeLocale;c.value=De.Interval,h.checked=De["Custom CSS"],r.usercss.disabled=!De["Custom CSS"],u.disabled=!De["Custom CSS"],p.value=De.timeLocale,Ve.on(c,"change",q.cb.interval),Ve.on(h,"change",W.togglecss),Ve.on(u,"click",()=>Ke.update()),Ve.on(p,"change",W.setTimeLocale);const g=Fe();for(s of["archives","selectedArchives","lastarchivecheck"])g[s]=De[s];Ve.get(g,function(t){Ve.extend(De,t),K.selectArchives(),W.addArchiveTable(e)});const f=Ve("#archive-board-select",e),m=Ve("#archive-table",e),b=Ve("#update-archives",e);Ve.on(f,"change",function(){Ve("tbody > :not([hidden])",m).hidden=!0,Ve(`tbody > .${this.value}`,m).hidden=!1}),Ve.on(b,"click",()=>K.update(()=>W.addArchiveTable(e))),Ve.on(r.beepVolume,"change",()=>{q.playBeep(!1)}),Ve.on(r.beepSource,"change",()=>{q.playBeep(!1)})},addArchiveTable(e){var t,n,o,a,i,s,r;let l,d;Ve("#lastarchivecheck",e).textContent=0===De.lastarchivecheck?"never":new Date(De.lastarchivecheck).toLocaleString();const c=Ve("#archive-board-select",e),h=Ve("#archive-table",e),u=Ve("tbody",e);Ve.rmAll(c),Ve.rmAll(u);const p=Fe();for(var{uid:g,name:f,boards:m,files:b,software:A}of De.archives)if(["fuuka","foolfuuka"].includes(A))for(l of m)d=p[l]||(p[l]={thread:[],threadJSON:[],post:[],file:[]}),d.threadJSON||(d.threadJSON=[]),t=[g??f,f],d.thread.push(t),"foolfuuka"===A&&(d.post.push(t),d.threadJSON.push(t)),b.includes(l)&&d.file.push(t);const v=[],x=[];for(l of Object.keys(p).sort()){for(o of((n=Ve.el("tr",{className:`board-${l}`})).hidden=l!==Ee.BOARD.ID,x.push(Ve.el("option",{textContent:`/${l}/`,value:`board-${l}`,selected:l===Ee.BOARD.ID})),d=p[l],["thread","threadJSON","post","file"]))Ve.add(n,W.addArchiveCell(l,d,o));v.push(n)}if(0!==v.length)for(l in c.hidden=h.hidden=!1,Ee.BOARD.ID in p||(v[0].hidden=!1),Ve.add(c,x),Ve.add(u,v),De.selectedArchives)for(i in a=De.selectedArchives[l])r=a[i],(s=Ve(`select[data-boardid='${l}'][data-type='${i}']`,u))&&(s.value=JSON.stringify(r),s.value||(s.value=s.firstChild.value));else c.hidden=h.hidden=!0},addArchiveCell(e,t,n){const{length:o}=t[n],a=Ve.el("td",{className:"archive-cell"});if(!o)return a.textContent="--",a;const i=[];let s=0;for(;s<o;){var r=t[n][s++];i.push(Ve.el("option",{value:JSON.stringify(r[0]),textContent:r[1]}))}Ve.extend(a,{innerHTML:"<select></select>"});const l=a.firstElementChild;return(l.disabled=1===o)||(l.setAttribute("data-boardid",e),l.setAttribute("data-type",n),Ve.on(l,"change",W.saveSelectedArchive)),Ve.add(l,i),a},saveSelectedArchive(){Ve.get("selectedArchives",De.selectedArchives,({selectedArchives:e})=>{(e[this.dataset.boardid]||(e[this.dataset.boardid]=Fe()))[this.dataset.type]=JSON.parse(this.value),Ve.set("selectedArchives",e),De.selectedArchives=e,K.selectArchives()})},boardnav(){Y.generateBoardList(this.value)},time(){this.nextElementSibling.textContent=$.format(new Date,this.value)},timeLocale(){W.time.call(Ve("[name=time]",W.dialog))},backlink(){this.nextElementSibling.textContent=this.value.replace(/%(?:id|%)/g,e=>({"%id":"123456789","%%":"%"}[e]))},fileInfo(){const e={isReply:!0,file:{url:`//${o.host()}/g/1334437723720.jpg`,name:"d9bb2efc98dd0df141a94399ff5880b7.jpg",size:"276 KB",sizeInBytes:282624,dimensions:"1280x720",isImage:!0,isVideo:!1,isSpoiler:!0,tag:"Loop"}};z.format(this.value,e,this.nextElementSibling)},favicon(){i.switch(),"thread"===Ee.VIEW&&De["Unread Favicon"]&&I.update();const e=this.nextElementSibling.children,t=i,n=[t.SFW,t.unreadSFW,t.unreadSFWY,t.NSFW,t.unreadNSFW,t.unreadNSFWY,t.dead,t.unreadDead,t.unreadDeadY];for(let t=0;t<n.length;t++){var o=n[t];e[t]||Ve.add(this.nextElementSibling,Ve.el("img")),e[t].src=o}},togglecss(){(Ve("textarea[name=usercss]",Ve.x("ancestor::fieldset[1]",this)).disabled=Ve.id("apply-css").disabled=!this.checked)?Ke.rmStyle():Ke.addStyle(),Ve.cb.checked.call(this)},setTimeLocale(e){const t=e.target;try{""!==t.value&&new Intl.DateTimeFormat(t.value),t.setCustomValidity(""),$.formatterCache.clear(),Ve.cb.value.call(t),W.timeLocale.call(t)}catch(e){t.setCustomValidity("Locale not recognized"),t.reportValidity()}},keyBindInputs:Fe(),keybinds(e){var t,n,o;let a;Ve.extend(e,{innerHTML:'<div class="warning"><code>Keybinds</code> are disabled.</div>\n<div>Allowed keys: <kbd>a-z</kbd>, <kbd>0-9</kbd>, <kbd>Ctrl</kbd>, <kbd>Shift</kbd>, <kbd>Alt</kbd>, <kbd>Meta</kbd>, <kbd>Enter</kbd>, <kbd>Esc</kbd>, <kbd>Up</kbd>, <kbd>Down</kbd>, <kbd>Right</kbd>, <kbd>Left</kbd>.</div>\n<div>Press <kbd>Backspace</kbd> to disable a keybind.</div>\n<table><tbody>\n  <tr><th>Actions</th><th>Keybinds</th></tr>\n</tbody></table>\n<button type="button" id="reset-keys">Reset keybinds</button>'}),Ve(".warning",e).hidden=De.Keybinds;const i=Ve("tbody",e),s=Fe(),r=W.keyBindInputs;for(a in Me.hotkeys)t=Me.hotkeys[a],n=Ve.el("tr",{innerHTML:`<td>${t[1]}</td><td><input class="field"></td>`}),(o=Ve("input",n)).name=a,o.spellcheck=!1,s[a]=De[a],r[a]=o,Ve.on(o,"keydown",W.keybind),Ve.add(i,n);Ve.get(s,function(e){for(a in e){var t=e[a];r[a].value=t}}),Ve.on(Ve("#reset-keys",e),"click",W.resetKeybinds)},keybind(e){if(9===e.keyCode)return;e.preventDefault(),e.stopPropagation();const t=H.keyCode(e);null!=t&&(this.value=t,Ve.cb.value.call(this))},resetKeybinds(){if(!confirm("Are you sure you want to reset the keybinds?"))return;const e=Object.fromEntries(Object.entries(Me.hotkeys).map(([e,t])=>[e,t[0]]));Ve.set(e,()=>{Object.assign(De,e);for(const[t,n]of Object.entries(e))W.keyBindInputs[t].value=n})}},J={filters:new Map,init(){var e,t,n;if(["index","thread","catalog"].includes(Ee.VIEW)&&De.Filter&&("catalog"!==Ee.VIEW||De["Filter in Native Catalog"])){for(e in De["Filtered Backlinks"]||Ve.addClass(Re,"hide-backlinks"),Me.filter)for(t of De[e].split("\n")){let o,a,i,s,r=!0,l=0,d=!1,c=!1,h=!1,u=!1,p=!1,g=De.Stubs;if("#"===t[0])continue;const f=t.match(/\/(.*)\/(\w*)/);if(!f)continue;if("uniqueID"===e||"MD5"===e)a=f[1];else try{a=RegExp(f[1],f[2])}catch(n){new It("warning",[Ve.tn(`Invalid ${e} filter:`),Ve.el("br"),Ve.tn(t),Ve.el("br"),Ve.tn(n.message)],60);continue}const m=t.length>f[0].length?t.replace(f[0],""):"";if(m){d=this.parseBoards(m.match(/(?:^|;)\s*boards:([^;]+)/)?.[1]),c=this.parseBoards(m.match(/(?:^|;)\s*exclude:([^;]+)/)?.[1]);const e=m.match(/(?:^|;)\s*op:(no|only)/)?.[1]||"";l=Ve.getOwn({no:1,only:2},e)||0;const t=m.match(/(?:^|;)\s*file:(no|only)/)?.[1]||"";l|=Ve.getOwn({no:4,only:8},t)||0,g=(()=>{switch(m.match(/(?:^|;)\s*stub:(yes|no)/)?.[1]){case"yes":return!0;case"no":return!1;default:return De.Stubs}})(),p=/(?:^|;)\s*notify/.test(m);const n=m.match(/(?:^|;)\s*highlight(?::([\w-]+))?/);n&&(o=n[1]||"filter-highlight",i="yes"===(m.match(/(?:^|;)\s*top:(yes|no)/)?.[1]||"yes"),r=/(?:^|;)\s*hide(?:[;:]|$)/.test(m)),r=r||!(o||p),s=m.match(/(?:^|;)\s*reason:([^;$]+)/)?.[1],h=/(?:^|;)\s*poster(?:[;:]|$)/.test(m),u=/(?:^|;)\s*replies(?:[;:]|$)/.test(m)}const b={regexp:a,boards:d,excludes:c,mask:l,hide:r,stub:g,hl:o,top:i,noti:p,reason:s,poster:h,replies:u};if("general"===e){const e=m.match(/(?:^|;)\s*type:([^;]*)/)?.[1].split(",")||["subject","name","filename","comment"];for(n of e)this.filters.get(n)?.push(b)??this.filters.set(n,[b])}else this.filters.get(e)?.push(b)??this.filters.set(e,[b])}if(this.filters.size){for(const e of["MD5","uniqueID"]){const t=this.filters.get(e);if(!t)continue;const n=new Map;for(const e of t)n.get(e.regexp)?.push(e)??n.set(e.regexp,[e]);this.filters.set(e,n)}return"catalog"===Ee.VIEW?J.catalog():Ne.Post.push({name:"Filter",cb:this.node})}}},parseBoards(e){var t,n,o,a;let i;if(!e)return!1;if(i=J.parseBoardsMemo[e])return i;i=Fe();let s="";for(t of e.split(","))for(n in t.includes(":")&&([s,t]=t.split(":").slice(-2)),Ee.sites)if(o=Ee.sites[n],n.slice(0,s.length)===s)if(["nsfw","sfw"].includes(t))for(a of o.sfwBoards?.("sfw"===t)||[])i[`${n}/${a}`]=!0;else i[`${n}/${encodeURIComponent(t)}`]=!0;return J.parseBoardsMemo[e]=i,i},parseBoardsMemo:Fe(),test(e,t=!0){if(e.filterResults)return e.filterResults;let n,o,a=!1,i=!0,s=!1,r=!1,l=!1,d=!1;k.isYou(e)&&(t=!1);let c=e.isReply?2:1;c|=e.file?4:8;const h=`${e.siteID}/${e.boardID}`,u=`${e.siteID}/*`;for(const p of J.filters.keys())for(const g of J.values(p,e)){const e=J.filters.get(p),f=Array.isArray(e)?e:e.get(g);if(!f)continue;const m="uniqueID"===p||"MD5"===p;for(const e of f)e.boards&&!e.boards[h]&&!e.boards[u]||e.excludes&&(e.excludes[h]||e.excludes[u])||e.mask&c||!(m?e.regexp===g:e.regexp.test(g))||(e.hide&&t&&(a=!0,i&&(({stub:i}=e),(o||(o=[])).push(e.reason||`Filtered ${p} ${e.regexp}`))),e.hl&&!n?.includes(e.hl)&&(n||(n=[])).push(e.hl),s||({top:s}=e),e.noti&&(r=!0),e.poster&&(l=!0),e.replies&&(d=!0))}return e.filterResults={hide:a,stub:i,hl:n,top:s,noti:r,poster:l,replies:d,reasons:o},e.filterResults},node(){if(this.isClone||!this.isReply&&!this.thread.nodes.root)return;const{hide:e,stub:t,hl:n,noti:o,poster:a,replies:i}=J.test(this,!this.isFetchedQuote&&(this.isReply||"index"===Ee.VIEW));let s;if(a&&this.info.uniqueID){s=`Hidden because it's the same poster as ${this.ID} (${this.filterResults.reasons})`;const{uniqueID:o}=this.info,a={regexp:o,boards:!1,excludes:!1,mask:0,hide:e,stub:t,replies:i,hl:n?.[0],reason:s},r=J.filters.get("uniqueID");r?r.get(o)?.push(a)??r.set(o,[a]):J.filters.set("uniqueID",(new Map).set(o,[a]))}if(e&&(this.isReply?(x.hide(this,t),i&&v.applyAndAdd(x.hide,this,t,void 0,`Hidden recursively from ${this.ID}`),a&&this.info.uniqueID&&Ee.posts.forEach(e=>{e.info.uniqueID===this.info.uniqueID&&e!==this&&(x.hide(e,t,i,s),i&&v.applyAndAdd(x.hide,e,t,void 0,`Hidden recursively from ${e.ID}`))})):L.hide(this.thread,t)),n&&(this.highlights=n,Ve.addClass(this.nodes.root,...n),this.isReply)){const e=(e,...t)=>{Ve.addClass(e.nodes.root,...t)};i&&v.applyAndAdd(e,this,...n),a&&this.info.uniqueID&&Ee.posts.forEach(t=>{t.info.uniqueID===this.info.uniqueID&&t!==this&&(Ve.addClass(t.nodes.root,...n),i&&v.applyAndAdd(e,t,...n))})}o&&I.posts&&this.ID>I.lastReadPost&&!k.isYou(this)&&I.openNotification(this," triggered a notification filter"),this.file?.thumbLink&&Ve.on(this.file.thumbLink,"click",e=>{e.shiftKey&&De["MD5 Quick Filter in Threads"]&&(J.quickFilterMD5.call(this),e.preventDefault(),e.stopImmediatePropagation())})},catalog(){let e;if(e=Ee.SITE.urls.catalogJSON?.(Ee.BOARD))return J.catalogData=Fe(),Ve.ajax(e,{onloadend:J.catalogParse}),Ne.CatalogThreadNative.push({name:"Filter",cb:this.catalogNode})},catalogParse(){var e,t;if([200,404].includes(this.status)){for(e of this.response)for(t of e.threads)J.catalogData[t.no]=t;Ee.BOARD.threads.forEach(function(e){if(e.catalogViewNative)return J.catalogNode.call(e.catalogViewNative)})}else new It("warning","Failed to fetch catalog JSON data. "+(this.status?`Error ${this.statusText} (${this.status})`:"Connection Error"),1)},catalogNode(){if(this.boardID!==Ee.BOARD.ID||!J.catalogData[this.ID])return;if(k.db?.get({siteID:Ee.SITE.ID,boardID:this.boardID,threadID:this.ID,postID:this.ID}))return;const{hide:e,hl:t,top:n}=J.test(Ee.SITE.Build.parseJSON(J.catalogData[this.ID],this));e&&(this.nodes.root.hidden=!0),t&&(this.highlights=t,Ve.addClass(this.nodes.root,...t)),n&&(Ve.prepend(this.nodes.root.parentNode,this.nodes.root),Ee.SITE.catalogPin?.(this.nodes.root))},isHidden:e=>!!J.test(e).hide,valueF:{postID:e=>[`${e.ID}`],name:e=>void 0===e.info.name?[]:[e.info.name],uniqueID:e=>[e.info.uniqueID||""],tripcode:e=>void 0===e.info.tripcode?[]:[e.info.tripcode],capcode:e=>void 0===e.info.capcode?[]:[e.info.capcode],pass:e=>[e.info.pass],email:e=>[e.info.email],subject:e=>[e.info.subject||(e.isReply?void 0:"")],comment:e=>(null==e.info.comment&&(e.info.comment=Ee.sites[e.siteID]?.Build?.parseComment?.(e.info.commentHTML.innerHTML)),[e.info.comment]),flag:e=>void 0===e.info.flag?[]:[e.info.flag],filename:e=>e.files.map(e=>e.name),dimensions:e=>e.files.map(e=>e.dimensions),filesize:e=>e.files.map(e=>e.size),MD5:e=>e.files.map(e=>e.MD5)},values:(e,t)=>Ve.hasOwn(J.valueF,e)?J.valueF[e](t).filter(e=>null!=e):[e.split("+").map(function(e){let n;return(n=Ve.getOwn(J.valueF,e))?n(t).map(e=>e||"").join("\n"):""}).join("\n")],addFilter(e,t,n){if(Ve.hasOwn(Me.filter,e))return Ve.get(e,De[e],function(o){let a=o[e];return a=a?`${a}\n${t}`:t,Ve.set(e,a,n)})},removeFilters:(e,t,n)=>Ve.get(e,De[e],function(o){let a=o[e];const i=(Array.isArray(t)?t:[...t.values()].flat()).map(J.escape).join("|");return a=a.replace(RegExp(`(?:$\n|^)(?:${i})$`,"mg"),""),Ve.set(e,a,n)}),showFilters(e){W.open("Filter");const t=Ve(".section-container"),n=Ve("select[name=filter]",t);return n.value=e,W.selectFilter.call(n),Ve.onExists(t,"textarea",function(e){const t=e.textLength;return e.setSelectionRange(t,t),e.focus()})},quickFilterMD5(){const e=this instanceof dt?this:n.postFromNode(this),t=e.files.filter(e=>e.MD5);if(!t.length)return;const o=t.map(e=>`/${e.MD5}/`).join("\n");J.addFilter("MD5",o);const a=e.origin||e;if(a.isReply?x.hide(a,void 0,void 0,t.map(e=>`Filtered MD5 ${e.MD5}`).join(" & ")):"index"===Ee.VIEW&&L.hide(a.thread),!De["MD5 Quick Filter Notifications"])return void(e.nodes.post.getBoundingClientRect().height&&new It("info","MD5 filtered.",2));let{notice:i}=J.quickFilterMD5;if(i)i.filters.push(o),i.posts.push(a),Ve("span",i.el).textContent=`${i.filters.length} MD5s filtered.`,i.resetTimer();else{const e=Ve.el("div",{innerHTML:'<span>MD5 filtered.</span> [<a href="javascript:;">show</a>] [<a href="javascript:;">undo</a>]'});i=J.quickFilterMD5.notice=new It("info",e,10,()=>delete J.quickFilterMD5.notice),i.filters=[o],i.posts=[a];const t=Ge("a",e);Ve.on(t[0],"click",J.quickFilterCB.show.bind(i)),Ve.on(t[1],"click",J.quickFilterCB.undo.bind(i))}},quickFilterCB:{show(){return J.showFilters("MD5"),this.close()},undo(){for(var e of(J.removeFilters("MD5",this.filters),this.posts))e.isReply?x.show(e):"index"===Ee.VIEW&&L.show(e.thread);return this.close()}},escape:e=>e.replace(/\/|\\|\^|\$|\n|\.|\(|\)|\{|\}|\[|\]|\?|\*|\+|\|/g,e=>"\n"===e?"\\n":`\\${e}`),menu:{init(){if(!["index","thread"].includes(Ee.VIEW)||!De.Menu||!De.Filter)return;const e={el:Ve.el("div",{textContent:"Filter"}),order:50,open:e=>(J.menu.post=e,!0),subEntries:[]};for(var t of[["Name","name"],["Unique ID","uniqueID"],["Tripcode","tripcode"],["Capcode","capcode"],["Pass Date","pass"],["Email","email"],["Subject","subject"],["Comment","comment"],["Flag","flag"],["Filename","filename"],["Image dimensions","dimensions"],["Filesize","filesize"],["Image MD5","MD5"]])e.subEntries.push(J.menu.createSubEntry(t[0],t[1]));return A.menu.addEntry(e)},createSubEntry(e,t){const n=Ve.el("a",{href:"javascript:;",textContent:e});return n.dataset.type=t,Ve.on(n,"click",J.menu.makeFilter),{el:n,open:e=>J.values(t,e).length}},makeFilter(){const{type:e}=this.dataset,t=J.values(e,J.menu.post).map(t=>["uniqueID","MD5"].includes(e)?`/${t}/`:`/^${J.escape(t)}$/`).join("\n");return J.addFilter(e,t,()=>J.showFilters(e))}}},_={defaultProperties:{"4chan.org":{software:"yotsuba"},"4channel.org":{canonical:"4chan.org"},"4cdn.org":{canonical:"4chan.org"},"notso.smuglo.li":{canonical:"smuglo.li"},"smugloli.net":{canonical:"smuglo.li"},"smug.nepu.moe":{canonical:"smuglo.li"}},init(e){Ve.extend(De.siteProperties,_.defaultProperties);let t=_.resolve();t&&Ve.hasOwn(kt,De.siteProperties[t].software)&&(this.set(t),e()),Ve.onExists(Re,"body",()=>{var n,o,a,i,s;for(n in kt)if(o=kt[n].detect?.()){for(s in o.software=n,t=location.hostname.replace(/^www\./,""),a=De.siteProperties[t]||(De.siteProperties[t]=Fe()),i=0,o)a[s]!==o[s]&&(a[s]=o[s],i++);return i&&Ve.set("siteProperties",De.siteProperties),void(Ee.SITE||(this.set(t),e()))}})},resolve(e=location){let{hostname:t}=e;for(;t&&!Ve.hasOwn(De.siteProperties,t);)t=t.replace(/^[^.]*\.?/,"");if(t){let e;(e=De.siteProperties[t].canonical)&&(t=e)}return t},parseURL(e){const t=_.resolve(e);return ke.parseURL(Ee.sites[t],e)},set(e){var t,n,o;for(t in De.siteProperties)if(!(o=De.siteProperties[t]).canonical){var{software:a}=o;a&&Ve.hasOwn(kt,a)&&(Ee.sites[t]=n=Object.create(kt[a]),Ve.extend(n,{ID:t,siteID:t,properties:o,software:a}))}return Ee.SITE=Ee.sites[e]}},G={init(){if("yotsuba"===Ee.SITE.software&&(De["External Catalog"]||De["JSON Index"])&&(!De["JSON Index"]||"index"!==Ee.VIEW)){const e=(()=>{switch(Ee.VIEW){case"thread":case"archive":return".navLinks.desktop > a";case"catalog":return".navLinks > :first-child > a";case"index":return"#ctrl-top > a, .cataloglink > a"}})();Ve.ready(function(){var t,n,o,a;for(t of Ge(e)){switch(t.pathname.replace(/\/+/g,"/")){case`/${Ee.BOARD}/`:De["JSON Index"]&&(t.textContent="Index"),t.href=G.index();break;case`/${Ee.BOARD}/catalog`:t.href=G.catalog()}"catalog"===Ee.VIEW&&(n=G.catalog())!==Ee.SITE.urls.catalog?.(Ee.BOARD)&&((a=(o=t.parentNode.cloneNode(!0)).firstElementChild).href=n,a.textContent=a.hostname===location.hostname?`${Ce.name} Catalog`:"External Catalog",Ve.after(t.parentNode,[Ve.tn(" "),o]))}})}if("yotsuba"===Ee.SITE.software&&De["JSON Index"]&&De[`Use ${Ce.name} Catalog`]&&Ne.Post.push({name:"Catalog Link Rewrite",cb:this.node}),this.enabled=De["Catalog Links"]){let e;G.el=e=rt.checkbox("Header catalog links","Catalog Links"),e.id="toggleCatalog";const t=Ve("input",e);return Ve.on(t,"change",this.toggle),Ve.sync("Header catalog links",G.set),Y.menu.addEntry({el:e,order:95})}},node(){var e,t;for(e of Ge("a",this.nodes.comment))(t=e.href.match(/^https?:\/\/(boards\.4chan(?:nel)?\.org\/[^\/]+)\/catalog(#s=.*)?/))&&(e.href=`//${t[1]}/${t[2]||"#catalog"}`)},toggle(){return Ve.event("CloseMenu"),Ve.set("Header catalog links",this.checked),G.set(this.checked)},set:e=>(De["Header catalog links"]=e,G.setLinks(Y.boardList),G.setLinks(Y.bottomBoardList),G.el.title=`Turn catalog links ${e?"off":"on"}.`,Ve("input",G.el).checked=e),setLinks(e){var t,o,a,i;if(!(G.enabled??De["Catalog Links"])||!e)return;const s=/(?:index)?(?:\.\w+)?$/;for(t of Ge("a:not([data-only])",e)){var{siteID:r,boardID:l}=t.dataset;if(!r||!l){if(({siteID:r,boardID:l,VIEW:o}=_.parseURL(t)),!r||!l||!["index","catalog"].includes(o)||!t.dataset.indexOptions&&t.href.replace(s,"")!==(n.url(o,{siteID:r,boardID:l})||"").replace(s,""))continue;Ve.extend(t.dataset,{siteID:r,boardID:l})}a={siteID:r,boardID:l},(i=De["Header catalog links"]?G.catalog(a):n.url("index",a))&&(t.href=i,t.dataset.indexOptions&&i.split("#")[0]===n.url("index",a)&&(t.href+=(t.hash?"/":"#")+t.dataset.indexOptions))}},externalParse(){var e,t,n,o,a;for(e of(G.externalList=Fe(),De.externalCatalogURLs.split("\n")))if("#"!==e[0])for(a in t=e.split(";")[0],n=J.parseBoards(e.match(/;boards:([^;]+)/)?.[1]||"*"),o=J.parseBoards(e.match(/;exclude:([^;]+)/)?.[1])||Fe(),n)o[a]||o[a.split("/")[0]+"/*"]||(G.externalList[a]=t)},external({siteID:e,boardID:t}){G.externalList||G.externalParse();const n=G.externalList[`${e}/${t}`]||G.externalList[`${e}/*`];return n?n.replace(/%board/g,t):void 0},jsonIndex:(e,t)=>Ee.SITE.ID===e.siteID&&Ee.BOARD.ID===e.boardID&&"index"===Ee.VIEW?t:n.url("index",e)+t,catalog(e=Ee.BOARD){let t,o;return De["External Catalog"]&&(t=G.external(e))?t:B.enabledOn(e)&&De[`Use ${Ce.name} Catalog`]?G.jsonIndex(e,"#catalog"):(o=n.url("catalog",e))?o:G.external(e)},index:(e=Ee.BOARD)=>B.enabledOn(e)?G.jsonIndex(e,"#index"):n.url("index",e)},Y={init(){Ve.onExists(Re,"body",()=>{if(ke.isThisPageLegit())return Ve.add(this.bar,[this.noticesRoot,this.toggle]),Ve.prepend(Te.body,this.bar),Ve.add(Te.body,Y.hover),this.setBarPosition(De["Bottom Header"])}),this.menu=new rt.Menu("header");const e=Ve.el("span",{className:"menu-button"});a.set(e,"caretDown","Menu");const t=rt.checkbox,n=t("Fixed Header","Fixed Header"),o=t("Header auto-hide","Auto-hide header"),i=t("Header auto-hide on scroll","Auto-hide header on scroll"),s=t("Bottom Header","Bottom header"),r=t("Centered links","Centered links"),l=t("Custom Board Navigation","Custom board navigation"),d=t("Bottom Board List","Hide bottom board list"),c=t("Shortcut Icons","Shortcut Icons"),h=Ve.el("a",{textContent:"Edit custom board navigation",href:"javascript:;"});if(this.barFixedToggler=n.firstElementChild,this.scrollHeaderToggler=i.firstElementChild,this.barPositionToggler=s.firstElementChild,this.linkJustifyToggler=r.firstElementChild,this.headerToggler=o.firstElementChild,this.footerToggler=d.firstElementChild,this.shortcutToggler=c.firstElementChild,this.customNavToggler=l.firstElementChild,Ve.on(e,"click",this.menuToggle),Ve.on(this.headerToggler,"change",this.toggleBarVisibility),Ve.on(this.barFixedToggler,"change",this.toggleBarFixed),Ve.on(this.barPositionToggler,"change",this.toggleBarPosition),Ve.on(this.scrollHeaderToggler,"change",this.toggleHideBarOnScroll),Ve.on(this.linkJustifyToggler,"change",this.toggleLinkJustify),Ve.on(this.footerToggler,"change",this.toggleFooterVisibility),Ve.on(this.shortcutToggler,"change",this.toggleShortcutIcons),Ve.on(this.customNavToggler,"change",this.toggleCustomNav),Ve.on(h,"click",this.editCustomNav),this.setBarFixed(De["Fixed Header"]),this.setHideBarOnScroll(De["Header auto-hide on scroll"]),this.setBarVisibility(De["Header auto-hide"]),this.setLinkJustify(De["Centered links"]),this.setShortcutIcons(De["Shortcut Icons"]),this.setFooterVisibility(De["Bottom Board List"]),Ve.sync("Fixed Header",this.setBarFixed),Ve.sync("Header auto-hide on scroll",this.setHideBarOnScroll),Ve.sync("Bottom Header",this.setBarPosition),Ve.sync("Shortcut Icons",this.setShortcutIcons),Ve.sync("Header auto-hide",this.setBarVisibility),Ve.sync("Centered links",this.setLinkJustify),Ve.sync("Bottom Board List",this.setFooterVisibility),this.addShortcut("menu",e,900),this.menu.addEntry({el:Ve.el("span",{textContent:"Header"}),order:107,subEntries:[{el:n},{el:o},{el:i},{el:s},{el:r},{el:d},{el:c},{el:l},{el:h}]}),Ve.on(Te,"CreateNotification",this.createNotification),this.setBoardList(),Ve.onExists(Re,`${Ee.SITE.selectors.boardList} + *`,Y.generateFullBoardList),ke.ready(function(){let e;if("yotsuba"===Ee.SITE.software&&!(e=Ve.id("boardNavDesktopFoot"))){let t;if(!(t=Ve.id("absbot")))return;e=Ve.id("boardNavDesktop").cloneNode(!0),e.id="boardNavDesktopFoot",Ve("#navtopright",e).id="navbotright",Ve("#settingsWindowLink",e).id="settingsWindowLinkBot",Ve.before(t,e),Ve.global("stubCloneTopNav")}if(Y.bottomBoardList=Ve(Ee.SITE.selectors.boardListBottom)){for(var t of Ge("a",Y.bottomBoardList))t.hostname===location.hostname&&t.pathname.split("/")[1]===Ee.BOARD.ID&&(t.className="current");return G.setLinks(Y.bottomBoardList)}}),"yotsuba"===Ee.SITE.software&&("catalog"===Ee.VIEW||!De["Disable Native Extension"])){const e=Ve.el("a",{href:"javascript:;"});"catalog"===Ee.VIEW?(e.title=e.textContent="Catalog Settings",a.set(e,"bookOpen","Catalog Settings"),this.addShortcut("native",e,810)):(e.title=e.textContent="4chan Settings",e.className="native-settings",this.addShortcut("native",e,810)),Ve.on(e,"click",()=>Ve.id("settingsWindowLink").click())}return this.enableDesktopNotifications()},bar:Ve.el("div",{id:"header-bar"}),noticesRoot:Ve.el("div",{id:"notifications"}),shortcuts:Ve.el("span",{id:"shortcuts"}),hover:Ve.el("div",{id:"hoverUI"}),toggle:Ve.el("div",{id:"scroll-marker"}),setBoardList(){let e;Y.boardList=e=Ve.el("span",{id:"board-list"}),Ve.extend(e,{innerHTML:'<span id="custom-board-list"></span><span id="full-board-list" hidden><span class="hide-board-list-container brackets-wrap"><a href="javascript:;" class="hide-board-list-button">&nbsp;-&nbsp;</a></span> <span class="boardList"></span></span>'});const t=Ve(".hide-board-list-button",e);return Ve.on(t,"click",Y.toggleBoardList),Ve.prepend(Y.bar,[Y.boardList,Y.shortcuts]),Y.setCustomNav(De["Custom Board Navigation"]),Y.generateBoardList(De.boardnav),Ve.sync("Custom Board Navigation",Y.setCustomNav),Ve.sync("boardnav",Y.generateBoardList)},generateFullBoardList(){let e;e=Ee.SITE.transformBoardList?Ee.SITE.transformBoardList():[...Ve(Ee.SITE.selectors.boardList).cloneNode(!0).childNodes];const t=Ve(".boardList",Y.boardList);for(var n of(Ve.add(t,e),Ge("a",t)))n.hostname===location.hostname&&n.pathname.split("/")[1]===Ee.BOARD.ID&&(n.className="current");return G.setLinks(t)},generateBoardList(e){const t=Ve("#custom-board-list",Y.boardList);if(Ve.rmAll(t),!e)return;const n=(e=e.replace(/(\r\n|\n|\r)/g," ")).split(/(\{\{(?:"[^"]+")?|\}\})/),o=[];let a=t;return n.forEach(e=>{if(e.startsWith("{{")){const t=Ve.el("span");Ve.add(a,t),o.push(t),a=t,e.length>2&&(t.className=e.slice(3,-1))}else if("}}"===e)o.pop(),a=o.length>0?o[o.length-1]:t;else{const t=/[\w@]+(-(all|title|replace|full|index|catalog|archive|expired|nt|(mode|sort|text):"[^"]+"(,"[^"]+")?))*|[^\w@]+/g;(e.match(t)||[]).map(e=>Y.mapCustomNavigation(e)).forEach(e=>a.appendChild(e))}}),G.setLinks(t)},mapCustomNavigation(e){let t,o,a,i;if(/^[^\w@]/.test(e))return Ve.tn(e);let s=i=null;e=e.replace(/-text:"([^"]+)"(?:,"([^"]+)")?/g,function(e,t,n){return s=t,i=n,""});let r=[];if(e=e.replace(/-(?:mode|sort):"([^"]+)"/g,function(e,t){return r.push(t.toLowerCase().replace(/\ /g,"-")),""}),r=r.join("/"),/^toggle-all/.test(e))return t=Ve.el("a",{className:"show-board-list-button",textContent:s||"+",href:"javascript:;"}),Ve.on(t,"click",Y.toggleBoardList),t;if(/^external/.test(e))return t=Ve.el("a",{href:i||"javascript:;",textContent:s||"+",className:"external"}),/-nt/.test(e)&&(t.target="_blank",t.rel="noopener"),t;let l=e.split("-")[0];if("current"===l){if(!["boards.4chan.org","boards.4channel.org"].includes(location.hostname))return t=Ve.el("a",{href:`/${Ee.BOARD.ID}/`,textContent:s||decodeURIComponent(Ee.BOARD.ID),className:"current"}),/-nt/.test(e)&&(t.target="_blank",t.rel="noopener"),/-index/.test(e)?t.dataset.only="index":/-catalog/.test(e)?(t.dataset.only="catalog",t.href+="catalog.html"):/-(archive|expired)/.test(e)&&(t=t.firstChild),t;l=Ee.BOARD.ID}if(t=function(){let e;return"@"===l?Ve.el("a",{href:"https://twitter.com/4chan",title:"4chan Twitter",className:"navSmall",textContent:"@"}):(t=Ve.el("a",{href:`//${b.domain(l)}/${l}/`,textContent:l,title:b.title(l)}),["catalog","archive"].includes(Ee.VIEW)&&(e=n.url(Ee.VIEW,{siteID:"4chan.org",boardID:l}))&&(t.href=e),t.hostname===location.hostname&&l===Ee.BOARD.ID&&(t.className="current"),t)}(),t.textContent=/-title/.test(e)||/-replace/.test(e)&&t.hostname===location.hostname&&l===Ee.BOARD.ID?t.title||t.textContent:/-full/.test(e)?`/${l}/`+(t.title?` - ${t.title}`:""):s||l,a=e.match(/-(index|catalog)/)){const e=G[a[1]]({siteID:"4chan.org",boardID:l});if(!e)return t.firstChild;t.dataset.only=a[1],t.href=e,"catalog"===a[1]&&Ve.addClass(t,"catalog")}if(De["JSON Index"]&&r&&(t.dataset.indexOptions=r,["boards.4chan.org","boards.4channel.org"].includes(t.hostname)&&""===t.pathname.split("/")[2]&&(t.href+=(t.hash?"/":"#")+r)),/-archive/.test(e)){if(!(o=K.to("board",{boardID:l})))return t.firstChild;t.href=o}if(/-expired/.test(e)){if(!b.isArchived(l))return t.firstChild;t.href=`//${b.domain(l)}/${l}/archive`}return/-nt/.test(e)&&(t.target="_blank",t.rel="noopener"),t},toggleBoardList(){const{bar:e}=Y,t=Ve("#custom-board-list",e),n=Ve("#full-board-list",e),o=!n.hidden;return t.hidden=!o,n.hidden=o},setLinkJustify:e=>(Y.linkJustifyToggler.checked=e,e?Ve.addClass(Re,"centered-links"):Ve.rmClass(Re,"centered-links")),toggleLinkJustify(){Ve.event("CloseMenu");const e="INPUT"===this.nodeName?this.checked:void 0;return Y.setLinkJustify(e),Ve.set("Centered links",e)},setBarFixed:e=>(Y.barFixedToggler.checked=e,e?(Ve.addClass(Re,"fixed"),Ve.addClass(Y.bar,"dialog")):(Ve.rmClass(Re,"fixed"),Ve.rmClass(Y.bar,"dialog"))),toggleBarFixed(){return Ve.event("CloseMenu"),Y.setBarFixed(this.checked),De["Fixed Header"]=this.checked,Ve.set("Fixed Header",this.checked)},setShortcutIcons:e=>(Y.shortcutToggler.checked=e,e?Ve.addClass(Re,"shortcut-icons"):Ve.rmClass(Re,"shortcut-icons")),toggleShortcutIcons(){return Ve.event("CloseMenu"),Y.setShortcutIcons(this.checked),De["Shortcut Icons"]=this.checked,Ve.set("Shortcut Icons",this.checked)},setBarVisibility:e=>(Y.headerToggler.checked=e,Ve.event("CloseMenu"),(e?Ve.addClass:Ve.rmClass)(Y.bar,"autohide"),(e?Ve.addClass:Ve.rmClass)(Re,"autohide")),toggleBarVisibility(){const e="INPUT"===this.nodeName?this.checked:!Ve.hasClass(Y.bar,"autohide");return De["Header auto-hide"]=e,Ve.set("Header auto-hide",e),Y.setBarVisibility(e),new It("info","The header bar will "+(e?"automatically hide itself.":"remain visible."),2)},setHideBarOnScroll(e){if(Y.scrollHeaderToggler.checked=e,!e)return Ve.off(window,"scroll",Y.hideBarOnScroll),Ve.rmClass(Y.bar,"scroll"),Y.bar.classList.toggle("autohide",De["Header auto-hide"]);Ve.on(window,"scroll",Y.hideBarOnScroll)},toggleHideBarOnScroll(){const e=this.checked;return Ve.cb.checked.call(this),Y.setHideBarOnScroll(e)},hideBarOnScroll(){const e=window.pageYOffset;return e>(Y.previousOffset||0)?Ve.addClass(Y.bar,"autohide","scroll"):Ve.rmClass(Y.bar,"autohide","scroll"),Y.previousOffset=e},setBarPosition(e){Y.barPositionToggler&&(Y.barPositionToggler.checked=e),Ve.event("CloseMenu");const t=e?["bottom-header","top-header","after"]:["top-header","bottom-header","add"];return Ve.addClass(Re,t[0]),Ve.rmClass(Re,t[1]),Ve[t[2]](Y.bar,Y.noticesRoot)},toggleBarPosition(){return Ve.cb.checked.call(this),Y.setBarPosition(this.checked)},setFooterVisibility:e=>(Y.footerToggler.checked=e,Re.classList.toggle("hide-bottom-board-list",e)),toggleFooterVisibility(){Ve.event("CloseMenu");const e="INPUT"===this.nodeName?this.checked:Ve.hasClass(Re,"hide-bottom-board-list");return Y.setFooterVisibility(e),Ve.set("Bottom Board List",e),new It("info",e?"The bottom navigation will now be hidden.":"The bottom navigation will remain visible.",2)},setCustomNav(e){Y.customNavToggler.checked=e;const t=Ve("#custom-board-list",Y.bar),n=Ve("#full-board-list",Y.bar),o=Ve(".hide-board-list-container",n);return[t.hidden,n.hidden,o.hidden]=e?[!1,!0,!1]:[!0,!1,!0]},toggleCustomNav(){return Ve.cb.checked.call(this),Y.setCustomNav(this.checked)},editCustomNav(){W.open("Advanced");const e=Ve.id("fourchanx-settings");return Ve("[name=boardnav]",e).focus()},scrollTo(e,t=!1,n=!1){let o,a;if(e.offsetParent)if(t){if(a=Y.getBottomOf(e),De["Fixed Header"]&&De["Header auto-hide on scroll"]&&De["Bottom header"]&&(({height:o}=Y.bar.getBoundingClientRect()),a<=0?Y.isHidden()||(a+=o):Y.isHidden()&&(a-=o)),!n||a<0)return window.scrollBy(0,-a)}else if(a=Y.getTopOf(e),De["Fixed Header"]&&De["Header auto-hide on scroll"]&&!De["Bottom header"]&&(({height:o}=Y.bar.getBoundingClientRect()),a>=0?Y.isHidden()||(a+=o):Y.isHidden()&&(a-=o)),!n||a<0)return window.scrollBy(0,a)},scrollToIfNeeded:(e,t)=>Y.scrollTo(e,t,!0),getTopOf(e){let{top:t}=e.getBoundingClientRect();if(De["Fixed Header"]&&!De["Bottom Header"]){const e=Y.toggle.getBoundingClientRect();t-=e.top+e.height}return t},getBottomOf(e){const{clientHeight:t}=Re;let n=t-e.getBoundingClientRect().bottom;if(De["Fixed Header"]&&De["Bottom Header"]){const e=Y.toggle.getBoundingClientRect();n-=t-e.bottom+e.height}return n},isNodeVisible(e){if(Te.hidden||!Re.contains(e))return!1;const{height:t}=e.getBoundingClientRect();return Y.getTopOf(e)+t>=0&&Y.getBottomOf(e)+t>=0},isHidden(){const{top:e}=Y.bar.getBoundingClientRect();return De["Bottom header"]?e===Re.clientHeight:e<0},addShortcut(e,t,n){const o=Ve.el("span",{id:`shortcut-${e}`,className:"shortcut brackets-wrap"});for(var a of(Ve.add(o,t),o.dataset.index=n.toString(),Ge("[data-index]",Y.shortcuts)))if(+a.dataset.index>+n)return void Ve.before(a,o);return Ve.add(Y.shortcuts,o)},rmShortcut:e=>Ve.rm(e.parentElement),menuToggle(e){return Y.menu.toggle(e,this,Ee)},createNotification(e){const{type:t,content:n,lifetime:o}=e.detail;return new It(t,n,o)},areNotificationsEnabled:!1,enableDesktopNotifications(){let e;if(!window.Notification||!De["Desktop Notifications"])return;switch(Notification.permission){case"granted":return void(Y.areNotificationsEnabled=!0);case"denied":return}const t=Ve.el("span",{innerHTML:`${Ce.name} needs your permission to show desktop notifications. [<a href="${Se(Ce.upstreamFaq)}#why-is-4chan-x-asking-for-permission-to-show-desktop-notifications" target="_blank">FAQ</a>]<br><button>Authorize</button> or <button>Disable</button>`}),[n,o]=Ge("button",t);return Ve.on(n,"click",()=>Notification.requestPermission(function(t){if(Y.areNotificationsEnabled="granted"===t,"default"!==t)return e.close()})),Ve.on(o,"click",function(){return Ve.set("Desktop Notifications",!1),e.close()}),e=new It("info",t)}};class It{constructor(e,t,n,o){this.add=this.add.bind(this),this.close=this.close.bind(this),this.timeout=n,this.onclose=o,this.el=Ve.el("div",{innerHTML:`<a href="javascript:;" class="close" title="Close">${a.get("xmark")}</a><div class="message"></div>`}),this.el.style.opacity=0,this.setType(e),Ve.on(this.el.firstElementChild,"click",this.close),"string"==typeof t&&(t=Ve.tn(t)),Ve.add(this.el.lastElementChild,t),Ve.ready(this.add)}setType(e){this.el.className=`notification ${e}`}add(){this.closed||(Te.hidden?Ve.on(Te,"visibilitychange",this.add):(Ve.off(Te,"visibilitychange",this.add),Ve.add(Y.noticesRoot,this.el),this.el.clientHeight,this.el.style.opacity=1,this.timeout&&(this.timeoutId=setTimeout(this.close,this.timeout*$e))))}close(){this.timeoutId&&clearTimeout(this.timeoutId),this.closed=!0,Ve.off(Te,"visibilitychange",this.add),Ve.rm(this.el),this.onclose?.()}resetTimer(){this.timeout&&(clearTimeout(this.timeoutId),this.timeoutId=setTimeout(this.close,this.timeout*$e))}}K={archives:[{uid:3,name:"4plebs",domain:"archive.4plebs.org",http:!0,https:!0,software:"foolfuuka",boards:["adv","f","hr","mlpol","mo","o","pol","s4s","sp","tg","trv","tv","x"],files:["adv","f","hr","mlpol","mo","o","pol","s4s","sp","tg","trv","tv","x"],reports:!0},{uid:10,name:"warosu",domain:"warosu.org",http:!1,https:!0,software:"fuuka",boards:["3","biz","cgl","ck","diy","fa","ic","jp","lit","sci","vr","vt"],files:["3","biz","cgl","ck","diy","fa","ic","jp","lit","sci","vr","vt"],search:["biz","cgl","ck","diy","fa","ic","jp","lit","sci","vr","vt"]},{uid:23,name:"Desuarchive",domain:"desuarchive.org",http:!0,https:!0,software:"foolfuuka",boards:["a","aco","an","c","cgl","co","d","fit","g","his","int","k","m","mlp","mu","q","qa","r9k","tg","trash","vr","wsg"],files:["a","aco","an","c","cgl","co","d","fit","g","his","int","k","m","mlp","mu","q","qa","r9k","tg","trash","vr"],reports:!0},{uid:24,name:"fireden.net",domain:"boards.fireden.net",http:!1,https:!0,software:"foolfuuka",boards:["cm","co","ic","sci","vip","y"],files:["cm","co","ic","sci","vip","y"],search:["cm","co","ic","sci","y"]},{uid:25,name:"not arch.b4k.co",domain:"arch.b4k.dev",http:!0,https:!0,software:"foolfuuka",boards:["g","mlp","qb","v","vg","vm","vmg","vp","vrpg","vst"],files:["qb","v","vg","vm","vmg","vp","vrpg","vst"],search:["qb","v","vg","vm","vmg","vp","vrpg","vst"]},{uid:29,name:"Archived.Moe",domain:"archived.moe",http:!0,https:!0,software:"foolfuuka",boards:["3","a","aco","adv","an","asp","b","bant","biz","c","can","cgl","ck","cm","co","cock","con","d","diy","e","f","fa","fap","fit","fitlit","g","gd","gif","h","hc","his","hm","hr","i","ic","int","jp","k","lgbt","lit","m","mlp","mlpol","mo","mtv","mu","n","news","o","out","outsoc","p","po","pol","pw","q","qa","qb","qst","r","r9k","s","s4s","sci","soc","sp","spa","t","tg","toy","trash","trv","tv","u","v","vg","vint","vip","vm","vmg","vp","vr","vrpg","vst","vt","w","wg","wsg","wsr","x","xs","y"],files:["can","cock","con","fap","fitlit","gd","mlpol","mo","mtv","outsoc","po","q","qb","qst","spa","vint","vip"],search:["aco","adv","an","asp","b","bant","biz","c","can","cgl","ck","cm","cock","con","d","diy","e","f","fap","fitlit","gd","gif","h","hc","his","hm","hr","i","ic","lgbt","lit","mlpol","mo","mtv","n","news","o","out","outsoc","p","po","pw","q","qa","qst","r","s","soc","spa","trv","u","vint","vip","vrpg","w","wg","wsg","wsr","x","y"],reports:!0},{uid:30,name:"TheBArchive.com",domain:"thebarchive.com",http:!0,https:!0,software:"foolfuuka",boards:["b","bant"],files:["b","bant"],reports:!0},{uid:31,name:"Archive Of Sins",domain:"archiveofsins.com",http:!0,https:!0,software:"foolfuuka",boards:["h","hc","hm","i","lgbt","r","s","soc","t","u"],files:["h","hc","hm","i","lgbt","r","s","soc","t","u"],reports:!0},{uid:36,name:"palanq.win",domain:"archive.palanq.win",http:!1,https:!0,software:"foolfuuka",boards:["bant","c","con","e","i","n","news","out","p","pw","qst","toy","vip","vp","vt","w","wg","wsr"],files:["bant","c","e","i","n","news","out","p","pw","qst","toy","vip","vp","vt","w","wg","wsr"],reports:!0},{uid:37,name:"Eientei",domain:"eientei.xyz",http:!1,https:!0,software:"Eientei",boards:["3","i","sci","xs"],files:["3","i","sci","xs"],reports:!0}],data:null,init(){if(this.selectArchives(),De.archiveAutoUpdate){const e=Date.now();(e-2*He>=De.lastarchivecheck||De.lastarchivecheck>e)&&this.update()}},selectArchives(){var e,t,n;const o={thread:new Map,threadJSON:new Map,post:new Map,file:new Map},a=Fe();for(const t of De.archives){for(e of["boards","files"])t[e]instanceof Array||(t[e]=[]);const{uid:n,name:i,boards:s,files:r,software:l}=t;if(["fuuka","foolfuuka"].includes(l)){a[JSON.stringify(n??i)]=t;for(const e of s)o.thread.has(e)||o.thread.set(e,t),!o.file.has(e)&&r.includes(e)&&o.file.set(e,t),"foolfuuka"===l&&(o.threadJSON.has(e)||o.threadJSON.set(e,t),o.post.has(e)||o.post.set(e,t))}}for(const e in De.selectedArchives){t=De.selectedArchives[e];for(const[i,s]of Object.entries(t))(n=a[JSON.stringify(s)])&&Ve.hasOwn(o,i)&&("file"===i?n.files:n.boards).includes(e)&&o[i].set(e,n)}K.data=o},update(e){let t;const n=[],o=[];let a=0;for(t of De.archiveLists.split("\n"))"#"!==t[0]&&(t=t.trim(),t&&n.push(t));const i=(e,t,n)=>new It("warning",`Error ${t} archive data from\n${e}\n${n}`,20),s=t=>function(){if(200!==this.status)return i(n[t],"fetching",this.status?`Error ${this.statusText} (${this.status})`:"Connection Error");let{response:s}=this;return s instanceof Array||(s=[s]),o[t]=s,a++,a===n.length?K.parse(o,e):void 0};if(n.length)for(let e=0;e<n.length;e++)if(t=n[e],["[","{"].includes(t[0])){var r;try{r=JSON.parse(t)}catch(e){i(t,"parsing",e.message);continue}s(e).call({status:200,response:r})}else U.ajax(t,{onloadend:s(e)});else K.parse([],e)},parse(e,t){var n,o,a;const i=[],s=Fe();for(n of e)for(o of n)(a=JSON.stringify(o.uid??o.name))in s?Ve.extend(s[a],o):(s[a]=Fe.clone(o),i.push(o));const r={archives:i,lastarchivecheck:Date.now()};return Ve.set(r),Ve.extend(De,r),K.selectArchives(),t?.()},to(e,t){const n=(["search","board"].includes(e)?K.data.thread:K.data[e]).get(t.boardID);return n?K[e](n,t):""},protocol(e){let{protocol:t}=location;return Ve.getOwn(e,t.slice(0,-1))||(t="https:"===t?"http:":"https:"),`${t}//`},thread(e,{boardID:t,threadID:n,postID:o}){let a=n?`${t}/thread/${n}`:`${t}/post/${o}`;return"foolfuuka"===e.software&&(a+="/"),n&&o&&(a+="foolfuuka"===e.software?`#${o}`:`#p${o}`),`${K.protocol(e)}${e.domain}/${a}`},threadJSON:(e,{boardID:t,threadID:n})=>`${K.protocol(e)}${e.domain}/_/api/chan/thread/?board=${t}&num=${n}`,post(e,{boardID:t,postID:n}){const o=`${K.protocol(e)}${e.domain}/_/api/chan/post/?board=${t}&num=${n}`;return K.securityCheck(o)?o:""},file(e,{boardID:t,filename:n}){if(!n)return"";if("f"===t)n=encodeURIComponent(Ve.unescape(decodeURIComponent(n)));else if(/[sm]\.jpg$/.test(n))return"";if(e.name.endsWith("arch.b4k.co")){const[e,t]=n.split(".");e.length>13&&(n=`${e.slice(0,-3)}.${t}`)}return`${K.protocol(e)}${e.domain}/${t}/full_image/${n}`},board:(e,{boardID:t})=>`${K.protocol(e)}${e.domain}/${t}/`,search(e,{boardID:t,type:n,value:o}){"capcode"===(n="name"===n?"username":"MD5"===n?"image":n)?o=Ve.getOwn({Developer:"dev",Verified:"ver"},o)||o.toLowerCase():"image"===n&&(o=o.replace(/[+/=]/g,e=>({"+":"-","/":"_","=":""}[e]))),o=encodeURIComponent(o);const a="foolfuuka"===e.software?`${t}/search/${n}/${o}/`:"image"===n?`${t}/image/${o}`:`${t}/?task=search2&search_${n}=${o}`;return`${K.protocol(e)}${e.domain}/${a}`},report(e){var t;const n=[];for(t of De.archives){var{software:o,https:a,reports:i,boards:s,name:r,domain:l}=t;"foolfuuka"===o&&a&&i&&s instanceof Array&&s.includes(e)&&n.push([r,`https://${l}/_/api/chan/offsite_report/`])}return n},securityCheck:e=>/^https:\/\//.test(e)||"http:"===location.protocol||De["Exempt Archives from Encryption"],navigate(e,t,n){K.data||K.init();const o=K.to(e,t);return o&&(K.securityCheck(o)||confirm(`Redirect to ${o}?\n\nYour connection will not be encrypted.`))?location.replace(o):n?location.replace(n):void 0}};class Ct{toString(){return this.ID}constructor(e){this.nodes={root:e,thumb:Ve(Ee.SITE.selectors.catalog.thumb,e)},this.siteID=Ee.SITE.ID,this.boardID=this.nodes.thumb.parentNode.pathname.split(/\/+/)[1],this.board=Ee.boards[this.boardID]||new ht(this.boardID),this.ID=this.threadID=+(e.dataset.id||e.id).match(/\d*$/)[0],this.thread=this.board.threads.get(this.ID)||new at(this.ID,this.board)}}const Dt={init(){if(De.Anonymize)return Ve.addClass(Re,"anonymize")}};X={init(){if(["index","thread"].includes(Ee.VIEW))return De["Image Hover"]&&Ne.Post.push({name:"Image Hover",cb:this.node}),De["Image Hover in Catalog"]?Ne.CatalogThread.push({name:"Image Hover",cb:this.catalogNode}):void 0},node(){return this.files.filter(e=>(e.isImage||e.isVideo)&&e.thumb).map(e=>Ve.on(e.thumb,"mouseover",X.mouseover(this,e)))},catalogNode(){const e=this.thread.OP.files[0];if(e&&(e.isImage||e.isVideo))return Ve.on(this.nodes.thumb,"mouseover",X.mouseover(this.thread.OP,e))},mouseover:(e,t)=>function(n){let o,a,i;if(!Re.contains(this))return;const{isVideo:s}=t;if(t.isExpanding||t.isExpanded||Ee.SITE.isThumbExpanded?.(t))return;const r=X.error(e,t);if(V.cache?.dataset.fileID===`${e.fullID}.${t.index}`?(o=V.popCache(),Ve.on(o,"error",r)):(o=Ve.el(s?"video":"img"),o.dataset.fileID=`${e.fullID}.${t.index}`,Ve.on(o,"error",r),o.src=t.url),De["Restart when Opened"]&&(V.rewind(o),V.rewind(this)),o.id="ihover",Ve.add(Y.hover,o),s&&(o.loop=!0,o.controls=!1,f.setup(o),De.Autoplay&&(o.play(),"VIDEO"===this.nodeName&&(this.currentTime=o.currentTime))),t.dimensions){[i,a]=t.dimensions.split("x").map(e=>+e);const e=Re.clientWidth,n=Re.clientHeight-rt.hover.padding,s=Math.min(1,e/i,n/a);i*=s,a*=s,o.style.maxWidth=`${i}px`,o.style.maxHeight=`${a}px`}return rt.hover({root:this,el:o,latestEvent:n,endEvents:"mouseout click",height:a,width:i,noRemove:!0,cb:()=>(Ve.off(o,"error",r),V.pushCache(o),V.pause(o),Ve.rm(o),o.removeAttribute("style"))})},error:(e,t)=>function(){if(!V.decodeError(this,t))return V.error(this,e,t,3e3,e=>e?this.src=e+(this.src===e?"?"+Date.now():""):Ve.rm(this))}},Z={init(){if(!["index","thread","archive"].includes(Ee.VIEW))return;const e=De["Replace JPG"]||De["Replace PNG"]||De["Replace GIF"]||De["Replace WEBM"];if(!De["Image Prefetching"]&&!e)return;if(Ne.Post.push({name:"Image Replace",cb:this.node}),Ve.on(Te,"PostsInserted",function(){if(Z.prefetchEnabled||e)return Ee.posts.forEach(Z.prefetchAll)}),De["Replace WEBM"]&&Ve.on(Te,"scroll visibilitychange 4chanXInitFinished PostsInserted",this.playVideos),!De["Image Prefetching"]||!["index","thread"].includes(Ee.VIEW))return;const t=Ve.el("a",{href:"javascript:;",title:"Prefetch Images",className:"disabled"});return a.set(t,"bolt","Prefetch"),Ve.on(t,"click",this.toggle),Y.addShortcut("prefetch",t,525)},node(){if(!this.isClone)for(var e of this.files)De["Replace WEBM"]&&e.isVideo&&Z.replaceVideo(this,e),Z.prefetch(this,e)},replaceVideo(e,t){const{thumb:n}=t,o=Ve.el("video",{preload:"none",loop:!0,muted:!0,poster:n.src||n.dataset.src,textContent:n.alt,className:n.className});for(var a of(o.setAttribute("muted","muted"),o.dataset.md5=n.dataset.md5,["height","width","maxHeight","maxWidth"]))o.style[a]=n.style[a];return o.src=t.url,Ve.replace(n,o),t.thumb=o,t.videoThumb=!0},prefetch(e,t){let n,o;const{isImage:a,isVideo:i,thumb:s,url:r}=t;if(t.isPrefetched||!a&&!i||e.isHidden||e.thread.isHidden)return;i?o="WEBM":(o=r.match(/\.([^.]+)$/)?.[1].toUpperCase(),"JPEG"===o&&(o="JPG"));const l=De[`Replace ${o}`]&&!/spoiler/.test(s.src||s.dataset.src);if(!l&&!Z.prefetchEnabled)return;if(Ve.hasClass(Re,"catalog-mode"))return;if(![e,...e.clones].some(e=>Re.contains(e.nodes.root)))return;if(t.isPrefetched=!0,t.videoThumb){for(n of e.clones)n.file.thumb.preload="auto";return s.preload="auto",void("gecko"===Ve.engine&&Ve.on(s,"loadeddata",function(){return this.removeAttribute("poster")}))}const d=Ve.el(a?"img":"video");return i&&(d.preload="auto"),l&&a&&Ve.on(d,"load",function(){for(n of e.clones)n.file.thumb.src=r;return s.src=r}),d.src=r},prefetchAll(e){for(var t of e.files)Z.prefetch(e,t)},toggle(){Z.prefetchEnabled=!Z.prefetchEnabled,this.classList.toggle("disabled",!Z.prefetchEnabled),Z.prefetchEnabled&&Ee.posts.forEach(Z.prefetchAll)},playVideos(){const e=Ve.id("qp")?.firstElementChild;return Ee.posts.forEach(function(t){var n;for(t of[t,...t.clones])for(n of t.files)if(n.videoThumb){var{thumb:o}=n;Y.isNodeVisible(o)||t.nodes.root===e?o.play():o.pause()}})}},ee={init(){if(De["WEBM Metadata"]&&["index","thread"].includes(Ee.VIEW))return Ne.Post.push({name:"WEBM Metadata",cb:this.node})},node(){var e,t;for(let n=0;n<this.files.length;n++)e=this.files[n],/webm$/i.test(e.url)&&(this.isClone?t=Ve(".webm-title",e.text):((t=Ve.el("span",{className:"webm-title"})).dataset.index=n,Ve.extend(t,{innerHTML:'<a href="javascript:;"></a>'}),Ve.add(e.text,[Ve.tn(" "),t])),1===t.children.length&&Ve.one(t.lastElementChild,"mouseover focus",ee.load))},load(){Ve.rmClass(this.parentNode,"error"),Ve.addClass(this.parentNode,"loading");const{index:e}=this.parentNode.dataset;return U.binary(n.postFromNode(this).files[+e].url,e=>{if(Ve.rmClass(this.parentNode,"loading"),null!=e){const t=ee.parse(e),n=Ve.el("span",{textContent:t||""});return null==t&&Ve.addClass(this.parentNode,"not-found"),Ve.before(this,n),this.parentNode.tabIndex=0,Te.activeElement===this&&this.parentNode.focus(),this.tabIndex=-1}return Ve.addClass(this.parentNode,"error"),Ve.one(this,"click",ee.load)},{Range:"bytes=0-9999"})},parse(e){var t,n,o,a;const i=function(){let n=e[t++],o=0;for(;n<128>>o;)o++;for(n^=128>>o;o--&&t<e.length;)n=n<<8^e[t++];return n};for(t=0;t<e.length;){if(n=i(),o=i(),15273===n){for(a="";o--&&t<e.length;)a+=String.fromCharCode(e[t++]);return decodeURIComponent(escape(a))}[139690087,88713574].includes(n)||(t+=o)}return null}};const Et={init(){if(["index","thread","archive"].includes(Ee.VIEW)&&De["Reveal Spoiler Thumbnails"])return Ne.Post.push({name:"Reveal Spoiler Thumbnails",cb:this.node})},node(){var e;if(!this.isClone)for(e of this.files)if(e.thumb&&e.isSpoiler){var{thumb:t}=e;t.removeAttribute("style"),t.style.maxHeight=t.style.maxWidth=this.isReply?"125px":"250px",t.src?t.src=e.thumbURL:t.dataset.src=e.thumbURL}}},St={init(){if("yotsuba"!==Ee.SITE.software||!["index","thread"].includes(Ee.VIEW)||!De.Menu||!De["Archive Link"])return;const e={el:Ve.el("div",{textContent:"Archive"}),order:60,open:({ID:e,thread:t,board:n})=>!!K.to("thread",{postID:e,threadID:t.ID,boardID:n.ID}),subEntries:[]};for(var t of[["Post","post"],["Name","name"],["Tripcode","tripcode"],["Capcode","capcode"],["Subject","subject"],["Flag","country"],["Filename","filename"],["Image MD5","MD5"]])e.subEntries.push(this.createSubEntry(t[0],t[1]));return A.menu.addEntry(e)},createSubEntry(e,t){const n=Ve.el("a",{textContent:e,target:"_blank"}),o="post"===t?function({ID:e,thread:t,board:o}){return n.href=K.to("thread",{postID:e,threadID:t.ID,boardID:o.ID}),!0}:function(e){const o="country"===t&&e.info.flagCodeTroll?"troll_country":t,a="country"===t?e.info.flagCode||e.info.flagCodeTroll?.toLowerCase():J.values(t,e)[0];return!!a&&(n.href=K.to("search",{boardID:e.board.ID,type:o,value:a,isSearch:!0}),!0)};return{el:n,open:o}}};te={init(){if(!["index","thread"].includes(Ee.VIEW)||!De.Menu||!De["Copy Text Link"])return;const e=Ve.el("a",{className:"copy-text-link",href:"javascript:;",textContent:"Copy Text"});return Ve.on(e,"click",te.copy),A.menu.addEntry({el:e,order:12,open:e=>(te.text=(e.origin||e).commentOrig(),!0)})},copy(){const e=Ve.el("textarea",{className:"copy-text-element",value:te.text});Ve.add(Te.body,e),e.select();try{Te.execCommand("copy")}catch(e){}return Ve.rm(e)}},ne={auto:[Fe(),Fe()],init(){if(!["index","thread"].includes(Ee.VIEW)||!De.Menu||!De["Delete Link"])return;const e=Ve.el("div",{className:"delete-link",textContent:"Delete"}),t=Ve.el("a",{className:"delete-post",href:"javascript:;"}),n=Ve.el("a",{className:"delete-file",href:"javascript:;"});this.nodes={menu:e.firstChild,links:[t,n]};const o={el:t,open:()=>(t.textContent=ne.linkText(!1),Ve.on(t,"click",ne.toggle),!0)},a={el:n,open:({file:e})=>!(!e||e.isDead||(n.textContent=ne.linkText(!0),Ve.on(n,"click",ne.toggle),0))};return A.menu.addEntry({el:e,order:40,open:e=>!e.isDead&&(ne.post=e,ne.nodes.menu.textContent=ne.menuText(),ne.cooldown.start(e),!0),subEntries:[o,a]})},menuText(){let e;return(e=ne.cooldown.seconds[ne.post.fullID])?`Delete (${e})`:"Delete"},linkText(e){let t=e?"File":"Post";return ne.auto[+e][ne.post.fullID]&&(t=`Deleting ${t.toLowerCase()}...`),t},toggle(){const{post:e}=ne,t=Ve.hasClass(this,"delete-file"),n=ne.auto[+t];if(n[e.fullID]?delete n[e.fullID]:n[e.fullID]=!0,this.textContent=ne.linkText(t),!ne.cooldown.seconds[e.fullID])return ne.delete(e,t)},delete(e,t){const n=ne.nodes.links[+t];delete ne.auto[+t][e.fullID],e.fullID===ne.post.fullID&&Ve.off(n,"click",ne.toggle);const o={mode:"usrdel",onlyimgdel:t,pwd:j.persona.getPassword()};return o[+e.ID]="delete",Ve.ajax(Ve.id("delform").action.replace(`/${Ee.BOARD}/`,`/${e.board}/`),{responseType:"document",withCredentials:!0,onloadend(){return ne.load(n,e,t,this.response)},form:Ve.formData(o)})},load(e,t,n,o){let a;if(!o)return new It("warning","Connection error, please retry.",20),void(t.fullID===ne.post.fullID&&Ve.on(e,"click",ne.toggle));if(e.textContent=ne.linkText(n),"4chan - Banned"===o.title){const e=Ve.el("span",{innerHTML:'You can&#039;t delete posts because you are <a href="//www.4chan.org/banned" target="_blank">banned</a>.'});return new It("warning",e,20)}if(a=o.getElementById("errmsg")){if(new It("warning",a.textContent,20),t.fullID===ne.post.fullID&&Ve.on(e,"click",ne.toggle),j.cooldown.data&&De.Cooldown&&/\bwait\b/i.test(a.textContent))return ne.cooldown.start(t,5),ne.auto[+n][t.fullID]=!0,ne.nodes.links[+n].textContent=ne.linkText(n)}else if(n||j.cooldown.delete(t),"Updating index..."===o.title&&(t.origin||t).kill(n),t.fullID===ne.post.fullID)return e.textContent="Deleted"},cooldown:{seconds:Fe(),start(e,t){if(null==ne.cooldown.seconds[e.fullID])return null==t&&(t=j.cooldown.secondsDeletion(e)),t>0?(ne.cooldown.seconds[e.fullID]=t,ne.cooldown.count(e)):void 0},count(e){if(e.fullID===ne.post.fullID&&(ne.nodes.menu.textContent=ne.menuText()),ne.cooldown.seconds[e.fullID]>0&&De.Cooldown)ne.cooldown.seconds[e.fullID]--,setTimeout(ne.cooldown.count,1e3,e);else for(var t of(delete ne.cooldown.seconds[e.fullID],[!1,!0]))ne.auto[+t][e.fullID]&&ne.delete(e,t)}}};const Tt={init(){if(!["index","thread"].includes(Ee.VIEW)||!De.Menu||!De["Download Link"])return;const e=Ve.el("a",{className:"download-link",textContent:"Download file"});return Ve.on(e,"click",V.download),A.menu.addEntry({el:e,order:100,open:({file:t})=>!!t&&(e.href=t.url,e.download=t.name,!0)})}};oe={init(){if(!["index","thread"].includes(Ee.VIEW)||!De.Menu||!De["Report Link"])return;const e=Ve.el("a",{className:"report-link",href:"javascript:;",textContent:"Report"});return Ve.on(e,"click",oe.report),A.menu.addEntry({el:e,order:10,open:e=>(oe.url=`//sys.${location.hostname.split(".")[1]}.org/${e.board}/imgboard.php?mode=report&no=${e}`,Te.cookie.indexOf("pass_enabled=1")>=0?oe.dims="width=350,height=275":oe.dims="width=400,height=550",!0)})},report(){const{url:e,dims:t}=oe,n=Date.now(),o=`toolbar=0,scrollbars=1,location=0,status=1,menubar=0,resizable=1,${t}`;return window.open(e,n,o)}},ae={init(){if(De["Disable Autoplaying Sounds"]){for(var e of(Ve.addClass(Re,"anti-autoplay"),Ge("audio[autoplay]",Re)))this.stop(e);return window.addEventListener("loadstart",e=>this.stop(e.target),!0),Ne.Post.push({name:"Disable Autoplaying Sounds",cb:this.node}),Ve.ready(()=>this.process(Te.body))}},stop(e){if(e.autoplay&&(e.pause(),e.autoplay=!1,!e.controls))return e.controls=!0,Ve.addClass(e,"controls-added")},node(){return ae.process(this.nodes.comment)},process(e){var t,n;for(t of Ge('iframe[src*="youtube"][src*="autoplay=1"]',e))ae.processVideo(t,"src");for(n of Ge('object[data*="youtube"][data*="autoplay=1"]',e))ae.processVideo(n,"data")},processVideo:(e,t)=>(e[t]=e[t].replace(/\?autoplay=1&?/,"?").replace("&autoplay=1",""),"none"===window.getComputedStyle(e).display&&(e.style.display="block"),Ve.addClass(e,"autoplay-removed"))},ie={init(){if(De["Custom Board Titles"]&&(this.db=new nt("customTitles",null,!0)),Ve.asap(()=>Te.body,()=>Ve.asap(()=>Ve("hr"),ie.ready)),"f"!==Ee.BOARD.ID)return ke.ready(()=>Ve.queueTask(ie.load))},ready(){const e=Ve(".boardBanner"),{children:t}=e;if("thread"===Ee.VIEW&&De["Remove Thread Excerpt"]&&ie.setTitle(t[1].textContent),t[0].title="Click to change",Ve.on(t[0],"click",ie.cb.toggle),De["Custom Board Titles"]&&(ie.custom(t[1]),t[2]))return ie.custom(t[2])},load(){const e=Ve.id("bannerCnt");if(!e.firstChild){const t=Ve.el("img",{alt:"4chan",src:"//s.4cdn.org/image/title/"+e.dataset.src});return Ve.add(e,t)}},setTitle:e=>null!=I.title?(I.title=e,I.update()):Te.title=e,cb:{toggle(){ie.choices?.length||(ie.choices=De.knownBanners.split(",").slice());const e=Math.floor(ie.choices.length*Math.random()),t=ie.choices.splice(e,1);return Ve("img",this.parentNode).src=`//s.4cdn.org/image/title/${t}`},click(e){if(e.ctrlKey||e.metaKey){for(var t of(null==ie.original[this.className]&&(ie.original[this.className]=this.cloneNode(!0)),this.contentEditable=!0,Ge("br",this)))Ve.replace(t,Ve.tn("\n"));return this.focus()}},keydown(e){if(e.stopPropagation(),!e.shiftKey&&13===e.keyCode)return this.blur()},blur(){for(var e of Ge("br",this))Ve.replace(e,Ve.tn("\n"));return(this.textContent=this.textContent.replace(/\n*$/,""))?(this.contentEditable=!1,ie.db.set({boardID:Ee.BOARD.ID,threadID:this.className,val:{title:this.textContent,orig:ie.original[this.className].textContent}})):(Ve.rmAll(this),Ve.add(this,[...ie.original[this.className].cloneNode(!0).childNodes]),ie.db.delete({boardID:Ee.BOARD.ID,threadID:this.className}))}},original:Fe(),custom(e){let t;const{className:n}=e;for(var o of(e.title=`Ctrl/âŒ˜+click to edit board ${n.slice(5).toLowerCase()}`,e.spellcheck=!1,["click","keydown","blur"]))Ve.on(e,o,ie.cb[o]);if(t=ie.db.get({boardID:Ee.BOARD.ID,threadID:n}))return De["Persistent Custom Board Titles"]||t.orig===e.textContent?(ie.original[n]=e.cloneNode(!0),e.textContent=t.title):ie.db.delete({boardID:Ee.BOARD.ID,threadID:n})}},se={init(){if("f"===Ee.BOARD.ID&&De["Enable Native Flash Embedding"])return Ve.ready(se.initReady)},initReady(){Ve.hasStorage?Ve.global("initFlash"):("thread"===Ee.VIEW&&Ve.global("setThreadId"),Ve.global("initFlashNoStorage"))}},re={init(){if("yotsuba"===Ee.SITE.software&&["index","thread","archive"].includes(Ee.VIEW))return b.ready(this.initBoard),ke.ready(this.initReady)},initBoard(){if(Ee.BOARD.config.code_tags&&(Ve.on(window,"prettyprint:cb",function(e){let t,n;if((t=Ee.posts.get(e.detail.ID))&&(n=Ge(".prettyprint",t.nodes.comment)[+e.detail.i]))return Ve.hasClass(n,"prettyprinted")?void 0:(n.innerHTML=e.detail.html,Ve.addClass(n,"prettyprinted"))}),Ve.global("fourChanPrettyPrintListener"),Ne.Post.push({name:"Parse [code] tags",cb:re.code}),Ee.posts.forEach(function(e){if(e.callbacksExecuted)return Ne.Post.execute(e,["Parse [code] tags"],!0)}),y.callbacks.push(re.code)),Ee.BOARD.config.math_tags)return Ve.global("fourChanMathjaxListener"),Ne.Post.push({name:"Parse [math] tags",cb:re.math}),Ee.posts.forEach(function(e){if(e.callbacksExecuted)return Ne.Post.execute(e,["Parse [math] tags"],!0)}),y.callbacks.push(re.math)},initReady:()=>Ve.global("disable4chanIdHl"),code(){if(!this.isClone)return Ve.ready(()=>{const e=Ge(".prettyprint",this.nodes.comment);for(let n=0;n<e.length;n++){var t=e[n];Ve.hasClass(t,"prettyprinted")||Ve.event("prettyprint",{ID:this.fullID,i:n,html:t.innerHTML},window)}})},math(){var e,t;let n;if(/\[(math|eqn)\]/.test(this.nodes.comment.textContent)){if((n=Ge("wbr",this.nodes.comment)).length){for(e of n)Ve.rm(e);this.nodes.comment.normalize()}return t=()=>{if(Re.contains(this.nodes.comment))return Ve.off(Te,"PostsInserted",t),Ve.event("mathjax",null,this.nodes.comment)},Ve.on(Te,"PostsInserted",t),t()}}},le={init(){if(["index","thread"].includes(Ee.VIEW)&&De["Color User IDs"])return this.ids=Fe(),this.ids.Heaven=[0,0,0,"#fff"],Ne.Post.push({name:"Color User IDs",cb:this.node})},node(){let e,t;if(this.isClone||!(t=this.info.uniqueID)||!(e=this.nodes.uniqueID))return;const n=le.ids[t]||le.compute(t),{style:o}=e;return o.color=n[3],o.backgroundColor=`rgb(${n[0]},${n[1]},${n[2]})`,Ve.addClass(e,"painted")},compute(e){const t=Ee.SITE.uidColor?Ee.SITE.uidColor(e):parseInt(e,16),n=[t>>16&255,t>>8&255,255&t];return n.push(Ve.luma(n)>125?"#000":"#fff"),this.ids[e]=n}},de={init(){if(["index","thread"].includes(Ee.VIEW))return Ne.Post.push({name:"Highlight by User ID",cb:this.node})},uniqueID:null,node(){if(this.nodes.uniqueIDRoot&&Ve.on(this.nodes.uniqueIDRoot,"click",de.click(this)),this.nodes.capcode&&Ve.on(this.nodes.capcode,"click",de.click(this)),!this.isClone)return de.set(this)},set(e){const t=(e.info.uniqueID||e.info.capcode)===de.uniqueID;return Ve[t?"addClass":"rmClass"](e.nodes.post,"highlight")},click:e=>function(){const t=e.info.uniqueID||e.info.capcode;return de.uniqueID=de.uniqueID===t?null:t,Ee.posts.forEach(de.set)}},ce={init(){if("thread"===Ee.VIEW&&De["Count Posts by ID"])return Ne.Thread.push({name:"Count Posts by ID",cb(){return ce.thread=this}}),Ne.Post.push({name:"Count Posts by ID",cb:this.node})},node(){if(this.nodes.uniqueID&&this.thread===ce.thread)return Ve.on(this.nodes.uniqueID,"mouseover",ce.count)},count(){const{uniqueID:e}=n.postFromNode(this).info;let t=0;return ce.thread.posts.forEach(function(n){if(n.info.uniqueID===e)return t++}),this.title=`${t} post${1===t?"":"s"} by this ID`}},he={init(){if("yotsuba"===Ee.SITE.software&&["index","thread"].includes(Ee.VIEW))return Ne.Post.push({name:"Mod Contact Links",cb:this.node})},node(){let e;if(this.isClone||!Ve.hasOwn(he.specific,this.info.capcode))return;const t=Ve.el("span",{className:"contact-links brackets-wrap"});if(Ve.extend(t,he.template(this.info.capcode)),Ve.after(this.nodes.capcode,t),(e=this.info.comment.match(/This thread was moved to >>>\/(\w+)\//))&&Ve.hasOwn(he.moveNote,e[1])){const t=Ve.el("div",{className:"move-note"});return Ve.extend(t,he.moveNote[e[1]]),Ve.add(this.nodes.post,t)}},template:e=>({innerHTML:'<a href="https://www.4chan.org/feedback" target="_blank">feedback</a>'+he.specific[e]().innerHTML}),specific:{Mod:()=>({innerHTML:' <a href="https://www.4chan-x.net/4chan-irc.html" target="_blank">IRC</a>'}),Manager:()=>he.specific.Mod(),Developer:()=>({innerHTML:' <a href="https://github.com/4chan" target="_blank">github</a>'}),Admin:()=>({innerHTML:' <a href="https://twitter.com/hiroyuki_ni" target="_blank">twitter</a>'})},moveNote:{qa:{innerHTML:'Moving a thread to /qa/ does not imply mods will read it. If you wish to contact mods, use <a href="https://www.4chan.org/feedback" target="_blank">feedback</a><span class="invisible"> (https://www.4chan.org/feedback)</span> or <a href="https://www.4chan-x.net/4chan-irc.html" target="_blank">IRC</a><span class="invisible"> (https://www.4chan-x.net/4chan-irc.html)</span>.'}}};const Rt={init(){if(!De["Normalize URL"])return;let e=location.pathname.split(/\/+/);if("yotsuba"===Ee.SITE.software)switch(Ee.VIEW){case"thread":e[2]="thread",e=e.slice(0,4);break;case"index":e=e.slice(0,3)}return e=e.join("/"),location.pathname!==e?history.replaceState(history.state,"",`${location.protocol}//${location.host}${e}${location.hash}`):void 0}};ue={init(){if(De["Unique ID and Capcode Navigation"]&&["index","thread"].includes(Ee.VIEW))return this.buttons=this.makeButtons(),a.set(this.buttons.firstChild,"arrowUpLong"),a.set(this.buttons.lastChild,"arrowDownLong"),Ne.Post.push({name:"Post Jumper",cb:this.node})},node(){if(this.isClone)for(var e of Ge(".postJumper",this.nodes.info))ue.addListeners(e);else if(this.nodes.uniqueIDRoot&&ue.addButtons(this,"uniqueID"),this.nodes.capcode)return ue.addButtons(this,"capcode")},addButtons(e,t){const n=e.info[t],o=ue.buttons.cloneNode(!0);return Ve.extend(o.dataset,{type:t,value:n}),Ve.after(e.nodes[t+("capcode"===t?"":"Root")],o),ue.addListeners(o)},addListeners:e=>(Ve.on(e.firstChild,"click",ue.buttonClick),Ve.on(e.lastChild,"click",ue.buttonClick)),buttonClick(){let e;const t=Ve.hasClass(this,"prev")?-1:1;if(e=ue.find(this.parentNode,t))return ue.scroll(this.parentNode,e)},find(e,t){const{type:n,value:o}=e.dataset,a=`span[contains(@class,"postJumper") and @data-value="${o}" and @data-type="${n}"]`,i=t<0?"preceding":"following";let s=e;for(;s=Ve.x(`${i}::${a}`,s);)if(s.getBoundingClientRect().height)return s;if((s=Ve.x(`(//${a})[${t<0?"last()":"1"}]`))&&s.getBoundingClientRect().height)return s;for(;(s=Ve.x(`${i}::${a}`,s))&&s!==e;)if(s.getBoundingClientRect().height)return s;return null},makeButtons(){const e=Ve.el("span",{className:"postJumper"});return Ve.extend(e,{innerHTML:'<a href="javascript:;" class="'+Se("prev")+'">'+Se("â«")+'</a><a href="javascript:;" class="'+Se("next")+'">'+Se("â¬")+"</a>"}),e},scroll(e,t){const n=e.getBoundingClientRect().top,o=t.getBoundingClientRect().top;return window.scrollBy(0,o-n)}};const Bt={init(){let e;if("yotsuba"===Ee.SITE.software&&"qa"===Ee.BOARD.ID&&(e=Ve.el("div",{className:"fcx-announcement"},{innerHTML:'Stay in touch with your <a href="https://www.4chan-x.net/qa_friends.html" target="_blank" rel="noopener">/qa/ friends</a>!'}),Ve.onExists(Re,".boardBanner",t=>Ve.after(t,e))),"samachan.org"in De.siteProperties&&!De.PSAseen.includes("samachan"))return e=Ve.el("span",{innerHTML:'<a href="https://sushigirl.us/yakuza/res/776.html" target="_blank" rel="noopener">Looking for a new home?<br>Some former Samachan users are regrouping on SushiChan.</a><br>(a message from 4chan X)'}),ke.ready(function(){return new It("info",e),De.PSAseen.push("samachan"),Ve.set("PSAseen",De.PSAseen)})}};pe={init(){if(De["Announcement Hiding"]&&Ee.SITE.selectors.psa)return Ve.addClass(Re,"hide-announcement"),Ve.onExists(Re,Ee.SITE.selectors.psa,this.setup),Ve.ready(function(){if(!Ve(Ee.SITE.selectors.psa))return Ve.rmClass(Re,"hide-announcement")})},setup(e){let t,n;pe.psa=e,pe.text=e.dataset.utc??e.innerHTML,Ee.SITE.selectors.psaTop&&(n=Ve(Ee.SITE.selectors.psaTop)?.previousElementSibling)&&"HR"===n.nodeName&&(pe.hr=n),pe.content=Ve.el("div");const o={el:Ve.el("a",{textContent:"Show announcement",className:"show-announcement",href:"javascript:;"}),order:50,open:()=>e.hidden};return Y.menu.addEntry(o),Ve.on(o.el,"click",pe.toggle),pe.btn=t=Ve.el("a",{title:"Mark announcement as read and hide.",className:"hide-announcement-button",href:"javascript:;",textContent:"âž–ï¸Ž"}),a.set(t,"squareMinus"),Ve.on(t,"click",pe.toggle),"HR"===e.firstChild?.tagName?Ve.after(e.firstChild,t):Ve.prepend(e,t),pe.sync(De.hiddenPSAList),Ve.rmClass(Re,"hide-announcement"),Ve.sync("hiddenPSAList",pe.sync)},toggle(){const e=Ve.hasClass(this,"hide-announcement-button"),t=function(t){return e?t[Ee.SITE.ID]=pe.text:delete t[Ee.SITE.ID]};return t(De.hiddenPSAList),pe.sync(De.hiddenPSAList),Ve.get("hiddenPSAList",De.hiddenPSAList,function({hiddenPSAList:e}){return t(e),Ve.set("hiddenPSAList",e)})},sync(e){const{psa:t,content:n}=pe;t.hidden=e[Ee.SITE.ID]===pe.text,t.hidden?Ve.add(n,[...t.childNodes]):Ve.add(t,[...n.childNodes]),pe.hr&&(pe.hr.hidden=t.hidden)}},ge={init(){if(De["Reveal Spoilers"]&&Ve.addClass(Re,"reveal-spoilers"),De["Remove Spoilers"])return Ne.Post.push({name:"Reveal Spoilers",cb:this.node}),"archive"===Ee.VIEW?Ve.ready(()=>ge.unspoiler(Ve.id("arc-list"))):void 0},node(){return ge.unspoiler(this.nodes.comment)},unspoiler(e){var t,n;const o=Ge(Ee.SITE.selectors.spoiler,e);for(t of o)n=Ve.el("span",{className:"removed-spoiler"}),Ve.replace(t,n),Ve.add(n,[...t.childNodes])}},fe={init(){if("index"===Ee.VIEW&&De["Open Threads in New Tab"])return Ne.Post.push({name:"Thread Links",cb:this.node}),Ne.CatalogThread.push({name:"Thread Links",cb:this.catalogNode})},node(){if(!this.isReply&&!this.isClone)return fe.process(this.nodes.reply)},catalogNode(){return fe.process(this.nodes.thumb.parentNode)},process:e=>e.target="_blank"};const Lt={init(){if("tinyboard"===Ee.SITE.software)return"thread"===Ee.VIEW?ke.ready(()=>Ve.global("initTinyBoard",{boardID:Ee.BOARD.ID,threadID:Ee.THREADID.toString()})):void 0}};me={init(){if("yotsuba"===Ee.SITE.software&&"thread"===Ee.VIEW&&De["Mark New IPs"])return Ne.Thread.push({name:"Mark New IPs",cb:this.node})},node(){return me.ipCount=this.ipCount,me.postCount=this.posts.keys.length,Ve.on(Te,"ThreadUpdate",me.onUpdate)},onUpdate(e){let t;const{ipCount:n,postCount:o,newPosts:a,deletedPosts:i}=e.detail;if(null!=n){switch(n-me.ipCount){case o-me.postCount+i.length:var s=me.ipCount;for(t of a)me.markNew(Ee.posts.get(t),++s);break;case-i.length:for(t of a)me.markOld(Ee.posts.get(t))}return me.ipCount=n,me.postCount=o}},markNew(e,t){const n=Math.floor(t/10)%10==1?"th":["st","nd","rd"][t%10-1]||"th",o=Ve.el("span",{className:"ip-counter",textContent:`(${t})`});return e.nodes.nameBlock.title=`This is the ${t}${n} IP in the thread.`,Ve.add(e.nodes.nameBlock,[Ve.tn(" "),o]),Ve.addClass(e.nodes.root,"new-ip")},markOld:e=>(e.nodes.nameBlock.title="Not the first post from this IP.",Ve.addClass(e.nodes.root,"old-ip"))},be={postCount:0,fileCount:0,postIndex:0,init(){let e;if("thread"!==Ee.VIEW||!De["Thread Stats"])return;De["Page Count in Stats"]&&(this[Ee.SITE.isPrunedByAge?.(Ee.BOARD)?"showPurgePos":"showPage"]=!0);const t={innerHTML:'<span id="post-count">?</span> / <span id="file-count">?</span>'+(De["IP Count in Stats"]&&Ee.SITE.hasIPCount?' / <span id="ip-count">?</span>':"")+(De["Page Count in Stats"]?' / <span id="page-count">?</span>':"")};let n="Posts / Files";return De["IP Count in Stats"]&&Ee.SITE.hasIPCount&&(n+=" / IPs"),De["Page Count in Stats"]&&(this.showPurgePos?n+=" / Purge Position":(n+=" / Page",De["Purge Position"]&&(n+=" (Purge Position)"))),De["Updater and Stats in Header"]?(this.dialog=e=Ve.el("span",{id:"thread-stats",title:n}),Ve.extend(e,t),Y.addShortcut("stats",e,200)):(this.dialog=e=rt.dialog("thread-stats",{innerHTML:'<div class="move" title="'+Se(n)+'">'+t.innerHTML+"</div>"}),Ve.addClass(Re,"float"),Ve.ready(()=>Ve.add(Te.body,e))),this.postCountEl=Ve("#post-count",e),this.fileCountEl=Ve("#file-count",e),this.ipCountEl=Ve("#ip-count",e),this.pageCountEl=Ve("#page-count",e),this.pageCountEl&&Ve.on(this.pageCountEl,"click",be.fetchPage),Ne.Thread.push({name:"Thread Stats",cb:this.node})},node(){return be.thread=this,be.count(),be.update(),be.fetchPage(),Ve.on(Te,"PostsInserted",()=>Ve.queueTask(be.onPostsInserted)),Ve.on(Te,"ThreadUpdate",be.onUpdate)},count(){const{posts:e}=be.thread,t=e.keys.length;for(let o=be.postIndex,a=t;o<a;o++){var n=e.get(e.keys[o]);n.isFetchedQuote||(be.postCount++,be.fileCount+=n.files.length)}be.postIndex=t},onUpdate(e){if(e.detail[404])return;const{postCount:t,fileCount:n}=e.detail;return Ve.extend(be,{postCount:t,fileCount:n}),be.postIndex=be.thread.posts.keys.length,be.update(),be.showPage&&"1"!==be.pageCountEl.textContent?be.fetchPage():void 0},onPostsInserted(){if(!(be.thread.posts.keys.length<=be.postIndex))return be.count(),be.update(),be.showPage&&"1"!==be.pageCountEl.textContent?be.fetchPage():void 0},update(){const{thread:e,postCountEl:t,fileCountEl:n,ipCountEl:o}=be;if(t.textContent=be.postCount,n.textContent=be.fileCount,o)if(e.ipCount)o.textContent=e.ipCount;else if(Ee.BOARD?.config.user_ids){const e=new Set;Ee.posts.forEach(t=>{e.add(t.info.uniqueID)}),o.textContent=e.size}else o.textContent="?";t.classList.toggle("warning",e.postLimit&&!e.isSticky),n.classList.toggle("warning",e.fileLimit&&!e.isSticky)},fetchPage(){if(be.pageCountEl){if(clearTimeout(be.timeout),be.thread.isDead)return be.pageCountEl.textContent="Dead",void Ve.addClass(be.pageCountEl,"warning");be.timeout=setTimeout(be.fetchPage,De["Purge Position"]&&be.pageCountEl.classList.contains("warning")?5e3:12e4),Ve.whenModified(Ee.SITE.urls.threadsListJSON(be.thread),"ThreadStats",be.onThreadsLoad)}},onThreadsLoad(){if(200===this.status){let e,t;if(be.showPurgePos){let n=1;for(e of this.response)for(t of e.threads)t.no<be.thread.ID&&n++;be.pageCountEl.textContent=n,be.pageCountEl.classList.toggle("warning",1===n)}else{let n,o=n=0;for(e of this.response)n+=e.threads.length;for(let a=0;a<this.response.length;a++)for(t of(e=this.response[a],e.threads)){if(t.no===be.thread.ID){be.pageCountEl.textContent=a+1;const e=o>=n-this.response[0].threads.length;return be.pageCountEl.classList.toggle("warning",e),e&&De["Purge Position"]&&(be.pageCountEl.textContent+=` (${n-o-1})`),be.lastPageUpdate=new Date(t.last_modified*$e),void be.retry()}o++}}}else 304===this.status&&be.retry()},retry(){!be.showPage||"1"===be.pageCountEl.textContent||Ee.SITE.threadModTimeIgnoresSage||be.thread.posts.get(be.thread.lastPost).info.date<=be.lastPageUpdate||(clearTimeout(be.timeout),be.timeout=setTimeout(be.fetchPage,5e3))}};const Nt={init(){if("yotsuba"===Ee.SITE.software&&De["Pass Link"])return ke.ready(this.ready)},ready(){let e;if(!(e=Ve.id("styleSelector")))return;const t=Ve.el("span",{className:"brackets-wrap pass-link-container"});return Ve.extend(t,{innerHTML:'<a href="javascript:;">4chan Pass</a>'}),Ve.on(t.firstElementChild,"click",()=>window.open(`//sys.${location.hostname.split(".")[1]}.org/auth`,Date.now(),"width=500,height=280,toolbar=0")),Ve.before(e.previousSibling,[t,Ve.tn("Â Â ")])}};Ae={init(){if(["index","thread"].includes(Ee.VIEW)&&De["Quote Inlining"])return De["Comment Expansion"]&&y.callbacks.push(this.node),Ne.Post.push({name:"Quote Inlining",cb:this.node})},node(){const{process:e}=Ae,{isClone:t}=this;for(var n of this.nodes.quotelinks.concat([...this.nodes.backlinks],this.nodes.archivelinks))e(n,t)},process:(e,t)=>(De["Quote Hash Navigation"]&&(t||Ve.after(e,Ae.qiQuote(e,Ve.hasClass(e,"filtered")))),Ve.on(e,"click",Ae.toggle)),qiQuote(e,t){let n="hashlink";return t&&(n+=" filtered"),Ve.el("a",{className:n,textContent:"#",href:e.href})},toggle(e){if(Ve.modifiedClick(e))return;const{boardID:t,threadID:o,postID:a}=n.postDataFromLink(this);if(De["Inline Cross-thread Quotes Only"]&&"thread"===Ee.VIEW&&Ee.posts.get(`${t}.${a}`)?.nodes.root.offsetParent)return;if(Ve.hasClass(Re,"catalog-mode"))return;e.preventDefault();const i=n.postFromNode(this),{context:s}=i;if(Ve.hasClass(this,"inlined"))Ae.rm(this,t,o,a,s);else{if(Ve.x(`ancestor::div[@data-full-i-d='${t}.${a}']`,this))return;Ae.add(this,t,o,a,s,i)}return this.classList.toggle("inlined")},findRoot:(e,t)=>Ve.x(t?'ancestor::*[parent::*[contains(@class,"post")]][1]':"ancestor-or-self::*[parent::blockquote][1]",e),add(e,t,n,o,a,i){let s;const r=Ve.hasClass(e,"backlink"),l=Ve.el("div",{className:"inline"});l.dataset.fullID=`${t}.${o}`;const d=Ae.findRoot(e,r);Ve.after(d,l);const c=Ve.x('ancestor::*[contains(@class,"postContainer")][1]',d);if(Ve.addClass(c,"hasInline"),new mt(t,n,o,l,i),(s=Ee.posts.get(`${t}.${o}`))&&a.thread===s.thread&&(r&&De["Forward Hiding"]&&(Ve.addClass(s.nodes.root,"forwarded"),s.forwarded++||(s.forwarded=1)),I.posts))return I.readSinglePost(s)},rm(e,t,o,a,i){let s,r;const l=Ve.hasClass(e,"backlink");let d=Ae.findRoot(e,l);d=Ve.x(`following-sibling::div[@data-full-i-d='${t}.${a}'][1]`,d);const c=Ve.x('ancestor::*[contains(@class,"postContainer")][1]',d),{parentNode:h}=d;if(Ve.rm(d),Ve.event("PostsRemoved",null,h),Ve(".inline",c)||Ve.rmClass(c,"hasInline"),!(s=d.firstElementChild))return;const u=Ee.posts.get(`${t}.${a}`);for(u.rmClone(s.dataset.clone),De["Forward Hiding"]&&l&&i.thread===Ee.threads.get(`${t}.${o}`)&&! --u.forwarded&&(delete u.forwarded,Ve.rmClass(u.nodes.root,"forwarded"));r=Ve(".inlined",s);)({boardID:t,threadID:o,postID:a}=n.postDataFromLink(r)),Ae.rm(r,t,o,a,i),Ve.rmClass(r,"inlined")}},ve={containers:Fe(),init(){if(["index","thread"].includes(Ee.VIEW)&&De["Quote Backlinks"])return(this.bottomBacklinks=De["Bottom Backlinks"])&&Ve.addClass(Re,"bottom-backlinks"),Ne.Post.push({name:"Quote Backlinking Part 1",cb:this.firstNode}),Ne.Post.push({name:"Quote Backlinking Part 2",cb:this.secondNode})},firstNode(){var e,t,n,o,a,i,s,r;if(this.isClone||!this.quotes.length||this.isRebuilt)return;const l=De["Mark Quotes of You"]&&k.isYou(this),d=Ve.el("a",{href:Ee.SITE.Build.postURL(this.board.ID,this.thread.ID,this.ID),className:this.isHidden?"filtered backlink":"backlink",textContent:De.backlink.replace(/%(?:id|%)/g,e=>({"%id":this.ID,"%%":"%"}[e]))});for(e of(l&&Ve.add(d,k.mark.cloneNode(!0)),this.quotes)){if(n=[ve.getContainer(e)],(t=Ee.posts.get(e))&&t.nodes.backlinkContainer)for(o of t.clones)n.push(o.nodes.backlinkContainer);for(a of n)i=d.cloneNode(!0),s=a.firstChild?[Ve.tn(" "),i]:[i],De["Quote Previewing"]&&Ve.on(i,"mouseover",R.mouseover),De["Quote Inlining"]&&(Ve.on(i,"click",Ae.toggle),De["Quote Hash Navigation"]&&(r=Ae.qiQuote(i,Ve.hasClass(i,"filtered")),s.push(r))),Ve.add(a,s)}},secondNode(){if(this.isClone&&(this.origin.isReply||De["OP Backlinks"]))return void(this.nodes.backlinkContainer=Ve(".container",this.nodes.post));if(!this.isReply&&!De["OP Backlinks"])return;const e=ve.getContainer(this.fullID);return this.nodes.backlinkContainer=e,ve.bottomBacklinks?Ve.add(this.nodes.post,e):Ve.add(this.nodes.info,e)},getContainer(e){return this.containers[e]||(this.containers[e]=Ve.el("span",{className:"container"}))}},xe={init(){if(["index","thread"].includes(Ee.VIEW)&&De["Mark Cross-thread Quotes"])return De["Comment Expansion"]&&y.callbacks.push(this.node),this.mark=Ve.el("span",{textContent:"Â (Cross-thread)",className:"qmark-ct"}),Ne.Post.push({name:"Mark Cross-thread Quotes",cb:this.node})},node(){var e;if(this.isClone&&this.thread===this.context.thread)return;const{board:t,thread:o}=this.context;for(e of this.nodes.quotelinks){var{boardID:a,threadID:i}=n.postDataFromLink(e);i&&(this.isClone&&Ve.rm(Ve(".qmark-ct",e)),a===t.ID&&i!==o.ID&&Ve.add(e,xe.mark.cloneNode(!0)))}}},we={init(){if(["index","thread"].includes(Ee.VIEW)&&De["Mark OP Quotes"])return De["Comment Expansion"]&&y.callbacks.push(this.node),this.mark=Ve.el("span",{textContent:"Â (OP)",className:"qmark-op"}),Ne.Post.push({name:"Mark OP Quotes",cb:this.node})},node(){let e,t,o;if(this.isClone&&this.thread===this.context.thread)return;if(!(o=this.quotes).length)return;const{quotelinks:a}=this.nodes;if(this.isClone&&o.includes(this.thread.fullID))for(e=0;t=a[e++];)Ve.rm(Ve(".qmark-op",t));const{fullID:i}=this.context.thread;if(o.includes(i))for(e=0;t=a[e++];){var{boardID:s,postID:r}=n.postDataFromLink(t);`${s}.${r}`===i&&Ve.add(t,we.mark.cloneNode(!0))}}};const Mt={init(){if(["index","thread"].includes(Ee.VIEW)&&(De["Reply Hiding Buttons"]||De.Menu&&De["Reply Hiding Link"]||De.Filter))return Ne.Post.push({name:"Strike-through Quotes",cb:this.node})},node(){var e;if(!this.isClone)for(e of this.nodes.quotelinks){var{boardID:t,postID:o}=n.postDataFromLink(e);Ee.posts.get(`${t}.${o}`)?.isHidden&&Ve.addClass(e,"filtered")}}};ye={init(){if(["index","thread"].includes(Ee.VIEW)&&De["Resurrect Quotes"])return Ve.addClass(Re,"resurrect-quotes"),De["Comment Expansion"]&&y.callbacks.push(this.node),Ne.Post.push({name:"Resurrect Quotes",cb:this.node})},node(){var e,t;if(this.isClone)this.nodes.archivelinks=Ge("a.linkify.quotelink",this.nodes.comment);else{for(e of Ge("a.linkify",this.nodes.comment))ye.parseArchivelink.call(this,e);for(t of Ge(".deadlink",this.nodes.comment))ye.parseDeadlink.call(this,t)}},parseArchivelink(e){let t;if(!(t=e.pathname.match(/^\/([^/]+)\/thread\/S?(\d+)\/?$/)))return;if(["boards.4chan.org","boards.4channel.org"].includes(e.hostname))return;const n=t[1],o=t[2],a=e.hash.match(/^#[pq]?(\d+)$|$/)[1]||o;return K.to("post",{boardID:n,postID:a})?(Ve.addClass(e,"quotelink"),Ve.extend(e.dataset,{boardID:n,threadID:o,postID:a}),this.nodes.archivelinks.push(e)):void 0},parseDeadlink(e){let t,n,o,a;if(Ve.hasClass(e.parentNode,"prettyprint"))return void ye.fixDeadlink(e);const i=e.textContent;if(!(a=i.match(/\d+$/)?.[0]))return;if("0"===a[0])return void ye.fixDeadlink(e);const s=(n=i.match(/^>>>\/([a-z\d]+)/))?n[1]:this.board.ID,r=`${s}.${a}`;if(o=Ee.posts.get(r))o.isDead?(t=Ve.el("a",{href:Ee.SITE.Build.postURL(s,o.thread.ID,a),className:"quotelink deadlink",textContent:i}),Ve.add(t,dt.deadMark.cloneNode(!0)),Ve.extend(t.dataset,{boardID:s,threadID:o.thread.ID,postID:a})):t=Ve.el("a",{href:Ee.SITE.Build.postURL(s,o.thread.ID,a),className:"quotelink",textContent:i});else{const e=K.to("thread",{boardID:s,threadID:0,postID:a}),n=K.to("post",{boardID:s,postID:a});(e||n)&&(t=Ve.el("a",{href:e||"javascript:;",className:"deadlink",textContent:i}),Ve.add(t,dt.deadMark.cloneNode(!0)),n&&(Ve.addClass(t,"quotelink"),Ve.extend(t.dataset,{boardID:s,postID:a})))}if(this.quotes.includes(r)||this.quotes.push(r),t)return Ve.replace(e,t),Ve.hasClass(t,"quotelink")?this.nodes.quotelinks.push(t):void 0;Ve.add(e,dt.deadMark.cloneNode(!0))},fixDeadlink(e){let t;if(!(t=e.previousSibling)||"BR"===t.nodeName){const t=Ve.el("span",{className:"quote"});Ve.before(e,t),Ve.add(t,e)}return Ve.replace(e,[...e.childNodes])}},ke={init(){var e,t,n;if("www.4chan.org"===location.hostname||location.search.includes("__cf"))return;try{let e=window;if(`${Ce.name} antidup`in e)return;e[`${Ce.name} antidup`]=!0}catch(e){}try{if(window.frameElement&&["","about:blank"].includes(window.frameElement.src))return}catch(e){}if(Re&&Ve.hasClass(Re,"fourchan-x"))return;Ve.asap(Le,function(){Ve.addClass(Re,"fourchan-xt","fourchan-x","seaweedchan"),Ve.engine&&Ve.addClass(Re,`ua-${Ve.engine}`),b.ready(()=>{null!=Ee.BOARD?.config.ws_board&&Ve.addClass(Re,Ee.BOARD.config.ws_board?"ws":"nws")})});try{Ve.global("exposeVersion",{version:Ee.VERSION,buildDate:Ee.VERSION_DATE.getTime().toString()})}catch(e){console.error(e)}for(n of(Ve.on(Te,"4chanXInitFinished",function(){return ke.expectInitFinished?delete ke.expectInitFinished:(new It("error",`Error: Multiple copies of ${Ce.name} or 4chan X are enabled.`),Ve.addClass(Re,"tainted"))}),e=function(){return Te.removeEventListener("mounted",e,!0),ke.isMounted=!0,ke.mountedCBs.map(e=>(()=>{try{return e()}catch(e){}})())},Te.addEventListener("mounted",e,!0),t=function(e,n){if(n instanceof Array)De[e]=Fe.clone(n[0]);else if("object"==typeof n)for(var o in n)t(o,n[o]);else De[e]=n},"boards.4chan.org"===location.hostname&&Ve.asap(Le,()=>Ve.onExists(Re,"iframe[srcdoc]",Ve.rm)),t(null,Me),nt.keys))De[n]=Fe();De.customTitles=Fe.clone({"4chan.org":{boards:{qa:{boardTitle:{orig:"/qa/ - Question & Answer",title:"/qa/ - 2D/Random"}}}}}),De.boardConfig={boards:Fe()},De.archives=K.archives,De.selectedArchives=Fe(),De.cooldowns=Fe(),De["Index Sort"]=Fe();for(let e=0;e<2;e++)De[`Last Long Reply Thresholds ${e}`]=Fe();De.siteProperties=Fe(),De["Except Archives from Encryption"]=!1,De["JSON Navigation"]=!0,De["Oekaki Links"]=!0,De["Show Name and Subject"]=!1,De["QR Shortcut"]=!0,De["Bottom QR Link"]=!0,De["Toggleable Thread Watcher"]=!0,De.siteSoftware="",De["Use Faster Image Host"]="true",De["Captcha Fixes"]=!0,De.captchaServiceDomain="",De.captchaServiceKey=Fe(),!/\.4chan(?:nel)?\.org$/.test(location.hostname)||kt.yotsuba.regexp.pass.test(location.href)||kt.yotsuba.regexp.captcha.test(location.href)||Ge("script:not([src])",Te).filter(e=>/this\[/.test(e.textContent)).length||(Ve.getSync||Ve.get)({jsWhitelist:De.jsWhitelist},({jsWhitelist:e})=>{const t=e.replace(/^#.*$/gm,"").replace(/[\s;]+/g," ").trim();/\S/.test(t)&&Ve.addCSP(`script-src ${t}`)});const o=Fe();for(const e in De)o[e]=void 0;o.previousversion=void 0,(Ve.getSync||Ve.get)(o,function(e){Ve.asap(Le,function(){Ve.cantSet||(null==e.previousversion?(ke.isFirstRun=!0,ke.ready(function(){return Ve.set("previousversion",Ee.VERSION),W.open()})):e.previousversion!==Ee.VERSION&&ke.upgrade(e));for(const t in De)De[t]=e[t]??De[t];_.init(ke.initFeatures)})})},upgrade(e){const{previousversion:t}=e,n=W.upgrade(e,t);return e.previousversion=n.previousversion=Ee.VERSION,Ve.set(n,function(){if(e["Show Updated Notifications"]??1){const e=Ve.el("span",{innerHTML:`${Ce.name} has been updated to <a href="${Ce.changelog}" target="_blank">version ${Ee.VERSION}</a>.`});return new It("info",e,15)}})},parseURL(e=Ee.SITE,t=location){const n={};if(!e)return n;if(n.siteID=e.ID,e.isBoardlessPage?.(t))return n;const o=t.pathname.split(/\/+/);return n.boardID=o[1],e.isFileURL(t)?n.VIEW="file":e.isAuxiliaryPage?.(t)||(["thread","res"].includes(o[2])?(n.VIEW="thread",n.threadID=n.THREADID=+o[3].replace(/\.\w+$/,"")):"archive"===o[2]&&"res"===o[3]?(n.VIEW="thread",n.threadID=n.THREADID=+o[4].replace(/\.\w+$/,""),n.threadArchived=!0):/^(?:catalog|archive)(?:\.\w+)?$/.test(o[2])?n.VIEW=o[2].replace(/\.\w+$/,""):/^(?:index|\d*)(?:\.\w+)?$/.test(o[2])&&(n.VIEW="index")),n},initFeatures(){if(Ve.global("initMain"),ke.jsEnabled=Ve.hasClass(Re,"js-enabled"),Ve.extend(Ee,ke.parseURL()),Ee.boardID&&(Ee.BOARD=new ht(Ee.boardID)),Ee.VIEW){if("file"!==Ee.VIEW){for(var[e,t]of(Ee.threads=new ot,Ee.posts=new ot,Ve.onExists(Re,"body",ke.initStyle),ke.features))if(!Ee.SITE.disabledFeatures||!Ee.SITE.disabledFeatures.includes(e))try{t.init()}catch(t){ke.handleErrors({message:`"${e}" initialization crashed.`,error:t})}return Ve.ready(ke.initReady)}Ve.asap(()=>"loading"!==Te.readyState,function(){let e;if("yotsuba"===Ee.SITE.software&&De["404 Redirect"]&&Ee.SITE.is404?.()){const e=location.pathname.split(/\/+/);return K.navigate("file",{boardID:Ee.BOARD.ID,filename:e[e.length-1]})}(e=Ve("video"))&&(De["Volume in New Tab"]&&f.setup(e),De["Loop in New Tab"]&&(e.loop=!0,e.controls=!0,e.play()))})}else Ee.SITE.initAuxiliary?.()},initStyle(){if(!ke.isThisPageLegit())return;const e=Ve("link[href*=mobile]",Te.head);return e&&(e.disabled=!0),Re.dataset.host=location.host,Ve.addClass(Re,`sw-${Ee.SITE.software}`),Ve.addClass(Re,"thread"===Ee.VIEW?"thread-view":Ee.VIEW),Ve.onExists(Re,".ad-cnt, .adg-rects > .desktop",e=>Ve.onExists(e,"img, iframe",()=>Ve.addClass(Re,"ads-loaded"))),De["Autohiding Scrollbar"]&&Ve.addClass(Re,"autohiding-scrollbar"),Ve.ready(function(){if(Te.body.clientHeight>Re.clientHeight&&window.innerWidth===Re.clientWidth!==De["Autohiding Scrollbar"])return De["Autohiding Scrollbar"]=!De["Autohiding Scrollbar"],Ve.set("Autohiding Scrollbar",De["Autohiding Scrollbar"]),Ve.toggleClass(Re,"autohiding-scrollbar")}),Ve.addStyle(Ye.sub(Ye.boards),"fourchanx-css"),ke.bgColorStyle=Ve.el("style",{id:"fourchanx-bgcolor-css"}),ke.setClass()},setClass(){let e,t,n;const o=["yotsuba","yotsuba-b","futaba","burichan","photon","tomorrow","spooky"];if("yotsuba"===Ee.SITE.software&&"catalog"===Ee.VIEW&&(e=Ve.id("base-css"))&&(t=e.href.match(/catalog_(\w+)/)?.[1].replace("_new","").replace(/_+/g,"-"),o.includes(t)))return void Ve.addClass(Re,t);t=e=n=null;const a=function(){if("yotsuba"===Ee.SITE.software){for(var a of(Ve.rmClass(Re,t),t=null,n))if(a.href===e?.href){t=a.title.toLowerCase().replace("new","").trim().replace(/\s+/g,"-"),"_special"===t&&(t=a.href.match(/[a-z]*(?=[^/]*$)/)[0]),o.includes(t)||(t=null);break}if(t)return Ve.addClass(Re,t),void Ve.rm(ke.bgColorStyle)}const i=Ee.SITE.bgColoredEl();i.style.position="absolute",i.style.visibility="hidden",Ve.add(Te.body,i);let s=window.getComputedStyle(i).backgroundColor;Ve.rm(i);const r=s.match(/[\d.]+/g);if(!/^rgb\(/.test(s)){const e=window.getComputedStyle(Te.body);s=`${e.backgroundColor} ${e.backgroundImage} ${e.backgroundRepeat} ${e.backgroundPosition}`}let l=`.dialog, .suboption-list > div:last-of-type, :root.catalog-hover-expand .catalog-container:hover > .post {\n  background: ${s};\n}\n.unread-mark-read {\n  background-color: rgba(${r.slice(0,3).join(", ")}, ${.5*(r[3]||1)});\n}`;return Ve.luma(r)<100&&(l+=".watch-thread-link { --xt-watcher: #c8c8c8 }"),ke.bgColorStyle.textContent=l,Ve.after(Ve.id("fourchanx-css"),ke.bgColorStyle)};if(Ve.onExists(Te.head,Ee.SITE.selectors.styleSheet,function(t){return e=t,"yotsuba"===Ee.SITE.software&&(n=Ge('link[rel="alternate stylesheet"]',Te.head)),new MutationObserver(a).observe(e,{attributes:!0,attributeFilter:["href"]}),Ve.on(e,"load",a),a()}),!e){for(var i of Ge('link[rel="stylesheet"]',Te.head))Ve.on(i,"load",a);return a()}},initReady(){if(Ee.SITE.is404?.())"thread"===Ee.VIEW&&E.set404(Ee.BOARD.ID,Ee.THREADID,function(){if(De["404 Redirect"])return K.navigate("thread",{boardID:Ee.BOARD.ID,threadID:Ee.THREADID,postID:+location.hash.match(/\d+/)},`/${Ee.BOARD}/`)});else{if(Ee.SITE.isIncomplete?.()){const e=Ve.el("div",{innerHTML:'The page didn&#039;t load completely.<br>Some features may not work unless you <a href="javascript:;">reload</a>.'});Ve.on(Ve("a",e),"click",()=>location.reload()),new It("warning",e)}"catalog"===Ee.VIEW?ke.initCatalog():B.enabled?(ke.expectInitFinished=!0,Ve.event("4chanXInitFinished")):Ee.SITE.awaitBoard?Ee.SITE.awaitBoard(ke.initThread):ke.initThread()}},initThread(){let e;const t=Ee.SITE.selectors;if(e=Ve(t.boardFor?.[Ee.VIEW]||t.board)){const n=[],o=[],a=[];try{Ee.SITE.preParsingFixes?.(e)}catch(e){}ke.addThreadsObserver=new MutationObserver(ke.addThreads),ke.addPostsObserver=new MutationObserver(ke.addPosts),ke.addThreadsObserver.observe(e,{childList:!0}),ke.parseThreads(Ge(t.thread,e),n,o,a),a.length&&ke.handleErrors(a),"thread"===Ee.VIEW&&(Ee.threadArchived&&(n[0].isArchived=!0,n[0].kill()),Ee.SITE.parseThreadMetadata?.(n[0])),setTimeout(()=>{ke.callbackNodes("Thread",n),ke.callbackNodesDB("Post",o,function(){for(var e of o)T.insert(e);ke.expectInitFinished=!0,Ve.event("4chanXInitFinished")})},0)}else ke.expectInitFinished=!0,Ve.event("4chanXInitFinished")},parseThreads(e,t,n,o){var a,i,s,r,l;for(a of e){if(i=(()=>{let e;return(e=a.dataset.board)?(e=encodeURIComponent(e),Ee.boards[e]||new ht(e)):Ee.BOARD})(),!(s=+a.id.match(/\d*$/)[0])||i.threads.get(s)?.nodes.root)return;(r=new at(s,i)).nodes.root=a,t.push(r),l=Ge(Ee.SITE.selectors.postContainer,a),Ee.SITE.isOPContainerThread&&l.unshift(a),ke.parsePosts(l,r,n,o),ke.addPostsObserver.observe(a,{childList:!0})}},parsePosts(e,t,n,o){for(var a of e)if((!a.dataset.fullID||!Ee.posts.get(a.dataset.fullID))&&Ve(Ee.SITE.selectors.comment,a))try{n.push(new dt(a,t,t.board))}catch(e){o.push({message:`Parsing of Post No.${a.id.match(/\d+/)} failed. Post will be skipped.`,error:e,html:a.outerHTML})}},addThreads(e){var t,n;const o=[];for(t of e)for(n of t.addedNodes)n.nodeType===Node.ELEMENT_NODE&&n.matches(Ee.SITE.selectors.thread)&&o.push(n);if(!o.length)return;const a=[],i=[],s=[];ke.parseThreads(o,a,i,s),s.length&&ke.handleErrors(s),ke.callbackNodes("Thread",a),ke.callbackNodesDB("Post",i,()=>Ve.event("PostsInserted",null,e[0].target))},addPosts(e){var t,o,a,i,s,r;let l;const d=[],c=[],h=[],u=[];for(t of e){for(a of(l=n.threadFromRoot(t.target),o=[],t.addedNodes))a.nodeType===Node.ELEMENT_NODE&&(a.matches(Ee.SITE.selectors.postContainer)||(a=Ve(Ee.SITE.selectors.postContainer,a)))&&o.push(a);for(r of(i=h.length,ke.parsePosts(o,l,h,u),h.length>i&&!d.includes(l)&&d.push(l),s=!1,t.removedNodes))if(n.postFromRoot(r)?.nodes.root===r&&!Re.contains(r)){s=!0;break}s&&!c.includes(l)&&c.push(l)}u.length&&ke.handleErrors(u),ke.callbackNodesDB("Post",h,function(){for(l of d)Ve.event("PostsInserted",null,l.nodes.root);for(l of c)Ve.event("PostsRemoved",null,l.nodes.root)})},initCatalog(){let e;const t=Ee.SITE.selectors.catalog;if(t&&(e=Ve(t.board))){const n=[],o=[];ke.addCatalogThreadsObserver=new MutationObserver(ke.addCatalogThreads),ke.addCatalogThreadsObserver.observe(e,{childList:!0}),ke.parseCatalogThreads(Ge(t.thread,e),n,o),o.length&&ke.handleErrors(o),ke.callbackNodes("CatalogThreadNative",n)}return ke.expectInitFinished=!0,Ve.event("4chanXInitFinished")},parseCatalogThreads(e,t,n){var o,a;for(o of e)try{a=new Ct(o),a.thread.catalogViewNative?.nodes.root!==o&&(a.thread.catalogViewNative=a,t.push(a))}catch(e){n.push({message:`Parsing of Catalog Thread No.${(o.dataset.id||o.id).match(/\d+/)} failed. Thread will be skipped.`,error:e,html:o.outerHTML})}},addCatalogThreads(e){var t,n;const o=[];for(t of e)for(n of t.addedNodes)n.nodeType===Node.ELEMENT_NODE&&n.matches(Ee.SITE.selectors.catalog.thread)&&o.push(n);if(!o.length)return;const a=[],i=[];return ke.parseCatalogThreads(o,a,i),i.length&&ke.handleErrors(i),ke.callbackNodes("CatalogThreadNative",a)},callbackNodes(e,t){let n,o=0;const a=Ne[e];for(;n=t[o++];)a.execute(n)},callbackNodesDB(e,t,n){let o=0;const a=Ne[e],i=function(){let e;return!!(e=t[o])&&(a.execute(e),++o%250)};var s=function(){for(;i(););t[o]?setTimeout(s,0):n&&n()};s()},handleErrors(e){let t;if(Te.body&&Ve.hasClass(Te.body,"fourchan_x")&&!Ve.hasClass(Re,"tainted")&&(new It("error",`Error: Multiple copies of ${Ce.name} or 4chan X are enabled.`),Ve.addClass(Re,"tainted")),Ee.SITE.testNativeExtension&&!Ve.hasClass(Re,"tainted")&&Ee.SITE.testNativeExtension().then(({enabled:e})=>{if(e&&(Ve.addClass(Re,"tainted"),De["Disable Native Extension"]&&!ke.isFirstRun)){const e=Ve.el("div",{innerHTML:'Failed to disable the native extension. You may need to <a href="'+Se(Ce.upstreamFaq)+'#blocking-native-extension" target="_blank">block it</a>.'});new It("error",e)}}),e instanceof Array?1===e.length&&(t=e[0]):t=e,t)return void new It("error",ke.parseError(t,ke.reportLink([t])),15);const n=Ve.el("div",{innerHTML:`${e.length} errors occurred.${ke.reportLink(e).innerHTML} [<a href="javascript:;">show</a>]`});Ve.on(n.lastElementChild,"click",function(){return[this.textContent,o.hidden]="show"===this.textContent?["hide",!1]:["show",!0]});var o=Ve.el("div",{hidden:!0});for(t of e)Ve.add(o,ke.parseError(t));return new It("error",[n,o],30)},parseError(e,t){Be.error(e.message,e.error.stack);const n=Ve.el("div",{innerHTML:Se(e.message)+(t?t.innerHTML:"")}),o=Ve.el("div",{textContent:`${e.error.name||"Error"}: ${e.error.message||"see console for details"}`}),a=e.error.stack?.match(/\d+(?=:\d+\)?$)/gm)?.join().replace(/^/," at ")||"";return[n,o,Ve.el("div",{textContent:`(${Ce.name} ${Ce.fork} v${Ee.VERSION} ${je} on ${Ve.engine}${a})`})]},reportLink(e){let t;const n=e[0];let o=n.message;e.length>1&&(o+=` (+${e.length-1} other errors)`);let a="";const i=function(e){if(encodeURIComponent(o+a+e+"\n").length<=Ce.newIssueMaxLength-Ce.newIssue.replace(/%(title|details)/,"").length)return a+=e+"\n"};return i(`[Please describe the steps needed to reproduce this error.]\n\nScript: ${Ce.name} ${Ce.fork} v${Ee.VERSION} ${je}\nURL: ${location.href}\nUser agent: ${navigator.userAgent}`),"userscript"===je&&(t="undefined"!=typeof GM&&null!==GM?GM.info:"undefined"!=typeof GM_info&&null!==GM_info?GM_info:void 0)&&i(`Userscript manager: ${t.scriptHandler} ${t.version}`),i("\n"+n.error),n.error.stack&&i(n.error.stack.replace(n.error.toString(),"").trim()),n.html&&i("\n`"+n.html+"`"),a=a.replace(/file:\/{3}.+\//g,""),{innerHTML:`<span class="report-error"> [<a href="${Ce.newIssue.replace("%title",encodeURIComponent(o)).replace("%details",encodeURIComponent(a))}" target="_blank">report</a>]</span>`}},isThisPageLegit:()=>("thisPageIsLegit"in ke||(ke.thisPageIsLegit=Ee.SITE.isThisPageLegit?Ee.SITE.isThisPageLegit():!/^[45]\d\d\b/.test(document.title)&&!/\.(?:json|rss)$/.test(location.pathname)),ke.thisPageIsLegit),ready:e=>Ve.ready(function(){if(ke.isThisPageLegit())return e()}),mounted:e=>ke.isMounted?e():ke.mountedCBs.push(e),mountedCBs:[],features:[["Board Configuration",b],["Normalize URL",Rt],["Delay Redirect on Post",ut],["Captcha Configuration",et],["Image Host Rewriting",o],["Redirect",K],["Header",Y],["Catalog Links",G],["Settings",W],["Index Generator",B],["Disable Autoplay",ae],["Announcement Hiding",pe],["Fourchan thingies",re],["Tinyboard Glue",Lt],["Color User IDs",le],["Highlight by User ID",de],["Count Posts by ID",ce],["Custom CSS",Ke],["Thread Links",fe],["Linkify",F],["Reveal Spoilers",ge],["Resurrect Quotes",ye],["Filter",J],["Thread Hiding Buttons",L],["Reply Hiding Buttons",x],["Recursive",v],["Strike-through Quotes",Mt],["Quick Reply Personas",j.persona],["Quick Reply",j],["Cooldown",j.cooldown],["Post Jumper",ue],["Pass Link",Nt],["Menu",A],["Index Generator (Menu)",B.menu],["Report Link",oe],["Copy Text Link",te],["Thread Hiding (Menu)",L.menu],["Reply Hiding (Menu)",x.menu],["Delete Link",ne],["Filter (Menu)",J.menu],["Edit Link",j.oekaki.menu],["Download Link",Tt],["Archive Link",St],["Quote Inlining",Ae],["Quote Previewing",R],["Quote Backlinks",ve],["Mark Quotes of You",k],["Mark OP Quotes",we],["Mark Cross-thread Quotes",xe],["Anonymize",Dt],["Time Formatting",$],["Relative Post Dates",w],["File Info Formatting",z],["Fappe Tyme",N],["Gallery",P],["Gallery (menu)",P.menu],["Sauce",M],["Image Expansion",m],["Image Expansion (Menu)",m.menu],["Reveal Spoiler Thumbnails",Et],["Image Loading",Z],["Image Hover",X],["Volume Control",f],["WEBM Metadata",ee],["Comment Expansion",y],["Thread Expansion",C],["Favicon",i],["Unread",I],["Unread Line in Index",D],["Quote Threading",T],["Thread Stats",be],["Thread Updater",q],["Thread Watcher",E],["Thread Watcher (Menu)",E.menu],["Mark New IPs",me],["Index Navigation",g],["Keybinds",H],["Banner",ie],["Announcements",Bt],["Flash Features",se],["Reply Pruning",S],["Mod Contact Links",he],["Restore deleted posts from archive",ft],["Mark posts on scroll bar",pt]]},Ve.ready(()=>ke.init())}();