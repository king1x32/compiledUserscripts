// ==UserScript==
// @name            manga comic downloader
// @namespace       https://baivong.github.io
// @version         3.4.7
// @icon            https://raw.githubusercontent.com/lelinhtinh/Userscript/master/manga_comic_downloader/icon.png
// @author          Zzbaivong
// @license         MIT; https://baivong.mit-license.org/license.txt
// @match           http://*.truyentranh8.com/*
// @match           https://*.truyentranh8.com/*
// @match           http://*.truyentranh8.net/*
// @match           https://*.truyentranh8.net/*
// @match           http://*.truyentranh8.org/*
// @match           https://*.truyentranh8.org/*
// @match           http://*.truyentranh86.com/*
// @match           https://*.truyentranh86.com/*
// @match           http://*.truyentranh869.com/*
// @match           https://*.truyentranh869.com/*
// @match           https://mangaxy.com/*
// @match           https://*.truyentranh.net/*
// @match           https://*.hamtruyen.com/*
// @match           https://*.hamtruyenmoi.com/*
// @match           https://*.a3manga.com/*
// @match           https://*.a3mnga.com/*
// @match           http://truyentranhtuan.com/*
// @match           https://truyentranhlh.net/*
// @match           https://truyenhay24h.com/*
// @match           https://thichtruyentranh.com/*
// @match           https://lxhentai.com/*
// @match           https://hentaivn.net/*
// @match           https://hentaivn.moe/*
// @match           https://otakusan.net/*
// @match           https://*.ngonphong.com/*
// @match           https://*.nettruyen.com/*
// @match           http://*.nettruyen.com/*
// @match           https://*.nettruyentop.com/*
// @match           http://*.nettruyentop.com/*
// @match           http://*.nettruyenonline.com/*
// @match           https://*.nettruyenonline.com/*
// @match           http://*.nettruyenapp.com/*
// @match           https://*.nettruyenapp.com/*
// @match           http://*.nettruyenpro.com/*
// @match           https://*.nettruyenpro.com/*
// @match           http://*.nettruyengo.com/*
// @match           https://*.nettruyengo.com/*
// @match           https://*.nettruyenmax.com/*
// @match           http://*.nettruyenmoi.com/*
// @match           https://*.nettruyenbb.com/*
// @match           https://*.kingtruyen.com/*
// @match           http://nhattruyen.com/*
// @match           http://nhattruyengo.com/*
// @match           http://*.hamtruyentranh.net/*
// @match           https://ttmanga.com/*
// @match           http://truyen.vnsharing.site/*
// @match           http://*.blogtruyen.com/*
// @match           https://*.blogtruyen.com/*
// @match           https://*.blogtruyenmoi.com/*
// @match           http://*.blogtruyen.vn/*
// @match           https://*.blogtruyen.vn/*
// @match           http://*.blogtruyen.top/*
// @match           https://*.blogtruyen.top/*
// @match           https://truyensieuhay.com/*
// @match           http://truyenqqvn.com/*
// @match           http://truyenqqvn.net/*
// @match           http://truyenqqtop.com/*
// @match           http://truyenqqpro.com/*
// @match           https://hentaicube.net/*
// @match           https://hentaicb.top/*
// @match           http://*.tuthienbao.com/*
// @match           https://vietcomic.net/*
// @match           https://hamtruyentranh.com/*
// @match           https://khotruyentranhz.com/*
// @match           https://truyenvn.com/*
// @match           https://truyenvn.vip/*
// @match           https://truyenvnpro.com/*
// @match           https://*.saytruyen.net/*
// @match           https://*.saytruyen.com/*
// @match           https://*.sayhentai.net/*
// @match           https://cocomic.net/truyen-tranh/*
// @require         https://code.jquery.com/jquery-3.6.0.min.js
// @require         https://unpkg.com/@zip.js/zip.js@2.7.41/dist/zip.min.js
// @require         https://unpkg.com/file-saver@2.0.5/dist/FileSaver.min.js
// @require         https://cdn.jsdelivr.net/npm/web-streams-polyfill@2.0.2/dist/ponyfill.min.js
// @require         https://cdn.jsdelivr.net/npm/streamsaver@2.0.3/StreamSaver.min.js
// @require         https://greasemonkey.github.io/gm4-polyfill/gm4-polyfill.js?v=a834d46
// @require         https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js
// @require         https://cdn.jsdelivr.net/gh/Joe12387/detectIncognito@53bb1cde47a849dd166443a24b92f15432d7c40a/dist/es5/detectIncognito.min.js
// @resource        success https://unpkg.com/facebook-sound-kit@2.0.0/Low_Volume_-20dB/Complete_and_Success/Success_2.m4a
// @resource        error https://unpkg.com/facebook-sound-kit@2.0.0/Low_Volume_-20dB/Errors_and_Cancel/Error_2.m4a
// @noframes
// @connect         *
// @supportURL      https://github.com/lelinhtinh/Userscript/issues
// @run-at          document-start
// @grant           GM_addStyle
// @grant           GM_xmlhttpRequest
// @grant           GM.xmlHttpRequest
// @grant           GM.getResourceUrl
// @grant           GM_getResourceURL
// @grant           GM_registerMenuCommand
// @downloadURL https://raw.githubusercontent.com/king1x32/compiledUserscripts/release/release/manga20comic20downloader.user.js
// @updateURL https://raw.githubusercontent.com/king1x32/compiledUserscripts/release/release/manga20comic20downloader.meta.js
// ==/UserScript==
window._URL=window.URL||window.webkitURL,jQuery(function(t){function e(e,n){function o(){var t=R.find("#mcd_noty_wrap");t.length&&(t.fadeOut(300,function(){t.remove(),t=[]}),clearTimeout(O))}function r(){O=setTimeout(function(){o()},2e3)}var a,i,c,s=R.find("#mcd_noty_wrap");s.length||(a=t("<div>",{id:"mcd_noty_wrap"}),i=t("<div>",{id:"mcd_noty_content",class:"mcd_"+n,html:e}),c=t("<div>",{id:"mcd_noty_close",html:"&times;"}),(s=a.append(i).append(c)).appendTo("body")),s.find("#mcd_noty_content").attr("class","mcd_"+n).html(e),s.fadeIn(300),clearTimeout(O),R.on("click","#mcd_noty_wrap",function(){o()}).on("mouseenter","#mcd_noty_wrap",function(){clearTimeout(O)}).on("mouseleave","#mcd_noty_wrap",r),"warning"!==n&&"success"!==n&&r()}function n(t){return U.link.split(/\s*,\s*/).map(function(e){return e+t}).join(",")}function o(){t(n('[href="'+U.href+'"]')).css({color:"red",textShadow:"0 0 1px red, 0 0 1px red, 0 0 1px red"}),F=!0}function r(){var e=t(n('[href="'+U.href+'"]'));F||e.css({color:"green",textShadow:"0 0 1px green, 0 0 1px green, 0 0 1px green"})}function a(t){t.preventDefault(),t.returnValue=""}function i(){o(),V=!1,window.removeEventListener("beforeunload",a),setTimeout(()=>{P.length||V||!T||T.play()},0)}function c(){e("Lỗi! Không tải được <strong>"+$+"</strong>","error"),i()}function s(){e("Lỗi! <strong>"+$+"</strong> không có dữ liệu","error"),i()}function m(t){X<1&&(X=1),X>32&&(X=32),H=t.map(function(t){return{url:t,attempt:tt}}),W=H.length,v(),e("Bắt đầu tải <strong>"+$+"</strong>","warning"),window.addEventListener("beforeunload",a)}function p(){document.title="[…] "+A,e("<strong>"+$+"</strong> đang lấy dữ liệu...","warning"),P=P.filter(function(t){return-1===U.href.indexOf(t)}),t(n('[href="'+U.href+'"]')).css({color:"orange",fontWeight:"bold",fontStyle:"italic",textDecoration:"underline",textShadow:"0 0 1px orange, 0 0 1px orange, 0 0 1px orange"})}function u(){P=[],t(U.link).each(function(e,n){P[e]=t(n).attr("href")}),U.reverse&&P.reverse()}function l(){e("Script đã <strong>sẵn sàng</strong> làm việc","info"),u(),R.on("click",U.link,function(e){var o,r;(e.ctrlKey||e.shiftKey)&&(e.preventDefault(),o=t(this).attr("href"),e.ctrlKey&&e.shiftKey?(P=P.filter(function(t){return-1===o.indexOf(t)}),t(n('[href="'+o+'"]')).css({color:"gray",fontWeight:"bold",fontStyle:"italic",textDecoration:"line-through",textShadow:"0 0 1px gray, 0 0 1px gray, 0 0 1px gray"})):(N||(P=[],N=!0),P.push(o),r=e.shiftKey?"violet":"purple",t(n('[href="'+o+'"]')).css({color:r,textDecoration:"overline",textShadow:"0 0 1px "+r+", 0 0 1px "+r+", 0 0 1px "+r})))}).on("keyup",function(t){"Control"!==t.key&&"Shift"!==t.key||(t.preventDefault(),P.length&&N&&("Shift"===t.key&&(Q=!0),h()))})}function h(){V||B||(N||P.length||u(),P.length&&(B=!0,t(n('[href$="'+P[0]+'"]')).trigger("contextmenu")))}function g(){Q=!0,h()}function d(){return $.replace(/\s+/g,"_").replace(/・/g,"·").replace(/(^_+|_+$)/,"")}function f(){Q||(j=new TransformStream,D=new Response(j.readable).blob(),M=new zip.ZipWriter(j.writable,{zip64:!0}),G=new AbortController,z=G.signal,J=[]),K=0,E=0,W=0,H=[],F=!1,V=!1,B&&(P.length?t(n('[href$="'+P[0]+'"]')).trigger("contextmenu"):(B=!1,N=!1)),setTimeout(()=>{P.length||V||!C||C.play()},0)}async function w(){e("Tạo file nén của <strong>"+$+"</strong>","warning");try{await Promise.all(J),await M.close(),async function(t,n){e("Tải hoàn tất <strong>"+n+"</strong>","info");try{const{isPrivate:e}=await detectIncognito();if(e)throw"isPrivate";const o=streamSaver.createWriteStream(n,{size:t.size}),r=t.stream();if(window.WritableStream&&r.pipeTo)return r.pipeTo(o);window.writer=o.getWriter();const a=r.getReader(),i=()=>a.read().then(t=>t.done?window.writer.close():window.writer.write(t.value).then(i));return void i()}catch(e){console.warn(e),saveAs(t,n)}}(await D,d()+"."+Y),r(),window.removeEventListener("beforeunload",a),document.title="[⇓] "+A,f()}catch(t){console.error(t),(z.reason==t||z.reason&&z.reason.code==t.code)&&zip.terminateWorkers(),e("Lỗi nén dữ liệu của <strong>"+$+"</strong>","error"),i(),document.title="[x] "+A,f()}}function y(t,e,n,o,r){if(H[t].attempt<=0)return E++,void n(o,r);setTimeout(function(){x(t,e,n),H[t].attempt--},2e3)}function x(t,e,n){var o,r=H[t].url,a=("0000"+K).slice(-4),i={};0===r.indexOf("//")&&(r=location.protocol+r),o=new URL(r).hostname,ot[o]?(i.referer=ot[o],i.origin=ot[o]):(i.referer=location.origin,i.origin=location.origin),GM.xmlHttpRequest({method:"GET",url:r,responseType:"arraybuffer",headers:i,onload:function(o){var r=function(t){if(!t.byteLength)return{mime:null,ext:null};var e="",n="",o=new DataView(t,0,5),r=o.getUint8(0,!0),a=o.getUint8(1,!0);switch(r.toString(16)+a.toString(16)){case"8950":e="png",n="image/png";break;case"4749":e="gif",n="image/gif";break;case"ffd8":e="jpg",n="image/jpeg";break;case"424d":e="bmp",n="image/bmp";break;case"5249":e="webp",n="image/webp";break;default:e=null,n=null}return{mime:n,ext:e}}(o.response).ext;if("gif"===r)return b();!r||o.response.byteLength<100||"OK"!==o.statusText&&""!==o.statusText?y(t,e,n,o,a):(a=a+"."+r,e(o.response,a))},onerror:function(o){y(t,e,n,o,a)}})}function b(){e("Đang tải xuống <strong>"+E+++"/"+W+"</strong>","warning"),E<K||(E<W?v():Q?P.length?(r(),f()):(Q=!1,w()):w())}function v(){var t=K+X,n="";for(t>W&&(t=W),Q&&(n=d()+"/");K<t;K++)x(K,function(t,e){var o=M.add(n+e,new Response(t).body,{signal:z,onend:b});J.push(o)},function(t,r){J.push(M.add(n+r+"_error.txt",new Blob([t.statusText+"\r\n"+t.finalUrl]).stream(),{signal:z,onend:b})),e(t.statusText,"error"),o()})}function k(e){var n=[];e.length?(t.each(e,function(t,e){var o;if(e=e.replace(/^[\s\n]+|[\s\n]+$/g,""),nt.some(function(t){return-1!==e.indexOf(t)}))n.push(e);else if(o=e,!et.some(function(t){return-1!==o.indexOf(t)})&&void 0!==e&&!/[><"']/.test(e)&&(0!==e.indexOf(location.origin)&&(0!==e.indexOf("/")||0===e.indexOf("//"))||/^(\.(jpg|png)|webp|jpeg)$/.test(e.slice(-4)))){if(0!==e.indexOf("http")&&0!==e.indexOf("//"))e=location.origin+(0===e.indexOf("/")?"":"/")+e;else{if(0!==e.indexOf("http")&&0!==e.indexOf("//"))return;e=function(t){return-1!==(t=(t=(t=(t=(t=(t=function(t){var e=(new DOMParser).parseFromString("<!doctype html><body>"+t,"text/html");return decodeURIComponent(e.body.textContent)}(t)).trim()).replace(/^.+(&|\?)url=/,"")).replace(/(https?:\/\/)lh(\d)(\.bp\.blogspot\.com)/,"$1$2$3")).replace(/(https?:\/\/)lh\d\.(googleusercontent|ggpht)\.com/,"$14.bp.blogspot.com")).replace(/\?.+$/,"")).indexOf("imgur.com")?t=t.replace(/(\/)(\w{5}|\w{7})(s|b|t|m|l|h)(\.(jpe?g|png|webp))$/,"$1$2$4"):-1!==t.indexOf("blogspot.com")?(t=(t=t.replace(/\/([^/]+-)?(Ic42)(-[^/]+)?\//,"/$2/")).replace(/\/(((s|w|h)\d+|(w|h)\d+-(w|h)\d+))?-?(c|d|g)?\/(?=[^/]+$)/,"/"),t+="?imgmax=16383"):t=t.replace(/(\?|&).+/,""),function(t){return-1!==t.search(/(i\.imgur\.com|\.blogspot\.com|\.fbcdn\.net|storage\.fshare\.vn)/i)&&0===t.indexOf("http://")&&(t=t.replace(/^http:\/\//,"https://")),t}(t=function(t){return 0===t.indexOf("//")&&(t=location.protocol+t),0!==t.search(/https?:\/\//)&&(t="http://"+t),t}(t=encodeURI(t)))}(e)}n.push(e)}}),m(n)):s()}function _(e){var n=[];e.each(function(e,o){var r=t(o);n[e]=(U.imgSrc?r.attr(U.imgSrc):r.data("src")||r.data("original"))||r.attr("src")}),k(n)}function S(){return V?(e("Chỉ được phép <strong>tải một truyện</strong> mỗi lần","error"),!1):(V=!0,!0)}function q(e){t(U.link).length&&(R.on("contextmenu",U.link,function(n){n.preventDefault(),F=!1,S()&&function(e,n){var o=t(e),r=U.name;U.href=o.attr("href"),$=o.text().trim(),"function"==typeof r?$=r(e,$):"string"==typeof r&&($=t(r).text().trim()+" "+$),p(),GM.xmlHttpRequest({method:"GET",url:U.href,onload:function(e){var o,r,a,i=function(e){var n=e.responseText;return U.imgSrc||(n=n.replace(/[\s\n]+src[\s\n]*=[\s\n]*/gi," data-src=")),n=n.replace(/^[^<]*/,""),U.imgSrc,t(n)}(e);"function"==typeof n?n(i):(o=i,a="find",U.filter&&(a="filter"),(r=o[a](U.contents).find("img")).length?_(r):s())},onerror:function(){c()}})}(n.currentTarget,e)}),l())}var C,T,O,L,U,$,I,A,R,j,D,M,G,z,J,K,E,W,H,P,F,V,B,N,Q,Z,Y="cbz",X=4,tt=5,et=["http://truyentranhtam.net/templates/main/images/gioithieubanbe3.png","http://1.bp.blogspot.com/-U1SdU4_52Xs/WvLvn1OjvHI/AAAAAAAEugM/dLBgVGSeUN0bVy-FoFfIZvrCJ07YQew7wCHMYCw/s0/haybaoloi.png","/public/images/loading.gif","http://truyentranhlh.net/wp-content/uploads/2015/10/lhmanga.png","/Content/Img/1eeef5d2-b936-496d-ba41-df1b21d0166a.jpg","/Content/Img/d79886b3-3699-47b2-bbf4-af6149c2e8fb.jpg","http://st.beeng.net/files/uploads/images/21/c8/21c8d2c3599c485e31f270675bc57e4c.jpeg","00k9jbV.gif"],nt=["proxy.truyen.cloud",".ttmanga.com",".fbcdn.net","mangaqq.net","mangaqq.com","truyenqqvn.net","truyenqqvn.com","truyenqqtop.com","truyenqqpro.com",".upanhmoi.net","qqtaku.com","qqtaku.net","trangshop.net",".beeng.net",".beeng.org","forumnt.com","hoitruyentranh.com","hoihentai.com","i02.hentaivn.net","truyentop1.com","anhnhanh.org","truyenvua.xyz","hamtruyen.vn",".xem-truyen.com"],ot={"i8.xem-truyen.com":"https://blogtruyenmoi.com","i.blogtruyen.com":"https://blogtruyen.com","truyen.cloud":"http://www.nettruyen.com","proxy.truyen.cloud":"http://www.nettruyen.com","i.netsnippet.com":"http://www.nettruyen.com/","forumnt.com":"http://www.nettruyen.com/","upload.forumnt.com":"http://www.nettruyen.com/","upload2.forumnt.com":"http://www.nettruyen.com/","upload.upanhmoi.net":"https://upanhmoi.net","upload2.upanhmoi.net":"https://upanhmoi.net","upload3.upanhmoi.net":"https://upanhmoi.net","upload4.upanhmoi.com":"https://upanhmoi.com","upload5.upanhmoi.com":"https://upanhmoi.com","upload6.upanhmoi.com":"https://upanhmoi.com","upload7.upanhmoi.com":"https://upanhmoi.com","upload8.upanhmoi.com":"https://upanhmoi.com","upload9.upanhmoi.com":"https://upanhmoi.com","img1.upanhmoi.net":"https://upanhmoi.net","img2.upanhmoi.net":"https://upanhmoi.net","proxy1.ttmanga.com":"https://ttmanga.com","proxy2.ttmanga.com":"https://ttmanga.com","proxy3.ttmanga.com":"https://ttmanga.com","cdn.lhmanga.com":"https://truyentranhlh.net","cdn1.lhmanga.com":"https://truyentranhlh.net","storage.fshare.vn":"https://truyentranh.net","ocumeo.com":"https://www.a3manga.com/","www.ocumeo.com":"https://www.a3manga.com/","mangaqq.net":"http://truyenqqpro.com/","mangaqq.com":"http://truyenqqpro.com/","truyenqq.net":"http://truyenqqpro.com/","truyenvua.xyz":"http://truyenqqpro.com/","i02.hentaivn.net":"https://hentaivn.net/","i1.hentaivn.net":"https://hentaivn.net/","i.imgur.com":"https://imgur.com/"};switch(window.URL=window._URL,GM.getResourceUrl("success").then(function(t){C=new Audio(t)}),GM.getResourceUrl("error").then(function(t){T=new Audio(t)}),L={reverse:!0,link:"",name:"",contents:"",imgSrc:"",filter:!1,init:q},I=location.host,A=document.title,R=t(document),j=new TransformStream,D=new Response(j.readable).blob(),M=new zip.ZipWriter(j.writable,{zip64:!0}),G=new AbortController,z=G.signal,J=[],K=0,E=0,W=0,H=[],P=[],F=!1,V=!1,B=!1,N=!1,Q=!1,streamSaver.mitm="https://lelinhtinh.github.io/stream/mitm.html",GM_registerMenuCommand("Download All Chapters",h),GM_registerMenuCommand("Download All To One File",g),R.on("keydown",function(t){"KeyY"===t.code&&t.altKey&&(t.preventDefault(),t.shiftKey?g():h())}),GM_addStyle("#mcd_noty_wrap{background:#fff;position:fixed;z-index:2147483647;right:20px;top:20px;min-width:150px;max-width:100%;padding:15px 25px;border:1px solid #ddd;border-radius:2px;box-shadow:0 0 0 1px rgba(0,0,0,.1),0 1px 10px rgba(0,0,0,.35);cursor:pointer}#mcd_noty_content{color:#444}#mcd_noty_content strong{font-weight:700}#mcd_noty_content.mcd_info strong{color:#2196f3}#mcd_noty_content.mcd_success strong{color:#4caf50}#mcd_noty_content.mcd_warning strong{color:#ffc107}#mcd_noty_content.mcd_error strong{color:#f44336}#mcd_noty_content strong.centered{display:block;text-align:center}#mcd_noty_close{position:absolute;right:0;top:0;font-size:18px;color:#ddd;height:20px;width:20px;line-height:20px;text-align:center}#mcd_noty_wrap:hover #mcd_noty_close{color:#333}"),I){case"truyentranh8.com":case"truyentranh8.net":case"truyentranh8.org":case"truyentranh869.com":case"truyentranh86.com":U={link:"#ChapList a",name:function(e){return t(".breadcrumb li:last").text().trim()+" "+t(e).find("span, strong, h2").text().trim()},contents:"#reading-detail"};break;case"mangaxy.com":U={link:"#ChapList a",name:function(e){return`${t("h1.comics-title").text()} ${t(e).find("div.episode-title").text()}`},contents:"#reading-detail"};break;case"truyentranh.net":case"www.truyentranh.net":U={reverse:!1,link:".chapter-list-item-box a",name:function(e){return t("h1").text().trim()+" "+t(e).text().trim()},contents:".manga-reading-box"};break;case"hamtruyen.com":case"www.hamtruyen.com":case"hamtruyenmoi.com":U={link:".list-chaps a",name:"h3.story-name",contents:".list-images"};break;case"m.hamtruyen.com":U={link:".list-chap a",name:".tentruyen",contents:"#content_chap"};break;case"a3manga.com":case"www.a3manga.com":case"a3mnga.com":case"www.a3mnga.com":case"www.ngonphong.com":U={link:".chapter-table a.text-capitalize",init:function(){q(function(t){var e,n,o=t.find('script:contains("htmlContent")'),r=t.filter('script:contains("htmlContent")');if(o.length&&r.length){if(r=r.text().match(/(CryptoJSAesDecrypt\(.+?(?:(;}|htmlContent\);)))/g),e=new Function(o.text()+"function "+r[0]+"return "+r[1]),this.CryptoJS=CryptoJS,e.apply(this),!(n=e().match(/(?<=(data-(lqz53ud|3dn5rc9)="))(.+?)(?=")/g)))return void s();k(n=n.map(t=>(t=(t=t.replace(/LqZ53ud|3Dn5rc9/g,".")).replace(/pPdp7FG|gNa8fuX/g,":")).replace(/9pyrBcb|hT3k3S6/g,"/")))}else s()})}};break;case"truyentranhtuan.com":U={link:".chapter-name a",init:function(){q(function(t){var e,n,o,r,a,i,c,m=t.find("#read-title").next("script");if(m.length){if(t=m.text().match(/var\s+slides_page_path\s*=\s*(.+?);/)[1],n=[],1!=((o=t=JSON.parse(t)).length>0?2:1))e=o;else for(i=(e=n).length-1,r=0;r<i;r++)for(a=r+1;a<e.length;a++)e[a]<e[r]&&(c=e[a],e[a]=e[r],e[r]=c);k(e)}else s()})}};break;case"truyentranhlh.net":U={link:".list-chapters a",contents:"#chapter-content",name:function(e){return t(".series-name").text().trim()+" "+t(e).find(".chapter-name").text().trim()}};break;case"truyenhay24h.com":U={link:".nano .chapname a",name:".name_sp",init:function(){q(function(e){e=(e=(e=e.find("#dvContentChap").siblings("script").text()).match(/GI2017\(([^;]+);/)[1]).split(/[,']+/),t.post("/TH24Service.asmx/GetChapterImages",{PID:e[0],ChapNumber:e[1],cc18:e[2],name:"",s:0}).done(function(e){var n=[];t(e).find("string").each(function(t,e){n[t]=e.textContent.replace(/\.(jpe?g|png)\w*$/,".$1")}),k(n)}).fail(function(){c()})})}};break;case"thichtruyentranh.com":U={reverse:!1,link:"#listChapterBlock .ul_listchap a",init:function(){q(function(t){(t=(t=t.find("#content_read").next("script").text()).match(/https?:\/\/[^"]+/g)).length?k(t):s()})}};break;case"lxhentai.com":U={link:'[style="max-height: 500px"] a',contents:'[class="text-center"]',name:function(e){return t(".grow.text-lg.ml-1.text-ellipsis.font-semibold:first").text().trim()+" "+t(e).find("span.text-ellipsis").text().trim()}};break;case"hentaivn.net":case"hentaivn.moe":U=[{link:".listing a",name:function(e){var n=t('h1[itemprop="name"]').find("a").text();return`${n=n.split("-")[0].trim()} ${t(e).find(".chuong_t").attr("title").split("-")[1].trim()}`},contents:"#image",init:function(){var t,n=document.querySelector("#inner-listshowchapter");null!==n&&(e("wait a moment...","warning"),setTimeout(()=>{n.scrollIntoView()},0),(t=new MutationObserver(function(e){e.forEach(function(e){"childList"===e.type&&e.target.querySelector(U.link)&&(q(),t.disconnect())})})).observe(n,{attributes:!1,childList:!0,subtree:!1}))}},{link:".episodes a",name:'[itemprop="name"] b',contents:"#image"}];break;case"otakusan.net":U={link:".read-chapter a",name:"h1.header",init:function(){var e=t(U.link);e.length&&(e.on("contextmenu",function(e){if(e.preventDefault(),F=!1,S()){var n=t(this);U.href=n.attr("href"),$=t("h1.title").first().attr("title")+" "+n.text().trim(),p(),GM.xmlHttpRequest({method:"GET",url:U.href,withCredentials:!0,headers:{host:"otakusan.net"},onload:function(){GM.xmlHttpRequest({method:"POST",url:"/Manga/UpdateView",responseType:"json",withCredentials:!0,headers:{host:"otakusan.net","content-length":14,"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},data:"chapId="+U.href.match(/\/(\d+)\/.+$/)[1],onload:function(t){var e=t.response;e.chapid?m(JSON.parse(e.view)):s()}})}})}}),l())}};break;case"www.nettruyen.com":case"nhattruyen.com":case"nhattruyengo.com":case"www.nettruyenapp.com":case"www.nettruyenpro.com":case"www.nettruyengo.com":case"www.nettruyenmoi.com":case"www.nettruyenmax.com":U={link:"#nt_listchapter .chapter a",name:".title-detail",contents:".reading-detail.box_doc",imgSrc:"data-original"};break;case"www.nettruyentop.com":case"www.nettruyenonline.com":case"www.nettruyenbb.com":case"kingtruyen.com":U={link:"#nt_listchapter .chapter a",name:".title-detail",contents:".readimg,.reading-detail.box_doc"};break;case"www.hamtruyentranh.net":U={link:"#examples a",name:function(e){var n=t(e).clone();return n.find("span").remove(),t(".title-manga").text().trim()+" "+n.text().trim()},contents:".each-page"};break;case"ttmanga.com":U={link:"#list-chapter a",init:function(){q(function(t){var e,n,o,r=t.find("#divImage").siblings("script").first().text();if(/lstImages\.push\("([^"]+)"\)/.test(r)){for(e=/lstImages\.push\("([^"]+)"\)/gi,o=[];n=e.exec(r);)o.push(decodeURIComponent(n[1]));k(o)}else s()})}};break;case"truyen.vnsharing.site":U={link:"#manga-chaplist a",contents:".read_content"};break;case"blogtruyen.com":case"blogtruyen.vn":case"blogtruyen.top":case"blogtruyenmoi.com":case"www.blogtruyen.com":case"www.blogtruyen.vn":case"www.blogtruyen.top":U={link:"#list-chapters .title a",contents:"#content"};break;case"m.blogtruyen.com":case"m.blogtruyen.vn":case"m.blogtruyen.top":case"m.blogtruyenmoi.com":U={link:".list-chapter a",name:function(e){return t("h1.title").text().trim()+" "+t(e).find("span").text().trim()},contents:".content"};break;case"truyensieuhay.com":U={link:"#chapter-list-flag a",name:"h1",init:function(){q(function(e){if(e.find("#wrap_alertvip").length)s();else{var n=e.find(".content-chap-image").find("script:not([type]):first").text();(n=/\bgetContentchap\('(.+?)','(.+?)'\)/.exec(n))?t.ajax({type:"POST",url:"/Service.asmx/getContentChap",data:'{ sID: "'+n[1]+'",chuc:"'+n[2]+'" }',contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){if(e.Message)s();else{var n,o,r,a,i=(n=(e=JSON.parse(e.d)).des,o=(o=e.id).substring(2,o.length-3),r=CryptoJS.enc.Utf8.parse(o.toLowerCase()),a=CryptoJS.enc.Utf8.parse("gqLOHUioQ0QjhuvI"),CryptoJS.AES.decrypt(n,r,{iv:a,mode:CryptoJS.mode.CBC}).toString(CryptoJS.enc.Utf8));_(i=t(i).filter("img"))}},error:function(){s()}}):s()}})}};break;case"truyenqq.com":case"truyenqq.net":case"truyenqqtop.com":case"truyenqqpro.com":U={link:".works-chapter-list a",name:"h1",contents:".chapter_content"};break;case"hentaicube.net":case"hentaicb.top":U={link:".wp-manga-chapter a",name:".post-title",contents:".reading-content",imgSrc:"data-src"};break;case"tuthienbao.com":case"www.tuthienbao.com":U={link:'a[id^="thread_title_"]',contents:".quotecontent"};break;case"vietcomic.net":U={link:'.chapter-list a:not([rel="nofollow"])',name:function(e,n){return t(".manga-info-text h1").text().trim()+" "+n},init:function(){q(function(t){var e=t.filter('script:not([src]):contains("Loadimage(i)")');e.length&&(e=e.text().match(/data\s=\s'(.+?)';/))?k(e=(e=e[1]).split("|")):s()})}};break;case"hamtruyentranh.com":U={reverse:!1,link:"#chaps .chapter-title a:not([target])",name:"h1",contents:".table-responsive",imgSrc:"id-source"};break;case"khotruyentranhz.com":U={link:"#chapters-list-content .chapter-list a",name:"h1",contents:".box-chapter-content"};break;case"truyenvn.com":case"truyenvn.vip":case"truyenvnpro.com":U={link:"#chapterList a",name:function(e){return t("h1.name").text().trim()+" "+t(e).find("span:first").text().trim()},contents:".content-text"};break;case"saytruyen.net":case"www.saytruyen.net":case"saytruyen.com":case"www.saytruyen.com":case"sayhentai.net":case"www.sayhentai.net":case"sayhentai.tv":U={link:".main-col .wp-manga-chapter a",name:".post-title h1",contents:"#chapter_content"};break;case"cocomic.net":U={link:".chapter-list .citem a",name:"h1",contents:".chapter-content"};break;default:U={}}Array.isArray(U)&&(Z=/mobi|android|touch|mini/i.test(navigator.userAgent.toLowerCase()),U=U[Z?1:0]),U&&(U=t.extend(L,U)).init()});