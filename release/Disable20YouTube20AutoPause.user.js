// ==UserScript==
// @name                Disable YouTube AutoPause
// @name:en             Disable YouTube AutoPause
// @namespace           http://tampermonkey.net/
// @version             2025.07.08.001
// @license             MIT License
// @author              CY Fung
// @match               https://www.youtube.com/*
// @exclude             /^https?://\S+\.(txt|png|jpg|jpeg|gif|xml|svg|manifest|log|ini)[^\/]*$/
// @icon                https://raw.githubusercontent.com/cyfung1031/userscript-supports/main/icons/disable-youtube-autopause.svg
// @supportURL          https://github.com/cyfung1031/userscript-supports
// @run-at              document-start
// @grant               none
// @unwrap
// @allFrames           true
// @inject-into         page
// @downloadURL https://raw.githubusercontent.com/king1x32/compiledUserscripts/release/release/Disable20YouTube20AutoPause.user.js
// @updateURL https://raw.githubusercontent.com/king1x32/compiledUserscripts/release/release/Disable20YouTube20AutoPause.meta.js
// ==/UserScript==
!function(){"use strict";function e(...e){Date.now()<y||(y=Date.now()+280,console.log(...e))}function t(e,t,o,n,s,r,c){Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:()=>(a.resolve(new Date).then(s).catch(console.warn),2===o?`${n}`:n),set(e){const t=c.get(this);return a.resolve([t,e,new Date]).then(r).catch(console.warn),c.set(this,e),!0}})}function o(o){if(!o||s.has(o))return;const n=o.playbackPauseDelayMs,a=o.promptDelaySec,y=o.lactThresholdMs,i=Math.floor(.1*Number.MAX_SAFE_INTEGER),u=Math.floor(i/1e3);if("playbackPauseDelayMs"in o&&n>=0&&n<4*i){s.set(o,n);const a="string"==typeof n?2:+("number"==typeof n);a>=1&&t(o,"playbackPauseDelayMs",a,5*i,t=>{e(`${l} is trying to pause video...`,t.toLocaleTimeString())},e=>{const[t,o,n]=e;console.log(`${l} is trying to change value 'playbackPauseDelayMs' from ${t} to ${o} ...`,n.toLocaleTimeString())},s),"number"!=typeof(o.showPausedActions||0).length||o.tvTyh||(o.tvTyh=[],function(e){Object.defineProperty(e,"showPausedActions",{enumerable:!0,configurable:!0,get(){const e=this.tvTyh;return(e||0).length>=1&&(e.length=0),e},set:()=>!0})}(o))}if("promptDelaySec"in o&&a>=0&&a<4*u){r.set(o,a);const n="string"==typeof a?2:+("number"==typeof a);n>=1&&t(o,"promptDelaySec",n,5*u,t=>{e(`${l} is trying to pause video...`,t.toLocaleTimeString())},e=>{const[t,o,n]=e;console.log(`${l} is trying to change value 'promptDelaySec' from ${t} to ${o} ...`,n.toLocaleTimeString())},r)}if("lactThresholdMs"in o&&y>=0&&y<4*i){c.set(o,y);const e="string"==typeof y?2:+("number"==typeof y);e>=1&&t(o,"lactThresholdMs",e,5*i,()=>{},e=>{const[t,o,n]=e;console.log(`${l} is trying to change value 'lactThresholdMs' from ${t} to ${o} ...`,n.toLocaleTimeString())},c)}}function n(){1===arguments.length&&(y=Date.now()+3400),a.resolve(0).then(()=>{!function(){const e=new Set,t=document.querySelector("#page-manager")||0;try{const o=(t&&(i(t).data||t.data||i(t).__data||t.__data||0)).playerResponse;o&&e.add(o.messages)}catch(e){}const n=document.querySelector("#ytd-player")||0,a=n&&(i(n).player_||n.player_||i(n).player||n.player||0);if(a&&"function"==typeof a.getPlayerResponse)try{const t=a.getPlayerResponse();t&&e.add(t.messages)}catch(e){}const s=document.querySelector("#movie_player")||0,r=s&&(i(s).getPlayerResponse?i(s):s);if(r&&"function"==typeof r.getPlayerResponse)try{const t=r.getPlayerResponse();t&&e.add(t.messages)}catch(e){}const c=new Set;for(const t of e)if(t&&t.length>0)for(const e of t)if(e.youThereRenderer){u||(u=!0,console.log("Detected message.youThereRenderer"));let t=null;try{t=e.youThereRenderer.configData.youThereData}catch(e){}t&&c.add(t),t=null;break}if(c.size>0){h||(h=!0,console.log("Detected youThereData"));for(const e of c)o(e);c.clear()}}();const e=document.querySelector("ytd-watch-flexy")||0,t=i(e);if(t){const a=(t.youThereManager_||e.youThereManager_||0).youThereData_||0;a&&o(a);const s=t.youthereDataChanged_;"function"!=typeof s||s.lq2S7||(console.log("detected ytdFlexyCnt.youthereDataChanged_"),t.youthereDataChanged_=function(e){return function(){console.log("youthereDataChanged_()");const t=e.apply(this,arguments);return n(),t}}(s),t.youthereDataChanged_.lq2S7=1)}}).catch(console.warn)}const a=(async()=>{})().constructor,s=new WeakMap,r=new WeakMap,c=new WeakMap,l="YouTube";let y=0;const i=e=>e?e.polymerController||e.inst||e||0:e||0;let u=!1,h=!1;document.addEventListener("yt-page-data-updated",n,!1),document.addEventListener("yt-navigate-finish",n,!1),document.addEventListener("spfdone",n,!1)}();